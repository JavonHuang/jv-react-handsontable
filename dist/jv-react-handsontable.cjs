"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const sn=require("react"),lR=require("react-dom"),uR=require("antd"),mN=(...t)=>t;var Xu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function pN(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){if(this instanceof r){var i=[null];i.push.apply(i,arguments);var o=Function.bind.apply(e,i);return new o}return e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var mf={},wN={get exports(){return mf},set exports(t){mf=t}},ou={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cR;function CN(){if(cR)return ou;cR=1;var t=sn,e=Symbol.for("react.element"),n=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function s(a,l,u){var c,d={},g=null,p=null;u!==void 0&&(g=""+u),l.key!==void 0&&(g=""+l.key),l.ref!==void 0&&(p=l.ref);for(c in l)r.call(l,c)&&!o.hasOwnProperty(c)&&(d[c]=l[c]);if(a&&a.defaultProps)for(c in l=a.defaultProps,l)d[c]===void 0&&(d[c]=l[c]);return{$$typeof:e,type:a,key:g,ref:p,props:d,_owner:i.current}}return ou.Fragment=n,ou.jsx=s,ou.jsxs=s,ou}var su={};/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hR;function vN(){return hR||(hR=1,process.env.NODE_ENV!=="production"&&function(){var t=sn,e=Symbol.for("react.element"),n=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),a=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),c=Symbol.for("react.suspense_list"),d=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),p=Symbol.for("react.offscreen"),C=Symbol.iterator,E="@@iterator";function I(k){if(k===null||typeof k!="object")return null;var ue=C&&k[C]||k[E];return typeof ue=="function"?ue:null}var M=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function y(k){{for(var ue=arguments.length,me=new Array(ue>1?ue-1:0),We=1;We<ue;We++)me[We-1]=arguments[We];$("error",k,me)}}function $(k,ue,me){{var We=M.ReactDebugCurrentFrame,ht=We.getStackAddendum();ht!==""&&(ue+="%s",me=me.concat([ht]));var vt=me.map(function(ut){return String(ut)});vt.unshift("Warning: "+ue),Function.prototype.apply.call(console[k],console,vt)}}var q=!1,G=!1,X=!1,re=!1,v=!1,S;S=Symbol.for("react.module.reference");function b(k){return!!(typeof k=="string"||typeof k=="function"||k===r||k===o||v||k===i||k===u||k===c||re||k===p||q||G||X||typeof k=="object"&&k!==null&&(k.$$typeof===g||k.$$typeof===d||k.$$typeof===s||k.$$typeof===a||k.$$typeof===l||k.$$typeof===S||k.getModuleId!==void 0))}function L(k,ue,me){var We=k.displayName;if(We)return We;var ht=ue.displayName||ue.name||"";return ht!==""?me+"("+ht+")":me}function P(k){return k.displayName||"Context"}function x(k){if(k==null)return null;if(typeof k.tag=="number"&&y("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),typeof k=="function")return k.displayName||k.name||null;if(typeof k=="string")return k;switch(k){case r:return"Fragment";case n:return"Portal";case o:return"Profiler";case i:return"StrictMode";case u:return"Suspense";case c:return"SuspenseList"}if(typeof k=="object")switch(k.$$typeof){case a:var ue=k;return P(ue)+".Consumer";case s:var me=k;return P(me._context)+".Provider";case l:return L(k,k.render,"ForwardRef");case d:var We=k.displayName||null;return We!==null?We:x(k.type)||"Memo";case g:{var ht=k,vt=ht._payload,ut=ht._init;try{return x(ut(vt))}catch{return null}}}return null}var W=Object.assign,D=0,B,z,w,h,f,m,T;function O(){}O.__reactDisabledLog=!0;function _(){{if(D===0){B=console.log,z=console.info,w=console.warn,h=console.error,f=console.group,m=console.groupCollapsed,T=console.groupEnd;var k={configurable:!0,enumerable:!0,value:O,writable:!0};Object.defineProperties(console,{info:k,log:k,warn:k,error:k,group:k,groupCollapsed:k,groupEnd:k})}D++}}function Y(){{if(D--,D===0){var k={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:W({},k,{value:B}),info:W({},k,{value:z}),warn:W({},k,{value:w}),error:W({},k,{value:h}),group:W({},k,{value:f}),groupCollapsed:W({},k,{value:m}),groupEnd:W({},k,{value:T})})}D<0&&y("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}}var U=M.ReactCurrentDispatcher,ie;function se(k,ue,me){{if(ie===void 0)try{throw Error()}catch(ht){var We=ht.stack.trim().match(/\n( *(at )?)/);ie=We&&We[1]||""}return`
`+ie+k}}var oe=!1,de;{var Ce=typeof WeakMap=="function"?WeakMap:Map;de=new Ce}function pe(k,ue){if(!k||oe)return"";{var me=de.get(k);if(me!==void 0)return me}var We;oe=!0;var ht=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var vt;vt=U.current,U.current=null,_();try{if(ue){var ut=function(){throw Error()};if(Object.defineProperty(ut.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ut,[])}catch(Ht){We=Ht}Reflect.construct(k,[],ut)}else{try{ut.call()}catch(Ht){We=Ht}k.call(ut.prototype)}}else{try{throw Error()}catch(Ht){We=Ht}k()}}catch(Ht){if(Ht&&We&&typeof Ht.stack=="string"){for(var ot=Ht.stack.split(`
`),be=We.stack.split(`
`),V=ot.length-1,ae=be.length-1;V>=1&&ae>=0&&ot[V]!==be[ae];)ae--;for(;V>=1&&ae>=0;V--,ae--)if(ot[V]!==be[ae]){if(V!==1||ae!==1)do if(V--,ae--,ae<0||ot[V]!==be[ae]){var ge=`
`+ot[V].replace(" at new "," at ");return k.displayName&&ge.includes("<anonymous>")&&(ge=ge.replace("<anonymous>",k.displayName)),typeof k=="function"&&de.set(k,ge),ge}while(V>=1&&ae>=0);break}}}finally{oe=!1,U.current=vt,Y(),Error.prepareStackTrace=ht}var st=k?k.displayName||k.name:"",Mn=st?se(st):"";return typeof k=="function"&&de.set(k,Mn),Mn}function we(k,ue,me){return pe(k,!1)}function ee(k){var ue=k.prototype;return!!(ue&&ue.isReactComponent)}function ye(k,ue,me){if(k==null)return"";if(typeof k=="function")return pe(k,ee(k));if(typeof k=="string")return se(k);switch(k){case u:return se("Suspense");case c:return se("SuspenseList")}if(typeof k=="object")switch(k.$$typeof){case l:return we(k.render);case d:return ye(k.type,ue,me);case g:{var We=k,ht=We._payload,vt=We._init;try{return ye(vt(ht),ue,me)}catch{}}}return""}var $e=Object.prototype.hasOwnProperty,Ae={},Fe=M.ReactDebugCurrentFrame;function Ie(k){if(k){var ue=k._owner,me=ye(k.type,k._source,ue?ue.type:null);Fe.setExtraStackFrame(me)}else Fe.setExtraStackFrame(null)}function R(k,ue,me,We,ht){{var vt=Function.call.bind($e);for(var ut in k)if(vt(k,ut)){var ot=void 0;try{if(typeof k[ut]!="function"){var be=Error((We||"React class")+": "+me+" type `"+ut+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof k[ut]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw be.name="Invariant Violation",be}ot=k[ut](ue,ut,We,me,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(V){ot=V}ot&&!(ot instanceof Error)&&(Ie(ht),y("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",We||"React class",me,ut,typeof ot),Ie(null)),ot instanceof Error&&!(ot.message in Ae)&&(Ae[ot.message]=!0,Ie(ht),y("Failed %s type: %s",me,ot.message),Ie(null))}}}var A=Array.isArray;function N(k){return A(k)}function J(k){{var ue=typeof Symbol=="function"&&Symbol.toStringTag,me=ue&&k[Symbol.toStringTag]||k.constructor.name||"Object";return me}}function F(k){try{return Q(k),!1}catch{return!0}}function Q(k){return""+k}function K(k){if(F(k))return y("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",J(k)),Q(k)}var j=M.ReactCurrentOwner,te={key:!0,ref:!0,__self:!0,__source:!0},Z,ne,fe;fe={};function Ee(k){if($e.call(k,"ref")){var ue=Object.getOwnPropertyDescriptor(k,"ref").get;if(ue&&ue.isReactWarning)return!1}return k.ref!==void 0}function He(k){if($e.call(k,"key")){var ue=Object.getOwnPropertyDescriptor(k,"key").get;if(ue&&ue.isReactWarning)return!1}return k.key!==void 0}function ke(k,ue){if(typeof k.ref=="string"&&j.current&&ue&&j.current.stateNode!==ue){var me=x(j.current.type);fe[me]||(y('Component "%s" contains the string ref "%s". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',x(j.current.type),k.ref),fe[me]=!0)}}function Ge(k,ue){{var me=function(){Z||(Z=!0,y("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",ue))};me.isReactWarning=!0,Object.defineProperty(k,"key",{get:me,configurable:!0})}}function Rt(k,ue){{var me=function(){ne||(ne=!0,y("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",ue))};me.isReactWarning=!0,Object.defineProperty(k,"ref",{get:me,configurable:!0})}}var Qe=function(k,ue,me,We,ht,vt,ut){var ot={$$typeof:e,type:k,key:ue,ref:me,props:ut,_owner:vt};return ot._store={},Object.defineProperty(ot._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(ot,"_self",{configurable:!1,enumerable:!1,writable:!1,value:We}),Object.defineProperty(ot,"_source",{configurable:!1,enumerable:!1,writable:!1,value:ht}),Object.freeze&&(Object.freeze(ot.props),Object.freeze(ot)),ot};function mt(k,ue,me,We,ht){{var vt,ut={},ot=null,be=null;me!==void 0&&(K(me),ot=""+me),He(ue)&&(K(ue.key),ot=""+ue.key),Ee(ue)&&(be=ue.ref,ke(ue,ht));for(vt in ue)$e.call(ue,vt)&&!te.hasOwnProperty(vt)&&(ut[vt]=ue[vt]);if(k&&k.defaultProps){var V=k.defaultProps;for(vt in V)ut[vt]===void 0&&(ut[vt]=V[vt])}if(ot||be){var ae=typeof k=="function"?k.displayName||k.name||"Unknown":k;ot&&Ge(ut,ae),be&&Rt(ut,ae)}return Qe(k,ot,be,ht,We,j.current,ut)}}var Et=M.ReactCurrentOwner,eo=M.ReactDebugCurrentFrame;function Ar(k){if(k){var ue=k._owner,me=ye(k.type,k._source,ue?ue.type:null);eo.setExtraStackFrame(me)}else eo.setExtraStackFrame(null)}var xt;xt=!1;function rn(k){return typeof k=="object"&&k!==null&&k.$$typeof===e}function bi(){{if(Et.current){var k=x(Et.current.type);if(k)return`

Check the render method of \``+k+"`."}return""}}function _n(k){{if(k!==void 0){var ue=k.fileName.replace(/^.*[\\\/]/,""),me=k.lineNumber;return`

Check your code at `+ue+":"+me+"."}return""}}var Jt={};function Mt(k){{var ue=bi();if(!ue){var me=typeof k=="string"?k:k.displayName||k.name;me&&(ue=`

Check the top-level render call using <`+me+">.")}return ue}}function nu(k,ue){{if(!k._store||k._store.validated||k.key!=null)return;k._store.validated=!0;var me=Mt(ue);if(Jt[me])return;Jt[me]=!0;var We="";k&&k._owner&&k._owner!==Et.current&&(We=" It was passed a child from "+x(k._owner.type)+"."),Ar(k),y('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',me,We),Ar(null)}}function gh(k,ue){{if(typeof k!="object")return;if(N(k))for(var me=0;me<k.length;me++){var We=k[me];rn(We)&&nu(We,ue)}else if(rn(k))k._store&&(k._store.validated=!0);else if(k){var ht=I(k);if(typeof ht=="function"&&ht!==k.entries)for(var vt=ht.call(k),ut;!(ut=vt.next()).done;)rn(ut.value)&&nu(ut.value,ue)}}}function Da(k){{var ue=k.type;if(ue==null||typeof ue=="string")return;var me;if(typeof ue=="function")me=ue.propTypes;else if(typeof ue=="object"&&(ue.$$typeof===l||ue.$$typeof===d))me=ue.propTypes;else return;if(me){var We=x(ue);R(me,k.props,"prop",We,k)}else if(ue.PropTypes!==void 0&&!xt){xt=!0;var ht=x(ue);y("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",ht||"Unknown")}typeof ue.getDefaultProps=="function"&&!ue.getDefaultProps.isReactClassApproved&&y("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}function ru(k){{for(var ue=Object.keys(k.props),me=0;me<ue.length;me++){var We=ue[me];if(We!=="children"&&We!=="key"){Ar(k),y("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",We),Ar(null);break}}k.ref!==null&&(Ar(k),y("Invalid attribute `ref` supplied to `React.Fragment`."),Ar(null))}}function mh(k,ue,me,We,ht,vt){{var ut=b(k);if(!ut){var ot="";(k===void 0||typeof k=="object"&&k!==null&&Object.keys(k).length===0)&&(ot+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var be=_n(ht);be?ot+=be:ot+=bi();var V;k===null?V="null":N(k)?V="array":k!==void 0&&k.$$typeof===e?(V="<"+(x(k.type)||"Unknown")+" />",ot=" Did you accidentally export a JSX literal instead of a component?"):V=typeof k,y("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",V,ot)}var ae=mt(k,ue,me,ht,vt);if(ae==null)return ae;if(ut){var ge=ue.children;if(ge!==void 0)if(We)if(N(ge)){for(var st=0;st<ge.length;st++)gh(ge[st],k);Object.freeze&&Object.freeze(ge)}else y("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else gh(ge,k)}return k===r?ru(ae):Da(ae),ae}}function qr(k,ue,me){return mh(k,ue,me,!0)}function iu(k,ue,me){return mh(k,ue,me,!1)}var ph=iu,wh=qr;su.Fragment=r,su.jsx=ph,su.jsxs=wh}()),su}(function(t){process.env.NODE_ENV==="production"?t.exports=CN():t.exports=vN()})(wN);const au=mf.jsx,mm=mf.jsxs;var lu=function(t){return t&&t.Math===Math&&t},Bn=lu(typeof globalThis=="object"&&globalThis)||lu(typeof window=="object"&&window)||lu(typeof self=="object"&&self)||lu(typeof Xu=="object"&&Xu)||lu(typeof Xu=="object"&&Xu)||function(){return this}()||Function("return this")(),yv={},Gr=function(t){try{return!!t()}catch{return!0}},SN=Gr,qi=!SN(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),yN=Gr,fg=!yN(function(){var t=function(){}.bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),bN=fg,vh=Function.prototype.call,gg=bN?vh.bind(vh):function(){return vh.apply(vh,arguments)},e1={},t1={}.propertyIsEnumerable,n1=Object.getOwnPropertyDescriptor,RN=n1&&!t1.call({1:2},1);e1.f=RN?function(e){var n=n1(this,e);return!!n&&n.enumerable}:t1;var bv=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},r1=fg,i1=Function.prototype,nC=i1.call,EN=r1&&i1.bind.bind(nC,nC),rr=r1?EN:function(t){return function(){return nC.apply(t,arguments)}},o1=rr,TN=o1({}.toString),_N=o1("".slice),Gl=function(t){return _N(TN(t),8,-1)},MN=rr,ON=Gr,AN=Gl,pm=Object,IN=MN("".split),PN=ON(function(){return!pm("z").propertyIsEnumerable(0)})?function(t){return AN(t)==="String"?IN(t,""):pm(t)}:pm,s1=function(t){return t==null},xN=s1,HN=TypeError,a1=function(t){if(xN(t))throw new HN("Can't call method on "+t);return t},DN=PN,NN=a1,mg=function(t){return DN(NN(t))},rC=typeof document=="object"&&document.all,LN=typeof rC>"u"&&rC!==void 0,l1={all:rC,IS_HTMLDDA:LN},u1=l1,$N=u1.all,xn=u1.IS_HTMLDDA?function(t){return typeof t=="function"||t===$N}:function(t){return typeof t=="function"},dR=xn,c1=l1,kN=c1.all,Ta=c1.IS_HTMLDDA?function(t){return typeof t=="object"?t!==null:dR(t)||t===kN}:function(t){return typeof t=="object"?t!==null:dR(t)},wm=Bn,FN=xn,WN=function(t){return FN(t)?t:void 0},Yc=function(t,e){return arguments.length<2?WN(wm[t]):wm[t]&&wm[t][e]},VN=rr,h1=VN({}.isPrototypeOf),Rv=typeof navigator<"u"&&String(navigator.userAgent)||"",d1=Bn,Cm=Rv,fR=d1.process,gR=d1.Deno,mR=fR&&fR.versions||gR&&gR.version,pR=mR&&mR.v8,di,pf;pR&&(di=pR.split("."),pf=di[0]>0&&di[0]<4?1:+(di[0]+di[1]));!pf&&Cm&&(di=Cm.match(/Edge\/(\d+)/),(!di||di[1]>=74)&&(di=Cm.match(/Chrome\/(\d+)/),di&&(pf=+di[1])));var BN=pf,wR=BN,UN=Gr,YN=Bn,GN=YN.String,Ev=!!Object.getOwnPropertySymbols&&!UN(function(){var t=Symbol("symbol detection");return!GN(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&wR&&wR<41}),zN=Ev,f1=zN&&!Symbol.sham&&typeof Symbol.iterator=="symbol",jN=Yc,KN=xn,qN=h1,XN=f1,ZN=Object,Tv=XN?function(t){return typeof t=="symbol"}:function(t){var e=jN("Symbol");return KN(e)&&qN(e.prototype,ZN(t))},QN=String,g1=function(t){try{return QN(t)}catch{return"Object"}},JN=xn,eL=g1,tL=TypeError,_v=function(t){if(JN(t))return t;throw new tL(eL(t)+" is not a function")},nL=_v,rL=s1,iL=function(t,e){var n=t[e];return rL(n)?void 0:nL(n)},vm=gg,Sm=xn,ym=Ta,oL=TypeError,sL=function(t,e){var n,r;if(e==="string"&&Sm(n=t.toString)&&!ym(r=vm(n,t))||Sm(n=t.valueOf)&&!ym(r=vm(n,t))||e!=="string"&&Sm(n=t.toString)&&!ym(r=vm(n,t)))return r;throw new oL("Can't convert object to primitive value")},wf={},aL={get exports(){return wf},set exports(t){wf=t}},CR=Bn,lL=Object.defineProperty,Mv=function(t,e){try{lL(CR,t,{value:e,configurable:!0,writable:!0})}catch{CR[t]=e}return e},uL=Bn,cL=Mv,vR="__core-js_shared__",hL=uL[vR]||cL(vR,{}),Ov=hL,SR=Ov;(aL.exports=function(t,e){return SR[t]||(SR[t]=e!==void 0?e:{})})("versions",[]).push({version:"3.34.0",mode:"global",copyright:"Â© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.34.0/LICENSE",source:"https://github.com/zloirock/core-js"});var dL=a1,fL=Object,pg=function(t){return fL(dL(t))},gL=rr,mL=pg,pL=gL({}.hasOwnProperty),ko=Object.hasOwn||function(e,n){return pL(mL(e),n)},wL=rr,CL=0,vL=Math.random(),SL=wL(1 .toString),m1=function(t){return"Symbol("+(t===void 0?"":t)+")_"+SL(++CL+vL,36)},yL=Bn,bL=wf,yR=ko,RL=m1,EL=Ev,TL=f1,Ml=yL.Symbol,bm=bL("wks"),_L=TL?Ml.for||Ml:Ml&&Ml.withoutSetter||RL,wg=function(t){return yR(bm,t)||(bm[t]=EL&&yR(Ml,t)?Ml[t]:_L("Symbol."+t)),bm[t]},ML=gg,bR=Ta,RR=Tv,OL=iL,AL=sL,IL=wg,PL=TypeError,xL=IL("toPrimitive"),HL=function(t,e){if(!bR(t)||RR(t))return t;var n=OL(t,xL),r;if(n){if(e===void 0&&(e="default"),r=ML(n,t,e),!bR(r)||RR(r))return r;throw new PL("Can't convert object to primitive value")}return e===void 0&&(e="number"),AL(t,e)},DL=HL,NL=Tv,p1=function(t){var e=DL(t,"string");return NL(e)?e:e+""},LL=Bn,ER=Ta,iC=LL.document,$L=ER(iC)&&ER(iC.createElement),Av=function(t){return $L?iC.createElement(t):{}},kL=qi,FL=Gr,WL=Av,w1=!kL&&!FL(function(){return Object.defineProperty(WL("div"),"a",{get:function(){return 7}}).a!==7}),VL=qi,BL=gg,UL=e1,YL=bv,GL=mg,zL=p1,jL=ko,KL=w1,TR=Object.getOwnPropertyDescriptor;yv.f=VL?TR:function(e,n){if(e=GL(e),n=zL(n),KL)try{return TR(e,n)}catch{}if(jL(e,n))return YL(!BL(UL.f,e,n),e[n])};var _a={},qL=qi,XL=Gr,C1=qL&&XL(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),ZL=Ta,QL=String,JL=TypeError,Gc=function(t){if(ZL(t))return t;throw new JL(QL(t)+" is not an object")},e$=qi,t$=w1,n$=C1,Sh=Gc,_R=p1,r$=TypeError,Rm=Object.defineProperty,i$=Object.getOwnPropertyDescriptor,Em="enumerable",Tm="configurable",_m="writable";_a.f=e$?n$?function(e,n,r){if(Sh(e),n=_R(n),Sh(r),typeof e=="function"&&n==="prototype"&&"value"in r&&_m in r&&!r[_m]){var i=i$(e,n);i&&i[_m]&&(e[n]=r.value,r={configurable:Tm in r?r[Tm]:i[Tm],enumerable:Em in r?r[Em]:i[Em],writable:!1})}return Rm(e,n,r)}:Rm:function(e,n,r){if(Sh(e),n=_R(n),Sh(r),t$)try{return Rm(e,n,r)}catch{}if("get"in r||"set"in r)throw new r$("Accessors not supported");return"value"in r&&(e[n]=r.value),e};var o$=qi,s$=_a,a$=bv,zc=o$?function(t,e,n){return s$.f(t,e,a$(1,n))}:function(t,e,n){return t[e]=n,t},oC={},l$={get exports(){return oC},set exports(t){oC=t}},sC=qi,u$=ko,v1=Function.prototype,c$=sC&&Object.getOwnPropertyDescriptor,Iv=u$(v1,"name"),h$=Iv&&function(){}.name==="something",d$=Iv&&(!sC||sC&&c$(v1,"name").configurable),f$={EXISTS:Iv,PROPER:h$,CONFIGURABLE:d$},g$=rr,m$=xn,aC=Ov,p$=g$(Function.toString);m$(aC.inspectSource)||(aC.inspectSource=function(t){return p$(t)});var w$=aC.inspectSource,C$=Bn,v$=xn,MR=C$.WeakMap,S$=v$(MR)&&/native code/.test(String(MR)),y$=wf,b$=m1,OR=y$("keys"),S1=function(t){return OR[t]||(OR[t]=b$(t))},Pv={},R$=S$,y1=Bn,E$=Ta,T$=zc,Mm=ko,Om=Ov,_$=S1,M$=Pv,AR="Object already initialized",lC=y1.TypeError,O$=y1.WeakMap,Cf,Tc,vf,A$=function(t){return vf(t)?Tc(t):Cf(t,{})},I$=function(t){return function(e){var n;if(!E$(e)||(n=Tc(e)).type!==t)throw new lC("Incompatible receiver, "+t+" required");return n}};if(R$||Om.state){var Ri=Om.state||(Om.state=new O$);Ri.get=Ri.get,Ri.has=Ri.has,Ri.set=Ri.set,Cf=function(t,e){if(Ri.has(t))throw new lC(AR);return e.facade=t,Ri.set(t,e),e},Tc=function(t){return Ri.get(t)||{}},vf=function(t){return Ri.has(t)}}else{var Na=_$("state");M$[Na]=!0,Cf=function(t,e){if(Mm(t,Na))throw new lC(AR);return e.facade=t,T$(t,Na,e),e},Tc=function(t){return Mm(t,Na)?t[Na]:{}},vf=function(t){return Mm(t,Na)}}var P$={set:Cf,get:Tc,has:vf,enforce:A$,getterFor:I$},xv=rr,x$=Gr,H$=xn,yh=ko,uC=qi,D$=f$.CONFIGURABLE,N$=w$,b1=P$,L$=b1.enforce,$$=b1.get,IR=String,Bd=Object.defineProperty,k$=xv("".slice),F$=xv("".replace),W$=xv([].join),V$=uC&&!x$(function(){return Bd(function(){},"length",{value:8}).length!==8}),B$=String(String).split("String"),U$=l$.exports=function(t,e,n){k$(IR(e),0,7)==="Symbol("&&(e="["+F$(IR(e),/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!yh(t,"name")||D$&&t.name!==e)&&(uC?Bd(t,"name",{value:e,configurable:!0}):t.name=e),V$&&n&&yh(n,"arity")&&t.length!==n.arity&&Bd(t,"length",{value:n.arity});try{n&&yh(n,"constructor")&&n.constructor?uC&&Bd(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var r=L$(t);return yh(r,"source")||(r.source=W$(B$,typeof e=="string"?e:"")),t};Function.prototype.toString=U$(function(){return H$(this)&&$$(this).source||N$(this)},"toString");var Y$=xn,G$=_a,z$=oC,j$=Mv,K$=function(t,e,n,r){r||(r={});var i=r.enumerable,o=r.name!==void 0?r.name:e;if(Y$(n)&&z$(n,o,r),r.global)i?t[e]=n:j$(e,n);else{try{r.unsafe?t[e]&&(i=!0):delete t[e]}catch{}i?t[e]=n:G$.f(t,e,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return t},R1={},q$=Math.ceil,X$=Math.floor,Z$=Math.trunc||function(e){var n=+e;return(n>0?X$:q$)(n)},Q$=Z$,Hv=function(t){var e=+t;return e!==e||e===0?0:Q$(e)},J$=Hv,ek=Math.max,tk=Math.min,nk=function(t,e){var n=J$(t);return n<0?ek(n+e,0):tk(n,e)},rk=Hv,ik=Math.min,ok=function(t){return t>0?ik(rk(t),9007199254740991):0},sk=ok,Cg=function(t){return sk(t.length)},ak=mg,lk=nk,uk=Cg,PR=function(t){return function(e,n,r){var i=ak(e),o=uk(i),s=lk(r,o),a;if(t&&n!==n){for(;o>s;)if(a=i[s++],a!==a)return!0}else for(;o>s;s++)if((t||s in i)&&i[s]===n)return t||s||0;return!t&&-1}},ck={includes:PR(!0),indexOf:PR(!1)},hk=rr,Am=ko,dk=mg,fk=ck.indexOf,gk=Pv,xR=hk([].push),E1=function(t,e){var n=dk(t),r=0,i=[],o;for(o in n)!Am(gk,o)&&Am(n,o)&&xR(i,o);for(;e.length>r;)Am(n,o=e[r++])&&(~fk(i,o)||xR(i,o));return i},Dv=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],mk=E1,pk=Dv,wk=pk.concat("length","prototype");R1.f=Object.getOwnPropertyNames||function(e){return mk(e,wk)};var T1={};T1.f=Object.getOwnPropertySymbols;var Ck=Yc,vk=rr,Sk=R1,yk=T1,bk=Gc,Rk=vk([].concat),Ek=Ck("Reflect","ownKeys")||function(e){var n=Sk.f(bk(e)),r=yk.f;return r?Rk(n,r(e)):n},HR=ko,Tk=Ek,_k=yv,Mk=_a,_1=function(t,e,n){for(var r=Tk(e),i=Mk.f,o=_k.f,s=0;s<r.length;s++){var a=r[s];!HR(t,a)&&!(n&&HR(n,a))&&i(t,a,o(e,a))}},Ok=Gr,Ak=xn,Ik=/#|\.prototype\./,jc=function(t,e){var n=xk[Pk(t)];return n===Dk?!0:n===Hk?!1:Ak(e)?Ok(e):!!e},Pk=jc.normalize=function(t){return String(t).replace(Ik,".").toLowerCase()},xk=jc.data={},Hk=jc.NATIVE="N",Dk=jc.POLYFILL="P",Nk=jc,Im=Bn,Lk=yv.f,$k=zc,kk=K$,Fk=Mv,Wk=_1,Vk=Nk,Ma=function(t,e){var n=t.target,r=t.global,i=t.stat,o,s,a,l,u,c;if(r?s=Im:i?s=Im[n]||Fk(n,{}):s=(Im[n]||{}).prototype,s)for(a in e){if(u=e[a],t.dontCallGetSet?(c=Lk(s,a),l=c&&c.value):l=s[a],o=Vk(r?a:n+(i?".":"#")+a,t.forced),!o&&l!==void 0){if(typeof u==typeof l)continue;Wk(u,l)}(t.sham||l&&l.sham)&&$k(u,"sham",!0),kk(s,a,u,t)}},Bk=Gl,M1=Array.isArray||function(e){return Bk(e)==="Array"},Uk=qi,Yk=M1,Gk=TypeError,zk=Object.getOwnPropertyDescriptor,jk=Uk&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}(),O1=jk?function(t,e){if(Yk(t)&&!zk(t,"length").writable)throw new Gk("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},Kk=TypeError,qk=9007199254740991,A1=function(t){if(t>qk)throw Kk("Maximum allowed index exceeded");return t},Xk=Ma,Zk=pg,Qk=Cg,Jk=O1,eF=A1,tF=Gr,nF=tF(function(){return[].push.call({length:4294967296},1)!==4294967297}),rF=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},iF=nF||!rF();Xk({target:"Array",proto:!0,arity:1,forced:iF},{push:function(e){var n=Zk(this),r=Qk(n),i=arguments.length;eF(r+i);for(var o=0;o<i;o++)n[r]=arguments[o],r++;return Jk(n,r),r}});var oF=fg,I1=Function.prototype,DR=I1.apply,NR=I1.call,vg=typeof Reflect=="object"&&Reflect.apply||(oF?NR.bind(DR):function(){return NR.apply(DR,arguments)}),sF=rr,aF=_v,lF=function(t,e,n){try{return sF(aF(Object.getOwnPropertyDescriptor(t,e)[n]))}catch{}},uF=xn,cF=String,hF=TypeError,dF=function(t){if(typeof t=="object"||uF(t))return t;throw new hF("Can't set "+cF(t)+" as a prototype")},fF=lF,gF=Gc,mF=dF,P1=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},n;try{n=fF(Object.prototype,"__proto__","set"),n(e,[]),t=e instanceof Array}catch{}return function(i,o){return gF(i),mF(o),t?n(i,o):i.__proto__=o,i}}():void 0),pF=_a.f,wF=function(t,e,n){n in t||pF(t,n,{configurable:!0,get:function(){return e[n]},set:function(r){e[n]=r}})},CF=xn,vF=Ta,LR=P1,SF=function(t,e,n){var r,i;return LR&&CF(r=e.constructor)&&r!==n&&vF(i=r.prototype)&&i!==n.prototype&&LR(t,i),t},yF=wg,bF=yF("toStringTag"),x1={};x1[bF]="z";var RF=String(x1)==="[object z]",EF=RF,TF=xn,Ud=Gl,_F=wg,MF=_F("toStringTag"),OF=Object,AF=Ud(function(){return arguments}())==="Arguments",IF=function(t,e){try{return t[e]}catch{}},PF=EF?Ud:function(t){var e,n,r;return t===void 0?"Undefined":t===null?"Null":typeof(n=IF(e=OF(t),MF))=="string"?n:AF?Ud(e):(r=Ud(e))==="Object"&&TF(e.callee)?"Arguments":r},xF=PF,HF=String,H1=function(t){if(xF(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return HF(t)},DF=H1,NF=function(t,e){return t===void 0?arguments.length<2?"":e:DF(t)},LF=Ta,$F=zc,kF=function(t,e){LF(e)&&"cause"in e&&$F(t,"cause",e.cause)},FF=rr,D1=Error,WF=FF("".replace),VF=function(t){return String(new D1(t).stack)}("zxcasd"),N1=/\n\s*at [^:]*:[^\n]*/,BF=N1.test(VF),UF=function(t,e){if(BF&&typeof t=="string"&&!D1.prepareStackTrace)for(;e--;)t=WF(t,N1,"");return t},YF=Gr,GF=bv,zF=!YF(function(){var t=new Error("a");return"stack"in t?(Object.defineProperty(t,"stack",GF(1,7)),t.stack!==7):!0}),jF=zc,KF=UF,qF=zF,$R=Error.captureStackTrace,XF=function(t,e,n,r){qF&&($R?$R(t,e):jF(t,"stack",KF(n,r)))},kR=Yc,ZF=ko,FR=zc,QF=h1,WR=P1,VR=_1,BR=wF,JF=SF,eW=NF,tW=kF,nW=XF,rW=qi,iW=function(t,e,n,r){var i="stackTraceLimit",o=r?2:1,s=t.split("."),a=s[s.length-1],l=kR.apply(null,s);if(l){var u=l.prototype;if(ZF(u,"cause")&&delete u.cause,!n)return l;var c=kR("Error"),d=e(function(g,p){var C=eW(r?p:g,void 0),E=r?new l(g):new l;return C!==void 0&&FR(E,"message",C),nW(E,d,E.stack,2),this&&QF(u,this)&&JF(E,this,d),arguments.length>o&&tW(E,arguments[o]),E});d.prototype=u,a!=="Error"?WR?WR(d,c):VR(d,c,{name:!0}):rW&&i in l&&(BR(d,l,i),BR(d,l,"prepareStackTrace")),VR(d,l);try{u.name!==a&&FR(u,"name",a),u.constructor=d}catch{}return d}},L1=Ma,oW=Bn,Xi=vg,$1=iW,cC="WebAssembly",UR=oW[cC],Sf=new Error("e",{cause:7}).cause!==7,Oa=function(t,e){var n={};n[t]=$1(t,e,Sf),L1({global:!0,constructor:!0,arity:1,forced:Sf},n)},Nv=function(t,e){if(UR&&UR[t]){var n={};n[t]=$1(cC+"."+t,e,Sf),L1({target:cC,stat:!0,constructor:!0,arity:1,forced:Sf},n)}};Oa("Error",function(t){return function(n){return Xi(t,this,arguments)}});Oa("EvalError",function(t){return function(n){return Xi(t,this,arguments)}});Oa("RangeError",function(t){return function(n){return Xi(t,this,arguments)}});Oa("ReferenceError",function(t){return function(n){return Xi(t,this,arguments)}});Oa("SyntaxError",function(t){return function(n){return Xi(t,this,arguments)}});Oa("TypeError",function(t){return function(n){return Xi(t,this,arguments)}});Oa("URIError",function(t){return function(n){return Xi(t,this,arguments)}});Nv("CompileError",function(t){return function(n){return Xi(t,this,arguments)}});Nv("LinkError",function(t){return function(n){return Xi(t,this,arguments)}});Nv("RuntimeError",function(t){return function(n){return Xi(t,this,arguments)}});var sW=Gl,aW=rr,lW=function(t){if(sW(t)==="Function")return aW(t)},YR=lW,uW=_v,cW=fg,hW=YR(YR.bind),dW=function(t,e){return uW(t),e===void 0?t:cW?hW(t,e):function(){return t.apply(e,arguments)}},fW=Yc,k1=fW("document","documentElement"),gW=rr,Lv=gW([].slice),mW=TypeError,F1=function(t,e){if(t<e)throw new mW("Not enough arguments");return t},pW=Rv,wW=/(?:ipad|iphone|ipod).*applewebkit/i.test(pW),CW=Bn,vW=Gl,SW=vW(CW.process)==="process",Tr=Bn,yW=vg,bW=dW,GR=xn,RW=ko,W1=Gr,zR=k1,EW=Lv,jR=Av,TW=F1,_W=wW,MW=SW,hC=Tr.setImmediate,dC=Tr.clearImmediate,OW=Tr.process,Pm=Tr.Dispatch,AW=Tr.Function,KR=Tr.MessageChannel,IW=Tr.String,xm=0,rc={},qR="onreadystatechange",_c,xs,Hm,Dm;W1(function(){_c=Tr.location});var $v=function(t){if(RW(rc,t)){var e=rc[t];delete rc[t],e()}},Nm=function(t){return function(){$v(t)}},XR=function(t){$v(t.data)},ZR=function(t){Tr.postMessage(IW(t),_c.protocol+"//"+_c.host)};(!hC||!dC)&&(hC=function(e){TW(arguments.length,1);var n=GR(e)?e:AW(e),r=EW(arguments,1);return rc[++xm]=function(){yW(n,void 0,r)},xs(xm),xm},dC=function(e){delete rc[e]},MW?xs=function(t){OW.nextTick(Nm(t))}:Pm&&Pm.now?xs=function(t){Pm.now(Nm(t))}:KR&&!_W?(Hm=new KR,Dm=Hm.port2,Hm.port1.onmessage=XR,xs=bW(Dm.postMessage,Dm)):Tr.addEventListener&&GR(Tr.postMessage)&&!Tr.importScripts&&_c&&_c.protocol!=="file:"&&!W1(ZR)?(xs=ZR,Tr.addEventListener("message",XR,!1)):qR in jR("script")?xs=function(t){zR.appendChild(jR("script"))[qR]=function(){zR.removeChild(this),$v(t)}}:xs=function(t){setTimeout(Nm(t),0)});var V1={set:hC,clear:dC},PW=Ma,xW=Bn,QR=V1.clear;PW({global:!0,bind:!0,enumerable:!0,forced:xW.clearImmediate!==QR},{clearImmediate:QR});var HW=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",B1=Bn,DW=vg,NW=xn,LW=HW,$W=Rv,kW=Lv,FW=F1,WW=B1.Function,VW=/MSIE .\./.test($W)||LW&&function(){var t=B1.Bun.version.split(".");return t.length<3||t[0]==="0"&&(t[1]<3||t[1]==="3"&&t[2]==="0")}(),BW=function(t,e){var n=e?2:1;return VW?function(r,i){var o=FW(arguments.length,1)>n,s=NW(r)?r:WW(r),a=o?kW(arguments,n):[],l=o?function(){DW(s,this,a)}:s;return e?t(l,i):t(l)}:t},UW=Ma,U1=Bn,JR=V1.set,YW=BW,e0=U1.setImmediate?YW(JR,!1):JR;UW({global:!0,bind:!0,enumerable:!0,forced:U1.setImmediate!==e0},{setImmediate:e0});/*! @license DOMPurify 2.4.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.7/LICENSE */function ls(t){return ls=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ls(t)}function fC(t,e){return fC=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},fC(t,e)}function GW(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Yd(t,e,n){return GW()?Yd=Reflect.construct:Yd=function(i,o,s){var a=[null];a.push.apply(a,o);var l=Function.bind.apply(i,a),u=new l;return s&&fC(u,s.prototype),u},Yd.apply(null,arguments)}function ai(t){return zW(t)||jW(t)||KW(t)||qW()}function zW(t){if(Array.isArray(t))return gC(t)}function jW(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function KW(t,e){if(t){if(typeof t=="string")return gC(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return gC(t,e)}}function gC(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function qW(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var XW=Object.hasOwnProperty,t0=Object.setPrototypeOf,ZW=Object.isFrozen,QW=Object.getPrototypeOf,JW=Object.getOwnPropertyDescriptor,nr=Object.freeze,pi=Object.seal,eV=Object.create,Y1=typeof Reflect<"u"&&Reflect,yf=Y1.apply,mC=Y1.construct;yf||(yf=function(e,n,r){return e.apply(n,r)});nr||(nr=function(e){return e});pi||(pi=function(e){return e});mC||(mC=function(e,n){return Yd(e,ai(n))});var tV=Yr(Array.prototype.forEach),n0=Yr(Array.prototype.pop),uu=Yr(Array.prototype.push),Gd=Yr(String.prototype.toLowerCase),Lm=Yr(String.prototype.toString),nV=Yr(String.prototype.match),Xr=Yr(String.prototype.replace),rV=Yr(String.prototype.indexOf),iV=Yr(String.prototype.trim),Gn=Yr(RegExp.prototype.test),$m=oV(TypeError);function Yr(t){return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return yf(t,e,r)}}function oV(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return mC(t,n)}}function tt(t,e,n){var r;n=(r=n)!==null&&r!==void 0?r:Gd,t0&&t0(t,null);for(var i=e.length;i--;){var o=e[i];if(typeof o=="string"){var s=n(o);s!==o&&(ZW(e)||(e[i]=s),o=s)}t[o]=!0}return t}function Hs(t){var e=eV(null),n;for(n in t)yf(XW,t,[n])===!0&&(e[n]=t[n]);return e}function bh(t,e){for(;t!==null;){var n=JW(t,e);if(n){if(n.get)return Yr(n.get);if(typeof n.value=="function")return Yr(n.value)}t=QW(t)}function r(i){return console.warn("fallback value for",i),null}return r}var r0=nr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),km=nr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Fm=nr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),sV=nr(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Wm=nr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),aV=nr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),i0=nr(["#text"]),o0=nr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Vm=nr(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),s0=nr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Rh=nr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),lV=pi(/\{\{[\w\W]*|[\w\W]*\}\}/gm),uV=pi(/<%[\w\W]*|[\w\W]*%>/gm),cV=pi(/\${[\w\W]*}/gm),hV=pi(/^data-[\-\w.\u00B7-\uFFFF]/),dV=pi(/^aria-[\-\w]+$/),fV=pi(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),gV=pi(/^(?:\w+script|data):/i),mV=pi(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),pV=pi(/^html$/i),wV=function(){return typeof window>"u"?null:window},CV=function(e,n){if(ls(e)!=="object"||typeof e.createPolicy!="function")return null;var r=null,i="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(i)&&(r=n.currentScript.getAttribute(i));var o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML:function(a){return a},createScriptURL:function(a){return a}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function G1(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:wV(),e=function(V){return G1(V)};if(e.version="2.4.7",e.removed=[],!t||!t.document||t.document.nodeType!==9)return e.isSupported=!1,e;var n=t.document,r=t.document,i=t.DocumentFragment,o=t.HTMLTemplateElement,s=t.Node,a=t.Element,l=t.NodeFilter,u=t.NamedNodeMap,c=u===void 0?t.NamedNodeMap||t.MozNamedAttrMap:u,d=t.HTMLFormElement,g=t.DOMParser,p=t.trustedTypes,C=a.prototype,E=bh(C,"cloneNode"),I=bh(C,"nextSibling"),M=bh(C,"childNodes"),y=bh(C,"parentNode");if(typeof o=="function"){var $=r.createElement("template");$.content&&$.content.ownerDocument&&(r=$.content.ownerDocument)}var q=CV(p,n),G=q?q.createHTML(""):"",X=r,re=X.implementation,v=X.createNodeIterator,S=X.createDocumentFragment,b=X.getElementsByTagName,L=n.importNode,P={};try{P=Hs(r).documentMode?r.documentMode:{}}catch{}var x={};e.isSupported=typeof y=="function"&&re&&re.createHTMLDocument!==void 0&&P!==9;var W=lV,D=uV,B=cV,z=hV,w=dV,h=gV,f=mV,m=fV,T=null,O=tt({},[].concat(ai(r0),ai(km),ai(Fm),ai(Wm),ai(i0))),_=null,Y=tt({},[].concat(ai(o0),ai(Vm),ai(s0),ai(Rh))),U=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ie=null,se=null,oe=!0,de=!0,Ce=!1,pe=!0,we=!1,ee=!1,ye=!1,$e=!1,Ae=!1,Fe=!1,Ie=!1,R=!0,A=!1,N="user-content-",J=!0,F=!1,Q={},K=null,j=tt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),te=null,Z=tt({},["audio","video","img","source","image","track"]),ne=null,fe=tt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Ee="http://www.w3.org/1998/Math/MathML",He="http://www.w3.org/2000/svg",ke="http://www.w3.org/1999/xhtml",Ge=ke,Rt=!1,Qe=null,mt=tt({},[Ee,He,ke],Lm),Et,eo=["application/xhtml+xml","text/html"],Ar="text/html",xt,rn=null,bi=r.createElement("form"),_n=function(V){return V instanceof RegExp||V instanceof Function},Jt=function(V){rn&&rn===V||((!V||ls(V)!=="object")&&(V={}),V=Hs(V),Et=eo.indexOf(V.PARSER_MEDIA_TYPE)===-1?Et=Ar:Et=V.PARSER_MEDIA_TYPE,xt=Et==="application/xhtml+xml"?Lm:Gd,T="ALLOWED_TAGS"in V?tt({},V.ALLOWED_TAGS,xt):O,_="ALLOWED_ATTR"in V?tt({},V.ALLOWED_ATTR,xt):Y,Qe="ALLOWED_NAMESPACES"in V?tt({},V.ALLOWED_NAMESPACES,Lm):mt,ne="ADD_URI_SAFE_ATTR"in V?tt(Hs(fe),V.ADD_URI_SAFE_ATTR,xt):fe,te="ADD_DATA_URI_TAGS"in V?tt(Hs(Z),V.ADD_DATA_URI_TAGS,xt):Z,K="FORBID_CONTENTS"in V?tt({},V.FORBID_CONTENTS,xt):j,ie="FORBID_TAGS"in V?tt({},V.FORBID_TAGS,xt):{},se="FORBID_ATTR"in V?tt({},V.FORBID_ATTR,xt):{},Q="USE_PROFILES"in V?V.USE_PROFILES:!1,oe=V.ALLOW_ARIA_ATTR!==!1,de=V.ALLOW_DATA_ATTR!==!1,Ce=V.ALLOW_UNKNOWN_PROTOCOLS||!1,pe=V.ALLOW_SELF_CLOSE_IN_ATTR!==!1,we=V.SAFE_FOR_TEMPLATES||!1,ee=V.WHOLE_DOCUMENT||!1,Ae=V.RETURN_DOM||!1,Fe=V.RETURN_DOM_FRAGMENT||!1,Ie=V.RETURN_TRUSTED_TYPE||!1,$e=V.FORCE_BODY||!1,R=V.SANITIZE_DOM!==!1,A=V.SANITIZE_NAMED_PROPS||!1,J=V.KEEP_CONTENT!==!1,F=V.IN_PLACE||!1,m=V.ALLOWED_URI_REGEXP||m,Ge=V.NAMESPACE||ke,U=V.CUSTOM_ELEMENT_HANDLING||{},V.CUSTOM_ELEMENT_HANDLING&&_n(V.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(U.tagNameCheck=V.CUSTOM_ELEMENT_HANDLING.tagNameCheck),V.CUSTOM_ELEMENT_HANDLING&&_n(V.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(U.attributeNameCheck=V.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),V.CUSTOM_ELEMENT_HANDLING&&typeof V.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(U.allowCustomizedBuiltInElements=V.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),we&&(de=!1),Fe&&(Ae=!0),Q&&(T=tt({},ai(i0)),_=[],Q.html===!0&&(tt(T,r0),tt(_,o0)),Q.svg===!0&&(tt(T,km),tt(_,Vm),tt(_,Rh)),Q.svgFilters===!0&&(tt(T,Fm),tt(_,Vm),tt(_,Rh)),Q.mathMl===!0&&(tt(T,Wm),tt(_,s0),tt(_,Rh))),V.ADD_TAGS&&(T===O&&(T=Hs(T)),tt(T,V.ADD_TAGS,xt)),V.ADD_ATTR&&(_===Y&&(_=Hs(_)),tt(_,V.ADD_ATTR,xt)),V.ADD_URI_SAFE_ATTR&&tt(ne,V.ADD_URI_SAFE_ATTR,xt),V.FORBID_CONTENTS&&(K===j&&(K=Hs(K)),tt(K,V.FORBID_CONTENTS,xt)),J&&(T["#text"]=!0),ee&&tt(T,["html","head","body"]),T.table&&(tt(T,["tbody"]),delete ie.tbody),nr&&nr(V),rn=V)},Mt=tt({},["mi","mo","mn","ms","mtext"]),nu=tt({},["foreignobject","desc","title","annotation-xml"]),gh=tt({},["title","style","font","a","script"]),Da=tt({},km);tt(Da,Fm),tt(Da,sV);var ru=tt({},Wm);tt(ru,aV);var mh=function(V){var ae=y(V);(!ae||!ae.tagName)&&(ae={namespaceURI:Ge,tagName:"template"});var ge=Gd(V.tagName),st=Gd(ae.tagName);return Qe[V.namespaceURI]?V.namespaceURI===He?ae.namespaceURI===ke?ge==="svg":ae.namespaceURI===Ee?ge==="svg"&&(st==="annotation-xml"||Mt[st]):Boolean(Da[ge]):V.namespaceURI===Ee?ae.namespaceURI===ke?ge==="math":ae.namespaceURI===He?ge==="math"&&nu[st]:Boolean(ru[ge]):V.namespaceURI===ke?ae.namespaceURI===He&&!nu[st]||ae.namespaceURI===Ee&&!Mt[st]?!1:!ru[ge]&&(gh[ge]||!Da[ge]):!!(Et==="application/xhtml+xml"&&Qe[V.namespaceURI]):!1},qr=function(V){uu(e.removed,{element:V});try{V.parentNode.removeChild(V)}catch{try{V.outerHTML=G}catch{V.remove()}}},iu=function(V,ae){try{uu(e.removed,{attribute:ae.getAttributeNode(V),from:ae})}catch{uu(e.removed,{attribute:null,from:ae})}if(ae.removeAttribute(V),V==="is"&&!_[V])if(Ae||Fe)try{qr(ae)}catch{}else try{ae.setAttribute(V,"")}catch{}},ph=function(V){var ae,ge;if($e)V="<remove></remove>"+V;else{var st=nV(V,/^[\r\n\t ]+/);ge=st&&st[0]}Et==="application/xhtml+xml"&&Ge===ke&&(V='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+V+"</body></html>");var Mn=q?q.createHTML(V):V;if(Ge===ke)try{ae=new g().parseFromString(Mn,Et)}catch{}if(!ae||!ae.documentElement){ae=re.createDocument(Ge,"template",null);try{ae.documentElement.innerHTML=Rt?G:Mn}catch{}}var Ht=ae.body||ae.documentElement;return V&&ge&&Ht.insertBefore(r.createTextNode(ge),Ht.childNodes[0]||null),Ge===ke?b.call(ae,ee?"html":"body")[0]:ee?ae.documentElement:Ht},wh=function(V){return v.call(V.ownerDocument||V,V,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT,null,!1)},k=function(V){return V instanceof d&&(typeof V.nodeName!="string"||typeof V.textContent!="string"||typeof V.removeChild!="function"||!(V.attributes instanceof c)||typeof V.removeAttribute!="function"||typeof V.setAttribute!="function"||typeof V.namespaceURI!="string"||typeof V.insertBefore!="function"||typeof V.hasChildNodes!="function")},ue=function(V){return ls(s)==="object"?V instanceof s:V&&ls(V)==="object"&&typeof V.nodeType=="number"&&typeof V.nodeName=="string"},me=function(V,ae,ge){x[V]&&tV(x[V],function(st){st.call(e,ae,ge,rn)})},We=function(V){var ae;if(me("beforeSanitizeElements",V,null),k(V)||Gn(/[\u0080-\uFFFF]/,V.nodeName))return qr(V),!0;var ge=xt(V.nodeName);if(me("uponSanitizeElement",V,{tagName:ge,allowedTags:T}),V.hasChildNodes()&&!ue(V.firstElementChild)&&(!ue(V.content)||!ue(V.content.firstElementChild))&&Gn(/<[/\w]/g,V.innerHTML)&&Gn(/<[/\w]/g,V.textContent)||ge==="select"&&Gn(/<template/i,V.innerHTML))return qr(V),!0;if(!T[ge]||ie[ge]){if(!ie[ge]&&vt(ge)&&(U.tagNameCheck instanceof RegExp&&Gn(U.tagNameCheck,ge)||U.tagNameCheck instanceof Function&&U.tagNameCheck(ge)))return!1;if(J&&!K[ge]){var st=y(V)||V.parentNode,Mn=M(V)||V.childNodes;if(Mn&&st)for(var Ht=Mn.length,On=Ht-1;On>=0;--On)st.insertBefore(E(Mn[On],!0),I(V))}return qr(V),!0}return V instanceof a&&!mh(V)||(ge==="noscript"||ge==="noembed"||ge==="noframes")&&Gn(/<\/no(script|embed|frames)/i,V.innerHTML)?(qr(V),!0):(we&&V.nodeType===3&&(ae=V.textContent,ae=Xr(ae,W," "),ae=Xr(ae,D," "),ae=Xr(ae,B," "),V.textContent!==ae&&(uu(e.removed,{element:V.cloneNode()}),V.textContent=ae)),me("afterSanitizeElements",V,null),!1)},ht=function(V,ae,ge){if(R&&(ae==="id"||ae==="name")&&(ge in r||ge in bi))return!1;if(!(de&&!se[ae]&&Gn(z,ae))){if(!(oe&&Gn(w,ae))){if(!_[ae]||se[ae]){if(!(vt(V)&&(U.tagNameCheck instanceof RegExp&&Gn(U.tagNameCheck,V)||U.tagNameCheck instanceof Function&&U.tagNameCheck(V))&&(U.attributeNameCheck instanceof RegExp&&Gn(U.attributeNameCheck,ae)||U.attributeNameCheck instanceof Function&&U.attributeNameCheck(ae))||ae==="is"&&U.allowCustomizedBuiltInElements&&(U.tagNameCheck instanceof RegExp&&Gn(U.tagNameCheck,ge)||U.tagNameCheck instanceof Function&&U.tagNameCheck(ge))))return!1}else if(!ne[ae]){if(!Gn(m,Xr(ge,f,""))){if(!((ae==="src"||ae==="xlink:href"||ae==="href")&&V!=="script"&&rV(ge,"data:")===0&&te[V])){if(!(Ce&&!Gn(h,Xr(ge,f,"")))){if(ge)return!1}}}}}}return!0},vt=function(V){return V.indexOf("-")>0},ut=function(V){var ae,ge,st,Mn;me("beforeSanitizeAttributes",V,null);var Ht=V.attributes;if(Ht){var On={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:_};for(Mn=Ht.length;Mn--;){ae=Ht[Mn];var Ch=ae,vn=Ch.name,gm=Ch.namespaceURI;if(ge=vn==="value"?ae.value:iV(ae.value),st=xt(vn),On.attrName=st,On.attrValue=ge,On.keepAttr=!0,On.forceKeepAttr=void 0,me("uponSanitizeAttribute",V,On),ge=On.attrValue,!On.forceKeepAttr&&(iu(vn,V),!!On.keepAttr)){if(!pe&&Gn(/\/>/i,ge)){iu(vn,V);continue}we&&(ge=Xr(ge,W," "),ge=Xr(ge,D," "),ge=Xr(ge,B," "));var aR=xt(V.nodeName);if(ht(aR,st,ge)){if(A&&(st==="id"||st==="name")&&(iu(vn,V),ge=N+ge),q&&ls(p)==="object"&&typeof p.getAttributeType=="function"&&!gm)switch(p.getAttributeType(aR,st)){case"TrustedHTML":{ge=q.createHTML(ge);break}case"TrustedScriptURL":{ge=q.createScriptURL(ge);break}}try{gm?V.setAttributeNS(gm,vn,ge):V.setAttribute(vn,ge),n0(e.removed)}catch{}}}}me("afterSanitizeAttributes",V,null)}},ot=function be(V){var ae,ge=wh(V);for(me("beforeSanitizeShadowDOM",V,null);ae=ge.nextNode();)me("uponSanitizeShadowNode",ae,null),!We(ae)&&(ae.content instanceof i&&be(ae.content),ut(ae));me("afterSanitizeShadowDOM",V,null)};return e.sanitize=function(be){var V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ae,ge,st,Mn,Ht;if(Rt=!be,Rt&&(be="<!-->"),typeof be!="string"&&!ue(be))if(typeof be.toString=="function"){if(be=be.toString(),typeof be!="string")throw $m("dirty is not a string, aborting")}else throw $m("toString is not a function");if(!e.isSupported){if(ls(t.toStaticHTML)==="object"||typeof t.toStaticHTML=="function"){if(typeof be=="string")return t.toStaticHTML(be);if(ue(be))return t.toStaticHTML(be.outerHTML)}return be}if(ye||Jt(V),e.removed=[],typeof be=="string"&&(F=!1),F){if(be.nodeName){var On=xt(be.nodeName);if(!T[On]||ie[On])throw $m("root node is forbidden and cannot be sanitized in-place")}}else if(be instanceof s)ae=ph("<!---->"),ge=ae.ownerDocument.importNode(be,!0),ge.nodeType===1&&ge.nodeName==="BODY"||ge.nodeName==="HTML"?ae=ge:ae.appendChild(ge);else{if(!Ae&&!we&&!ee&&be.indexOf("<")===-1)return q&&Ie?q.createHTML(be):be;if(ae=ph(be),!ae)return Ae?null:Ie?G:""}ae&&$e&&qr(ae.firstChild);for(var Ch=wh(F?be:ae);st=Ch.nextNode();)st.nodeType===3&&st===Mn||We(st)||(st.content instanceof i&&ot(st.content),ut(st),Mn=st);if(Mn=null,F)return be;if(Ae){if(Fe)for(Ht=S.call(ae.ownerDocument);ae.firstChild;)Ht.appendChild(ae.firstChild);else Ht=ae;return(_.shadowroot||_.shadowrootmod)&&(Ht=L.call(n,Ht,!0)),Ht}var vn=ee?ae.outerHTML:ae.innerHTML;return ee&&T["!doctype"]&&ae.ownerDocument&&ae.ownerDocument.doctype&&ae.ownerDocument.doctype.name&&Gn(pV,ae.ownerDocument.doctype.name)&&(vn="<!DOCTYPE "+ae.ownerDocument.doctype.name+`>
`+vn),we&&(vn=Xr(vn,W," "),vn=Xr(vn,D," "),vn=Xr(vn,B," ")),q&&Ie?q.createHTML(vn):vn},e.setConfig=function(be){Jt(be),ye=!0},e.clearConfig=function(){rn=null,ye=!1},e.isValidAttribute=function(be,V,ae){rn||Jt({});var ge=xt(be),st=xt(V);return ht(ge,st,ae)},e.addHook=function(be,V){typeof V=="function"&&(x[be]=x[be]||[],uu(x[be],V))},e.removeHook=function(be){if(x[be])return n0(x[be])},e.removeHooks=function(be){x[be]&&(x[be]=[])},e.removeAllHooks=function(){x={}},e}var vV=G1();//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var z1;function le(){return z1.apply(null,arguments)}function SV(t){z1=t}function wi(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function Ca(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function wt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function kv(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(wt(t,e))return!1;return!0}function hr(t){return t===void 0}function Do(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function Kc(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function j1(t,e){var n=[],r,i=t.length;for(r=0;r<i;++r)n.push(e(t[r],r));return n}function fs(t,e){for(var n in e)wt(e,n)&&(t[n]=e[n]);return wt(e,"toString")&&(t.toString=e.toString),wt(e,"valueOf")&&(t.valueOf=e.valueOf),t}function Zi(t,e,n,r){return wI(t,e,n,r,!0).utc()}function yV(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Je(t){return t._pf==null&&(t._pf=yV()),t._pf}var pC;Array.prototype.some?pC=Array.prototype.some:pC=function(t){var e=Object(this),n=e.length>>>0,r;for(r=0;r<n;r++)if(r in e&&t.call(this,e[r],r,e))return!0;return!1};function Fv(t){if(t._isValid==null){var e=Je(t),n=pC.call(e.parsedDateParts,function(i){return i!=null}),r=!isNaN(t._d.getTime())&&e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n);if(t._strict&&(r=r&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=r;else return r}return t._isValid}function Sg(t){var e=Zi(NaN);return t!=null?fs(Je(e),t):Je(e).userInvalidated=!0,e}var a0=le.momentProperties=[],Bm=!1;function Wv(t,e){var n,r,i,o=a0.length;if(hr(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),hr(e._i)||(t._i=e._i),hr(e._f)||(t._f=e._f),hr(e._l)||(t._l=e._l),hr(e._strict)||(t._strict=e._strict),hr(e._tzm)||(t._tzm=e._tzm),hr(e._isUTC)||(t._isUTC=e._isUTC),hr(e._offset)||(t._offset=e._offset),hr(e._pf)||(t._pf=Je(e)),hr(e._locale)||(t._locale=e._locale),o>0)for(n=0;n<o;n++)r=a0[n],i=e[r],hr(i)||(t[r]=i);return t}function qc(t){Wv(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),Bm===!1&&(Bm=!0,le.updateOffset(this),Bm=!1)}function Ci(t){return t instanceof qc||t!=null&&t._isAMomentObject!=null}function K1(t){le.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function zr(t,e){var n=!0;return fs(function(){if(le.deprecationHandler!=null&&le.deprecationHandler(null,t),n){var r=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])wt(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];r.push(i)}K1(t+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var l0={};function q1(t,e){le.deprecationHandler!=null&&le.deprecationHandler(t,e),l0[t]||(K1(e),l0[t]=!0)}le.suppressDeprecationWarnings=!1;le.deprecationHandler=null;function Qi(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function bV(t){var e,n;for(n in t)wt(t,n)&&(e=t[n],Qi(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function wC(t,e){var n=fs({},t),r;for(r in e)wt(e,r)&&(Ca(t[r])&&Ca(e[r])?(n[r]={},fs(n[r],t[r]),fs(n[r],e[r])):e[r]!=null?n[r]=e[r]:delete n[r]);for(r in t)wt(t,r)&&!wt(e,r)&&Ca(t[r])&&(n[r]=fs({},n[r]));return n}function Vv(t){t!=null&&this.set(t)}var CC;Object.keys?CC=Object.keys:CC=function(t){var e,n=[];for(e in t)wt(t,e)&&n.push(e);return n};var RV={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function EV(t,e,n){var r=this._calendar[t]||this._calendar.sameElse;return Qi(r)?r.call(e,n):r}function Ki(t,e,n){var r=""+Math.abs(t),i=e-r.length,o=t>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var Bv=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Eh=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Um={},Hl={};function Le(t,e,n,r){var i=r;typeof r=="string"&&(i=function(){return this[r]()}),t&&(Hl[t]=i),e&&(Hl[e[0]]=function(){return Ki(i.apply(this,arguments),e[1],e[2])}),n&&(Hl[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function TV(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function _V(t){var e=t.match(Bv),n,r;for(n=0,r=e.length;n<r;n++)Hl[e[n]]?e[n]=Hl[e[n]]:e[n]=TV(e[n]);return function(i){var o="",s;for(s=0;s<r;s++)o+=Qi(e[s])?e[s].call(i,t):e[s];return o}}function zd(t,e){return t.isValid()?(e=X1(e,t.localeData()),Um[e]=Um[e]||_V(e),Um[e](t)):t.localeData().invalidDate()}function X1(t,e){var n=5;function r(i){return e.longDateFormat(i)||i}for(Eh.lastIndex=0;n>=0&&Eh.test(t);)t=t.replace(Eh,r),Eh.lastIndex=0,n-=1;return t}var MV={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function OV(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(Bv).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[t])}var AV="Invalid date";function IV(){return this._invalidDate}var PV="%d",xV=/\d{1,2}/;function HV(t){return this._ordinal.replace("%d",t)}var DV={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function NV(t,e,n,r){var i=this._relativeTime[n];return Qi(i)?i(t,e,n,r):i.replace(/%d/i,t)}function LV(t,e){var n=this._relativeTime[t>0?"future":"past"];return Qi(n)?n(e):n.replace(/%s/i,e)}var ic={};function Un(t,e){var n=t.toLowerCase();ic[n]=ic[n+"s"]=ic[e]=t}function jr(t){return typeof t=="string"?ic[t]||ic[t.toLowerCase()]:void 0}function Uv(t){var e={},n,r;for(r in t)wt(t,r)&&(n=jr(r),n&&(e[n]=t[r]));return e}var Z1={};function Yn(t,e){Z1[t]=e}function $V(t){var e=[],n;for(n in t)wt(t,n)&&e.push({unit:n,priority:Z1[n]});return e.sort(function(r,i){return r.priority-i.priority}),e}function yg(t){return t%4===0&&t%100!==0||t%400===0}function Br(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function lt(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=Br(e)),n}function zl(t,e){return function(n){return n!=null?(Q1(this,t,n),le.updateOffset(this,e),this):bf(this,t)}}function bf(t,e){return t.isValid()?t._d["get"+(t._isUTC?"UTC":"")+e]():NaN}function Q1(t,e,n){t.isValid()&&!isNaN(n)&&(e==="FullYear"&&yg(t.year())&&t.month()===1&&t.date()===29?(n=lt(n),t._d["set"+(t._isUTC?"UTC":"")+e](n,t.month(),Mg(n,t.month()))):t._d["set"+(t._isUTC?"UTC":"")+e](n))}function kV(t){return t=jr(t),Qi(this[t])?this[t]():this}function FV(t,e){if(typeof t=="object"){t=Uv(t);var n=$V(t),r,i=n.length;for(r=0;r<i;r++)this[n[r].unit](t[n[r].unit])}else if(t=jr(t),Qi(this[t]))return this[t](e);return this}var J1=/\d/,Or=/\d\d/,eI=/\d{3}/,Yv=/\d{4}/,bg=/[+-]?\d{6}/,$t=/\d\d?/,tI=/\d\d\d\d?/,nI=/\d\d\d\d\d\d?/,Rg=/\d{1,3}/,Gv=/\d{1,4}/,Eg=/[+-]?\d{1,6}/,jl=/\d+/,Tg=/[+-]?\d+/,WV=/Z|[+-]\d\d:?\d\d/gi,_g=/Z|[+-]\d\d(?::?\d\d)?/gi,VV=/[+-]?\d+(\.\d{1,3})?/,Xc=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Rf;Rf={};function Me(t,e,n){Rf[t]=Qi(e)?e:function(r,i){return r&&n?n:e}}function BV(t,e){return wt(Rf,t)?Rf[t](e._strict,e._locale):new RegExp(UV(t))}function UV(t){return Er(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,r,i,o){return n||r||i||o}))}function Er(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var vC={};function Tt(t,e){var n,r=e,i;for(typeof t=="string"&&(t=[t]),Do(e)&&(r=function(o,s){s[e]=lt(o)}),i=t.length,n=0;n<i;n++)vC[t[n]]=r}function Zc(t,e){Tt(t,function(n,r,i,o){i._w=i._w||{},e(n,i._w,i,o)})}function YV(t,e,n){e!=null&&wt(vC,t)&&vC[t](e,n._a,n,t)}var Fn=0,Eo=1,Bi=2,wn=3,fi=4,To=5,da=6,GV=7,zV=8;function jV(t,e){return(t%e+e)%e}var an;Array.prototype.indexOf?an=Array.prototype.indexOf:an=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function Mg(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=jV(e,12);return t+=(e-n)/12,n===1?yg(t)?29:28:31-n%7%2}Le("M",["MM",2],"Mo",function(){return this.month()+1});Le("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});Le("MMMM",0,0,function(t){return this.localeData().months(this,t)});Un("month","M");Yn("month",8);Me("M",$t);Me("MM",$t,Or);Me("MMM",function(t,e){return e.monthsShortRegex(t)});Me("MMMM",function(t,e){return e.monthsRegex(t)});Tt(["M","MM"],function(t,e){e[Eo]=lt(t)-1});Tt(["MMM","MMMM"],function(t,e,n,r){var i=n._locale.monthsParse(t,r,n._strict);i!=null?e[Eo]=i:Je(n).invalidMonth=t});var KV="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),rI="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),iI=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,qV=Xc,XV=Xc;function ZV(t,e){return t?wi(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||iI).test(e)?"format":"standalone"][t.month()]:wi(this._months)?this._months:this._months.standalone}function QV(t,e){return t?wi(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[iI.test(e)?"format":"standalone"][t.month()]:wi(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function JV(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)o=Zi([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return n?e==="MMM"?(i=an.call(this._shortMonthsParse,s),i!==-1?i:null):(i=an.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=an.call(this._shortMonthsParse,s),i!==-1?i:(i=an.call(this._longMonthsParse,s),i!==-1?i:null)):(i=an.call(this._longMonthsParse,s),i!==-1?i:(i=an.call(this._shortMonthsParse,s),i!==-1?i:null))}function eB(t,e,n){var r,i,o;if(this._monthsParseExact)return JV.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=Zi([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!n&&!this._monthsParse[r]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[r].test(t))return r;if(n&&e==="MMM"&&this._shortMonthsParse[r].test(t))return r;if(!n&&this._monthsParse[r].test(t))return r}}function oI(t,e){var n;if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=lt(e);else if(e=t.localeData().monthsParse(e),!Do(e))return t}return n=Math.min(t.date(),Mg(t.year(),e)),t._d["set"+(t._isUTC?"UTC":"")+"Month"](e,n),t}function sI(t){return t!=null?(oI(this,t),le.updateOffset(this,!0),this):bf(this,"Month")}function tB(){return Mg(this.year(),this.month())}function nB(t){return this._monthsParseExact?(wt(this,"_monthsRegex")||aI.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(wt(this,"_monthsShortRegex")||(this._monthsShortRegex=qV),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function rB(t){return this._monthsParseExact?(wt(this,"_monthsRegex")||aI.call(this),t?this._monthsStrictRegex:this._monthsRegex):(wt(this,"_monthsRegex")||(this._monthsRegex=XV),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function aI(){function t(s,a){return a.length-s.length}var e=[],n=[],r=[],i,o;for(i=0;i<12;i++)o=Zi([2e3,i]),e.push(this.monthsShort(o,"")),n.push(this.months(o,"")),r.push(this.months(o,"")),r.push(this.monthsShort(o,""));for(e.sort(t),n.sort(t),r.sort(t),i=0;i<12;i++)e[i]=Er(e[i]),n[i]=Er(n[i]);for(i=0;i<24;i++)r[i]=Er(r[i]);this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}Le("Y",0,0,function(){var t=this.year();return t<=9999?Ki(t,4):"+"+t});Le(0,["YY",2],0,function(){return this.year()%100});Le(0,["YYYY",4],0,"year");Le(0,["YYYYY",5],0,"year");Le(0,["YYYYYY",6,!0],0,"year");Un("year","y");Yn("year",1);Me("Y",Tg);Me("YY",$t,Or);Me("YYYY",Gv,Yv);Me("YYYYY",Eg,bg);Me("YYYYYY",Eg,bg);Tt(["YYYYY","YYYYYY"],Fn);Tt("YYYY",function(t,e){e[Fn]=t.length===2?le.parseTwoDigitYear(t):lt(t)});Tt("YY",function(t,e){e[Fn]=le.parseTwoDigitYear(t)});Tt("Y",function(t,e){e[Fn]=parseInt(t,10)});function oc(t){return yg(t)?366:365}le.parseTwoDigitYear=function(t){return lt(t)+(lt(t)>68?1900:2e3)};var lI=zl("FullYear",!0);function iB(){return yg(this.year())}function oB(t,e,n,r,i,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,r,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,r,i,o,s),a}function Mc(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function Ef(t,e,n){var r=7+e-n,i=(7+Mc(t,0,r).getUTCDay()-e)%7;return-i+r-1}function uI(t,e,n,r,i){var o=(7+n-r)%7,s=Ef(t,r,i),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=oc(l)+a):a>oc(t)?(l=t+1,u=a-oc(t)):(l=t,u=a),{year:l,dayOfYear:u}}function Oc(t,e,n){var r=Ef(t.year(),e,n),i=Math.floor((t.dayOfYear()-r-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+Ho(s,e,n)):i>Ho(t.year(),e,n)?(o=i-Ho(t.year(),e,n),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function Ho(t,e,n){var r=Ef(t,e,n),i=Ef(t+1,e,n);return(oc(t)-r+i)/7}Le("w",["ww",2],"wo","week");Le("W",["WW",2],"Wo","isoWeek");Un("week","w");Un("isoWeek","W");Yn("week",5);Yn("isoWeek",5);Me("w",$t);Me("ww",$t,Or);Me("W",$t);Me("WW",$t,Or);Zc(["w","ww","W","WW"],function(t,e,n,r){e[r.substr(0,1)]=lt(t)});function sB(t){return Oc(t,this._week.dow,this._week.doy).week}var aB={dow:0,doy:6};function lB(){return this._week.dow}function uB(){return this._week.doy}function cB(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function hB(t){var e=Oc(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Le("d",0,"do","day");Le("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});Le("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});Le("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});Le("e",0,0,"weekday");Le("E",0,0,"isoWeekday");Un("day","d");Un("weekday","e");Un("isoWeekday","E");Yn("day",11);Yn("weekday",11);Yn("isoWeekday",11);Me("d",$t);Me("e",$t);Me("E",$t);Me("dd",function(t,e){return e.weekdaysMinRegex(t)});Me("ddd",function(t,e){return e.weekdaysShortRegex(t)});Me("dddd",function(t,e){return e.weekdaysRegex(t)});Zc(["dd","ddd","dddd"],function(t,e,n,r){var i=n._locale.weekdaysParse(t,r,n._strict);i!=null?e.d=i:Je(n).invalidWeekday=t});Zc(["d","e","E"],function(t,e,n,r){e[r]=lt(t)});function dB(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function fB(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function zv(t,e){return t.slice(e,7).concat(t.slice(0,e))}var gB="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),cI="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),mB="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),pB=Xc,wB=Xc,CB=Xc;function vB(t,e){var n=wi(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?zv(n,this._week.dow):t?n[t.day()]:n}function SB(t){return t===!0?zv(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function yB(t){return t===!0?zv(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function bB(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)o=Zi([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return n?e==="dddd"?(i=an.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=an.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=an.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=an.call(this._weekdaysParse,s),i!==-1||(i=an.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=an.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=an.call(this._shortWeekdaysParse,s),i!==-1||(i=an.call(this._weekdaysParse,s),i!==-1)?i:(i=an.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=an.call(this._minWeekdaysParse,s),i!==-1||(i=an.call(this._weekdaysParse,s),i!==-1)?i:(i=an.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function RB(t,e,n){var r,i,o;if(this._weekdaysParseExact)return bB.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=Zi([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[r].test(t))return r;if(n&&e==="ddd"&&this._shortWeekdaysParse[r].test(t))return r;if(n&&e==="dd"&&this._minWeekdaysParse[r].test(t))return r;if(!n&&this._weekdaysParse[r].test(t))return r}}function EB(t){if(!this.isValid())return t!=null?this:NaN;var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return t!=null?(t=dB(t,this.localeData()),this.add(t-e,"d")):e}function TB(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function _B(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=fB(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function MB(t){return this._weekdaysParseExact?(wt(this,"_weekdaysRegex")||jv.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(wt(this,"_weekdaysRegex")||(this._weekdaysRegex=pB),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function OB(t){return this._weekdaysParseExact?(wt(this,"_weekdaysRegex")||jv.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(wt(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=wB),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function AB(t){return this._weekdaysParseExact?(wt(this,"_weekdaysRegex")||jv.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(wt(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=CB),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function jv(){function t(c,d){return d.length-c.length}var e=[],n=[],r=[],i=[],o,s,a,l,u;for(o=0;o<7;o++)s=Zi([2e3,1]).day(o),a=Er(this.weekdaysMin(s,"")),l=Er(this.weekdaysShort(s,"")),u=Er(this.weekdays(s,"")),e.push(a),n.push(l),r.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),n.sort(t),r.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function Kv(){return this.hours()%12||12}function IB(){return this.hours()||24}Le("H",["HH",2],0,"hour");Le("h",["hh",2],0,Kv);Le("k",["kk",2],0,IB);Le("hmm",0,0,function(){return""+Kv.apply(this)+Ki(this.minutes(),2)});Le("hmmss",0,0,function(){return""+Kv.apply(this)+Ki(this.minutes(),2)+Ki(this.seconds(),2)});Le("Hmm",0,0,function(){return""+this.hours()+Ki(this.minutes(),2)});Le("Hmmss",0,0,function(){return""+this.hours()+Ki(this.minutes(),2)+Ki(this.seconds(),2)});function hI(t,e){Le(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}hI("a",!0);hI("A",!1);Un("hour","h");Yn("hour",13);function dI(t,e){return e._meridiemParse}Me("a",dI);Me("A",dI);Me("H",$t);Me("h",$t);Me("k",$t);Me("HH",$t,Or);Me("hh",$t,Or);Me("kk",$t,Or);Me("hmm",tI);Me("hmmss",nI);Me("Hmm",tI);Me("Hmmss",nI);Tt(["H","HH"],wn);Tt(["k","kk"],function(t,e,n){var r=lt(t);e[wn]=r===24?0:r});Tt(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});Tt(["h","hh"],function(t,e,n){e[wn]=lt(t),Je(n).bigHour=!0});Tt("hmm",function(t,e,n){var r=t.length-2;e[wn]=lt(t.substr(0,r)),e[fi]=lt(t.substr(r)),Je(n).bigHour=!0});Tt("hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[wn]=lt(t.substr(0,r)),e[fi]=lt(t.substr(r,2)),e[To]=lt(t.substr(i)),Je(n).bigHour=!0});Tt("Hmm",function(t,e,n){var r=t.length-2;e[wn]=lt(t.substr(0,r)),e[fi]=lt(t.substr(r))});Tt("Hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[wn]=lt(t.substr(0,r)),e[fi]=lt(t.substr(r,2)),e[To]=lt(t.substr(i))});function PB(t){return(t+"").toLowerCase().charAt(0)==="p"}var xB=/[ap]\.?m?\.?/i,HB=zl("Hours",!0);function DB(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var fI={calendar:RV,longDateFormat:MV,invalidDate:AV,ordinal:PV,dayOfMonthOrdinalParse:xV,relativeTime:DV,months:KV,monthsShort:rI,week:aB,weekdays:gB,weekdaysMin:mB,weekdaysShort:cI,meridiemParse:xB},Wt={},cu={},Ac;function NB(t,e){var n,r=Math.min(t.length,e.length);for(n=0;n<r;n+=1)if(t[n]!==e[n])return n;return r}function u0(t){return t&&t.toLowerCase().replace("_","-")}function LB(t){for(var e=0,n,r,i,o;e<t.length;){for(o=u0(t[e]).split("-"),n=o.length,r=u0(t[e+1]),r=r?r.split("-"):null;n>0;){if(i=Og(o.slice(0,n).join("-")),i)return i;if(r&&r.length>=n&&NB(o,r)>=n-1)break;n--}e++}return Ac}function $B(t){return t.match("^[^/\\\\]*$")!=null}function Og(t){var e=null,n;if(Wt[t]===void 0&&typeof module<"u"&&module&&module.exports&&$B(t))try{e=Ac._abbr,n=require,n("./locale/"+t),Cs(e)}catch{Wt[t]=null}return Wt[t]}function Cs(t,e){var n;return t&&(hr(e)?n=Fo(t):n=qv(t,e),n?Ac=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),Ac._abbr}function qv(t,e){if(e!==null){var n,r=fI;if(e.abbr=t,Wt[t]!=null)q1("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=Wt[t]._config;else if(e.parentLocale!=null)if(Wt[e.parentLocale]!=null)r=Wt[e.parentLocale]._config;else if(n=Og(e.parentLocale),n!=null)r=n._config;else return cu[e.parentLocale]||(cu[e.parentLocale]=[]),cu[e.parentLocale].push({name:t,config:e}),null;return Wt[t]=new Vv(wC(r,e)),cu[t]&&cu[t].forEach(function(i){qv(i.name,i.config)}),Cs(t),Wt[t]}else return delete Wt[t],null}function kB(t,e){if(e!=null){var n,r,i=fI;Wt[t]!=null&&Wt[t].parentLocale!=null?Wt[t].set(wC(Wt[t]._config,e)):(r=Og(t),r!=null&&(i=r._config),e=wC(i,e),r==null&&(e.abbr=t),n=new Vv(e),n.parentLocale=Wt[t],Wt[t]=n),Cs(t)}else Wt[t]!=null&&(Wt[t].parentLocale!=null?(Wt[t]=Wt[t].parentLocale,t===Cs()&&Cs(t)):Wt[t]!=null&&delete Wt[t]);return Wt[t]}function Fo(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Ac;if(!wi(t)){if(e=Og(t),e)return e;t=[t]}return LB(t)}function FB(){return CC(Wt)}function Xv(t){var e,n=t._a;return n&&Je(t).overflow===-2&&(e=n[Eo]<0||n[Eo]>11?Eo:n[Bi]<1||n[Bi]>Mg(n[Fn],n[Eo])?Bi:n[wn]<0||n[wn]>24||n[wn]===24&&(n[fi]!==0||n[To]!==0||n[da]!==0)?wn:n[fi]<0||n[fi]>59?fi:n[To]<0||n[To]>59?To:n[da]<0||n[da]>999?da:-1,Je(t)._overflowDayOfYear&&(e<Fn||e>Bi)&&(e=Bi),Je(t)._overflowWeeks&&e===-1&&(e=GV),Je(t)._overflowWeekday&&e===-1&&(e=zV),Je(t).overflow=e),t}var WB=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,VB=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,BB=/Z|[+-]\d\d(?::?\d\d)?/,Th=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Ym=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],UB=/^\/?Date\((-?\d+)/i,YB=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,GB={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function gI(t){var e,n,r=t._i,i=WB.exec(r)||VB.exec(r),o,s,a,l,u=Th.length,c=Ym.length;if(i){for(Je(t).iso=!0,e=0,n=u;e<n;e++)if(Th[e][1].exec(i[1])){s=Th[e][0],o=Th[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,n=c;e<n;e++)if(Ym[e][1].exec(i[3])){a=(i[2]||" ")+Ym[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(i[4])if(BB.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),Qv(t)}else t._isValid=!1}function zB(t,e,n,r,i,o){var s=[jB(t),rI.indexOf(e),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function jB(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function KB(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function qB(t,e,n){if(t){var r=cI.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(r!==i)return Je(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function XB(t,e,n){if(t)return GB[t];if(e)return 0;var r=parseInt(n,10),i=r%100,o=(r-i)/100;return o*60+i}function mI(t){var e=YB.exec(KB(t._i)),n;if(e){if(n=zB(e[4],e[3],e[2],e[5],e[6],e[7]),!qB(e[1],n,t))return;t._a=n,t._tzm=XB(e[8],e[9],e[10]),t._d=Mc.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),Je(t).rfc2822=!0}else t._isValid=!1}function ZB(t){var e=UB.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(gI(t),t._isValid===!1)delete t._isValid;else return;if(mI(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:le.createFromInputFallback(t)}le.createFromInputFallback=zr("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function Rl(t,e,n){return t??e??n}function QB(t){var e=new Date(le.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function Zv(t){var e,n,r=[],i,o,s;if(!t._d){for(i=QB(t),t._w&&t._a[Bi]==null&&t._a[Eo]==null&&JB(t),t._dayOfYear!=null&&(s=Rl(t._a[Fn],i[Fn]),(t._dayOfYear>oc(s)||t._dayOfYear===0)&&(Je(t)._overflowDayOfYear=!0),n=Mc(s,0,t._dayOfYear),t._a[Eo]=n.getUTCMonth(),t._a[Bi]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=r[e]=i[e];for(;e<7;e++)t._a[e]=r[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[wn]===24&&t._a[fi]===0&&t._a[To]===0&&t._a[da]===0&&(t._nextDay=!0,t._a[wn]=0),t._d=(t._useUTC?Mc:oB).apply(null,r),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[wn]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(Je(t).weekdayMismatch=!0)}}function JB(t){var e,n,r,i,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,n=Rl(e.GG,t._a[Fn],Oc(Lt(),1,4).year),r=Rl(e.W,1),i=Rl(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=Oc(Lt(),o,s),n=Rl(e.gg,t._a[Fn],u.year),r=Rl(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),r<1||r>Ho(n,o,s)?Je(t)._overflowWeeks=!0:l!=null?Je(t)._overflowWeekday=!0:(a=uI(n,r,i,o,s),t._a[Fn]=a.year,t._dayOfYear=a.dayOfYear)}le.ISO_8601=function(){};le.RFC_2822=function(){};function Qv(t){if(t._f===le.ISO_8601){gI(t);return}if(t._f===le.RFC_2822){mI(t);return}t._a=[],Je(t).empty=!0;var e=""+t._i,n,r,i,o,s,a=e.length,l=0,u,c;for(i=X1(t._f,t._locale).match(Bv)||[],c=i.length,n=0;n<c;n++)o=i[n],r=(e.match(BV(o,t))||[])[0],r&&(s=e.substr(0,e.indexOf(r)),s.length>0&&Je(t).unusedInput.push(s),e=e.slice(e.indexOf(r)+r.length),l+=r.length),Hl[o]?(r?Je(t).empty=!1:Je(t).unusedTokens.push(o),YV(o,r,t)):t._strict&&!r&&Je(t).unusedTokens.push(o);Je(t).charsLeftOver=a-l,e.length>0&&Je(t).unusedInput.push(e),t._a[wn]<=12&&Je(t).bigHour===!0&&t._a[wn]>0&&(Je(t).bigHour=void 0),Je(t).parsedDateParts=t._a.slice(0),Je(t).meridiem=t._meridiem,t._a[wn]=eU(t._locale,t._a[wn],t._meridiem),u=Je(t).era,u!==null&&(t._a[Fn]=t._locale.erasConvertYear(u,t._a[Fn])),Zv(t),Xv(t)}function eU(t,e,n){var r;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(r=t.isPM(n),r&&e<12&&(e+=12),!r&&e===12&&(e=0)),e)}function tU(t){var e,n,r,i,o,s,a=!1,l=t._f.length;if(l===0){Je(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,s=!1,e=Wv({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],Qv(e),Fv(e)&&(s=!0),o+=Je(e).charsLeftOver,o+=Je(e).unusedTokens.length*10,Je(e).score=o,a?o<r&&(r=o,n=e):(r==null||o<r||s)&&(r=o,n=e,s&&(a=!0));fs(t,n||e)}function nU(t){if(!t._d){var e=Uv(t._i),n=e.day===void 0?e.date:e.day;t._a=j1([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(r){return r&&parseInt(r,10)}),Zv(t)}}function rU(t){var e=new qc(Xv(pI(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function pI(t){var e=t._i,n=t._f;return t._locale=t._locale||Fo(t._l),e===null||n===void 0&&e===""?Sg({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),Ci(e)?new qc(Xv(e)):(Kc(e)?t._d=e:wi(n)?tU(t):n?Qv(t):iU(t),Fv(t)||(t._d=null),t))}function iU(t){var e=t._i;hr(e)?t._d=new Date(le.now()):Kc(e)?t._d=new Date(e.valueOf()):typeof e=="string"?ZB(t):wi(e)?(t._a=j1(e.slice(0),function(n){return parseInt(n,10)}),Zv(t)):Ca(e)?nU(t):Do(e)?t._d=new Date(e):le.createFromInputFallback(t)}function wI(t,e,n,r,i){var o={};return(e===!0||e===!1)&&(r=e,e=void 0),(n===!0||n===!1)&&(r=n,n=void 0),(Ca(t)&&kv(t)||wi(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=n,o._i=t,o._f=e,o._strict=r,rU(o)}function Lt(t,e,n,r){return wI(t,e,n,r,!1)}var oU=zr("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Lt.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:Sg()}),sU=zr("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Lt.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:Sg()});function CI(t,e){var n,r;if(e.length===1&&wi(e[0])&&(e=e[0]),!e.length)return Lt();for(n=e[0],r=1;r<e.length;++r)(!e[r].isValid()||e[r][t](n))&&(n=e[r]);return n}function aU(){var t=[].slice.call(arguments,0);return CI("isBefore",t)}function lU(){var t=[].slice.call(arguments,0);return CI("isAfter",t)}var uU=function(){return Date.now?Date.now():+new Date},hu=["year","quarter","month","week","day","hour","minute","second","millisecond"];function cU(t){var e,n=!1,r,i=hu.length;for(e in t)if(wt(t,e)&&!(an.call(hu,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(r=0;r<i;++r)if(t[hu[r]]){if(n)return!1;parseFloat(t[hu[r]])!==lt(t[hu[r]])&&(n=!0)}return!0}function hU(){return this._isValid}function dU(){return Si(NaN)}function Ag(t){var e=Uv(t),n=e.year||0,r=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=cU(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+r*3+n*12,this._data={},this._locale=Fo(),this._bubble()}function jd(t){return t instanceof Ag}function SC(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function fU(t,e,n){var r=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<r;s++)(n&&t[s]!==e[s]||!n&&lt(t[s])!==lt(e[s]))&&o++;return o+i}function vI(t,e){Le(t,0,0,function(){var n=this.utcOffset(),r="+";return n<0&&(n=-n,r="-"),r+Ki(~~(n/60),2)+e+Ki(~~n%60,2)})}vI("Z",":");vI("ZZ","");Me("Z",_g);Me("ZZ",_g);Tt(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=Jv(_g,t)});var gU=/([\+\-]|\d\d)/gi;function Jv(t,e){var n=(e||"").match(t),r,i,o;return n===null?null:(r=n[n.length-1]||[],i=(r+"").match(gU)||["-",0,0],o=+(i[1]*60)+lt(i[2]),o===0?0:i[0]==="+"?o:-o)}function eS(t,e){var n,r;return e._isUTC?(n=e.clone(),r=(Ci(t)||Kc(t)?t.valueOf():Lt(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+r),le.updateOffset(n,!1),n):Lt(t).local()}function yC(t){return-Math.round(t._d.getTimezoneOffset())}le.updateOffset=function(){};function mU(t,e,n){var r=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=Jv(_g,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(i=yC(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),r!==t&&(!e||this._changeInProgress?bI(this,Si(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,le.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:yC(this)}function pU(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function wU(t){return this.utcOffset(0,t)}function CU(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(yC(this),"m")),this}function vU(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=Jv(WV,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function SU(t){return this.isValid()?(t=t?Lt(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function yU(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function bU(){if(!hr(this._isDSTShifted))return this._isDSTShifted;var t={},e;return Wv(t,this),t=pI(t),t._a?(e=t._isUTC?Zi(t._a):Lt(t._a),this._isDSTShifted=this.isValid()&&fU(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function RU(){return this.isValid()?!this._isUTC:!1}function EU(){return this.isValid()?this._isUTC:!1}function SI(){return this.isValid()?this._isUTC&&this._offset===0:!1}var TU=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,_U=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Si(t,e){var n=t,r=null,i,o,s;return jd(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:Do(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(r=TU.exec(t))?(i=r[1]==="-"?-1:1,n={y:0,d:lt(r[Bi])*i,h:lt(r[wn])*i,m:lt(r[fi])*i,s:lt(r[To])*i,ms:lt(SC(r[da]*1e3))*i}):(r=_U.exec(t))?(i=r[1]==="-"?-1:1,n={y:Ds(r[2],i),M:Ds(r[3],i),w:Ds(r[4],i),d:Ds(r[5],i),h:Ds(r[6],i),m:Ds(r[7],i),s:Ds(r[8],i)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(s=MU(Lt(n.from),Lt(n.to)),n={},n.ms=s.milliseconds,n.M=s.months),o=new Ag(n),jd(t)&&wt(t,"_locale")&&(o._locale=t._locale),jd(t)&&wt(t,"_isValid")&&(o._isValid=t._isValid),o}Si.fn=Ag.prototype;Si.invalid=dU;function Ds(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function c0(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function MU(t,e){var n;return t.isValid()&&e.isValid()?(e=eS(e,t),t.isBefore(e)?n=c0(t,e):(n=c0(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function yI(t,e){return function(n,r){var i,o;return r!==null&&!isNaN(+r)&&(q1(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=r,r=o),i=Si(n,r),bI(this,i,t),this}}function bI(t,e,n,r){var i=e._milliseconds,o=SC(e._days),s=SC(e._months);t.isValid()&&(r=r??!0,s&&oI(t,bf(t,"Month")+s*n),o&&Q1(t,"Date",bf(t,"Date")+o*n),i&&t._d.setTime(t._d.valueOf()+i*n),r&&le.updateOffset(t,o||s))}var OU=yI(1,"add"),AU=yI(-1,"subtract");function RI(t){return typeof t=="string"||t instanceof String}function IU(t){return Ci(t)||Kc(t)||RI(t)||Do(t)||xU(t)||PU(t)||t===null||t===void 0}function PU(t){var e=Ca(t)&&!kv(t),n=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=r.length;for(i=0;i<s;i+=1)o=r[i],n=n||wt(t,o);return e&&n}function xU(t){var e=wi(t),n=!1;return e&&(n=t.filter(function(r){return!Do(r)&&RI(t)}).length===0),e&&n}function HU(t){var e=Ca(t)&&!kv(t),n=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<r.length;i+=1)o=r[i],n=n||wt(t,o);return e&&n}function DU(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function NU(t,e){arguments.length===1&&(arguments[0]?IU(arguments[0])?(t=arguments[0],e=void 0):HU(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||Lt(),r=eS(n,this).startOf("day"),i=le.calendarFormat(this,r)||"sameElse",o=e&&(Qi(e[i])?e[i].call(this,n):e[i]);return this.format(o||this.localeData().calendar(i,this,Lt(n)))}function LU(){return new qc(this)}function $U(t,e){var n=Ci(t)?t:Lt(t);return this.isValid()&&n.isValid()?(e=jr(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function kU(t,e){var n=Ci(t)?t:Lt(t);return this.isValid()&&n.isValid()?(e=jr(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function FU(t,e,n,r){var i=Ci(t)?t:Lt(t),o=Ci(e)?e:Lt(e);return this.isValid()&&i.isValid()&&o.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(i,n):!this.isBefore(i,n))&&(r[1]===")"?this.isBefore(o,n):!this.isAfter(o,n))):!1}function WU(t,e){var n=Ci(t)?t:Lt(t),r;return this.isValid()&&n.isValid()?(e=jr(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(r=n.valueOf(),this.clone().startOf(e).valueOf()<=r&&r<=this.clone().endOf(e).valueOf())):!1}function VU(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function BU(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function UU(t,e,n){var r,i,o;if(!this.isValid())return NaN;if(r=eS(t,this),!r.isValid())return NaN;switch(i=(r.utcOffset()-this.utcOffset())*6e4,e=jr(e),e){case"year":o=Kd(this,r)/12;break;case"month":o=Kd(this,r);break;case"quarter":o=Kd(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-i)/864e5;break;case"week":o=(this-r-i)/6048e5;break;default:o=this-r}return n?o:Br(o)}function Kd(t,e){if(t.date()<e.date())return-Kd(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),r=t.clone().add(n,"months"),i,o;return e-r<0?(i=t.clone().add(n-1,"months"),o=(e-r)/(r-i)):(i=t.clone().add(n+1,"months"),o=(e-r)/(i-r)),-(n+o)||0}le.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";le.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function YU(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function GU(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?zd(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Qi(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",zd(n,"Z")):zd(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function zU(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,r,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(n+r+i+o)}function jU(t){t||(t=this.isUtc()?le.defaultFormatUtc:le.defaultFormat);var e=zd(this,t);return this.localeData().postformat(e)}function KU(t,e){return this.isValid()&&(Ci(t)&&t.isValid()||Lt(t).isValid())?Si({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function qU(t){return this.from(Lt(),t)}function XU(t,e){return this.isValid()&&(Ci(t)&&t.isValid()||Lt(t).isValid())?Si({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function ZU(t){return this.to(Lt(),t)}function EI(t){var e;return t===void 0?this._locale._abbr:(e=Fo(t),e!=null&&(this._locale=e),this)}var TI=zr("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function _I(){return this._locale}var Tf=1e3,Dl=60*Tf,_f=60*Dl,MI=(365*400+97)*24*_f;function Nl(t,e){return(t%e+e)%e}function OI(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-MI:new Date(t,e,n).valueOf()}function AI(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-MI:Date.UTC(t,e,n)}function QU(t){var e,n;if(t=jr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?AI:OI,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Nl(e+(this._isUTC?0:this.utcOffset()*Dl),_f);break;case"minute":e=this._d.valueOf(),e-=Nl(e,Dl);break;case"second":e=this._d.valueOf(),e-=Nl(e,Tf);break}return this._d.setTime(e),le.updateOffset(this,!0),this}function JU(t){var e,n;if(t=jr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?AI:OI,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=_f-Nl(e+(this._isUTC?0:this.utcOffset()*Dl),_f)-1;break;case"minute":e=this._d.valueOf(),e+=Dl-Nl(e,Dl)-1;break;case"second":e=this._d.valueOf(),e+=Tf-Nl(e,Tf)-1;break}return this._d.setTime(e),le.updateOffset(this,!0),this}function e2(){return this._d.valueOf()-(this._offset||0)*6e4}function t2(){return Math.floor(this.valueOf()/1e3)}function n2(){return new Date(this.valueOf())}function r2(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function i2(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function o2(){return this.isValid()?this.toISOString():null}function s2(){return Fv(this)}function a2(){return fs({},Je(this))}function l2(){return Je(this).overflow}function u2(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Le("N",0,0,"eraAbbr");Le("NN",0,0,"eraAbbr");Le("NNN",0,0,"eraAbbr");Le("NNNN",0,0,"eraName");Le("NNNNN",0,0,"eraNarrow");Le("y",["y",1],"yo","eraYear");Le("y",["yy",2],0,"eraYear");Le("y",["yyy",3],0,"eraYear");Le("y",["yyyy",4],0,"eraYear");Me("N",tS);Me("NN",tS);Me("NNN",tS);Me("NNNN",S2);Me("NNNNN",y2);Tt(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,r){var i=n._locale.erasParse(t,r,n._strict);i?Je(n).era=i:Je(n).invalidEra=t});Me("y",jl);Me("yy",jl);Me("yyy",jl);Me("yyyy",jl);Me("yo",b2);Tt(["y","yy","yyy","yyyy"],Fn);Tt(["yo"],function(t,e,n,r){var i;n._locale._eraYearOrdinalRegex&&(i=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[Fn]=n._locale.eraYearOrdinalParse(t,i):e[Fn]=parseInt(t,10)});function c2(t,e){var n,r,i,o=this._eras||Fo("en")._eras;for(n=0,r=o.length;n<r;++n){switch(typeof o[n].since){case"string":i=le(o[n].since).startOf("day"),o[n].since=i.valueOf();break}switch(typeof o[n].until){case"undefined":o[n].until=1/0;break;case"string":i=le(o[n].until).startOf("day").valueOf(),o[n].until=i.valueOf();break}}return o}function h2(t,e,n){var r,i,o=this.eras(),s,a,l;for(t=t.toUpperCase(),r=0,i=o.length;r<i;++r)if(s=o[r].name.toUpperCase(),a=o[r].abbr.toUpperCase(),l=o[r].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[r];break;case"NNNN":if(s===t)return o[r];break;case"NNNNN":if(l===t)return o[r];break}else if([s,a,l].indexOf(t)>=0)return o[r]}function d2(t,e){var n=t.since<=t.until?1:-1;return e===void 0?le(t.since).year():le(t.since).year()+(e-t.offset)*n}function f2(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].name;return""}function g2(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].narrow;return""}function m2(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].abbr;return""}function p2(){var t,e,n,r,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=i[t].since<=i[t].until?1:-1,r=this.clone().startOf("day").valueOf(),i[t].since<=r&&r<=i[t].until||i[t].until<=r&&r<=i[t].since)return(this.year()-le(i[t].since).year())*n+i[t].offset;return this.year()}function w2(t){return wt(this,"_erasNameRegex")||nS.call(this),t?this._erasNameRegex:this._erasRegex}function C2(t){return wt(this,"_erasAbbrRegex")||nS.call(this),t?this._erasAbbrRegex:this._erasRegex}function v2(t){return wt(this,"_erasNarrowRegex")||nS.call(this),t?this._erasNarrowRegex:this._erasRegex}function tS(t,e){return e.erasAbbrRegex(t)}function S2(t,e){return e.erasNameRegex(t)}function y2(t,e){return e.erasNarrowRegex(t)}function b2(t,e){return e._eraYearOrdinalRegex||jl}function nS(){var t=[],e=[],n=[],r=[],i,o,s=this.eras();for(i=0,o=s.length;i<o;++i)e.push(Er(s[i].name)),t.push(Er(s[i].abbr)),n.push(Er(s[i].narrow)),r.push(Er(s[i].name)),r.push(Er(s[i].abbr)),r.push(Er(s[i].narrow));this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}Le(0,["gg",2],0,function(){return this.weekYear()%100});Le(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Ig(t,e){Le(0,[t,t.length],0,e)}Ig("gggg","weekYear");Ig("ggggg","weekYear");Ig("GGGG","isoWeekYear");Ig("GGGGG","isoWeekYear");Un("weekYear","gg");Un("isoWeekYear","GG");Yn("weekYear",1);Yn("isoWeekYear",1);Me("G",Tg);Me("g",Tg);Me("GG",$t,Or);Me("gg",$t,Or);Me("GGGG",Gv,Yv);Me("gggg",Gv,Yv);Me("GGGGG",Eg,bg);Me("ggggg",Eg,bg);Zc(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,r){e[r.substr(0,2)]=lt(t)});Zc(["gg","GG"],function(t,e,n,r){e[r]=le.parseTwoDigitYear(t)});function R2(t){return II.call(this,t,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function E2(t){return II.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function T2(){return Ho(this.year(),1,4)}function _2(){return Ho(this.isoWeekYear(),1,4)}function M2(){var t=this.localeData()._week;return Ho(this.year(),t.dow,t.doy)}function O2(){var t=this.localeData()._week;return Ho(this.weekYear(),t.dow,t.doy)}function II(t,e,n,r,i){var o;return t==null?Oc(this,r,i).year:(o=Ho(t,r,i),e>o&&(e=o),A2.call(this,t,e,n,r,i))}function A2(t,e,n,r,i){var o=uI(t,e,n,r,i),s=Mc(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}Le("Q",0,"Qo","quarter");Un("quarter","Q");Yn("quarter",7);Me("Q",J1);Tt("Q",function(t,e){e[Eo]=(lt(t)-1)*3});function I2(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Le("D",["DD",2],"Do","date");Un("date","D");Yn("date",9);Me("D",$t);Me("DD",$t,Or);Me("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});Tt(["D","DD"],Bi);Tt("Do",function(t,e){e[Bi]=lt(t.match($t)[0])});var PI=zl("Date",!0);Le("DDD",["DDDD",3],"DDDo","dayOfYear");Un("dayOfYear","DDD");Yn("dayOfYear",4);Me("DDD",Rg);Me("DDDD",eI);Tt(["DDD","DDDD"],function(t,e,n){n._dayOfYear=lt(t)});function P2(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Le("m",["mm",2],0,"minute");Un("minute","m");Yn("minute",14);Me("m",$t);Me("mm",$t,Or);Tt(["m","mm"],fi);var x2=zl("Minutes",!1);Le("s",["ss",2],0,"second");Un("second","s");Yn("second",15);Me("s",$t);Me("ss",$t,Or);Tt(["s","ss"],To);var H2=zl("Seconds",!1);Le("S",0,0,function(){return~~(this.millisecond()/100)});Le(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Le(0,["SSS",3],0,"millisecond");Le(0,["SSSS",4],0,function(){return this.millisecond()*10});Le(0,["SSSSS",5],0,function(){return this.millisecond()*100});Le(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Le(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Le(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Le(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});Un("millisecond","ms");Yn("millisecond",16);Me("S",Rg,J1);Me("SS",Rg,Or);Me("SSS",Rg,eI);var gs,xI;for(gs="SSSS";gs.length<=9;gs+="S")Me(gs,jl);function D2(t,e){e[da]=lt(("0."+t)*1e3)}for(gs="S";gs.length<=9;gs+="S")Tt(gs,D2);xI=zl("Milliseconds",!1);Le("z",0,0,"zoneAbbr");Le("zz",0,0,"zoneName");function N2(){return this._isUTC?"UTC":""}function L2(){return this._isUTC?"Coordinated Universal Time":""}var he=qc.prototype;he.add=OU;he.calendar=NU;he.clone=LU;he.diff=UU;he.endOf=JU;he.format=jU;he.from=KU;he.fromNow=qU;he.to=XU;he.toNow=ZU;he.get=kV;he.invalidAt=l2;he.isAfter=$U;he.isBefore=kU;he.isBetween=FU;he.isSame=WU;he.isSameOrAfter=VU;he.isSameOrBefore=BU;he.isValid=s2;he.lang=TI;he.locale=EI;he.localeData=_I;he.max=sU;he.min=oU;he.parsingFlags=a2;he.set=FV;he.startOf=QU;he.subtract=AU;he.toArray=r2;he.toObject=i2;he.toDate=n2;he.toISOString=GU;he.inspect=zU;typeof Symbol<"u"&&Symbol.for!=null&&(he[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});he.toJSON=o2;he.toString=YU;he.unix=t2;he.valueOf=e2;he.creationData=u2;he.eraName=f2;he.eraNarrow=g2;he.eraAbbr=m2;he.eraYear=p2;he.year=lI;he.isLeapYear=iB;he.weekYear=R2;he.isoWeekYear=E2;he.quarter=he.quarters=I2;he.month=sI;he.daysInMonth=tB;he.week=he.weeks=cB;he.isoWeek=he.isoWeeks=hB;he.weeksInYear=M2;he.weeksInWeekYear=O2;he.isoWeeksInYear=T2;he.isoWeeksInISOWeekYear=_2;he.date=PI;he.day=he.days=EB;he.weekday=TB;he.isoWeekday=_B;he.dayOfYear=P2;he.hour=he.hours=HB;he.minute=he.minutes=x2;he.second=he.seconds=H2;he.millisecond=he.milliseconds=xI;he.utcOffset=mU;he.utc=wU;he.local=CU;he.parseZone=vU;he.hasAlignedHourOffset=SU;he.isDST=yU;he.isLocal=RU;he.isUtcOffset=EU;he.isUtc=SI;he.isUTC=SI;he.zoneAbbr=N2;he.zoneName=L2;he.dates=zr("dates accessor is deprecated. Use date instead.",PI);he.months=zr("months accessor is deprecated. Use month instead",sI);he.years=zr("years accessor is deprecated. Use year instead",lI);he.zone=zr("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",pU);he.isDSTShifted=zr("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",bU);function $2(t){return Lt(t*1e3)}function k2(){return Lt.apply(null,arguments).parseZone()}function HI(t){return t}var Ct=Vv.prototype;Ct.calendar=EV;Ct.longDateFormat=OV;Ct.invalidDate=IV;Ct.ordinal=HV;Ct.preparse=HI;Ct.postformat=HI;Ct.relativeTime=NV;Ct.pastFuture=LV;Ct.set=bV;Ct.eras=c2;Ct.erasParse=h2;Ct.erasConvertYear=d2;Ct.erasAbbrRegex=C2;Ct.erasNameRegex=w2;Ct.erasNarrowRegex=v2;Ct.months=ZV;Ct.monthsShort=QV;Ct.monthsParse=eB;Ct.monthsRegex=rB;Ct.monthsShortRegex=nB;Ct.week=sB;Ct.firstDayOfYear=uB;Ct.firstDayOfWeek=lB;Ct.weekdays=vB;Ct.weekdaysMin=yB;Ct.weekdaysShort=SB;Ct.weekdaysParse=RB;Ct.weekdaysRegex=MB;Ct.weekdaysShortRegex=OB;Ct.weekdaysMinRegex=AB;Ct.isPM=PB;Ct.meridiem=DB;function Mf(t,e,n,r){var i=Fo(),o=Zi().set(r,e);return i[n](o,t)}function DI(t,e,n){if(Do(t)&&(e=t,t=void 0),t=t||"",e!=null)return Mf(t,e,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=Mf(t,r,n,"month");return i}function rS(t,e,n,r){typeof t=="boolean"?(Do(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,Do(e)&&(n=e,e=void 0),e=e||"");var i=Fo(),o=t?i._week.dow:0,s,a=[];if(n!=null)return Mf(e,(n+o)%7,r,"day");for(s=0;s<7;s++)a[s]=Mf(e,(s+o)%7,r,"day");return a}function F2(t,e){return DI(t,e,"months")}function W2(t,e){return DI(t,e,"monthsShort")}function V2(t,e,n){return rS(t,e,n,"weekdays")}function B2(t,e,n){return rS(t,e,n,"weekdaysShort")}function U2(t,e,n){return rS(t,e,n,"weekdaysMin")}Cs("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=lt(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});le.lang=zr("moment.lang is deprecated. Use moment.locale instead.",Cs);le.langData=zr("moment.langData is deprecated. Use moment.localeData instead.",Fo);var to=Math.abs;function Y2(){var t=this._data;return this._milliseconds=to(this._milliseconds),this._days=to(this._days),this._months=to(this._months),t.milliseconds=to(t.milliseconds),t.seconds=to(t.seconds),t.minutes=to(t.minutes),t.hours=to(t.hours),t.months=to(t.months),t.years=to(t.years),this}function NI(t,e,n,r){var i=Si(e,n);return t._milliseconds+=r*i._milliseconds,t._days+=r*i._days,t._months+=r*i._months,t._bubble()}function G2(t,e){return NI(this,t,e,1)}function z2(t,e){return NI(this,t,e,-1)}function h0(t){return t<0?Math.floor(t):Math.ceil(t)}function j2(){var t=this._milliseconds,e=this._days,n=this._months,r=this._data,i,o,s,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=h0(bC(n)+e)*864e5,e=0,n=0),r.milliseconds=t%1e3,i=Br(t/1e3),r.seconds=i%60,o=Br(i/60),r.minutes=o%60,s=Br(o/60),r.hours=s%24,e+=Br(s/24),l=Br(LI(e)),n+=l,e-=h0(bC(l)),a=Br(n/12),n%=12,r.days=e,r.months=n,r.years=a,this}function LI(t){return t*4800/146097}function bC(t){return t*146097/4800}function K2(t){if(!this.isValid())return NaN;var e,n,r=this._milliseconds;if(t=jr(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+r/864e5,n=this._months+LI(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(bC(this._months)),t){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return e*24+r/36e5;case"minute":return e*1440+r/6e4;case"second":return e*86400+r/1e3;case"millisecond":return Math.floor(e*864e5)+r;default:throw new Error("Unknown unit "+t)}}function q2(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+lt(this._months/12)*31536e6:NaN}function Wo(t){return function(){return this.as(t)}}var X2=Wo("ms"),Z2=Wo("s"),Q2=Wo("m"),J2=Wo("h"),eY=Wo("d"),tY=Wo("w"),nY=Wo("M"),rY=Wo("Q"),iY=Wo("y");function oY(){return Si(this)}function sY(t){return t=jr(t),this.isValid()?this[t+"s"]():NaN}function Aa(t){return function(){return this.isValid()?this._data[t]:NaN}}var aY=Aa("milliseconds"),lY=Aa("seconds"),uY=Aa("minutes"),cY=Aa("hours"),hY=Aa("days"),dY=Aa("months"),fY=Aa("years");function gY(){return Br(this.days()/7)}var vo=Math.round,Ol={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function mY(t,e,n,r,i){return i.relativeTime(e||1,!!n,t,r)}function pY(t,e,n,r){var i=Si(t).abs(),o=vo(i.as("s")),s=vo(i.as("m")),a=vo(i.as("h")),l=vo(i.as("d")),u=vo(i.as("M")),c=vo(i.as("w")),d=vo(i.as("y")),g=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||s<=1&&["m"]||s<n.m&&["mm",s]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(g=g||c<=1&&["w"]||c<n.w&&["ww",c]),g=g||u<=1&&["M"]||u<n.M&&["MM",u]||d<=1&&["y"]||["yy",d],g[2]=e,g[3]=+t>0,g[4]=r,mY.apply(null,g)}function wY(t){return t===void 0?vo:typeof t=="function"?(vo=t,!0):!1}function CY(t,e){return Ol[t]===void 0?!1:e===void 0?Ol[t]:(Ol[t]=e,t==="s"&&(Ol.ss=e-1),!0)}function vY(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,r=Ol,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(r=Object.assign({},Ol,e),e.s!=null&&e.ss==null&&(r.ss=e.s-1)),i=this.localeData(),o=pY(this,!n,r,i),n&&(o=i.pastFuture(+this,o)),i.postformat(o)}var Gm=Math.abs;function La(t){return(t>0)-(t<0)||+t}function Pg(){if(!this.isValid())return this.localeData().invalidDate();var t=Gm(this._milliseconds)/1e3,e=Gm(this._days),n=Gm(this._months),r,i,o,s,a=this.asSeconds(),l,u,c,d;return a?(r=Br(t/60),i=Br(r/60),t%=60,r%=60,o=Br(n/12),n%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=La(this._months)!==La(a)?"-":"",c=La(this._days)!==La(a)?"-":"",d=La(this._milliseconds)!==La(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(n?u+n+"M":"")+(e?c+e+"D":"")+(i||r||t?"T":"")+(i?d+i+"H":"")+(r?d+r+"M":"")+(t?d+s+"S":"")):"P0D"}var ft=Ag.prototype;ft.isValid=hU;ft.abs=Y2;ft.add=G2;ft.subtract=z2;ft.as=K2;ft.asMilliseconds=X2;ft.asSeconds=Z2;ft.asMinutes=Q2;ft.asHours=J2;ft.asDays=eY;ft.asWeeks=tY;ft.asMonths=nY;ft.asQuarters=rY;ft.asYears=iY;ft.valueOf=q2;ft._bubble=j2;ft.clone=oY;ft.get=sY;ft.milliseconds=aY;ft.seconds=lY;ft.minutes=uY;ft.hours=cY;ft.days=hY;ft.weeks=gY;ft.months=dY;ft.years=fY;ft.humanize=vY;ft.toISOString=Pg;ft.toString=Pg;ft.toJSON=Pg;ft.locale=EI;ft.localeData=_I;ft.toIsoString=zr("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Pg);ft.lang=TI;Le("X",0,0,"unix");Le("x",0,0,"valueOf");Me("x",Tg);Me("X",VV);Tt("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});Tt("x",function(t,e,n){n._d=new Date(lt(t))});//! moment.js
le.version="2.29.4";SV(Lt);le.fn=he;le.min=aU;le.max=lU;le.now=uU;le.utc=Zi;le.unix=$2;le.months=F2;le.isDate=Kc;le.locale=Cs;le.invalid=Sg;le.duration=Si;le.isMoment=Ci;le.weekdays=V2;le.parseZone=k2;le.localeData=Fo;le.isDuration=jd;le.monthsShort=W2;le.weekdaysMin=U2;le.defineLocale=qv;le.updateLocale=kB;le.locales=FB;le.weekdaysShort=B2;le.normalizeUnits=jr;le.relativeTimeRounding=wY;le.relativeTimeThreshold=CY;le.calendarFormat=DU;le.prototype=he;le.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const SY=Object.freeze(Object.defineProperty({__proto__:null,default:le},Symbol.toStringTag,{value:"Module"}));function $I(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function RC(t,e){const n=e.length;let r=0;for(;r<n;)t.push(e[r]),r+=1}function sc(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,r=t[0].length;for(let i=0;i<n;i++)for(let o=0;o<r;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function nn(t,e,n,r){let i=-1,o=t,s=n;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(r&&a&&(i+=1,s=o[i]),i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function _r(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];e(a,n,r)&&(s+=1,o[s]=a),n+=1}return o}function Xe(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];s+=1,o[s]=e(a,n,r),n+=1}return o}function H(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length;for(;n<i&&e(r[n],n,r)!==!1;)n+=1;return t}function kI(t){return nn(t,(e,n)=>e+n,0)}function yY(t){return nn(t,(e,n)=>e>n?e:n,Array.isArray(t)?t[0]:void 0)}function bY(t){return nn(t,(e,n)=>e<n?e:n,Array.isArray(t)?t[0]:void 0)}function RY(t){return t.length?kI(t)/t.length:0}function FI(t){return nn(t,(e,n)=>e.concat(Array.isArray(n)?FI(n):n),[])}function iS(t){const e=[];return H(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function EC(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return H(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function EY(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return H(i,s=>{o=o.filter(a=>s.includes(a))}),o}function TY(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e],o=new Set(r);return H(i,s=>{H(s,a=>{o.has(a)||o.add(a)})}),Array.from(o)}function TC(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}const _Y=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:RY,arrayEach:H,arrayFilter:_r,arrayFlatten:FI,arrayMap:Xe,arrayMax:yY,arrayMin:bY,arrayReduce:nn,arraySum:kI,arrayUnique:iS,extendArray:RC,getDifferenceOfArrays:EC,getIntersectionOfArrays:EY,getUnionOfArrays:TY,pivot:sc,stringToArray:TC,to2dArray:$I},Symbol.toStringTag,{value:"Module"}));function bt(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return nn(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=n[a]?n[a]:"";return o+l+u},"").trim()}function Zt(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function Re(t){return typeof t<"u"}function It(t){return typeof t>"u"}function mn(t){return t===null||t===""||It(t)}function WI(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const Zu="length",ac=t=>parseInt(t,16),d0=t=>parseInt(t,10),Of=(t,e,n)=>t.substr(e,n),lc=t=>t.codePointAt(0)-65,_C=t=>`${t}`.replace(/\-/g,""),MY=t=>ac(Of(_C(t),ac("12"),lc("F")))/(ac(Of(_C(t),lc("B"),~~![][Zu]))||9),OY=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let f0=!1;const g0={invalid:()=>bt`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return bt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>bt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},m0={invalid:()=>bt`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return bt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>bt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function VI(t,e){const n=!mn(t),r=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="14.0.0";let o,s="invalid",a="invalid";t=_C(t||"");const l=AY(t);if(n||r||l)if(l){const u=le("30/11/2023","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),d=MY(t);o=le((d+1)*864e5,"x").format("MMMM DD, YYYY"),c>d?(s="expired",a="expired"):(s="valid",a="valid")}else r?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(OY()&&(s="valid",a="valid"),!f0&&s!=="valid"&&(g0[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"](g0[s]({keyValidityDate:o,hotVersion:i})),f0=!0),a!=="valid"&&e.parentNode&&m0[a]({keyValidityDate:o,hotVersion:i})){const c=document.createElement("div");c.className="hot-display-license-info",c.innerHTML=m0[a]({keyValidityDate:o,hotVersion:i}),e.parentNode.insertBefore(c,e.nextSibling)}}function AY(t){let e=[][Zu],n=e;if(t[Zu]!==lc("Z"))return!1;for(let r="",i="B<H4P+".split(""),o=lc(i.shift());o;o=lc(i.shift()||"A"))--o<""[Zu]?n=n|(d0(`${d0(ac(r)+(ac(Of(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=Of(t,o,o?i[Zu]===1?9:8:6);return n===e}const IY=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:VI,isDefined:Re,isEmpty:mn,isRegExp:WI,isUndefined:It,stringify:Zt},Symbol.toStringTag,{value:"Module"}));function Wn(t){return t[0].toUpperCase()+t.substr(1)}function PY(){const t=[];for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];let i=n.length;for(;i;){i-=1;const o=Zt(n[i]).toLowerCase();t.indexOf(o)===-1&&t.push(o)}return t.length===1}function oS(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function sS(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function aS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,r)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[r]===void 0?"":e[r])}function MC(t){return xg(`${t}`,{ALLOWED_TAGS:[]})}function xg(t,e){return vV.sanitize(t,e)}const xY=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:PY,isPercentValue:sS,randomString:oS,sanitize:xg,stripTags:MC,substitute:aS,toUpperCaseFirst:Wn},Symbol.toStringTag,{value:"Module"})),Kl=t=>["tabindex",t],HY=()=>["role","treegrid"],Gi=()=>["role","presentation"],DY=()=>["role","gridcell"],NY=()=>["role","rowheader"],BI=()=>["role","rowgroup"],LY=()=>["role","columnheader"],OC=()=>["role","row"],$Y=()=>["role","menu"],kY=()=>["role","menuitem"],FY=()=>["role","combobox"],UI=()=>["role","listbox"],WY=()=>["role","option"],VY=()=>["role","checkbox"],BY=()=>["scope","col"],UY=()=>["scope","row"],YY=()=>["type","text"],lS=t=>["aria-label",t],Vo=()=>["aria-hidden","true"],GY=()=>["aria-disabled","true"],zY=()=>["aria-multiselectable","true"],YI=t=>["aria-haspopup",t],GI=t=>["aria-rowcount",t],Hg=t=>["aria-colcount",t],zI=t=>["aria-rowindex",t],uS=t=>["aria-colindex",t],Ur=t=>["aria-expanded",t],jY=t=>["aria-sort",t],p0=()=>["aria-readonly","true"],w0=()=>["aria-invalid","true"],KY=t=>["aria-checked",t],cS=()=>["aria-selected","true"],qY=()=>["aria-autocomplete","list"],XY=t=>["aria-controls",t],ZY=t=>["aria-activedescendant",t],QY=t=>["aria-live",t],JY=t=>["aria-relevant",t],eG=t=>["aria-setsize",t],tG=t=>["aria-posinset",t];function jI(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=null,i=t;for(;i!==null;){if(n===e){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return r}function KI(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function qI(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function Ic(t){return qI(t)&&t.parent}function nG(t){return!!Object.getPrototypeOf(t.parent)}function Es(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==n;){const{nodeType:s,nodeName:a}=o;if(s===r&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function Qu(t,e,n){const r=[];let i=t;for(;i&&(i=Es(i,e,n),!(!i||n&&!n.contains(i)));)r.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=r.length;return o?r[o-1]:null}function vs(t,e){let n=t.parentNode,r=[];for(typeof e=="string"?t.defaultView?r=Array.prototype.slice.call(t.querySelectorAll(e),0):r=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);n!==null;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function XI(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function os(t,e,n){const r=n.parentElement.querySelector(`.ht_clone_${t}`);return r?r.contains(e):null}function ZI(t){return!t||!t.length?[]:t.filter(e=>!!e)}function QI(t,e){if(!t||!t.length)return e?{regexFree:[],regexes:[]}:[];const n=[],r=[];return r.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&n.push(i),!o})),e?{regexFree:r,regexes:n}:r}function Ve(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function ce(t,e){typeof e=="string"&&(e=e.split(" ")),e=ZI(e),e.length>0&&t.classList.add(...e)}function Ye(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:r}=QI(e,!0);n=ZI(n),n.length>0&&t.classList.remove(...n),r.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function Ne(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(r=>{Array.isArray(r)&&r[0]!==""&&t.setAttribute(...r)})}function Ia(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:r}=QI(e,!0);n.forEach(i=>{i!==""&&t.removeAttribute(i)}),r.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function hS(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)hS(e[n])}}function vi(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const JI=/(<(.*)>|&(.*);)/;function Pa(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;JI.test(e)?t.innerHTML=n?xg(e):e:Ts(t,e)}function Ts(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(vi(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function _s(t){const e=t.ownerDocument.documentElement;let n=t;for(;n!==e;){if(n===null)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(n.host){if(n.host.impl)return _s(n.host.impl);if(n.host)return _s(n.host);throw new Error("Lost in Web Components world")}else return!1;else if(No(n).display==="none")return!1;n=n.parentNode}return!0}function ln(t){const e=t.ownerDocument,n=e.defaultView,r=e.documentElement;let i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=n.pageXOffset||r.scrollLeft,s+=n.pageYOffset||r.scrollTop),{left:o,top:s}}function dS(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function Dg(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function Pc(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?dS(e):t.scrollTop}function Af(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?Dg(e):t.scrollLeft}function xc(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const r=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=n.getComputedStyle(i),r.includes(o)||r.includes(s)||r.includes(a)||i.clientHeight<=i.scrollHeight+1&&(r.includes(a)||r.includes(o))||i.clientWidth<=i.scrollWidth+1&&(r.includes(s)||r.includes(o)))return i;i=i.parentNode}return n}function va(t){const e=t.ownerDocument,n=e.defaultView;let r=t.parentNode;for(;r&&r.style&&e.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;const i=No(r,n),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return r;r=r.parentNode}return n}function Wl(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const r=t.style[e];if(r!==""&&r!==void 0)return r;const i=No(t,n);if(i[e]!==""&&i[e]!==void 0)return i[e]}function rG(t,e){const{selectorText:n}=e;let r=!1;return e.type===CSSRule.STYLE_RULE&&n&&(t.msMatchesSelector?r=t.msMatchesSelector(n):t.matches&&(r=t.matches(n))),r}function No(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t.currentStyle||e.getComputedStyle(t)}function yt(t){return t.offsetWidth}function Bt(t){return t.offsetHeight}function _o(t){return t.clientHeight||t.innerHeight}function uc(t){return t.clientWidth||t.innerWidth}function iG(t,e,n){t.addEventListener(e,n,!1)}function oG(t,e,n){t.removeEventListener(e,n,!1)}function fS(t){return t.selectionStart?t.selectionStart:0}function eP(t){return t.selectionEnd?t.selectionEnd:0}function sG(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=t.document;let n="";return t.getSelection?n=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(n=e.selection.createRange().text),n}function AC(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function Qc(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,n),i.style.display=o}}}let zm;function aG(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const r=e.offsetWidth;n.style.overflow="scroll";let i=e.offsetWidth;return r===i&&(i=n.clientWidth),(t.body||t.documentElement).removeChild(n),r-i}function Cn(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return zm===void 0&&(zm=aG(t)),zm}function tP(t){return t.offsetWidth!==t.clientWidth}function nP(t){return t.offsetHeight!==t.clientHeight}function Ng(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function lG(t){let e;return t.style.transform&&(e=t.style.transform)!==""?["transform",e]:-1}function Jc(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function If(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function Lg(t){return If(t)&&t.hasAttribute("data-hot-input")===!1}function uG(t){const e=t.ownerDocument.activeElement;Lg(e)||t.select()}function gS(t){return!t.parentNode}function rP(t,e){new IntersectionObserver((r,i)=>{r.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function mS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=t.ownerDocument,i=r.createRange(),o=r.defaultView.getSelection();Ne(t,"contenteditable",!0),n&&Ne(t,...Vo()),e&&ce(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function pS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&Ye(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function iP(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;mS(t,n),e(),pS(t,n)}const cG=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:JI,addClass:ce,addEvent:iG,clearTextSelection:AC,closest:Es,closestDown:Qu,empty:vi,fastInnerHTML:Pa,fastInnerText:Ts,getCaretPosition:fS,getComputedStyle:No,getCssTransform:lG,getFrameElement:qI,getParent:jI,getParentWindow:Ic,getScrollLeft:Af,getScrollTop:Pc,getScrollableElement:xc,getScrollbarWidth:Cn,getSelectionEndPosition:eP,getSelectionText:sG,getStyle:Wl,getTrimmingContainer:va,getWindowScrollLeft:Dg,getWindowScrollTop:dS,hasAccessToParentWindow:nG,hasClass:Ve,hasHorizontalScrollbar:nP,hasVerticalScrollbar:tP,index:XI,innerHeight:_o,innerWidth:uc,isChildOf:vs,isDetached:gS,isInput:If,isOutsideInput:Lg,isThisHotChild:KI,isVisible:_s,makeElementContentEditableAndSelectItsContent:mS,matchesCSSRules:rG,observeVisibilityChangeOnce:rP,offset:ln,outerHeight:Bt,outerWidth:yt,overlayContainsElement:os,removeAttribute:Ia,removeClass:Ye,removeContentEditableFromElementAndDeselect:pS,removeEvent:oG,removeTextNodes:hS,resetCssTransform:Jc,runWithSelectedContendEditableElement:iP,selectElementIfAllowed:uG,setAttribute:Ne,setCaretPosition:Qc,setOverlayPosition:Ng},Symbol.toStringTag,{value:"Module"}));function At(t){return typeof t=="function"}function oP(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=0;const r={lastCallThrottled:!0};let i=null;function o(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];const u=Date.now();let c=!1;r.lastCallThrottled=!0,n||(n=u,c=!0);const d=e-(u-n);return c?(r.lastCallThrottled=!1,t.apply(this,a)):(i&&clearTimeout(i),i=setTimeout(()=>{r.lastCallThrottled=!1,t.apply(this,a),n=0,i=void 0},d)),r}return o}function hG(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const r=oP(t,e);let i=n;function o(){i=n}function s(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return i?(i-=1,t.apply(this,l)):r.apply(this,l)}return s.clearHits=o,s}function $g(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,r;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout(()=>{r=t.apply(this,s)},e),r}return i}function dG(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=e;return function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return nn(i,(u,c)=>c(u),r.apply(this,a))}}function wS(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,n.concat(s))}}function sP(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s);let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function fG(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s.reverse());let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function Pf(t,e,n,r,i,o,s,a){return Re(a)?t.call(e,n,r,i,o,s,a):Re(s)?t.call(e,n,r,i,o,s):Re(o)?t.call(e,n,r,i,o):Re(i)?t.call(e,n,r,i):Re(r)?t.call(e,n,r):Re(n)?t.call(e,n):t.call(e)}const gG=Object.freeze(Object.defineProperty({__proto__:null,curry:sP,curryRight:fG,debounce:$g,fastCall:Pf,isFunction:At,partial:wS,pipe:dG,throttle:oP,throttleAfterHits:hG},Symbol.toStringTag,{value:"Module"}));var mG=rr,C0=M1,pG=xn,v0=Gl,wG=H1,S0=mG([].push),CG=function(t){if(pG(t))return t;if(C0(t)){for(var e=t.length,n=[],r=0;r<e;r++){var i=t[r];typeof i=="string"?S0(n,i):(typeof i=="number"||v0(i)==="Number"||v0(i)==="String")&&S0(n,wG(i))}var o=n.length,s=!0;return function(a,l){if(s)return s=!1,l;if(C0(this))return l;for(var u=0;u<o;u++)if(n[u]===a)return l}}},vG=Ma,aP=Yc,lP=vg,SG=gg,eh=rr,uP=Gr,y0=xn,b0=Tv,cP=Lv,yG=CG,bG=Ev,RG=String,Ss=aP("JSON","stringify"),_h=eh(/./.exec),R0=eh("".charAt),EG=eh("".charCodeAt),TG=eh("".replace),_G=eh(1 .toString),MG=/[\uD800-\uDFFF]/g,E0=/^[\uD800-\uDBFF]$/,T0=/^[\uDC00-\uDFFF]$/,_0=!bG||uP(function(){var t=aP("Symbol")("stringify detection");return Ss([t])!=="[null]"||Ss({a:t})!=="{}"||Ss(Object(t))!=="{}"}),M0=uP(function(){return Ss("\uDF06\uD834")!=='"\\udf06\\ud834"'||Ss("\uDEAD")!=='"\\udead"'}),OG=function(t,e){var n=cP(arguments),r=yG(e);if(!(!y0(r)&&(t===void 0||b0(t))))return n[1]=function(i,o){if(y0(r)&&(o=SG(r,this,RG(i),o)),!b0(o))return o},lP(Ss,null,n)},AG=function(t,e,n){var r=R0(n,e-1),i=R0(n,e+1);return _h(E0,t)&&!_h(T0,i)||_h(T0,t)&&!_h(E0,r)?"\\u"+_G(EG(t,0),16):t};Ss&&vG({target:"JSON",stat:!0,arity:3,forced:_0||M0},{stringify:function(e,n,r){var i=cP(arguments),o=lP(_0?OG:Ss,null,i);return M0&&typeof o=="string"?TG(o,MG,AG):o}});function Vl(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Ze(t,(n,r)=>{r!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[r]=Vl(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[r]=[Vl(n[0])]:e[r]=[]:e[r]=null)})),e}function Bo(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function un(t,e,n){const r=Array.isArray(n);return Ze(e,(i,o)=>{(r===!1||n.includes(o))&&(t[o]=i)}),t}function th(t,e){Ze(e,(n,r)=>{e[r]&&typeof e[r]=="object"?(t[r]||(Array.isArray(e[r])?t[r]=[]:Object.prototype.toString.call(e[r])==="[object Date]"?t[r]=e[r]:t[r]={}),th(t[r],e[r])):t[r]=e[r]})}function Vn(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function tr(t){const e={};return Ze(t,(n,r)=>{e[r]=n}),e}function _t(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return H(n,i=>{t.MIXINS.push(i.MIXIN_NAME),Ze(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,d){const g=`_${c}`,p=C=>{let E=C;return(Array.isArray(E)||qe(E))&&(E=Vn(E)),E};return function(){return this[g]===void 0&&(this[g]=p(d)),this[g]}},l=function(c){const d=`_${c}`;return function(g){this[d]=g}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function kg(t,e){return JSON.stringify(t)===JSON.stringify(e)}function qe(t){return Object.prototype.toString.call(t)==="[object Object]"}function Ji(t,e,n,r){r.value=n,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(t,e,r)}function Ze(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function hP(t,e){const n=e.split(".");let r=t;return Ze(n,i=>{if(r=r[i],r===void 0)return r=void 0,!1}),r}function qd(t,e,n){const r=e.split(".");let i=t;r.forEach((o,s)=>{s!==r.length-1?(Vt(i,o)||(i[o]={}),i=i[o]):i[o]=n})}function Fg(t){if(!qe(t))return 0;const e=function(n){let r=0;return qe(n)?Ze(n,(i,o)=>{o!=="__children"&&(r+=e(i))}):r+=1,r};return e(t)}function gi(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,r={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[n]},set(i){this._touched=!0,this[n]=i},enumerable:!0,configurable:!0}),r}function Vt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const IG=Object.freeze(Object.defineProperty({__proto__:null,clone:tr,createObjectPropListener:gi,deepClone:Vn,deepExtend:th,deepObjectSize:Fg,defineGetter:Ji,duckSchema:Vl,extend:un,getProperty:hP,hasOwnProperty:Vt,inherit:Bo,isObject:qe,isObjectEqual:kg,mixin:_t,objectEach:Ze,setProperty:qd},Symbol.toStringTag,{value:"Module"})),Fr=t=>{const e={value:!1};return e.test=(n,r)=>{e.value=t(n,r)},e},Uo={chrome:Fr((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:Fr(t=>/CriOS/.test(t)),edge:Fr(t=>/Edge/.test(t)),edgeWebKit:Fr(t=>/EdgiOS/.test(t)),firefox:Fr(t=>/Firefox/.test(t)),firefoxWebKit:Fr(t=>/FxiOS/.test(t)),mobile:Fr(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:Fr((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},ql={mac:Fr(t=>/^Mac/.test(t)),win:Fr(t=>/^Win/.test(t)),linux:Fr(t=>/^Linux/.test(t)),ios:Fr(t=>/iPhone|iPad|iPod/i.test(t))};function dP(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ze(Uo,n=>{let{test:r}=n;return void r(t,e)})}function fP(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ze(ql,e=>{let{test:n}=e;return void n(t)})}dP();fP();function CS(){return Uo.chrome.value}function gP(){return Uo.chromeWebKit.value}function Xd(){return Uo.firefox.value}function mP(){return Uo.firefoxWebKit.value}function vS(){return Uo.safari.value}function pP(){return Uo.edge.value}function PG(){return Uo.edgeWebKit.value}function Mo(){return Uo.mobile.value}function SS(){return ql.ios.value}function yS(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&ql.mac.value}function IC(){return ql.win.value}function Hc(){return ql.mac.value}function xG(){return ql.linux.value}const HG=Object.freeze(Object.defineProperty({__proto__:null,isChrome:CS,isChromeWebKit:gP,isEdge:pP,isEdgeWebKit:PG,isFirefox:Xd,isFirefoxWebKit:mP,isIOS:SS,isIpadOS:yS,isLinuxOS:xG,isMacOS:Hc,isMobileBrowser:Mo,isSafari:vS,isWindowsOS:IC,setBrowserMeta:dP,setPlatformMeta:fP},Symbol.toStringTag,{value:"Module"})),Pe={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Xd()?182:174,AUDIO_MUTE:Xd()?181:173,AUDIO_UP:Xd()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},DG=[Pe.ALT,Pe.ARROW_DOWN,Pe.ARROW_LEFT,Pe.ARROW_RIGHT,Pe.ARROW_UP,Pe.AUDIO_DOWN,Pe.AUDIO_MUTE,Pe.AUDIO_UP,Pe.BACKSPACE,Pe.CAPS_LOCK,Pe.DELETE,Pe.END,Pe.ENTER,Pe.ESCAPE,Pe.F1,Pe.F2,Pe.F3,Pe.F4,Pe.F5,Pe.F6,Pe.F7,Pe.F8,Pe.F9,Pe.F10,Pe.F11,Pe.F12,Pe.F13,Pe.F14,Pe.F15,Pe.F16,Pe.F17,Pe.F18,Pe.F19,Pe.HOME,Pe.INSERT,Pe.MEDIA_NEXT,Pe.MEDIA_PLAY_PAUSE,Pe.MEDIA_PREV,Pe.MEDIA_STOP,Pe.NULL,Pe.NUM_LOCK,Pe.PAGE_DOWN,Pe.PAGE_UP,Pe.PAUSE,Pe.SCROLL_LOCK,Pe.SHIFT,Pe.TAB];function wP(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function bS(t){return DG.includes(t)}function NG(t){const e=[];return Hc()?e.push(Pe.COMMAND_LEFT,Pe.COMMAND_RIGHT,Pe.COMMAND_FIREFOX):e.push(Pe.CONTROL),e.includes(t)}function CP(t){return[Pe.CONTROL,Pe.COMMAND_LEFT,Pe.COMMAND_RIGHT,Pe.COMMAND_FIREFOX].includes(t)}function Xl(t,e){const n=e.split("|");let r=!1;return H(n,i=>{if(t===Pe[i])return r=!0,!1}),r}const LG=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:Pe,isCtrlKey:NG,isCtrlMetaKey:CP,isFunctionKey:bS,isKey:Xl,isPrintableChar:wP},Symbol.toStringTag,{value:"Module"}));function Kr(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function us(t){return t.isImmediatePropagationEnabled===!1}function Ms(t){return t.button===2}function Wg(t){return t.button===0}function vP(t,e){const n={x:t.offsetX,y:t.offsetY};let r=t.target;if(!(e instanceof HTMLElement)||r!==e&&r.contains(e))return n;for(;r!==e;)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;return n}const $G=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:us,isLeftClick:Wg,isRightClick:Ms,offsetRelativeTo:vP,stopImmediatePropagation:Kr},Symbol.toStringTag,{value:"Module"}));function Pt(){Re(console)&&console.warn(...arguments)}function RS(){Re(console)&&console.error(...arguments)}function kG(t,e,n){return e=FG(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function FG(t){var e=WG(t,"string");return typeof e=="symbol"?e:String(e)}function WG(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const $a=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],VG=bt`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,jm=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),Km=new Map([[]]);class SP{static getSingleton(){return UG()}constructor(){kG(this,"globalBucket",void 0),this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const e=Object.create(null);return H($a,n=>e[n]=[]),e}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(n))H(n,i=>this.add(e,i,r));else{jm.has(e)&&Pt(aS(VG,{hookName:e,removedInVersion:jm.get(e)})),Km.has(e)&&Pt(Km.get(e));const i=this.getBucket(r);if(typeof i[e]>"u"&&(this.register(e),i[e]=[]),n.skip=!1,i[e].indexOf(n)===-1){let o=!1;n.initialHook&&H(i[e],(s,a)=>{if(s.initialHook)return i[e][a]=n,o=!0,!1}),o||i[e].push(n)}}return this}once(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(n)?H(n,i=>this.once(e,i,r)):(n.runOnce=!0,this.add(e,n,r))}remove(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const i=this.getBucket(r);return typeof i[e]<"u"&&i[e].indexOf(n)>=0?(n.skip=!0,!0):!1}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const r=this.getBucket(n);return!!(r[e]!==void 0&&r[e].length)}run(e,n,r,i,o,s,a,l){{const u=this.globalBucket[n],c=u?u.length:0;let d=0;if(c)for(;d<c;){if(!u[d]||u[d].skip){d+=1;continue}const g=Pf(u[d],e,r,i,o,s,a,l);g!==void 0&&(r=g),u[d]&&u[d].runOnce&&this.remove(n,u[d]),d+=1}}{const u=this.getBucket(e)[n],c=u?u.length:0;let d=0;if(c)for(;d<c;){if(!u[d]||u[d].skip){d+=1;continue}const g=Pf(u[d],e,r,i,o,s,a,l);g!==void 0&&(r=g),u[d]&&u[d].runOnce&&this.remove(n,u[d],e),d+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Ze(this.getBucket(e),(n,r,i)=>i[r].length=0)}register(e){this.isRegistered(e)||$a.push(e)}deregister(e){this.isRegistered(e)&&$a.splice($a.indexOf(e),1)}isDeprecated(e){return Km.has(e)||jm.has(e)}isRegistered(e){return $a.indexOf(e)>=0}getRegistered(){return $a}}const BG=new SP;function UG(){return BG}const _e=SP,qm=new Map;function yi(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";qm.has(t)||qm.set(t,new Map);const e=qm.get(t);function n(a,l){e.set(a,l)}function r(a){return e.get(a)}function i(a){return e.has(a)}function o(){return[...e.keys()]}function s(){return[...e.values()]}return{register:n,getItem:r,hasItem:i,getNames:o,getValues:s}}const PC=new WeakMap,{register:YG,getItem:yP,hasItem:bP,getNames:GG,getValues:Vae}=yi("editors");function zG(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new n(r)),e[r.guid]},_e.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function RP(t,e){let n;if(typeof t=="function")PC.get(t)||dr(null,t),n=PC.get(t);else if(typeof t=="string")n=yP(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function xf(t){if(typeof t=="function")return t;if(!bP(t))throw Error(`No registered editor found under "${t}" name`);return yP(t).getConstructor()}function dr(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new zG(e);typeof t=="string"&&YG(t,n),PC.set(e,n)}function jG(t,e,n){return e=KG(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function KG(t){var e=qG(t,"string");return typeof e=="symbol"?e:String(e)}function qG(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let Zd=0;class XG{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;jG(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){r.call(this,ZG(s))}return this.context.eventListeners.push({element:e,event:n,callback:r,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(n,o,i),Zd+=1,()=>{this.removeEventListener(e,n,r)}}removeEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===n&&s.element===e){if(r&&r!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options),Zd-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const r=this.context.eventListeners[n];e&&r.eventManager!==this||(this.context.eventListeners.splice(n,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),Zd-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let r=e.document,i=e;r||(r=e.ownerDocument?e.ownerDocument:e,i=r.defaultView);const o={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let s;r.createEvent?(s=r.createEvent("MouseEvents"),s.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,r.body.parentNode)):s=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${n}`,s)}}function ZG(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),Kr(this)},t}const Mr=XG;function QG(){return Zd}function O0(t,e){JG(t,e),e.add(t)}function JG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zo(t,e,n){return e=ez(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ez(t){var e=tz(t,"string");return typeof e=="symbol"?e:String(e)}function tz(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function A0(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Vg="editorManager.navigation";var I0=new WeakSet,P0=new WeakSet;class xC{constructor(e,n,r){O0(this,P0),O0(this,I0),zo(this,"hot",void 0),zo(this,"tableMeta",void 0),zo(this,"selection",void 0),zo(this,"eventManager",void 0),zo(this,"destroyed",!1),zo(this,"lock",!1),zo(this,"activeEditor",void 0),zo(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=r,this.eventManager=new Mr(e),this.hot.addHook("afterDocumentKeyDown",i=>A0(this,I0,nz).call(this,i)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",i=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",i)}),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>A0(this,P0,rz).call(this,i,o,s))}lockEditor(){this.lock=!0}unlockEditor(){this.lock=!1}destroyEditor(e){this.lock||this.closeEditor(e)}getActiveEditor(){return this.activeEditor}prepareEditor(){if(this.lock)return;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,l=>{l&&this.prepareEditor()});return}const{highlight:e}=this.hot.getSelectedRangeLast();if(e.isHeader())return;const{row:n,col:r}=e,i=this.hot.runHooks("modifyGetCellCoords",n,r);let o=n,s=r;if(Array.isArray(i)&&([o,s]=i),this.cellProperties=this.hot.getCellMeta(o,s),!this.isCellEditable()){this.clearActiveEditor();return}const a=this.hot.getCell(n,r,!0);if(a){const l=this.hot.getCellEditor(this.cellProperties),u=this.hot.colToProp(s),c=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o),s);this.activeEditor=RP(l,this.hot),this.activeEditor.prepare(n,r,u,a,c,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,r){this.activeEditor?this.activeEditor.finishEditing(e,n,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:r,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(r))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!n||a)}moveSelectionAfterEnter(e){const n=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;e?this.selection.transformStart(-n.row,-n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function nz(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||us(t))return;const{keyCode:n}=t,r=(t.ctrlKey||t.metaKey)&&!t.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!bS(n)&&!CP(n)&&!r&&!this.isEditorOpened()){const o=this.hot.getShortcutManager().getContext("editor"),s={runOnlyIf:()=>Re(this.hot.getSelected()),group:Vg};o.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],s),this.openEditor("",t)}}function rz(t,e,n){n.nodeName==="TD"&&this.openEditor(null,t,!0)}const x0=new WeakMap;xC.getInstance=function(t,e,n){let r=x0.get(t);return r||(r=new xC(t,e,n),x0.set(t,r)),r};const iz=xC;function Mh(t,e){EP(t,e),e.add(t)}function du(t,e,n){EP(t,e),e.set(t,n)}function EP(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Al(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function jt(t,e){var n=TP(t,e,"get");return oz(t,n)}function oz(t,e){return e.get?e.get.call(t):e.value}function fu(t,e,n){var r=TP(t,e,"set");return sz(t,r,n),n}function TP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function sz(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const ms=Object.freeze({CELL:"cell",MIXED:"mixed"});var Pn=new WeakMap,Oh=new WeakMap,Ah=new WeakMap,Ih=new WeakMap,Ph=new WeakMap,Hf=new WeakSet,H0=new WeakSet,D0=new WeakSet,N0=new WeakSet;class az{constructor(e){var n=this;Mh(this,N0),Mh(this,D0),Mh(this,H0),Mh(this,Hf),du(this,Pn,{writable:!0,value:void 0}),du(this,Oh,{writable:!0,value:void 0}),du(this,Ah,{writable:!0,value:50}),du(this,Ih,{writable:!0,value:null}),du(this,Ph,{writable:!0,value:new Map});const r=e.getSettings();fu(this,Pn,e),fu(this,Oh,r.imeFastEdit?ms.MIXED:ms.CELL),jt(this,Pn).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Al(n,N0,cz).call(n,...o)}),jt(this,Pn).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Al(n,H0,lz).call(n,...o)}),jt(this,Pn).addHook("afterSelectionEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Al(n,D0,uz).call(n,...o)})}getFocusMode(){return jt(this,Oh)}setFocusMode(e){Object.values(ms).includes(e)?fu(this,Oh,e):Pt(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return jt(this,Ah)}setRefocusDelay(e){fu(this,Ah,e)}setRefocusElementGetter(e){fu(this,Ih,e)}getRefocusElement(){if(typeof jt(this,Ih)=="function")return jt(this,Ih).call(this);var e;return(e=jt(this,Pn).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const n=r=>{var i,o;const s=(i=jt(this,Pn).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!s)return;let a=jt(this,Pn).runHooks("modifyFocusedElement",s.row,s.col,r);a instanceof HTMLElement||(a=r),a&&!((o=jt(this,Pn).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?n(e):Al(this,Hf,ES).call(this,r=>n(r))}refocusToEditorTextarea(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:jt(this,Ah);const r=this.getRefocusElement();jt(this,Pn).getSettings().imeFastEdit&&!((e=jt(this,Pn).getActiveEditor())!==null&&e!==void 0&&e.isOpened())&&r&&(jt(this,Ph).has(n)||jt(this,Ph).set(n,$g(()=>{r.select()},n)),jt(this,Ph).get(n)())}}function ES(t){var e;const n=(e=jt(this,Pn).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||!jt(this,Pn).selection.isCellVisible(n)){t(null);return}const r=jt(this,Pn).getCell(n.row,n.col,!0);r===null?jt(this,Pn).addHookOnce("afterScroll",()=>{t(jt(this,Pn).getCell(n.row,n.col,!0))}):t(r)}function lz(){Al(this,Hf,ES).call(this,t=>{const{activeElement:e}=jt(this,Pn).rootDocument;e&&Lg(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function uz(){Al(this,Hf,ES).call(this,t=>{this.getFocusMode()===ms.MIXED&&t.nodeName==="TD"&&this.refocusToEditorTextarea()})}function cz(t){t.imeFastEdit&&this.getFocusMode()!==ms.MIXED?this.setFocusMode(ms.MIXED):!t.imeFastEdit&&this.getFocusMode()!==ms.CELL&&this.setFocusMode(ms.CELL)}const _P={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},hz=new RegExp(Object.keys(_P).map(t=>`(${t})`).join("|"),"gi");function dz(t){return(t&&t.nodeName||"")==="TABLE"}function HC(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),r=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...r),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,d=e?1:0;for(let g=0;g<o;g+=1){const p=e&&g===0,C=[];for(let I=0;I<s;I+=1){const M=!p&&n&&I===0;let y="";if(p)y=`<th>${t.getColHeader(I-c)}</th>`;else if(M)y=`<th>${t.getRowHeader(g-d)}</th>`;else{const $=i[g][I],{hidden:q,rowspan:G,colspan:X}=t.getCellMeta(g-d,I-c);if(!q){const re=[];if(G&&re.push(`rowspan="${G}"`),X&&re.push(`colspan="${X}"`),mn($))y=`<td ${re.join(" ")}></td>`;else{const v=$.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");y=`<td ${re.join(" ")}>${v}</td>`}}}C.push(y)}const E=["<tr>",...C,"</tr>"].join("");p?l.splice(1,0,E):u.splice(-1,0,E)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function DC(t){const e=t.length,n=["<table>"];for(let r=0;r<e;r+=1){const i=t[r],o=i.length,s=[];r===0&&n.push("<tbody>");for(let a=0;a<o;a+=1){const l=i[a],u=mn(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}n.push("<tr>",...s,"</tr>"),r+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function MP(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},r=e.createDocumentFragment(),i=e.createElement("div");r.appendChild(i);let o=t;if(typeof o=="string"){const $=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,q=>{const G=q.match(/<td\b[^>]*?>/g)[0],X=q.substring(G.length,q.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,"");return`${G}${X}</td>`});i.insertAdjacentHTML("afterbegin",`${$}`),o=i.querySelector("table")}if(!o||!dz(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce(($,q)=>$+q.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],d=[];let g=!1,p=0,C=0;if(o.tHead){const $=Array.from(o.tHead.rows).filter(q=>{const G=q.querySelector("td")!==null;return G&&d.push(q),!G});p=$.length,g=p>0,p>1?n.nestedHeaders=Array.from($).reduce((q,G)=>{const X=Array.from(G.cells).reduce((re,v,S)=>{if(a&&S===0)return re;const{colSpan:b,innerHTML:L}=v,P=b>1?{label:L,colspan:b}:L;return re.push(P),re},[]);return q.push(X),q},[]):g&&(n.colHeaders=Array.from($[0].children).reduce((q,G,X)=>(a&&X===0||q.push(G.innerHTML),q),[]))}d.length&&(n.fixedRowsTop=d.length),c.length&&(n.fixedRowsBottom=c.length);const E=[...d,...Array.from(o.tBodies).reduce(($,q)=>($.push(...Array.from(q.rows)),$),[]),...c];C=E.length;const I=new Array(C);for(let $=0;$<C;$++)I[$]=new Array(u);const M=[],y=[];for(let $=0;$<C;$++){const q=E[$],G=Array.from(q.cells),X=G.length;for(let re=0;re<X;re++){const v=G[re],{nodeName:S,innerHTML:b,rowSpan:L,colSpan:P}=v,x=I[$].findIndex(W=>W===void 0);if(S==="TD"){if(L>1||P>1){for(let z=$;z<$+L;z++)if(z<C)for(let w=x;w<x+P;w++)I[z][w]=null;const D=v.getAttribute("style");D&&D.includes("mso-ignore:colspan")||M.push({col:x,row:$,rowspan:L,colspan:P})}let W="";s&&/excel/gi.test(s.content)?W=b.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):W=b.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),I[$][x]=W.replace(hz,D=>_P[D])}else y.push(b)}}return M.length&&(n.mergeCells=M),y.length&&(n.rowHeaders=y),I.length&&(n.data=I),n}const fz=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:DC,htmlToGridSettings:MP,instanceToHTML:HC},Symbol.toStringTag,{value:"Module"}));function er(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const r=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?\\s*(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function OP(t){return er(t,[","])}function xe(t,e,n){let r=-1;for(typeof e=="function"?(n=e,e=t):r=t-1;++r<=e&&n(r)!==!1;);}function Df(t,e,n){let r=t+1;for(typeof e=="function"&&(n=e,e=0);--r>=e&&n(r)!==!1;);}function TS(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function pr(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}const gz=Object.freeze(Object.defineProperty({__proto__:null,clamp:pr,isNumeric:er,isNumericLike:OP,rangeEach:xe,rangeEachReverse:Df,valueAccordingPercent:TS},Symbol.toStringTag,{value:"Module"})),NC="asc",mz="desc",L0=new Map([[NC,[-1,1]],[mz,[1,-1]]]),pz=t=>`The priority '${t}' is already declared in a map.`,wz=t=>`The priority '${t}' is not a number.`;function Cz(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=At(t)?t:pz,e=At(e)?e:wz;function r(o,s){if(!er(o))throw new Error(e(o));if(n.has(o))throw new Error(t(o));n.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:NC;const[s,a]=L0.get(o)||L0.get(NC);return[...n].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:r,getItems:i}}const vz=t=>`The id '${t}' is already declared in a map.`;function Bg(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=At(t)?t:vz;function n(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function r(u){return e.delete(u)}function i(){e.clear()}function o(u){const[c]=a().find(d=>{let[g,p]=d;return u===p?g:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:n,clear:i,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:r}}const Sz=t=>`'${t}' value is already declared in a unique set.`;function yz(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=At(t)?t:Sz;function n(o){if(e.has(o))throw new Error(t(o));e.add(o)}function r(){return[...e]}function i(){e.clear()}return{addItem:n,clear:i,getItems:r}}const _S=t=>`There is already registered "${t}" plugin.`,bz=t=>`There is already registered plugin on priority "${t}".`,Rz=t=>`The priority "${t}" is not a number.`,AP=Cz({errorPriorityExists:bz,errorPriorityNaN:Rz}),IP=yz({errorItemExists:_S}),LC=Bg({errorIdExists:_S});function MS(){return[...AP.getItems(),...IP.getItems()]}function nh(t){const e=Wn(t);return LC.getItem(e)}function Ez(t){return!!nh(t)}function dt(t,e,n){[t,e,n]=_z(t,e,n),nh(t)===void 0&&Tz(t,e,n)}function Tz(t,e,n){const r=Wn(t);if(LC.hasItem(r))throw new Error(_S(r));n===void 0?IP.addItem(r):AP.addItem(n,r),LC.addItem(r,e)}function _z(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:Mz,getItem:Oz,hasItem:PP,getNames:Az,getValues:Bae}=yi("renderers");function Nf(t){if(typeof t=="function")return t;if(!PP(t))throw Error(`No registered renderer found under "${t}" name`);return Oz(t)}function ki(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),Mz(t,e)}const{register:Iz,getItem:Pz,hasItem:xP,getNames:xz,getValues:Uae}=yi("validators");function OS(t){if(typeof t=="function")return t;if(!xP(t))throw Error(`No registered validator found under "${t}" name`);return Pz(t)}function Il(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),Iz(t,e)}var HP={},Hz=E1,Dz=Dv,Nz=Object.keys||function(e){return Hz(e,Dz)},Lz=qi,$z=C1,kz=_a,Fz=Gc,Wz=mg,Vz=Nz;HP.f=Lz&&!$z?Object.defineProperties:function(e,n){Fz(e);for(var r=Wz(n),i=Vz(n),o=i.length,s=0,a;o>s;)kz.f(e,a=i[s++],r[a]);return e};var Bz=Gc,Uz=HP,$0=Dv,Yz=Pv,Gz=k1,zz=Av,jz=S1,k0=">",F0="<",$C="prototype",kC="script",DP=jz("IE_PROTO"),Xm=function(){},NP=function(t){return F0+kC+k0+t+F0+"/"+kC+k0},W0=function(t){t.write(NP("")),t.close();var e=t.parentWindow.Object;return t=null,e},Kz=function(){var t=zz("iframe"),e="java"+kC+":",n;return t.style.display="none",Gz.appendChild(t),t.src=String(e),n=t.contentWindow.document,n.open(),n.write(NP("document.F=Object")),n.close(),n.F},xh,Qd=function(){try{xh=new ActiveXObject("htmlfile")}catch{}Qd=typeof document<"u"?document.domain&&xh?W0(xh):Kz():W0(xh);for(var t=$0.length;t--;)delete Qd[$C][$0[t]];return Qd()};Yz[DP]=!0;var qz=Object.create||function(e,n){var r;return e!==null?(Xm[$C]=Bz(e),r=new Xm,Xm[$C]=null,r[DP]=e):r=Qd(),n===void 0?r:Uz.f(r,n)},Xz=wg,Zz=qz,Qz=_a.f,FC=Xz("unscopables"),WC=Array.prototype;WC[FC]===void 0&&Qz(WC,FC,{configurable:!0,value:Zz(null)});var LP=function(t){WC[FC][t]=!0},Jz=Ma,ej=pg,tj=Cg,nj=Hv,rj=LP;Jz({target:"Array",proto:!0},{at:function(e){var n=ej(this),r=tj(n),i=nj(e),o=i>=0?i:r+i;return o<0||o>=r?void 0:n[o]}});rj("at");const ha=1,$n=2;function V0(t,e,n){ij(t,e),e.set(t,n)}function ij(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function no(t,e,n){return e=oj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oj(t){var e=sj(t,"string");return typeof e=="symbol"?e:String(e)}function sj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hn(t,e){var n=$P(t,e,"get");return aj(t,n)}function aj(t,e){return e.get?e.get.call(t):e.value}function B0(t,e,n){var r=$P(t,e,"set");return lj(t,r,n),n}function $P(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function lj(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Hh=new WeakMap,dn=new WeakMap;class AS{static get DEFAULT_WIDTH(){return 50}constructor(e){no(this,"count",0),no(this,"startColumn",null),no(this,"endColumn",null),no(this,"startPosition",null),no(this,"isVisibleInTrimmingContainer",!1),no(this,"stretchAllRatio",0),no(this,"stretchLastWidth",0),V0(this,Hh,{writable:!0,value:0}),no(this,"needVerifyLastColumnWidth",!0),no(this,"stretchAllColumnsWidth",[]),V0(this,dn,{writable:!0,value:void 0}),B0(this,dn,e),typeof hn(this,dn).stretchingColumnWidthFn!="function"&&(hn(this,dn).stretchingColumnWidthFn=n=>n),this.calculate()}calculate(){const{calculationType:e,overrideFn:n,scrollOffset:r,totalColumns:i,viewportWidth:o}=hn(this,dn),s=Math.max(hn(this,dn).scrollOffset,0),a=s>0?o+1:o;let l=0,u=!0;const c=[];let d,g=0,p=0;for(let M=0;M<i;M++)if(d=this._getColumnWidth(M),l<=s&&e!==$n&&(this.startColumn=M,g=d),l>=s&&l+(e===$n?d:0)<=s+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=M,g=d),this.endColumn=M),c.push(l),l+=d,p=d,e!==$n&&(this.endColumn=M),l>=s+o){u=!1;break}const C=r+o-a,E=e===$n?0:p,I=e===$n?g:0;if(C<-1*hn(this,dn).inlineStartOffset||r>c.at(-1)+E||-1*hn(this,dn).scrollOffset-hn(this,dn).viewportWidth>-1*I?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===i-1&&u)for(this.startColumn=this.endColumn;this.startColumn>0;){const M=c[this.endColumn]+d-c[this.startColumn-1];if((M<=o||e!==$n)&&(this.startColumn-=1),M>o)break}e===ha&&this.startColumn!==null&&n&&n(this),this.startPosition=c[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}refreshStretching(e){if(hn(this,dn).stretchMode==="none")return;let n=e;B0(this,Hh,n);const r=hn(this,dn).totalColumns;let i=0;for(let s=0;s<r;s++){const a=this._getColumnWidth(s),l=hn(this,dn).stretchingColumnWidthFn(void 0,s);typeof l=="number"?n-=l:i+=a}const o=n-i;if(hn(this,dn).stretchMode==="all"&&o>0)this.stretchAllRatio=n/i,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(hn(this,dn).stretchMode==="last"&&n!==1/0){const s=this._getColumnWidth(r-1),a=o+s;this.stretchLastWidth=a>=0?a:s}}getStretchedColumnWidth(e,n){let r=null;return hn(this,dn).stretchMode==="all"&&this.stretchAllRatio!==0?r=this._getStretchedAllColumnWidth(e,n):hn(this,dn).stretchMode==="last"&&this.stretchLastWidth!==0&&(r=this._getStretchedLastColumnWidth(e)),r}_getStretchedAllColumnWidth(e,n){let r=0;const i=hn(this,dn).totalColumns;if(!this.stretchAllColumnsWidth[e]){const o=Math.round(n*this.stretchAllRatio),s=hn(this,dn).stretchingColumnWidthFn(o,e);s===void 0?this.stretchAllColumnsWidth[e]=o:this.stretchAllColumnsWidth[e]=isNaN(s)?this._getColumnWidth(e):s}if(this.stretchAllColumnsWidth.length===i&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let o=0;o<this.stretchAllColumnsWidth.length;o++)r+=this.stretchAllColumnsWidth[o];r!==hn(this,Hh)&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=hn(this,Hh)-r)}return this.stretchAllColumnsWidth[e]}_getStretchedLastColumnWidth(e){const n=hn(this,dn).totalColumns;return e===n-1?this.stretchLastWidth:null}_getColumnWidth(e){let n=hn(this,dn).columnWidthFn(e);return isNaN(n)&&(n=AS.DEFAULT_WIDTH),n}}const IS=AS;function uj(t,e,n){cj(t,e),e.set(t,n)}function cj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gu(t,e,n){return e=hj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hj(t){var e=dj(t,"string");return typeof e=="symbol"?e:String(e)}function dj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Zm(t,e){var n=kP(t,e,"get");return fj(t,n)}function fj(t,e){return e.get?e.get.call(t):e.value}function gj(t,e,n){var r=kP(t,e,"set");return mj(t,r,n),n}function kP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function mj(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var mu=new WeakMap;class PS{static get DEFAULT_HEIGHT(){return 23}constructor(e){gu(this,"count",0),gu(this,"startRow",null),gu(this,"endRow",null),gu(this,"startPosition",null),gu(this,"isVisibleInTrimmingContainer",!1),uj(this,mu,{writable:!0,value:void 0}),gj(this,mu,e),this.calculate()}calculate(){const{calculationType:e,overrideFn:n,rowHeightFn:r,scrollOffset:i,totalRows:o,viewportHeight:s}=Zm(this,mu),a=Math.max(Zm(this,mu).scrollOffset,0),l=Zm(this,mu).horizontalScrollbarHeight||0;let u=0,c=!0;const d=[];let g,p=0,C=0;for(let y=0;y<o;y++)if(g=r(y),isNaN(g)&&(g=PS.DEFAULT_HEIGHT),u<=a&&e!==$n&&(this.startRow=y,p=g),u>=a&&u+(e===$n?g:0)<=a+s-l&&(this.startRow===null&&(this.startRow=y,p=g),this.endRow=y),d.push(u),u+=g,C=g,e!==$n&&(this.endRow=y),u>=a+s-l){c=!1;break}const E=i+s-l,I=e===$n?p:0,M=e===$n?0:C;if(E<I||i>d.at(-1)+M?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===o-1&&c)for(this.startRow=this.endRow;this.startRow>0;){const y=d[this.endRow]+g-d[this.startRow-1];if((y<=s-l||e!==$n)&&(this.startRow-=1),y>=s-l)break}e===ha&&this.startRow!==null&&n&&n(this),this.startPosition=d[this.startRow],this.startPosition===void 0&&(this.startPosition=null),o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}const FP=PS;function pj(t,e,n){wj(t,e),e.set(t,n)}function wj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function U0(t,e,n){return e=Cj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cj(t){var e=vj(t,"string");return typeof e=="symbol"?e:String(e)}function vj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ka(t,e){var n=WP(t,e,"get");return Sj(t,n)}function Sj(t,e){return e.get?e.get.call(t):e.value}function Y0(t,e,n){var r=WP(t,e,"set");return yj(t,r,n),n}function WP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function yj(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var ro=new WeakMap;class Lf{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;U0(this,"row",null),U0(this,"col",null),pj(this,ro,{writable:!0,value:!1}),Y0(this,ro,r),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:r,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=n||this.col>=r)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return ka(this,ro)}isSouthEastOf(e){return this.row>=e.row&&(ka(this,ro)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(ka(this,ro)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(ka(this,ro)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(ka(this,ro)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof Lf&&Y0(this,ro,e.isRtl()),this}clone(){return new Lf(this.row,this.col,ka(this,ro))}toObject(){return{row:this.row,col:this.col}}}const $f=Lf;function bj(t,e,n){Rj(t,e),e.set(t,n)}function Rj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qm(t,e,n){return e=Ej(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ej(t){var e=Tj(t,"string");return typeof e=="symbol"?e:String(e)}function Tj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ei(t,e){var n=VP(t,e,"get");return _j(t,n)}function _j(t,e){return e.get?e.get.call(t):e.value}function Mj(t,e,n){var r=VP(t,e,"set");return Oj(t,r,n),n}function VP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Oj(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Ir=new WeakMap;class xS{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;Qm(this,"highlight",null),Qm(this,"from",null),Qm(this,"to",null),bj(this,Ir,{writable:!0,value:!1}),this.highlight=e.clone(),this.from=n.clone(),this.to=r.clone(),Mj(this,Ir,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:r}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=n&&o.row>=n&&i.col<=r&&o.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopRightCorner().col>=e.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=e.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=e.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=e.getOuterTopLeftCorner().col}isOverlappingVertically(e){return this.getOuterBottomRightCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=e.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=e.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>r.row||e.col>r.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0):!1}expandByRange(e){if(this.includesRange(e)||!this.overlaps(e))return!1;const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),i=this.getDirection(),o=e.getOuterTopStartCorner(),s=e.getOuterBottomEndCorner(),a=Math.min(n.row,o.row),l=Math.min(n.col,o.col),u=Math.max(r.row,s.row),c=Math.max(r.col,s.col),d=this._createCellCoords(a,l),g=this._createCellCoords(u,c);return this.from=d,this.to=g,this.setDirection(i),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return Ei(this,Ir)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return Ei(this,Ir)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return Ei(this,Ir)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return Ei(this,Ir)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return Ei(this,Ir)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return Ei(this,Ir)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return Ei(this,Ir)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return Ei(this,Ir)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e,n){return n&&n.includes(e)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(n.from.row,n.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(n.from.row,n.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(n.to.row,n.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(n.to.row,n.to.col)))?!0:e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e,n){if(!(e instanceof $f))return!1;if(n){const{from:r,to:i}=n;if(n.includes(e)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(r.row,r.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(r.row,i.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(i.row,r.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(i.row,i.col)))return this.getOuterTopStartCorner()}}if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return n.top===r.top&&i.push("top"),n.right===r.right&&i.push("right"),n.bottom===r.bottom&&i.push("bottom"),n.left===r.left&&i.push("left"),i}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&r.push(this._createCellCoords(i,o));return r}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)e.row===i&&e.col===o?r.push(e):n.row===i&&n.col===o?r.push(n):r.push(this._createCellCoords(i,o));return r}forAll(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let i=n.row;i<=r.row;i++)for(let o=n.col;o<=r.col;o++)if(e(i,o)===!1)return}clone(){return new xS(this.highlight,this.from,this.to,Ei(this,Ir))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new $f(e,n,Ei(this,Ir))}}const HS=xS;function Ug(t){return window.requestAnimationFrame(t)}function Dc(t){window.cancelAnimationFrame(t)}function DS(){return"ontouchstart"in window}let Fa;function BP(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Fa||(typeof Intl=="object"?Fa=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?Fa=(n,r)=>`${n}`.localeCompare(r):Fa=(n,r)=>n===r?0:n>r?-1:1,Fa)}const Aj=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:Dc,getComparisonFunction:BP,isTouchSupported:DS,requestAnimationFrame:Ug},Symbol.toStringTag,{value:"Module"}));function Ti(t,e,n){Ij(t,e),e.set(t,n)}function Ij(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function De(t,e){var n=UP(t,e,"get");return Pj(t,n)}function Pj(t,e){return e.get?e.get.call(t):e.value}function jo(t,e,n){var r=UP(t,e,"set");return xj(t,r,n),n}function UP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function xj(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Pr=new WeakMap,Jm=new WeakMap,Sn=new WeakMap,Wa=new WeakMap,Dh=new WeakMap,Zr=new WeakMap,ep=new WeakMap,pu=new WeakMap,Ns=new WeakMap,_i=new WeakMap;let Hj=class{constructor(e,n,r,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Ti(this,Pr,{writable:!0,value:void 0}),Ti(this,Jm,{writable:!0,value:void 0}),Ti(this,Sn,{writable:!0,value:void 0}),Ti(this,Wa,{writable:!0,value:void 0}),Ti(this,Dh,{writable:!0,value:void 0}),Ti(this,Zr,{writable:!0,value:void 0}),Ti(this,ep,{writable:!0,value:void 0}),Ti(this,pu,{writable:!0,value:void 0}),Ti(this,Ns,{writable:!0,value:[null,null]}),Ti(this,_i,{writable:!0,value:[null,null]}),jo(this,Pr,r),jo(this,Jm,n),jo(this,Sn,o),jo(this,Wa,s),jo(this,Dh,a),jo(this,Zr,i),jo(this,ep,e),this.registerEvents()}registerEvents(){De(this,Zr).addEventListener(De(this,Sn).holder,"contextmenu",r=>this.onContextMenu(r)),De(this,Zr).addEventListener(De(this,Sn).TABLE,"mouseover",r=>this.onMouseOver(r)),De(this,Zr).addEventListener(De(this,Sn).TABLE,"mouseout",r=>this.onMouseOut(r));const e=()=>{De(this,Zr).addEventListener(De(this,Sn).holder,"touchstart",r=>this.onTouchStart(r)),De(this,Zr).addEventListener(De(this,Sn).holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),De(this,Zr).addEventListener(De(this,Sn).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||De(this,Pr).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,De(this,Pr).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{De(this,Zr).addEventListener(De(this,Sn).holder,"mouseup",r=>this.onMouseUp(r)),De(this,Zr).addEventListener(De(this,Sn).holder,"mousedown",r=>this.onMouseDown(r))};Mo()?e():(DS()&&e(),n())}selectedCellWasTouched(e){const r=this.parentCell(e).coords;if(De(this,pu)&&r){const[i,o]=[r.row,De(this,pu).from.row],[s,a]=[r.col,De(this,pu).from.col];return i===o&&s===a}return!1}parentCell(e){const n={},r=De(this,Sn).TABLE,i=Qu(e,["TD","TH"],r);return i?(n.coords=De(this,Sn).getCoords(i),n.TD=i):Ve(e,"wtBorder")&&Ve(e,"current")?(n.coords=De(this,Wa).getFocusSelection().cellRange.highlight,n.TD=De(this,Sn).getCell(n.coords)):Ve(e,"wtBorder")&&Ve(e,"area")&&De(this,Wa).getAreaSelection().cellRange&&(n.coords=De(this,Wa).getAreaSelection().cellRange.to,n.TD=De(this,Sn).getCell(n.coords)),n}onMouseDown(e){const n=De(this,Jm).rootDocument.activeElement,r=wS(jI,e.target),i=e.target;if(!["TD","TH"].includes(n.nodeName)&&(i===n||r(0)===n||r(1)===n))return;const o=this.parentCell(i);Ve(i,"corner")?De(this,Pr).getSetting("onCellCornerMouseDown",e,i):o.TD&&De(this,Pr).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(De(this,_i)[0]=o.TD,clearTimeout(De(this,Ns)[0]),De(this,Ns)[0]=setTimeout(()=>{De(this,_i)[0]=null},1e3))}onContextMenu(e){if(De(this,Pr).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!De(this,Pr).has("onCellMouseOver"))return;const n=De(this,Sn).TABLE,r=Qu(e.target,["TD","TH"],n),i=De(this,Dh)||this;r&&r!==i.lastMouseOver&&vs(r,n)&&(i.lastMouseOver=r,this.callListener("onCellMouseOver",e,De(this,Sn).getCoords(r),r))}onMouseOut(e){if(!De(this,Pr).has("onCellMouseOut"))return;const n=De(this,Sn).TABLE,r=Qu(e.target,["TD","TH"],n),i=Qu(e.relatedTarget,["TD","TH"],n),o=De(this,Dh)||this;r&&r!==i&&vs(r,n)&&(this.callListener("onCellMouseOut",e,De(this,Sn).getCoords(r),r),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&De(this,Pr).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===De(this,_i)[0]&&n.TD===De(this,_i)[1]?(Ve(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),De(this,_i)[0]=null,De(this,_i)[1]=null):n.TD===De(this,_i)[0]&&(De(this,_i)[1]=n.TD,clearTimeout(De(this,Ns)[1]),De(this,Ns)[1]=setTimeout(()=>{De(this,_i)[1]=null},500)))}onTouchStart(e){jo(this,pu,De(this,Wa).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const r=e.target,i=(n=this.parentCell(r))===null||n===void 0?void 0:n.coords,o=Re(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&De(this,Pr).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];SS()&&(gP()||mP())&&this.selectedCellWasTouched(r)&&!a.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,r,i){const o=De(this,Pr).getSettingPure(e);o&&o(n,r,i,De(this,ep).call(this))}destroy(){clearTimeout(De(this,Ns)[0]),clearTimeout(De(this,Ns)[1]),De(this,Zr).destroy()}};const YP=Hj;function tp(t,e,n){return e=Dj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dj(t){var e=Nj(t,"string");return typeof e=="symbol"?e:String(e)}function Nj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Lj{constructor(e,n,r){tp(this,"offset",void 0),tp(this,"total",void 0),tp(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const $j=Lj;function np(t,e,n){return e=kj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kj(t){var e=Fj(t,"string");return typeof e=="symbol"?e:String(e)}function Fj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Wj{constructor(e,n,r){np(this,"offset",void 0),np(this,"total",void 0),np(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const Vj=Wj,Bj=0,kf=1,Ff=2;function Nh(t,e,n){return e=Uj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Uj(t){var e=Yj(t,"string");return typeof e=="symbol"?e:String(e)}function Yj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class G0{constructor(){Nh(this,"currentSize",0),Nh(this,"nextSize",0),Nh(this,"currentOffset",0),Nh(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}function rp(t,e,n){return e=Gj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gj(t){var e=zj(t,"string");return typeof e=="symbol"?e:String(e)}function zj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jj{constructor(){rp(this,"size",new G0),rp(this,"workingSpace",Bj),rp(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof G0}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=kf,e.workingSpace=Ff,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=Ff,e.workingSpace=kf,this.sharedSize=e.getViewSize()}}function Va(t,e,n){return e=Kj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kj(t){var e=qj(t,"string");return typeof e=="symbol"?e:String(e)}function qj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class GP{constructor(e,n,r){Va(this,"rootNode",void 0),Va(this,"nodesPool",void 0),Va(this,"sizeSet",new jj),Va(this,"childNodeType",void 0),Va(this,"visualIndex",0),Va(this,"collectedNodes",[]),this.rootNode=e,this.nodesPool=n,this.childNodeType=r.toUpperCase()}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:n}=this;let r=0;if(this.isSharedViewSet()){let i=e.firstElementChild;for(;i;){if(i.tagName===this.childNodeType)r+=1;else if(n.isPlaceOn(kf))break;i=i.nextElementSibling}}else r=e.childElementCount;return r}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:n}=this,r=this.isSharedViewSet(),{nextSize:i}=n.getViewSize();let o=this.getRenderedChildCount();for(;o<i;){const a=this.nodesPool();!r||r&&n.isPlaceOn(Ff)?e.appendChild(a):e.insertBefore(a,e.firstChild),o+=1}const s=r&&n.isPlaceOn(kf);for(;o>i;)e.removeChild(s?e.firstChild:e.lastChild),o-=1}render(){const{rootNode:e,sizeSet:n}=this;let r=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(Ff)&&(r+=n.sharedSize.nextSize);let i=e.childNodes[r];if(i.tagName!==this.childNodeType){const o=this.nodesPool();e.replaceChild(o,i),i=o}this.collectedNodes.push(i),this.visualIndex+=1}end(){}}class zP extends GP{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function Xj(t,e,n){return e=Zj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zj(t){var e=Qj(t,"string");return typeof e=="symbol"?e:String(e)}function Qj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Jj{constructor(e){Xj(this,"nodeType",void 0),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}function wu(t,e,n){return e=eK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eK(t){var e=tK(t,"string");return typeof e=="symbol"?e:String(e)}function tK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rh{constructor(e,n){wu(this,"nodesPool",null),wu(this,"nodeType",void 0),wu(this,"rootNode",void 0),wu(this,"table",null),wu(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new Jj(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function z0(t,e,n){return e=nK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nK(t){var e=rK(t,"string");return typeof e=="symbol"?e:String(e)}function rK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class iK extends rh{constructor(){super("TH"),z0(this,"orderViews",new WeakMap),z0(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new zP(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:r,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(let d=0;d<r;d++){u.render();const g=u.getCurrentNode();g.className="",g.removeAttribute("style"),Ia(g,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Ne(g,[NY(),UY(),uS(d+1),Kl(-1)]),n[d](a,g,d)}u.end()}}}class oK extends rh{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+n;for(let a=0,l=e;a<l;a++){for(r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<o;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)r.removeChild(r.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&vi(r)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Ne(this.rootNode,[BI()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:r,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&Ne(s,[OC(),zI(n+1)]);for(let a=-1*o;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),Ia(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Ne(u,[uS(a+1+this.table.rowHeadersCount),Kl(-1),LY(),...a>=0?[BY()]:[OC()]]),r[n](l,u,n)}}}}class sK extends rh{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,r=e+n;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;for(let i=0;i<n;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getStretchedColumnWidth(o);this.rootNode.childNodes[i+n].style.width=`${s}px`}const r=this.rootNode.firstChild;r&&ce(r,"rowHeader")}}function aK(t,e,n){return e=lK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lK(t){var e=uK(t,"string");return typeof e=="symbol"?e:String(e)}function uK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let j0=!1;class cK extends rh{constructor(e){super("TR",e),aK(this,"orderView",void 0),this.orderView=new GP(e,n=>this.nodesPool.obtain(n),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!j0&&e>1e3&&(j0=!0,Pt(bt`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Ne(this.rootNode,[BI()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var n,r;Ne(o,[OC(),zI(s+((n=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}}this.orderView.end()}}function K0(t,e,n){return e=hK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hK(t){var e=dK(t,"string");return typeof e=="symbol"?e:String(e)}function dK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fK extends rh{constructor(){super("TD"),K0(this,"orderViews",new WeakMap),K0(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new zP(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:r,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=r.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),d=i.obtainOrderView(u);c.prependView(d).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(let g=0;g<n;g++){c.render();const p=c.getCurrentNode(),C=this.table.renderedColumnToSource(g);if(Ve(p,"hide")||(p.className=""),p.removeAttribute("style"),p.removeAttribute("dir"),Ia(p,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,C,p),this.table.isAriaEnabled()){var o,s;Ne(p,[...p.hasAttribute("role")?[]:[DY()],Kl(-1),uS(C+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function yn(t,e,n){return e=gK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gK(t){var e=mK(t,"string");return typeof e=="symbol"?e:String(e)}function mK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pK{constructor(e){let{cellRenderer:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};yn(this,"rootNode",void 0),yn(this,"rootDocument",void 0),yn(this,"rowHeaders",null),yn(this,"columnHeaders",null),yn(this,"colGroup",null),yn(this,"rows",null),yn(this,"cells",null),yn(this,"rowFilter",null),yn(this,"columnFilter",null),yn(this,"rowUtils",null),yn(this,"columnUtils",null),yn(this,"rowsToRender",0),yn(this,"columnsToRender",0),yn(this,"rowHeaderFunctions",[]),yn(this,"rowHeadersCount",0),yn(this,"columnHeaderFunctions",[]),yn(this,"columnHeadersCount",0),yn(this,"cellRenderer",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:r,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),r.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=r,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let r=0;r<e;r++){const i=n.getRenderedNode(r);if(i.firstChild){const o=this.renderedRowToSource(r),s=this.rowUtils.getHeight(o);s?i.firstChild.style.height=`${s-1}px`:i.firstChild.style.height=""}}}}class wK{constructor(){let{TABLE:e,THEAD:n,COLGROUP:r,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new pK(e,{cellRenderer:a}),this.renderer.setRenderers({rowHeaders:new iK,columnHeaders:new oK(n),colGroup:new sK(r),rows:new cK(i),cells:new fK}),this.renderer.setAxisUtils(o,s)}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function ip(t,e,n){return e=CK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function CK(t){var e=vK(t,"string");return typeof e=="symbol"?e:String(e)}function vK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class SK{constructor(e,n){ip(this,"dataAccessObject",void 0),ip(this,"wtSettings",void 0),ip(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=n}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(e){const n=this.dataAccessObject.wtViewport.columnsRenderCalculator;let r=this.getWidth(e);if(n){const i=n.getStretchedColumnWidth(e,r);i&&(r=i)}return r}getHeaderHeight(e){let n=this.wtSettings.getSetting("defaultRowHeight");const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(n=n?Math.max(n,r):r),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this,{wtTable:n,wtViewport:r,cloneSource:i}=this.dataAccessObject,o=i?i.wtTable.holder:n.holder,s=o.offsetHeight<o.scrollHeight?Cn():0;let a=e.getSetting("rowHeaderWidth");if(r.columnsRenderCalculator.refreshStretching(r.getViewportWidth()-s),a=e.getSetting("onModifyRowHeaderWidth",a),a!=null){const l=e.getSetting("rowHeaders").length,u=e.getSetting("defaultColumnWidth");for(let c=0;c<l;c++){let d=Array.isArray(a)?a[c]:a;d=d??u,this.headerWidths.set(c,d)}}}}function q0(t,e,n){return e=yK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yK(t){var e=bK(t,"string");return typeof e=="symbol"?e:String(e)}function bK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class RK{constructor(e,n){q0(this,"dataAccessObject",void 0),q0(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(n=n===void 0?r:Math.max(n,r)),n}}function Mi(t,e,n){return e=EK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function EK(t){var e=TK(t,"string");return typeof e=="symbol"?e:String(e)}function TK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _K{constructor(e,n,r,i,o){Mi(this,"wtSettings",null),Mi(this,"domBindings",void 0),Mi(this,"TBODY",null),Mi(this,"THEAD",null),Mi(this,"COLGROUP",null),Mi(this,"hasTableHeight",!0),Mi(this,"hasTableWidth",!0),Mi(this,"isTableVisible",!1),Mi(this,"tableOffset",0),Mi(this,"holderOffset",0),this.domBindings=r,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,hS(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new RK(this.dataAccessObject,this.wtSettings),this.columnUtils=new SK(this.dataAccessObject,this.wtSettings),this.tableRenderer=new wK({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Ve(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",n&&n.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Ne(r,[Gi()]),r}createHider(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Ve(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",n&&n.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Ne(r,[Gi()]),r}createHolder(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Ve(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",n&&n.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Ne(r.parentNode,[Gi()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Ne(r,[Gi()]),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:r,wtViewport:i}=this.dataAccessObject,o=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),a=n.getSetting("rowHeaders"),l=a.length,u=n.getSetting("columnHeaders"),c=u.length;let d=!1,g=e;if(this.isMaster&&(this.holderOffset=ln(this.holder),g=i.createRenderCalculators(g),l&&!n.getSetting("fixedColumnsStart"))){const C=r.inlineStartOverlay.getScrollPosition(),E=this.correctHeaderWidth;this.correctHeaderWidth=C!==0,E!==this.correctHeaderWidth&&(g=!1)}if(this.isMaster&&(d=r.updateStateOfRendering()),g)this.isMaster&&i.createVisibleCalculators(),r&&r.refresh(!0);else{this.isMaster?this.tableOffset=ln(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const C=o>0?this.getFirstRenderedRow():0,E=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new Vj(C,o,c),this.columnFilter=new $j(E,s,l);let I=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const M={};this.wtSettings.getSetting("beforeDraw",!0,M),I=M.skipRender!==!0}if(I){this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(Ui)||this.is(ys))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();let M;if(this.isMaster&&(M=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Ui))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();const y=yt(this.hider),$=yt(this.TABLE);y!==0&&$!==y&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),M!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(Ui)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let p=!1;return this.isMaster&&(p=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(p=r.bottomOverlay.resetFixedPosition()||p),p=r.inlineStartOverlay.resetFixedPosition()||p,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),p?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(g),d&&r.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("defaultRowHeight");let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,o=this.getColumnHeaderHeight(r),s=this.getColumnHeader(n,r),s&&(a=_o(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),Array.isArray(l)?l[r]!==null&&l[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(l[r]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(r[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height=`${r[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(Ui))&&!e.getSetting("externalRowCalculator")){const r=this.getRenderedRowsCount();for(let i=0;i<r;i++){const o=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}}getCell(e){let n=e.row,r=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",n,r);if(i&&Array.isArray(i)&&([n,r]=i),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const o=this.getRow(n);if(!o&&n>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!s&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let n=null,r=null;if(e<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),r=this.TBODY}return n!==void 0&&r!==void 0?r.childNodes.length<n+1?!1:r.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.THEAD.childNodes[n];return r==null?void 0:r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[r];o&&n.push(o)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.wtSettings.getSetting("rowHeaders").length;if(n>=r)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a==null?void 0:a.childNodes[n]}getRowHeaders(e){const n=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<r;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o==null?void 0:o.childNodes[i];s&&n.push(s)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=Es(n,["TD","TH"])),n===null)return null;const r=n.parentNode,i=r.parentNode;let o=XI(r),s=n.cellIndex;return os(ba,n,this.wtRootElement)||os(Sa,n,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):os(ys,n,this.wtRootElement)||os(Ui,n,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):o=this.rowFilter.renderedToSource(o),os(ba,n,this.wtRootElement)||os(ya,n,this.wtRootElement)||os(ys,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=e*this.wtSettings.getSetting("defaultRowHeight"),r=_o(this.TBODY)-1;let i,o,s,a,l;if(!(n===r&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;)e-=1,s=this.rowFilter.renderedToSource(e),i=this.getRowHeight(s),a=this.getTrForRow(s),l=a.querySelector("th"),l?o=_o(l):o=_o(a)-1,(!i&&this.wtSettings.getSetting("defaultRowHeight")<o||i<o)&&(o+=1,this.dataAccessObject.wtViewport.oversizedRows[s]=o)}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}getStretchedColumnWidth(e){return this.columnUtils.getStretchedColumnWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return yt(this.TABLE)}getHeight(){return Bt(this.TABLE)}getTotalWidth(){const e=yt(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=Bt(this.hider);return e!==0?e:this.getHeight()}isVisible(){return _s(this.TABLE)}_modifyRowHeaderWidth(e){let n=At(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const Zl=_K,MK="stickyRowsBottom",jP={getFirstRenderedRow(){const t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),n=t-e;return t===0||e===0?-1:n<0?0:n},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};Ji(jP,"MIXIN_NAME",MK,{writable:!1,enumerable:!1});const KP=jP,OK="stickyColumnsStart",qP={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Ji(qP,"MIXIN_NAME",OK,{writable:!1,enumerable:!1});const NS=qP;class LS extends Zl{constructor(e,n,r,i){super(e,n,r,i,ys)}}_t(LS,KP);_t(LS,NS);const AK=LS,Sa="top",Ui="bottom",ya="inline_start",ba="top_inline_start_corner",ys="bottom_inline_start_corner",IK=[Sa,Ui,ya,ba,ys],PK=new Map([[Sa,`ht_clone_${Sa}`],[Ui,`ht_clone_${Ui}`],[ya,`ht_clone_${ya} ht_clone_left`],[ba,`ht_clone_${ba} ht_clone_top_left_corner`],[ys,`ht_clone_${ys} ht_clone_bottom_left_corner`]]);function op(t,e,n){return e=xK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xK(t){var e=HK(t,"string");return typeof e=="symbol"?e:String(e)}function HK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class DK{constructor(e){op(this,"dataAccessObject",void 0),op(this,"lastScrolledColumnPos",-1),op(this,"lastScrolledRowPos",-1),this.dataAccessObject=e}scrollViewport(e,n,r,i,o){const s=this.scrollViewportHorizontally(e.col,r,o),a=this.scrollViewportVertically(e.row,n,i);return s||a}scrollViewportHorizontally(e,n,r){const{drawn:i,totalColumns:o}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>o)return!1;const s=this.getFirstVisibleColumn(),a=this.getLastVisibleColumn(),l=n===void 0&&r===void 0,{fixedColumnsStart:u,inlineStartOverlay:c}=this.dataAccessObject;if(l&&e<u)return!1;let d=!1;return e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e),s===-1?d=c.scrollTo(e,l?e>this.lastScrolledColumnPos:n):(l&&(e<s||e>a)||!l)&&(d=c.scrollTo(e,l?e>a:n)),d&&(this.lastScrolledColumnPos=e),d}scrollViewportVertically(e,n,r){const{drawn:i,totalRows:o}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>o)return!1;const s=this.getFirstVisibleRow(),a=this.getLastVisibleRow(),l=n===void 0&&r===void 0,{fixedRowsBottom:u,fixedRowsTop:c,topOverlay:d}=this.dataAccessObject;if(l&&(e<c||e>o-u-1))return!1;let g=!1;return e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e),s===-1?g=d.scrollTo(e,l?e>this.lastScrolledRowPos:r):(l&&(e<s||e>a)||!l)&&(g=d.scrollTo(e,l?e>a:r)),g&&(this.lastScrolledRowPos=e),g}getFirstVisibleRow(){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,fixedRowsTop:o,rootWindow:s}=this.dataAccessObject;let a=n.getFirstVisibleRow();if(e.mainTableScrollableElement===s){const l=ln(n.wtRootElement),u=_o(n.hider),c=_o(s),d=Pc(s,s);if(l.top+u-c<=d){let g=r.getColumnHeaderHeight();g+=e.sumCellSizes(0,o);for(let p=i;p>0;p--)if(g+=e.sumCellSizes(p-1,p),l.top+u-g<=d){a=p;break}}}return a}getLastVisibleRow(){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,rootWindow:o}=this.dataAccessObject;let s=n.getLastVisibleRow();if(e.mainTableScrollableElement===o){const a=ln(n.wtRootElement),l=Pc(o,o);if(a.top>l){const u=_o(o);let c=r.getColumnHeaderHeight();for(let d=1;d<=i;d++)if(c+=e.sumCellSizes(d-1,d),a.top+c-l>=u){s=d-2;break}}}return s}getFirstVisibleColumn(){const{inlineStartOverlay:e,wtTable:n,wtViewport:r,totalColumns:i,rootWindow:o}=this.dataAccessObject;let s=n.getFirstVisibleColumn();if(e.mainTableScrollableElement===o){const a=ln(n.wtRootElement),l=uc(n.hider),u=uc(o),c=Math.abs(Af(o,o));if(a.left+l-u<=c){let d=r.getRowHeaderWidth();for(let g=i;g>0;g--)if(d+=e.sumCellSizes(g-1,g),a.left+l-d<=c){s=g;break}}}return s}getLastVisibleColumn(){const{wtSettings:e,inlineStartOverlay:n,wtTable:r,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;let a=r.getLastVisibleColumn();if(n.mainTableScrollableElement===s){const l=e.getSetting("rtlMode");let u=null;if(l){const d=r.TABLE.getBoundingClientRect(),p=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;u=Math.abs(d.right-p)}else u=ln(r.wtRootElement).left;const c=Math.abs(Af(s,s));if(u>c){const d=uc(s);let g=i.getRowHeaderWidth();for(let p=1;p<=o;p++)if(g+=n.sumCellSizes(p-1,p),u+g-c>=d){a=p-2;break}}}return a}}const NK=DK;function Qr(t,e,n){return e=LK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function LK(t){var e=$K(t,"string");return typeof e=="symbol"?e:String(e)}function $K(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $S{get eventManager(){return new Mr(this)}constructor(e,n){Qr(this,"wtTable",void 0),Qr(this,"wtScroll",void 0),Qr(this,"wtViewport",void 0),Qr(this,"wtOverlays",void 0),Qr(this,"selectionManager",void 0),Qr(this,"wtEvent",void 0),Qr(this,"guid",`wt_${oS()}`),Qr(this,"drawInterrupted",!1),Qr(this,"drawn",!1),Qr(this,"domBindings",void 0),Qr(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new NK(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;n<r;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,r){Ts(r,e[n])}])}}createCellCoords(e,n){return new $f(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,r){return new HS(e,n,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!e&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const r=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=r-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,r,i,o){return e.col<0||e.row<0?!1:this.wtScroll.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return e<0?!1:this.wtScroll.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return e<0?!1:this.wtScroll.scrollViewportVertically(e,n,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function X0(t,e,n){return e=kK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kK(t){var e=FK(t,"string");return typeof e=="symbol"?e:String(e)}function FK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class WK extends $S{constructor(e,n,r){super(e,n),X0(this,"cloneSource",void 0),X0(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new YP(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}function VK(t,e,n){return e=BK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function BK(t){var e=UK(t,"string");return typeof e=="symbol"?e:String(e)}function UK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ih{constructor(e,n,r,i,o){VK(this,"wtSettings",null),Ji(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=n,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=va(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}updateStateOfRendering(){const e=this.needFullRender;this.needFullRender=this.shouldBeRendered();const n=e!==this.needFullRender;return n&&!this.needFullRender&&this.reset(),n}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=va(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=xc(e.TABLE)}getRelativeCellPosition(e,n,r){if(this.clone.wtTable.holder.contains(e)===!1){Pt(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=r<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),a=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let d=null;return i?d=this.getRelativeCellPositionWithinWindow(s,o,c,u):d=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),d}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,r,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!n)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+Cn())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:r.start+s,top:r.top+a}}getRelativeCellPositionWithinHolder(e,n,r,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(r||(a=s.horizontal-o.start),n){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(IK.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=r.createElement("div"),s=r.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${PK.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,n.getSetting("ariaTags")&&Ne(o,[Gi()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===Sa||u==="vertical"&&this.type===ya?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=xc(e.TABLE),new WK(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(e),this.needFullRender=n}reset(){if(!this.clone)return;const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,r=e.style,i=n.style,o=e.parentNode.style;H([r,i,o],s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class YK extends ih{constructor(e,n,r,i,o,s){super(e,n,ys,r,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new AK(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${o}px`,n.style.bottom=`${s}px`}else Jc(n),this.repositionOverlay();let r=Bt(this.clone.wtTable.TABLE);const i=yt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),n.style.height=`${r}px`,n.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=Cn(r)),i.style.bottom=`${o}px`}}const GK="calculatedColumns",XP={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Ji(XP,"MIXIN_NAME",GK,{writable:!1,enumerable:!1});const kS=XP;class FS extends Zl{constructor(e,n,r,i){super(e,n,r,i,Ui)}}_t(FS,KP);_t(FS,kS);const zK=FS;function jK(t,e,n){return e=KK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function KK(t){var e=qK(t,"string");return typeof e=="symbol"?e:String(e)}function qK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class XK extends ih{constructor(e,n,r,i){super(e,n,Ui,r,i),jK(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new zK(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let r=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(r=this.getOverlayOffset(),n.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=Cn(r)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;return this.mainTableScrollableElement===n?(n.scrollTo(Dg(n),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:r,wtSettings:i}=this.wot,o=i.getSetting("defaultRowHeight");let s=e,a=0;for(;s<n;){const l=r.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=Cn(r),a=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||l==="horizontal"){let c=n.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(c-=o),c=Math.min(c,e.wtRootElement.scrollWidth),a.width=`${c}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let u=Bt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(u=0),a.height=`${u}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;n&&o.offsetHeight!==o.clientHeight&&(s=Cn(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Pc(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==n,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((r||n===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=Ve(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(ce(s,"innerBorderBottom"),o=!a):(Ye(s,"innerBorderBottom"),o=a)}return o}}const ZK="calculatedRows",ZP={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Ji(ZP,"MIXIN_NAME",ZK,{writable:!1,enumerable:!1});const QP=ZP;class WS extends Zl{constructor(e,n,r,i){super(e,n,r,i,ya)}}_t(WS,QP);_t(WS,NS);const QK=WS,JK="localHooks",JP={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,r,i,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)Pf(this._localHooks[t][l],this,e,n,r,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};Ji(JP,"MIXIN_NAME",JK,{writable:!1,enumerable:!1});const wr=JP;let ex=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};_t(ex,wr);const e3=ex,tx="active-header",VS="header",BS="area",US="focus",t3="fill",n3="row",r3="column",i3="custom-selection",YS=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});var o3=LP;o3("flat");function s3(t,e){nx(t,e),e.add(t)}function Z0(t,e,n){nx(t,e),e.set(t,n)}function nx(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sp(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function on(t,e){var n=rx(t,e,"get");return a3(t,n)}function a3(t,e){return e.get?e.get.call(t):e.value}function Q0(t,e,n){var r=rx(t,e,"set");return l3(t,r,n),n}function rx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function l3(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Jr=new WeakMap,ar=new WeakMap,Lh=new WeakSet;class u3{constructor(){s3(this,Lh),Z0(this,Jr,{writable:!0,value:void 0}),Z0(this,ar,{writable:!0,value:void 0})}setActiveOverlay(e){return Q0(this,ar,e),this}setActiveSelection(e){return Q0(this,Jr,e),this}scan(){const e=on(this,Jr).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="area"?this.scanCellsRange(r=>n.add(r)):e==="focus"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r)),this.scanCellsRange(r=>n.add(r))):e==="fill"?this.scanCellsRange(r=>n.add(r)):e==="header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="row"?(this.scanRowsInHeadersRange(r=>n.add(r)),this.scanRowsInCellsRange(r=>n.add(r))):e==="column"&&(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanColumnsInCellsRange(r=>n.add(r))),n}scanColumnsInHeadersRange(e){const[n,r,i,o]=on(this,Jr).getCorners(),{wtTable:s}=on(this,ar),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const d=s.columnFilter.renderedToSource(c);if(!(d<r||d>o)){for(let g=-l;g<0;g++){if(g<n||g>i)continue;const p=g+l;let C=s.getColumnHeader(d,p);const E=on(this,ar).getSetting("onBeforeHighlightingColumnHeader",d,p,{selectionType:on(this,Jr).settings.selectionType,columnCursor:u,selectionWidth:o-r+1});E!==null&&(E!==d&&(C=s.getColumnHeader(E,p)),e(C))}u+=1}}}scanRowsInHeadersRange(e){const[n,r,i,o]=on(this,Jr).getCorners(),{wtTable:s}=on(this,ar),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const d=s.rowFilter.renderedToSource(c);if(!(d<n||d>i)){for(let g=-l;g<0;g++){if(g<r||g>o)continue;const p=g+l;let C=s.getRowHeader(d,p);const E=on(this,ar).getSetting("onBeforeHighlightingRowHeader",d,p,{selectionType:on(this,Jr).settings.selectionType,rowCursor:u,selectionHeight:i-n+1});E!==null&&(E!==d&&(C=s.getRowHeader(E,p)),e(C))}u+=1}}}scanCellsRange(e){const[n,r,i,o]=on(this,Jr).getCorners(),{wtTable:s}=on(this,ar);sp(this,Lh,ap).call(this,(a,l)=>{if(a>=n&&a<=i&&l>=r&&l<=o){const u=s.getCell(on(this,ar).createCellCoords(a,l)),c=on(this,ar).getSetting("onAfterDrawSelection",a,l,on(this,Jr).settings.layerLevel);typeof c=="string"&&ce(u,c),e(u)}})}scanRowsInCellsRange(e){const[n,,r]=on(this,Jr).getCorners(),{wtTable:i}=on(this,ar);sp(this,Lh,ap).call(this,(o,s)=>{if(o>=n&&o<=r){const a=i.getCell(on(this,ar).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,n,,r]=on(this,Jr).getCorners(),{wtTable:i}=on(this,ar);sp(this,Lh,ap).call(this,(o,s)=>{if(s>=n&&s<=r){const a=i.getCell(on(this,ar).createCellCoords(o,s));e(a)}})}}function ap(t){const{wtTable:e}=on(this,ar),n=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let i=0;i<n;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<r;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class c3{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=YS,this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,r=this.main.childNodes.length;n<r;n++){const i=this.main.childNodes[n];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Kr(e);const r=this,i=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(r.eventManager.removeEventListener(i,"mousemove",a),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const r=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=r[a],u=n.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Mo()&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=n.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const n=10,r=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const i={position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${parseInt(r/1.5,10)}px`};Ze(i,(s,a)=>{this.selectionHandles.styles.bottomHitArea[a]=s,this.selectionHandles.styles.topHitArea[a]=s});const o={position:"absolute",height:`${n}px`,width:`${n}px`,"border-radius":`${parseInt(n/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};Ze(o,(s,a)=>{this.selectionHandles.styles.bottom[a]=s,this.selectionHandles.styles.top[a]=s}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const r=this.wot.selectionManager.getAreaSelection();return!!(r.cellRange&&(e!==r.cellRange.to.row||n!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,r,i,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:d,bottomHitArea:g}=this.selectionHandles.styles,p=parseInt(u.borderWidth,10),C=parseInt(u.width,10),E=parseInt(c.width,10),I=this.wot.wtTable.getWidth(),M=this.wot.wtTable.getHeight();u.top=`${parseInt(r-C-1,10)}px`,u[l]=`${parseInt(i-C-1,10)}px`,c.top=`${parseInt(r-E/4*3,10)}px`,c[l]=`${parseInt(i-E/4*3,10)}px`;const y=Math.min(parseInt(i+o,10),I-C-p*2),$=Math.min(parseInt(i+o-E/4,10),I-E-p*2);d[l]=`${y}px`,g[l]=`${$}px`;const q=Math.min(parseInt(r+s,10),M-C-p*2),G=Math.min(parseInt(r+s-E/4,10),M-E-p*2);d.top=`${q}px`,g.top=`${G}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,n)?(d.display="none",g.display="none"):(d.display="block",g.display="block")):(u.display="none",d.display="none",c.display="none",g.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;const{wtTable:n,rootDocument:r,rootWindow:i}=this.wot;let o,s,a,l,u,c;const d=n.getRenderedRowsCount();for(let w=0;w<d;w+=1){const h=n.rowFilter.renderedToSource(w);if(h>=e[0]&&h<=e[2]){o=h,u=e[0];break}}for(let w=d-1;w>=0;w-=1){const h=n.rowFilter.renderedToSource(w);if(h>=e[0]&&h<=e[2]){s=h;break}}const g=n.getRenderedColumnsCount();for(let w=0;w<g;w+=1){const h=n.columnFilter.renderedToSource(w);if(h>=e[1]&&h<=e[3]){a=h,c=e[1];break}}for(let w=g-1;w>=0;w-=1){const h=n.columnFilter.renderedToSource(w);if(h>=e[1]&&h<=e[3]){l=h;break}}if(o===void 0||a===void 0){this.disappear();return}let p=n.getCell(this.wot.createCellCoords(o,a));const C=o!==s||a!==l,E=C?n.getCell(this.wot.createCellCoords(s,l)):p,I=ln(p),M=C?ln(E):I,y=ln(n.TABLE),$=yt(n.TABLE),q=I.top,G=I.left,X=this.wot.wtSettings.getSetting("rtlMode");let re=0,v=0;if(X){const w=yt(p),h=i.innerWidth-y.left-$;v=G+w-M.left,re=i.innerWidth-G-w-h-1}else v=M.left+yt(E)-G,re=G-y.left-1;if(this.isEntireColumnSelected(o,s)){const w=this.getDimensionsFromHeader("columns",a,l,u,y);let h=null;w&&([h,re,v]=w),h&&(p=h)}let S=q-y.top-1,b=M.top+Bt(E)-q;if(this.isEntireRowSelected(a,l)){const w=this.getDimensionsFromHeader("rows",o,s,c,y);let h=null;w&&([h,S,b]=w),h&&(p=h)}const L=No(p,i);parseInt(L.borderTopWidth,10)>0&&(S+=1,b=b>0?b-1:0),parseInt(L[X?"borderRightWidth":"borderLeftWidth"],10)>0&&(re+=1,v=v>0?v-1:0);const P=X?"right":"left";this.topStyle.top=`${S}px`,this.topStyle[P]=`${re}px`,this.topStyle.width=`${v}px`,this.topStyle.display="block",this.startStyle.top=`${S}px`,this.startStyle[P]=`${re}px`,this.startStyle.height=`${b}px`,this.startStyle.display="block";const x=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${S+b-x}px`,this.bottomStyle[P]=`${re}px`,this.bottomStyle.width=`${v}px`,this.bottomStyle.display="block",this.endStyle.top=`${S}px`,this.endStyle[P]=`${re+v-x}px`,this.endStyle.height=`${b+1}px`,this.endStyle.display="block";let W=this.settings.border.cornerVisible;W=typeof W=="function"?W(this.settings.layerLevel):W;const D=this.wot.getSetting("onModifyGetCellCoords",s,l);let[B,z]=[s,l];if(D&&Array.isArray(D)&&([,,B,z]=D),Mo()||!W||this.isPartRange(B,z))this.cornerStyle.display="none";else{this.cornerStyle.top=`${S+b+this.cornerCenterPointOffset-1}px`,this.cornerStyle[P]=`${re+v+this.cornerCenterPointOffset-1}px`,this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let w=va(n.TABLE);const h=w===i;h&&(w=r.documentElement);const f=parseInt(this.cornerDefaultStyle.width,10)/2,m=parseInt(this.cornerDefaultStyle.height,10)/2;if(l===this.wot.getSetting("totalColumns")-1){const T=h?E.getBoundingClientRect().left:E.offsetLeft;let O=!1,_=0;X?(_=T-parseInt(this.cornerDefaultStyle.width,10)/2,O=_<0):(_=T+yt(E)+parseInt(this.cornerDefaultStyle.width,10)/2,O=_>=uc(w)),O&&(this.cornerStyle[P]=`${Math.floor(re+v+this.cornerCenterPointOffset-f)}px`,this.cornerStyle[X?"borderLeftWidth":"borderRightWidth"]=0)}s===this.wot.getSetting("totalRows")-1&&(h?E.getBoundingClientRect().top:E.offsetTop)+Bt(E)+parseInt(this.cornerDefaultStyle.height,10)/2>=_o(w)&&(this.cornerStyle.top=`${Math.floor(S+b+this.cornerCenterPointOffset-m)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}Mo()&&this.updateMultipleSelectionHandlesPosition(s,l,S,re,v,b)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,r,i,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,d=null,g=null,p=null,C=null,E=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return Bt(...arguments)},c="ht__selection--rows",p="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return yt(...arguments)},c="ht__selection--columns",p="left";break}if(a.classList.contains(c)){const I=this.wot.getSetting("columnHeaders").length;if(C=l(n,I-i),E=l(r,I-i),!C||!E)return!1;const M=ln(C),y=ln(E);return C&&E&&(d=M[p]-o[p]-1,g=y[p]+u(E)-M[p]),[C,d,g]}return!1}changeBorderStyle(e,n){const r=this[e].style,i=n[e];!i||i.hide?ce(this[e],"hidden"):(Ve(this[e],"hidden")&&Ye(this[e],"hidden"),r.backgroundColor=i.color,(e==="top"||e==="bottom")&&(r.height=`${i.width}px`),(e==="start"||e==="end")&&(r.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},r=this[e].style;r.backgroundColor=n.color,r.width=`${n.width}px`,r.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?ce(this[e],"hidden"):Ye(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Mo()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}const J0=c3;function h3(t,e){ix(t,e),e.add(t)}function Ba(t,e,n){ix(t,e),e.set(t,n)}function ix(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function d3(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function rt(t,e){var n=ox(t,e,"get");return f3(t,n)}function f3(t,e){return e.get?e.get.call(t):e.value}function eE(t,e,n){var r=ox(t,e,"set");return g3(t,r,n),n}function ox(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function g3(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Ln=new WeakMap,fr=new WeakMap,lp=new WeakMap,Ju=new WeakMap,up=new WeakMap,Ls=new WeakMap,tE=new WeakSet;class m3{constructor(e){h3(this,tE),Ba(this,Ln,{writable:!0,value:void 0}),Ba(this,fr,{writable:!0,value:void 0}),Ba(this,lp,{writable:!0,value:new u3}),Ba(this,Ju,{writable:!0,value:new WeakMap}),Ba(this,up,{writable:!0,value:new WeakSet}),Ba(this,Ls,{writable:!0,value:new Map}),eE(this,fr,e)}setActiveOverlay(e){return eE(this,Ln,e),rt(this,lp).setActiveOverlay(rt(this,Ln)),rt(this,Ju).has(rt(this,Ln))||rt(this,Ju).set(rt(this,Ln),new Set),this}getFocusSelection(){return rt(this,fr)!==null?rt(this,fr).getFocus():null}getAreaSelection(){return rt(this,fr)!==null?rt(this,fr).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(rt(this,Ls).has(e)){const r=rt(this,Ls).get(e);if(r.has(rt(this,Ln)))return r.get(rt(this,Ln));const i=new J0(rt(this,Ln),e.settings);return r.set(rt(this,Ln),i),i}const n=new J0(rt(this,Ln),e.settings);return rt(this,Ls).set(e,new Map([[rt(this,Ln),n]])),n}getBorderInstances(e){var n,r;return Array.from((n=(r=rt(this,Ls).get(e))===null||r===void 0?void 0:r.values())!==null&&n!==void 0?n:[])}destroyBorders(e){rt(this,Ls).get(e).forEach(n=>n.destroy()),rt(this,Ls).delete(e)}render(e){if(rt(this,fr)===null)return;e&&d3(this,tE,p3).call(this);const n=Array.from(rt(this,fr)),r=new Map,i=new Map;for(let o=0;o<n.length;o++){const s=n[o],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;rt(this,up).has(s)||(rt(this,up).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const d=this.getBorderInstance(s);if(s.isEmpty()){d==null||d.disappear();continue}a&&rt(this,lp).setActiveSelection(s).scan().forEach(C=>{if(r.has(C)){const E=r.get(C);E.has(a)&&u===!0?E.set(a,E.get(a)+1):E.set(a,1)}else r.set(C,new Map([[a,1]]));l&&(i.has(C)||i.set(C,[]),C.nodeName==="TH"&&i.get(C).push(...l))});const g=s.getCorners();rt(this,Ln).getSetting("onBeforeDrawBorders",g,c),d==null||d.appear(g)}r.forEach((o,s)=>{var a;const l=Array.from(o).map(u=>{let[c,d]=u;return d===1?c:[c,...Array.from({length:d-1},(g,p)=>`${c}-${p+1}`)]}).flat();l.forEach(u=>rt(this,Ju).get(rt(this,Ln)).add(u)),ce(s,l),s.nodeName==="TD"&&Array.isArray((a=rt(this,fr).options)===null||a===void 0?void 0:a.cellAttributes)&&Ne(s,rt(this,fr).options.cellAttributes)}),Array.from(i.keys()).forEach(o=>{Ne(o,[...i.get(o)])})}}function p3(){const t=rt(this,Ju).get(rt(this,Ln)),e=rt(this,Ln).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var r,i;const o=rt(this,Ln).wtTable.TABLE.querySelectorAll(`.${n}`);let s=[];Array.isArray((r=rt(this,fr).options)===null||r===void 0?void 0:r.cellAttributes)&&(s=rt(this,fr).options.cellAttributes.map(a=>a[0])),Array.isArray((i=rt(this,fr).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...rt(this,fr).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)Ye(o[a],n),Ia(o[a],s)}),t.clear()}class w3 extends ih{constructor(e,n,r,i){super(e,n,ya,r,i)}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new QK(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===n&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),Ng(r,`${o}px`,"0px")):(o=this.getScrollPosition(),Jc(r));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===n&&n.scrollX!==e?(n.scrollTo(e,dS(n)),r=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<n;)o+=this.wot.wtTable.getStretchedColumnWidth(i)||r,i+=1;return o}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=Cn(n),s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="vertical"){let u=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(u-=i),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=yt(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=this.wot.selectionManager.getFocusSelection()?parseInt(YS.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;if(n){const a=this.wot.wtTable.getColumnWidth(e),l=this.wot.wtViewport.getViewportWidth();a>l&&(n=!1)}return n&&o.offsetWidth!==o.clientWidth&&(s=Cn(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportWidth()):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(Af(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wot.wtTable.holder.parentNode,r=this.wtSettings.getSetting("rowHeaders"),i=this.wtSettings.getSetting("fixedColumnsStart");this.wtSettings.getSetting("totalRows")?Ye(n,"emptyRows"):ce(n,"emptyRows");let s=!1;if(i&&!r.length)ce(n,"innerBorderLeft innerBorderInlineStart");else if(!i&&r.length){const a=Ve(n,"innerBorderInlineStart");e?(ce(n,"innerBorderLeft innerBorderInlineStart"),s=!a):(Ye(n,"innerBorderLeft innerBorderInlineStart"),s=a)}return s}}const C3="stickyRowsTop",sx={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Ji(sx,"MIXIN_NAME",C3,{writable:!1,enumerable:!1});const ax=sx;class GS extends Zl{constructor(e,n,r,i){super(e,n,r,i,ba)}}_t(GS,ax);_t(GS,NS);const v3=GS;function nE(t,e,n){return e=S3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function S3(t){var e=y3(t,"string");return typeof e=="symbol"?e:String(e)}function y3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class b3 extends ih{constructor(e,n,r,i,o,s){super(e,n,ba,r,i),nE(this,"topOverlay",void 0),nE(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new v3(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();Ng(e,`${i}px`,`${o}px`)}else Jc(e);let n=Bt(this.clone.wtTable.TABLE);const r=yt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${r}px`,!1}}class zS extends Zl{constructor(e,n,r,i){super(e,n,r,i,Sa)}}_t(zS,ax);_t(zS,kS);const R3=zS;function E3(t,e,n){return e=T3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function T3(t){var e=_3(t,"string");return typeof e=="symbol"?e:String(e)}function _3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class M3 extends ih{constructor(e,n,r,i){super(e,n,Sa,r,i),E3(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new R3(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===n&&(!r||r!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,i=this.getOverlayOffset(),Ng(e,"0px",`${i}px`)}else i=this.getScrollPosition(),Jc(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const n=this.domBindings.rootWindow;let r=!1;return this.mainTableScrollableElement===n&&n.scrollY!==e?(n.scrollTo(Dg(n),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultRowHeight");let i=e,o=0;for(;i<n;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?r:s,i+=1}return o}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=Cn(n),s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="horizontal"){let u=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(u-=i),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=Bt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=this.wot.selectionManager.getFocusSelection()?parseInt(YS.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:r,wtSettings:i}=this,s=(r.cloneSource?r.cloneSource:r).wtTable.holder;let a=this.getTableParentOffset(),l=0;if(n){const u=this.wot.wtTable.getRowHeight(e),c=this.wot.wtViewport.getViewportHeight();u>c&&(n=!1)}if(n&&s.offsetHeight!==s.clientHeight&&(l=Cn(this.domBindings.rootDocument)),n){const u=i.getSetting("fixedRowsBottom"),c=i.getSetting("totalRows");a+=this.sumCellSizes(0,e+1),a-=r.wtViewport.getViewportHeight()-this.sumCellSizes(c-u,c),a+=1}else a+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return a+=l,this.setScrollPosition(a)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Pc(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.wot.wtTable.holder.parentNode;this.wtSettings.getSetting("totalColumns")?Ye(r,"emptyColumns"):ce(r,"emptyColumns");let o=!1;if(!n){const s=this.wtSettings.getSetting("fixedRowsTop"),a=this.cachedFixedRowsTop!==s,l=this.wtSettings.getSetting("columnHeaders");if((a||s===0)&&l.length>0){const u=Ve(r,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),e||this.wtSettings.getSetting("totalRows")===0?(ce(r,"innerBorderTop"),o=!u):(Ye(r,"innerBorderTop"),o=u)}}return o}}function io(t,e,n){return e=O3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function O3(t){var e=A3(t,"string");return typeof e=="symbol"?e:String(e)}function A3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class I3{constructor(e,n,r,i,o,s){io(this,"wot",null),io(this,"topOverlay",null),io(this,"bottomOverlay",null),io(this,"inlineStartOverlay",null),io(this,"topInlineStartCornerOverlay",null),io(this,"bottomInlineStartCornerOverlay",null),io(this,"browserLineHeight",void 0),io(this,"wtSettings",null),io(this,"resizeObserver",new ResizeObserver(c=>{Ug(()=>{!Array.isArray(c)||!c.length||this.wtSettings.getSetting("onContainerElementResize")})})),this.wot=e,this.wtSettings=i,this.domBindings=r,this.facadeGetter=n,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=Cn(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:xc(s.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,r=e.getComputedStyle(n.body),i=parseInt(r.lineHeight,10),o=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new M3(...e),this.bottomOverlay=new XK(...e),this.inlineStartOverlay=new w3(...e),this.topInlineStartCornerOverlay=new b3(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new YK(...e,this.bottomOverlay,this.inlineStartOverlay)}updateStateOfRendering(){let e=this.topOverlay.updateStateOfRendering();return e=this.bottomOverlay.updateStateOfRendering()||e,e=this.inlineStartOverlay.updateStateOfRendering()||e,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(e=this.topInlineStartCornerOverlay.updateStateOfRendering()||e),this.bottomOverlay.needFullRender&&(e=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||e)),e}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",d=>this.onKeyDown(d)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",d=>this.onTableScroll(d),{passive:!0}),r!==i&&this.eventManager.addEventListener(i,"scroll",d=>this.onTableScroll(d),{passive:!0});const o=n.devicePixelRatio&&n.devicePixelRatio>1,s=this.scrollableElement===n,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!CS())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",d=>this.onCloneWheel(d,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(d=>{if(d&&d.needFullRender){const{holder:g}=d.clone.wtTable;this.eventManager.addEventListener(g,"wheel",p=>this.onCloneWheel(p,a),l)}});let c;this.eventManager.addEventListener(n,"resize",()=>{clearTimeout(c),c=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize")},200)}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==n&&o!==n&&!e.target.contains(i)||r!==n&&o!==n&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,n){const{rootWindow:r}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==r&&s!==r&&!s.contains(o),l=i!==r&&s!==r&&!s.contains(i);if(this.keyPressed&&(a||l))return;const u=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==r&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=Xl(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,n+=n*this.browserLineHeight);const i=this.scrollVertically(n),o=this.scrollHorizontally(r);return i||o}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,n=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder,[i,o]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=n.scrollLeft!==i||this.lastScrollX!==e.scrollX,this.verticalScrolling=r.scrollTop!==o||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){n.scrollLeft=i;const s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=i)}this.verticalScrolling&&(r.scrollTop=o),this.refreshAll()}syncScrollWithMaster(){const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=xc(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,r=e.clientHeight,i=n!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r),i}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtViewport:n}=this.wot,{wtTable:r}=this,i=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),s=n.getRowHeaderWidth(),a=n.getColumnHeaderHeight(),l=r.hider.style;if(l.width=`${s+this.inlineStartOverlay.sumCellSizes(0,i)}px`,l.height=`${a+this.topOverlay.sumCellSizes(0,o)+1}px`,this.scrollbarSize>0){const{scrollHeight:u,scrollWidth:c}=r.wtRootElement,{scrollHeight:d,scrollWidth:g}=r.holder;this.hasScrollbarRight=u<d,this.hasScrollbarBottom=c<g,this.hasScrollbarRight&&r.hider.scrollWidth+this.scrollbarSize>c?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&r.hider.scrollHeight+this.scrollbarSize>u&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(e),this.inlineStartOverlay.adjustElementsSize(e),this.bottomOverlay.adjustElementsSize(e)}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return H(n,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(r=i.clone)}),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];H(n,r=>{r&&(r.clone.wtTable.TABLE.className=e.className)})}}const P3=I3;function rE(t,e,n){return e=x3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function x3(t){var e=H3(t,"string");return typeof e=="symbol"?e:String(e)}function H3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class D3{constructor(e){rE(this,"settings",{}),rE(this,"defaults",Object.freeze(this.getDefaults())),Ze(this.defaults,(n,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(n===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,r)=>{const i=this.getSetting("data",e,n);Ts(r,i??"")},columnWidth(){},rowHeight(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:e=>e,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,n){return n===void 0?Ze(e,(r,i)=>{this.settings[i]=r}):this.settings[e]=n,this}getSetting(e,n,r,i,o){return typeof this.settings[e]=="function"?this.settings[e](n,r,i,o):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class jS extends Zl{constructor(e,n,r,i){super(e,n,r,i,"master")}alignOverlaysWithTrimmingContainer(){const e=va(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const r=e.parentElement,i=Wl(e,"height",n),o=Wl(e,"overflow",n),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(o)){const g=e.cloneNode(!1);g.style.overflow="auto",g.style.position="absolute",e.nextElementSibling?r.insertBefore(g,e.nextElementSibling):r.appendChild(g);const p=parseInt(No(g,n).height,10);r.removeChild(g),p===0&&(c=0)}c=Math.min(c,l),s.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=_s(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,r="master",o=e.getSetting("columnHeaders").length;if(o&&!n.hasOversizedColumnHeadersMarked[r]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);n.hasOversizedColumnHeadersMarked[r]=!0}}}_t(jS,QP);_t(jS,kS);const N3=jS;class L3{constructor(e,n,r,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;return n===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=Bt(n)>0&&n.clientHeight>0?n.clientHeight:1/0,r}getWorkspaceWidth(){const{wtSettings:e}=this,{rootDocument:n,rootWindow:r}=this.domBindings,i=this.dataAccessObject.inlineStartOverlayTrimmingContainer,o=n.documentElement.offsetWidth,s=e.getSetting("totalColumns"),a=e.getSetting("preventOverflow"),l=e.getSetting("rtlMode"),u=this.wtTable.TABLE.getBoundingClientRect(),c=l?u.right-o:u.left,d=o-c;let g,p;if(a)return yt(this.wtTable.wtRootElement);if(e.getSetting("freezeOverlays")?g=Math.min(d,o):g=Math.min(this.getContainerFillWidth(),d,o),i===r&&s>0&&this.sumColumnWidths(0,s-1)>g)return n.documentElement.clientWidth;if(i!==r&&(p=Wl(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",r),p==="scroll"||p==="hidden"||p==="auto"))return Math.max(g,i.clientWidth);const C=e.getSetting("stretchH");return C==="none"||!C?Math.max(g,yt(this.wtTable.TABLE)):g}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(e,n){let r=0,i=e;for(;i<n;)r+=this.wtTable.getColumnWidth(i),i+=1;return r}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const e=this.wtTable.holder,n=this.domBindings.rootDocument.createElement("div");n.style.width="100%",n.style.height="1px",e.appendChild(n);const r=n.offsetWidth;return this.containerWidth=r,e.removeChild(n),r}getWorkspaceOffset(){return ln(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Bt(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,i=n.length;r<i;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=n.length;i<o;i++)r?(this.rowHeaderWidth+=yt(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ha;const{wtSettings:n,wtTable:r}=this;let i,o,s;this.rowHeaderWidth=NaN,n.getSetting("renderAllRows")&&e===ha?i=1/0:i=this.getViewportHeight();let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=n.getSetting("fixedRowsTop"),u=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=s),r.holder.clientHeight===r.holder.offsetHeight?o=0:o=Cn(this.domBindings.rootDocument),new FP({viewportHeight:i,scrollOffset:a,totalRows:n.getSetting("totalRows"),rowHeightFn:d=>r.getRowHeight(d),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),calculationType:e,horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ha;const{wtSettings:n,wtTable:r}=this;let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=n.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return r.holder.clientWidth!==r.holder.offsetWidth&&(i-=Cn(this.domBindings.rootDocument)),new IS({viewportWidth:i,scrollOffset:o,totalColumns:n.getSetting("totalColumns"),columnWidthFn:a=>r.getColumnWidth(a),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),calculationType:e,stretchMode:n.getSetting("stretchH"),stretchingColumnWidthFn:(a,l)=>n.getSetting("onBeforeStretchingColumnWidth",a,l),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createRenderCalculators(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(n){const r=this.createRowsCalculator($n),i=this.createColumnsCalculator($n);this.areAllProposedVisibleRowsAlreadyRendered(r)&&this.areAllProposedVisibleColumnsAlreadyRendered(i)||(n=!1)}return n||(this.rowsRenderCalculator=this.createRowsCalculator(ha),this.columnsRenderCalculator=this.createColumnsCalculator(ha)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,n}createVisibleCalculators(){this.rowsVisibleCalculator=this.createRowsCalculator($n),this.columnsVisibleCalculator=this.createColumnsCalculator($n)}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;const{startRow:n,endRow:r,isVisibleInTrimmingContainer:i}=e;if(n===null&&r===null)return!i;const{startRow:o,endRow:s}=this.rowsRenderCalculator;return n<o||n===o&&n>0?!1:!(r>s||r===s&&r<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;const{startColumn:n,endColumn:r,isVisibleInTrimmingContainer:i}=e;if(n===null&&r===null)return!i;const{startColumn:o,endColumn:s}=this.columnsRenderCalculator;return n<o||n===o&&n>0?!1:!(r>s||r===s&&r<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){Ze(this.hasOversizedColumnHeadersMarked,(e,n,r)=>{r[n]=void 0})}}const $3=L3;class k3 extends $S{constructor(e,n){super(e,new D3(n));const r=this.wtSettings.getSetting("facade",this);this.wtTable=new N3(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new $3(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new m3(this.wtSettings.getSetting("selections")),this.wtEvent=new YP(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new P3(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],r=[];Ze(e,(i,o)=>{this.wtSettings.getSetting(o).length&&r.push(i),n.push(i)}),Ye(this.wtTable.wtRootElement.parentNode,n),ce(this.wtTable.wtRootElement.parentNode,r)}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class KS{constructor(e){e instanceof $S?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const r=new KS(n);return()=>r},this._wot=new k3(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,r){return this._wot.createCellRange(e,n,r)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,r,i,o){return this._wot.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return this._wot.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return this._wot.scrollViewportVertically(e,n,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,r,i,o){return this._wot.wtSettings.getSetting(e,n,r,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function iE(t){let{isShiftKey:e,isLeftClick:n,isRightClick:r,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const d=!o.inInSelection(i),g=n||r&&d;i.row<0&&i.col>=0&&!s.column?g&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?g&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?g&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}}function F3(t){let{isLeftClick:e,coords:n,selection:r,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),u=r.tableProps.countRows();a&&!i.column?r.setRangeEnd(o(u-1,n.col)):s&&!i.row?r.setRangeEnd(o(n.row,l-1)):i.cell||r.setRangeEnd(n)}const W3=new Map([["mousedown",iE],["mouseover",F3],["touchstart",iE]]);function oE(t,e){let{coords:n,selection:r,controller:i,cellCoordsFactory:o}=e;W3.get(t.type)({coords:n,selection:r,controller:i,cellCoordsFactory:o,isShiftKey:t.shiftKey,isLeftClick:Wg(t)||t.type==="touchstart",isRightClick:Ms(t)})}const lx=new WeakMap,qS=Symbol("rootInstance");function V3(t){lx.set(t,!0)}function B3(t){return t===qS}function Jd(t){return lx.has(t)}function sE(t,e){ux(t,e),e.add(t)}function $s(t,e,n){ux(t,e),e.set(t,n)}function ux(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ko(t,e,n){return e=U3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function U3(t){var e=Y3(t,"string");return typeof e=="symbol"?e:String(e)}function Y3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function VC(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function bn(t,e){var n=cx(t,e,"get");return G3(t,n)}function G3(t,e){return e.get?e.get.call(t):e.value}function xr(t,e,n){var r=cx(t,e,"set");return z3(t,r,n),n}function cx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function z3(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var cp=new WeakMap,$h=new WeakMap,kh=new WeakMap,oo=new WeakMap,ei=new WeakMap,hp=new WeakMap,dp=new WeakMap,BC=new WeakSet,aE=new WeakSet;class j3{constructor(e){sE(this,aE),sE(this,BC),Ko(this,"hot",void 0),Ko(this,"eventManager",void 0),Ko(this,"settings",void 0),Ko(this,"THEAD",void 0),Ko(this,"TBODY",void 0),Ko(this,"_wt",void 0),Ko(this,"activeWt",void 0),$s(this,cp,{writable:!0,value:0}),$s(this,$h,{writable:!0,value:0}),Ko(this,"postponedAdjustElementsSize",!1),$s(this,kh,{writable:!0,value:!1}),$s(this,oo,{writable:!0,value:void 0}),$s(this,ei,{writable:!0,value:void 0}),$s(this,hp,{writable:!0,value:0}),$s(this,dp,{writable:!0,value:0}),this.hot=e,this.eventManager=new Mr(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(e)}getCellAtCoords(e,n){const r=this._wt.getCell(e,n);return r<0?null:r}scrollViewport(e,n,r,i,o){return this._wt.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return this._wt.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return this._wt.scrollViewportVertically(e,n,r)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),ce(e,"handsontable"),xr(this,ei,n.createElement("TABLE")),ce(bn(this,ei),"htCore"),this.hot.getSettings().tableClassName&&ce(bn(this,ei),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Ne(bn(this,ei),[Gi()]),Ne(e,[HY(),GI(-1),Hg(this.hot.countCols()),zY()])),this.THEAD=n.createElement("THEAD"),bn(this,ei).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),bn(this,ei).appendChild(this.TBODY),this.hot.table=bn(this,ei),this.hot.container.insertBefore(bn(this,ei),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:n,selection:r}=this.hot,i=n.documentElement;this.eventManager.addEventListener(e,"mousedown",o=>{if(xr(this,kh,!0),!this.isTextSelectionAllowed(o.target)){const{rootWindow:s}=this.hot;AC(s),o.preventDefault(),s.focus()}}),this.eventManager.addEventListener(e,"mouseup",()=>{xr(this,kh,!1)}),this.eventManager.addEventListener(e,"mousemove",o=>{bn(this,kh)&&!this.isTextSelectionAllowed(o.target)&&(this.settings.fragmentSelection&&AC(this.hot.rootWindow),o.preventDefault())}),this.eventManager.addEventListener(i,"keyup",o=>{r.isInProgress()&&!o.shiftKey&&r.finish()}),this.eventManager.addEventListener(i,"mouseup",o=>{r.isInProgress()&&Wg(o)&&r.finish(),xr(this,oo,!1);const s=Lg(n.activeElement);s&&(s||!r.isSelected()&&!r.isSelectedByAnyHeader()&&!e.contains(o.target)&&!Ms(o))&&this.hot.unlisten()}),this.eventManager.addEventListener(i,"contextmenu",o=>{r.isInProgress()&&Ms(o)&&(r.finish(),xr(this,oo,!1))}),this.eventManager.addEventListener(i,"touchend",()=>{r.isInProgress()&&r.finish(),xr(this,oo,!1)}),this.eventManager.addEventListener(i,"mousedown",o=>{const s=o.target,a=o.x||o.clientX,l=o.y||o.clientY;let u=o.target;if(bn(this,oo)||!e||!this.hot.view)return;const{holder:c}=this.hot.view._wt.wtTable;if(u===c){const g=Cn(n);if(n.elementFromPoint(a+g,l)!==c||n.elementFromPoint(a,l+g)!==c)return}else for(;u!==i;){if(u===null){if(o.isTargetWebComponent)break;return}if(u===e)return;u=u.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(s):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)}),this.eventManager.addEventListener(bn(this,ei),"selectstart",o=>{this.settings.fragmentSelection||If(o.target)||o.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,r))}translateFromRenderableToVisualIndex(e,n){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return r===null&&(r=e),i===null&&(i=n),[r,i]}countRenderableIndexes(e,n){const r=Math.min(e.getNotTrimmedIndexesLength(),n),i=e.getNearestNotHiddenIndex(r-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,r,i){if(isNaN(e)||e<0)return 0;const o=r.getNearestNotHiddenIndex(e,n),s=r.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return n<0?a=s+1:n>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}countRenderableRowsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:bn(this,ei),isDataViewInstance:()=>Jd(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),xr(this,$h,o.length),this.hot.getSettings().ariaTags&&VC(this,BC,hx).call(this)===this.hot.countCols()&&VC(this,aE,K3).call(this,bn(this,$h)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),xr(this,cp,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u);let d=l,g=u;Array.isArray(c)&&([d,g]=c);const p=this.hot.getCellMeta(d,g),C=this.hot.colToProp(g);let E=this.hot.getDataAtRowProp(d,C);this.hot.hasHook("beforeValueRender")&&(E=this.hot.runHooks("beforeValueRender",E,p)),this.hot.runHooks("beforeRenderer",a,l,u,C,E,p),this.hot.getCellRenderer(p)(this.hot,a,l,u,C,E,p),this.hot.runHooks("afterRenderer",a,l,u,C,E,p)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&_s(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,xr(this,oo,!0),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!us(o)&&(oE(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(d,g)=>this.hot._createCellCoords(d,g)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,xr(this,oo,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!us(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!us(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!us(o)&&(bn(this,oo)&&oE(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(d,g)=>this.hot._createCellCoords(d,g)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt)},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(us(o)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:o=>{const s=this.hot.rowIndexMapper,a=o<0;let l=o;return!a&&(l=s.getVisualFromRenderableIndex(o),l===null)?o:(l=this.hot.runHooks("beforeViewportScrollVertically",l),this.hot.runHooks("beforeViewportScroll"),a?l:s.getRenderableFromVisualIndex(l))},onBeforeViewportScrollHorizontally:o=>{const s=this.hot.columnIndexMapper,a=o<0;let l=o;return!a&&(l=s.getVisualFromRenderableIndex(o),l===null)?o:(l=this.hot.runHooks("beforeViewportScrollHorizontally",l),this.hot.runHooks("beforeViewportScroll"),a?l:s.getRenderableFromVisualIndex(l))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const d=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?d:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(d,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const d=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?d:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(d,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),d=this.hot.selection.getSelectedRange();if(d.size()>0){const p=d.peekByIndex(a??0);l=[p.from.row,p.from.col,p.to.row,p.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,d=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",d,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(o,s)=>{const a=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s);return this.hot.runHooks("beforeStretchingColumnWidth",o,a)},onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=this.hot.columnIndexMapper,c=s>=0?u.getVisualFromRenderableIndex(s):s,d=o>=0?l.getVisualFromRenderableIndex(o):o,g=this.hot.runHooks("modifyGetCellCoords",d,c,a);if(Array.isArray(g)){const[p,C,E,I]=g;return[p>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(p,1)):p,C>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(C,1)):C,E>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(E,-1)):E,I>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(I,-1)):I]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.ceil(u/a*12);o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.ceil(u/a*6);o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new KS(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:r,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,i),this.eventManager.addEventListener(n,"mousedown",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(If(e))return!0;const n=vs(e,this.hot.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return bn(this,oo)}isSelectedOnlyCell(){var e,n;return(e=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const r=n.firstChild;if(!Ve(r,"relative")){vi(n),this.appendRowHeader(e,n);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:r,getRowHeader:i}=this.hot,o=r.createElement("div"),s=r.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),n.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(n.firstChild){const o=n.firstChild;Ve(o,"relative")?this.updateCellHeader(o.querySelector(".colHeader"),e,r,i):(vi(n),this.appendColHeader(e,n,r,i))}else{const{rootDocument:o}=this.hot,s=o.createElement("div"),a=o.createElement("span");s.className="relative",a.className="colHeader",this.settings.ariaTags&&(Ne(s,...Gi()),Ne(a,...Gi())),this.updateCellHeader(a,e,r,i),s.appendChild(a),n.appendChild(s)}this.hot.runHooks("afterGetColHeader",e,n,i)}updateCellHeader(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(Ve(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(n):Ve(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(n))),o>-1?Pa(e,r(n,i)):(Ts(e,String.fromCharCode(160)),ce(e,"cornerHeader"))}maximumVisibleElementWidth(e){const r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){const r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,n){xr(this,hp,e),xr(this,dp,n)}getLastSize(){return{width:bn(this,hp),height:bn(this,dp)}}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleColumn())}getColumnHeadersCount(){return bn(this,cp)}getRowHeadersCount(){return bn(this,$h)}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function hx(){return parseInt(this.hot.rootElement.getAttribute(Hg()[0]),10)}function K3(t){const e=VC(this,BC,hx).call(this)+t;Ne(this.hot.rootElement,...Hg(e))}const q3=j3,dx="ABCDEFGHIJKLMNOPQRSTUVWXYZ",UC=dx.length;function Yg(t){let e=t+1,n="",r;for(;e>0;)r=(e-1)%UC,n=String.fromCharCode(65+r)+n,e=parseInt((e-r)/UC,10);return n}function X3(t){let e=0;if(t)for(let n=0,r=t.length-1;n<t.length;n+=1,r-=1)e+=UC**r*(dx.indexOf(t[n])+1);return e-=1,e}function Z3(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o=[];for(i=0;i<e;i++)o.push(Yg(i)+(r+1));n.push(o)}return n}function Q3(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o={};for(i=0;i<e;i++)o[`prop${i}`]=Yg(i)+(r+1);n.push(o)}return n}function J3(t,e){const n=[];let r;for(let i=0;i<t;i++){r=[];for(let o=0;o<e;o++)r.push("");n.push(r)}return n}function XS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const r=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((i,o)=>{Array.isArray(i)?i.forEach((s,a)=>{r.push([o+e,a,s])}):Object.keys(i).forEach(s=>{r.push([o+e,s,i[s]])})}),r}function ZS(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&qe(t[0])&&(e=Fg(t[0]))),e}function fx(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function gx(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const eq=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:ZS,createEmptySpreadsheetData:J3,createSpreadsheetData:Z3,createSpreadsheetObjectData:Q3,dataRowToChangesArray:XS,isArrayOfArrays:fx,isArrayOfObjects:gx,spreadsheetColumnIndex:X3,spreadsheetColumnLabel:Yg},Symbol.toStringTag,{value:"Module"}));function Cu(t,e,n){return e=tq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tq(t){var e=nq(t,"string");return typeof e=="symbol"?e:String(e)}function nq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rq{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Cu(this,"hot",void 0),Cu(this,"data",void 0),Cu(this,"dataType","array"),Cu(this,"colToProp",()=>{}),Cu(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return H(this.data,(r,i)=>{const o=this.getAtCell(i,e);n.push(o)}),n}getAtRow(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=n===void 0&&r===void 0;let s=null,a=null;if(s=this.modifyRowData(e),Array.isArray(s))a=[],o?s.forEach((l,u)=>{a[u]=this.getAtPhysicalCell(e,u,s)}):xe(n,r,l=>{a[l-n]=this.getAtPhysicalCell(e,l,s)});else if(qe(s)||At(s))if(i?a=[]:a={},!o||i){const u=this.countFirstRowKeys()-1;xe(0,u,c=>{const d=this.colToProp(c);if(c>=(n||0)&&c<=(r||u)&&!Number.isInteger(d)){const g=this.getAtPhysicalCell(e,d,s);i?a.push(g):qd(a,d,g)}})}else Ze(s,(l,u)=>{qd(a,u,this.getAtPhysicalCell(e,u,s))});return a}setAtCell(e,n,r){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=gi(r);this.hot.runHooks("modifySourceData",e,n,i,"set"),i.isTouched()&&(r=i.value)}Number.isInteger(n)?this.data[e][n]=r:qd(this.data[e],n,r)}}getAtPhysicalCell(e,n,r){let i=null;if(r&&(typeof n=="string"?i=hP(r,n):typeof n=="function"?i=n(r):i=r[n]),this.hot.hasHook("modifySourceData")){const o=gi(i);this.hot.runHooks("modifySourceData",e,n,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,n){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||n===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,n.row),s=Math.min(e.col,n.col),a=Math.max(e.row,n.row),l=Math.max(e.col,n.col));const u=[];return xe(o,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,r):this.getAtRow(c,s,l,r))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return ZS(this.data)}destroy(){this.data=null,this.hot=null}}const iq=rq;function lE(t,e,n){return e=oq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oq(t){var e=sq(t,"string");return typeof e=="symbol"?e:String(e)}function sq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xa{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;lE(this,"indexedValues",[]),lE(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,At(this.initValueOrFn)?xe(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):xe(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}_t(xa,wr);function QS(t,e,n,r){const i=n.length?n[0]:void 0;return[...t.slice(0,i),...n.map((o,s)=>At(r)?r(o,s):r),...i===void 0?[]:t.slice(i)]}function JS(t,e){return _r(t,(n,r)=>e.includes(r)===!1)}class Ps extends xa{insert(e,n){this.indexedValues=QS(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=JS(this.indexedValues,e),super.remove(e)}}class Gg extends Ps{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return nn(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}function ey(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function Nc(t,e){return _r(t,n=>e.includes(n)===!1)}function ty(t,e){return Xe(t,n=>n-e.filter(r=>r<n).length)}function ny(t,e){const n=e[0],r=e.length;return Xe(t,i=>i>=n?i+r:i)}function aq(t,e,n){return e=lq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lq(t){var e=uq(t,"string");return typeof e=="symbol"?e:String(e)}function uq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zg extends xa{constructor(){super(...arguments),aq(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=Nc(this.orderOfIndexes,[e]),At(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=QS(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=ny(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=JS(this.indexedValues,e),this.orderOfIndexes=Nc(this.orderOfIndexes,e),this.orderOfIndexes=ty(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class oh extends Ps{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return nn(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}const uE=new Map([["indexesSequence",{getListWithInsertedItems:ey,getListWithRemovedItems:Nc}],["physicallyIndexed",{getListWithInsertedItems:QS,getListWithRemovedItems:JS}]]),mx=t=>{if(uE.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return uE.get(t)};class px extends xa{constructor(){super(e=>e)}insert(e,n){const r=ny(this.indexedValues,n);this.indexedValues=ey(r,e,n),super.insert(e,n)}remove(e){const n=Nc(this.indexedValues,e);this.indexedValues=ty(n,e),super.remove(e)}}const cE=new Map([["hiding",Gg],["index",xa],["linkedPhysicalIndexToValue",zg],["physicalIndexToValue",Ps],["trimming",oh]]);function cq(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!cE.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(cE.get(t))(e)}function hq(t,e,n){return e=dq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dq(t){var e=fq(t,"string");return typeof e=="symbol"?e:String(e)}function fq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let YC=0;class ry{constructor(){hq(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)),YC+=1)}unregister(e){const n=this.collection.get(e);Re(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n),YC-=1)}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return It(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(r=>{r.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}_t(ry,wr);function gq(){return YC}function fp(t,e,n){return e=mq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mq(t){var e=pq(t,"string");return typeof e=="symbol"?e:String(e)}function pq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hE extends ry{constructor(e,n){super(),fp(this,"mergedValuesCache",[]),fp(this,"aggregationFunction",void 0),fp(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=Xe(this.get(),o=>o.getValues()),r=[],i=Re(n[0])&&n[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(n[a][o]);r.push(s)}return Xe(r,this.aggregationFunction)}getMergedValueAtIndex(e,n){const r=this.getMergedValues(n)[e];return Re(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function wq(t,e,n){Cq(t,e),e.set(t,n)}function Cq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vq(t,e,n){var r=wx(t,e,"set");return Sq(t,r,n),n}function Sq(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function yq(t,e){var n=wx(t,e,"get");return bq(t,n)}function wx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function bq(t,e){return e.get?e.get.call(t):e.value}var gp=new WeakMap;class Cx{constructor(){wq(this,gp,{writable:!0,value:[]})}subscribe(e){return this.addLocalHook("change",e),this._write(yq(this,gp)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){vq(this,gp,e)}}_t(Cx,wr);function dE(t,e){const n=[];let r=0,i=0;for(;r<t.length&&i<e.length;r++,i++)t[r]!==e[i]&&n.push({op:"replace",index:i,oldValue:t[r],newValue:e[i]});for(;r<e.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;i<t.length;i++)n.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return n}function vu(t,e,n){Rq(t,e),e.set(t,n)}function Rq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hr(t,e){var n=vx(t,e,"get");return Eq(t,n)}function Eq(t,e){return e.get?e.get.call(t):e.value}function Fh(t,e,n){var r=vx(t,e,"set");return Tq(t,r,n),n}function vx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Tq(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Wh=new WeakMap,Su=new WeakMap,Vh=new WeakMap,Bh=new WeakMap,Uh=new WeakMap;class _q{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};vu(this,Wh,{writable:!0,value:new Set}),vu(this,Su,{writable:!0,value:[]}),vu(this,Vh,{writable:!0,value:[]}),vu(this,Bh,{writable:!0,value:!1}),vu(this,Uh,{writable:!0,value:!1}),Fh(this,Uh,e??!1)}createObserver(){const e=new Cx;return Hr(this,Wh).add(e),e.addLocalHook("unsubscribe",()=>{Hr(this,Wh).delete(e)}),e._writeInitialChanges(dE(Hr(this,Su),Hr(this,Vh))),e}emit(e){let n=Hr(this,Vh);(!Hr(this,Bh)||Hr(this,Su).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(Hr(this,Uh)):Fh(this,Su,new Array(e.length).fill(Hr(this,Uh))),Hr(this,Bh)||(Fh(this,Bh,!0),n=Hr(this,Su)));const r=dE(n,e);Hr(this,Wh).forEach(i=>i._write(r)),Fh(this,Vh,e)}}function zn(t,e,n){return e=Mq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mq(t){var e=Oq(t,"string");return typeof e=="symbol"?e:String(e)}function Oq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class GC{constructor(){zn(this,"indexesSequence",new px),zn(this,"trimmingMapsCollection",new hE(e=>e.some(n=>n===!0),!1)),zn(this,"hidingMapsCollection",new hE(e=>e.some(n=>n===!0),!1)),zn(this,"variousMapsCollection",new ry),zn(this,"hidingChangesObservable",new _q({initialIndexValue:!1})),zn(this,"notTrimmedIndexesCache",[]),zn(this,"notHiddenIndexesCache",[]),zn(this,"isBatched",!1),zn(this,"indexesSequenceChanged",!1),zn(this,"indexesChangeSource",void 0),zn(this,"trimmedIndexesChanged",!1),zn(this,"hiddenIndexesChanged",!1),zn(this,"renderablePhysicalIndexesCache",[]),zn(this,"fromPhysicalToVisualIndexesCache",new Map),zn(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,r){return this.registerMap(e,cq(n,r))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof oh?this.trimmingMapsCollection.register(e,n):n instanceof Gg?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const r=this.getNumberOfIndexes();return r>0&&n.init(r),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return Re(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return Re(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return Re(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return Re(n)?n:null}getNearestNotHiddenIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return n>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?r?this.getNearestNotHiddenIndex(e,-n,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const r=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(r)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const r=Xe(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=Nc(this.getIndexesSequence(),r),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(n+o<i){const u=a[n];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(ey(s,l,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){const r=this.getNotTrimmedIndexes()[e],i=Re(r)?r:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),s=Xe(new Array(n).fill(i),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(r,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(i,n)}}}_t(GC,wr);function Aq(t,e){return Ze(e,(n,r)=>{It(t[r])&&(t[r]=n)}),t}function Sx(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function yx(t){Re(t)&&RS(bt`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function Iq(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:Pq,getValues:xq}=yi("phraseFormatters");function Hq(t,e){Pq(t,e)}function Dq(){return xq()}Hq("pluralize",Iq);const bx="ContextMenu:items",je=bx,iy=`${je}.noItems`,oy=`${je}.insertRowAbove`,sy=`${je}.insertRowBelow`,ay=`${je}.insertColumnOnTheLeft`,ly=`${je}.insertColumnOnTheRight`,uy=`${je}.removeRow`,cy=`${je}.removeColumn`,hy=`${je}.undo`,dy=`${je}.redo`,fy=`${je}.readOnly`,gy=`${je}.clearColumn`,my=`${je}.copy`,py=`${je}.copyWithHeaders`,wy=`${je}.copyWithGroupHeaders`,Cy=`${je}.copyHeadersOnly`,vy=`${je}.cut`,Sy=`${je}.freezeColumn`,yy=`${je}.unfreezeColumn`,by=`${je}.mergeCells`,Ry=`${je}.unmergeCells`,Ey=`${je}.addComment`,Ty=`${je}.editComment`,_y=`${je}.removeComment`,My=`${je}.readOnlyComment`,Oy=`${je}.align`,Ay=`${je}.align.left`,Iy=`${je}.align.center`,Py=`${je}.align.right`,xy=`${je}.align.justify`,Hy=`${je}.align.top`,Dy=`${je}.align.middle`,Ny=`${je}.align.bottom`,Ly=`${je}.borders`,$y=`${je}.borders.top`,ky=`${je}.borders.right`,Fy=`${je}.borders.bottom`,Wy=`${je}.borders.left`,Vy=`${je}.borders.remove`,By=`${je}.nestedHeaders.insertChildRow`,Uy=`${je}.nestedHeaders.detachFromParent`,Yy=`${je}.hideColumn`,Gy=`${je}.showColumn`,zy=`${je}.hideRow`,jy=`${je}.showRow`,ir="Filters:",Qt=`${ir}conditions`,jg=`${Qt}.none`,Ky=`${Qt}.isEmpty`,qy=`${Qt}.isNotEmpty`,Xy=`${Qt}.isEqualTo`,Zy=`${Qt}.isNotEqualTo`,Qy=`${Qt}.beginsWith`,Jy=`${Qt}.endsWith`,eb=`${Qt}.contains`,tb=`${Qt}.doesNotContain`,Nq=`${Qt}.byValue`,nb=`${Qt}.greaterThan`,rb=`${Qt}.greaterThanOrEqualTo`,ib=`${Qt}.lessThan`,ob=`${Qt}.lessThanOrEqualTo`,sb=`${Qt}.isBetween`,ab=`${Qt}.isNotBetween`,lb=`${Qt}.after`,ub=`${Qt}.before`,cb=`${Qt}.today`,hb=`${Qt}.tomorrow`,db=`${Qt}.yesterday`,fb=`${ir}labels.filterByCondition`,gb=`${ir}labels.filterByValue`,mb=`${ir}labels.conjunction`,Kg=`${ir}labels.disjunction`,Wf=`${ir}values.blankCells`,pb=`${ir}buttons.selectAll`,wb=`${ir}buttons.clear`,Cb=`${ir}buttons.ok`,vb=`${ir}buttons.cancel`,Sb=`${ir}buttons.placeholder.search`,yb=`${ir}buttons.placeholder.value`,bb=`${ir}buttons.placeholder.secondValue`,Rb="CheckboxRenderer:",Eb=`${Rb}checked`,Tb=`${Rb}unchecked`,Lq=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:Eb,CHECKBOX_RENDERER_NAMESPACE:Rb,CHECKBOX_UNCHECKED:Tb,CONTEXTMENU_ITEMS_ADD_COMMENT:Ey,CONTEXTMENU_ITEMS_ALIGNMENT:Oy,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:Ny,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:Iy,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:xy,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:Ay,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:Dy,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:Py,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:Hy,CONTEXTMENU_ITEMS_BORDERS:Ly,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:Fy,CONTEXTMENU_ITEMS_BORDERS_LEFT:Wy,CONTEXTMENU_ITEMS_BORDERS_RIGHT:ky,CONTEXTMENU_ITEMS_BORDERS_TOP:$y,CONTEXTMENU_ITEMS_CLEAR_COLUMN:gy,CONTEXTMENU_ITEMS_COPY:my,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:Cy,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:wy,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:py,CONTEXTMENU_ITEMS_CUT:vy,CONTEXTMENU_ITEMS_EDIT_COMMENT:Ty,CONTEXTMENU_ITEMS_FREEZE_COLUMN:Sy,CONTEXTMENU_ITEMS_HIDE_COLUMN:Yy,CONTEXTMENU_ITEMS_HIDE_ROW:zy,CONTEXTMENU_ITEMS_INSERT_LEFT:ay,CONTEXTMENU_ITEMS_INSERT_RIGHT:ly,CONTEXTMENU_ITEMS_MERGE_CELLS:by,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:Uy,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:By,CONTEXTMENU_ITEMS_NO_ITEMS:iy,CONTEXTMENU_ITEMS_READ_ONLY:fy,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:My,CONTEXTMENU_ITEMS_REDO:dy,CONTEXTMENU_ITEMS_REMOVE_BORDERS:Vy,CONTEXTMENU_ITEMS_REMOVE_COLUMN:cy,CONTEXTMENU_ITEMS_REMOVE_COMMENT:_y,CONTEXTMENU_ITEMS_REMOVE_ROW:uy,CONTEXTMENU_ITEMS_ROW_ABOVE:oy,CONTEXTMENU_ITEMS_ROW_BELOW:sy,CONTEXTMENU_ITEMS_SHOW_COLUMN:Gy,CONTEXTMENU_ITEMS_SHOW_ROW:jy,CONTEXTMENU_ITEMS_UNDO:hy,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:yy,CONTEXTMENU_ITEMS_UNMERGE_CELLS:Ry,CONTEXT_MENU_ITEMS_NAMESPACE:bx,FILTERS_BUTTONS_CANCEL:vb,FILTERS_BUTTONS_CLEAR:wb,FILTERS_BUTTONS_OK:Cb,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:Sb,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:bb,FILTERS_BUTTONS_PLACEHOLDER_VALUE:yb,FILTERS_BUTTONS_SELECT_ALL:pb,FILTERS_CONDITIONS_AFTER:lb,FILTERS_CONDITIONS_BEFORE:ub,FILTERS_CONDITIONS_BEGINS_WITH:Qy,FILTERS_CONDITIONS_BETWEEN:sb,FILTERS_CONDITIONS_BY_VALUE:Nq,FILTERS_CONDITIONS_CONTAINS:eb,FILTERS_CONDITIONS_EMPTY:Ky,FILTERS_CONDITIONS_ENDS_WITH:Jy,FILTERS_CONDITIONS_EQUAL:Xy,FILTERS_CONDITIONS_GREATER_THAN:nb,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:rb,FILTERS_CONDITIONS_LESS_THAN:ib,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:ob,FILTERS_CONDITIONS_NAMESPACE:Qt,FILTERS_CONDITIONS_NONE:jg,FILTERS_CONDITIONS_NOT_BETWEEN:ab,FILTERS_CONDITIONS_NOT_CONTAIN:tb,FILTERS_CONDITIONS_NOT_EMPTY:qy,FILTERS_CONDITIONS_NOT_EQUAL:Zy,FILTERS_CONDITIONS_TODAY:cb,FILTERS_CONDITIONS_TOMORROW:hb,FILTERS_CONDITIONS_YESTERDAY:db,FILTERS_DIVS_FILTER_BY_CONDITION:fb,FILTERS_DIVS_FILTER_BY_VALUE:gb,FILTERS_LABELS_CONJUNCTION:mb,FILTERS_LABELS_DISJUNCTION:Kg,FILTERS_NAMESPACE:ir,FILTERS_VALUES_BLANK_CELLS:Wf},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const $q={languageCode:"en-US",[iy]:"No available options",[oy]:"Insert row above",[sy]:"Insert row below",[ay]:"Insert column left",[ly]:"Insert column right",[uy]:["Remove row","Remove rows"],[cy]:["Remove column","Remove columns"],[hy]:"Undo",[dy]:"Redo",[fy]:"Read only",[gy]:"Clear column",[Oy]:"Alignment",[Ay]:"Left",[Iy]:"Center",[Py]:"Right",[xy]:"Justify",[Hy]:"Top",[Dy]:"Middle",[Ny]:"Bottom",[Sy]:"Freeze column",[yy]:"Unfreeze column",[Ly]:"Borders",[$y]:"Top",[ky]:"Right",[Fy]:"Bottom",[Wy]:"Left",[Vy]:"Remove border(s)",[Ey]:"Add comment",[Ty]:"Edit comment",[_y]:"Delete comment",[My]:"Read-only comment",[by]:"Merge cells",[Ry]:"Unmerge cells",[my]:"Copy",[py]:["Copy with header","Copy with headers"],[wy]:["Copy with group header","Copy with group headers"],[Cy]:["Copy header only","Copy headers only"],[vy]:"Cut",[By]:"Insert child row",[Uy]:"Detach from parent",[Yy]:["Hide column","Hide columns"],[Gy]:["Show column","Show columns"],[zy]:["Hide row","Hide rows"],[jy]:["Show row","Show rows"],[jg]:"None",[Ky]:"Is empty",[qy]:"Is not empty",[Xy]:"Is equal to",[Zy]:"Is not equal to",[Qy]:"Begins with",[Jy]:"Ends with",[eb]:"Contains",[tb]:"Does not contain",[nb]:"Greater than",[rb]:"Greater than or equal to",[ib]:"Less than",[ob]:"Less than or equal to",[sb]:"Is between",[ab]:"Is not between",[lb]:"After",[ub]:"Before",[cb]:"Today",[hb]:"Tomorrow",[db]:"Yesterday",[Wf]:"Blank cells",[fb]:"Filter by condition",[gb]:"Filter by value",[mb]:"And",[Kg]:"Or",[pb]:"Select all",[wb]:"Clear",[Cb]:"OK",[vb]:"Cancel",[Sb]:"Search",[yb]:"Value",[bb]:"Second value",[Eb]:"Checked",[Tb]:"Unchecked"},Rx=$q,kq=Lq,zC=Rx.languageCode,{register:Fq,getItem:Ex,hasItem:Wq,getValues:Vq}=yi("languagesDictionaries");Tx(Rx);function Tx(t,e){let n=t,r=e;return qe(t)&&(r=t,n=r.languageCode),Bq(n,r),Fq(n,Vn(r)),Vn(r)}function Bq(t,e){t!==zC&&Aq(e,Ex(zC))}function _x(t){return _b(t)?Vn(Ex(t)):null}function _b(t){return Wq(t)}function Uq(){return Vq()}function Mx(t,e,n){const r=_x(t);if(r===null)return null;const i=r[e];if(It(i))return null;const o=Yq(i,n);return Array.isArray(o)?o[0]:o}function Yq(t,e){let n=t;return H(Dq(),r=>{n=r(t,e)}),n}function Gq(t){let e=Sx(t);return _b(e)||(e=zC,yx(t)),e}function zq(t,e,n){return e=jq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jq(t){var e=Kq(t,"string");return typeof e=="symbol"?e:String(e)}function Kq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qq extends e3{constructor(e,n){super(e,null),zq(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:r}=e,i=this.getNearestNotHiddenCoords(n,1),o=this.getNearestNotHiddenCoords(r,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=n,o=r),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,n,r){return n<0?n:e.getNearestNotHiddenIndex(n,r)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),r=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(n,r,i)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const r=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(n);return r.row===null||r.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(r,r,i)}}const Yo=qq;function mp(t){let{activeHeaderClassName:e,...n}=t;return new Yo({className:e,...n,selectionType:tx})}function Xq(t){let{areaCornerVisible:e,...n}=t;return new Yo({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:BS})}function Zq(t){let{...e}=t;return new Yo({className:"highlight",...e,selectionType:BS})}function Qq(t){let{columnClassName:e,...n}=t;return new Yo({className:e,...n,selectionType:r3})}function Jq(t){let{cellCornerVisible:e,...n}=t;return new Yo({className:"current",headerAttributes:[cS()],border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:US})}function eX(t){let{border:e,visualCellRange:n,...r}=t;return new Yo({...e,...r,selectionType:i3},n)}function tX(t){let{...e}=t;return new Yo({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:t3})}function fE(t){let{headerClassName:e,...n}=t;return new Yo({className:e,...n,selectionType:VS})}function nX(t){let{rowClassName:e,...n}=t;return new Yo({className:e,...n,selectionType:n3})}let Ox;function rX(t,e){iX(t,e),e.add(t)}function iX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function or(t,e,n){return e=oX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oX(t){var e=sX(t,"string");return typeof e=="symbol"?e:String(e)}function sX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function so(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var Oi=new WeakSet;Ox=Symbol.iterator;class aX{constructor(e){rX(this,Oi),or(this,"options",void 0),or(this,"layerLevel",0),or(this,"focus",void 0),or(this,"fill",void 0),or(this,"layeredAreas",new Map),or(this,"areas",new Map),or(this,"rowHeaders",new Map),or(this,"columnHeaders",new Map),or(this,"activeRowHeaders",new Map),or(this,"activeColumnHeaders",new Map),or(this,"activeCornerHeaders",new Map),or(this,"rowHighlights",new Map),or(this,"columnHighlights",new Map),or(this,"customSelections",[]),this.options=e,this.focus=Jq(e),this.fill=tX(e)}isEnabledFor(e,n){let r=e;e===US&&(r="current");let i=this.options.disabledCellSelection(n.row,n.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return so(this,Oi,ao).call(this,this.layeredAreas,Xq)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return so(this,Oi,ao).call(this,this.areas,Zq)}getAreas(){return[...this.areas.values()]}createRowHeader(){return so(this,Oi,ao).call(this,this.rowHeaders,fE)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return so(this,Oi,ao).call(this,this.columnHeaders,fE)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return so(this,Oi,ao).call(this,this.activeRowHeaders,mp)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return so(this,Oi,ao).call(this,this.activeColumnHeaders,mp)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return so(this,Oi,ao).call(this,this.activeCornerHeaders,mp)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return so(this,Oi,ao).call(this,this.rowHighlights,nX)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return so(this,Oi,ao).call(this,this.columnHighlights,Qq)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(eX({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),H(this.areas.values(),e=>void e.clear()),H(this.layeredAreas.values(),e=>void e.clear()),H(this.rowHeaders.values(),e=>void e.clear()),H(this.columnHeaders.values(),e=>void e.clear()),H(this.activeRowHeaders.values(),e=>void e.clear()),H(this.activeColumnHeaders.values(),e=>void e.clear()),H(this.activeCornerHeaders.values(),e=>void e.clear()),H(this.rowHighlights.values(),e=>void e.clear()),H(this.columnHighlights.values(),e=>void e.clear())}[Ox](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function ao(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const r=e({layerLevel:n,...this.options});return t.set(n,r),r}const lX=aX;let Ax;function gE(t,e,n){return e=uX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uX(t){var e=cX(t,"string");return typeof e=="symbol"?e:String(e)}function cX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}Ax=Symbol.iterator;class hX{constructor(e){gE(this,"ranges",[]),gE(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(n=>n.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[Ax](){return this.ranges[Symbol.iterator]()}}const dX=hX;function yu(t,e){Ix(t,e),e.add(t)}function pp(t,e,n){Ix(t,e),e.set(t,n)}function Ix(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function at(t,e){var n=Px(t,e,"get");return fX(t,n)}function fX(t,e){return e.get?e.get.call(t):e.value}function lr(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function jC(t,e,n){var r=Px(t,e,"set");return gX(t,r,n),n}function Px(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function gX(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Yh=new WeakMap,pt=new WeakMap,Os=new WeakMap,wp=new WeakSet,Cp=new WeakSet,KC=new WeakSet,vp=new WeakSet,ks=new WeakSet;class xx{constructor(e,n){yu(this,ks),yu(this,vp),yu(this,KC),yu(this,Cp),yu(this,wp),pp(this,Yh,{writable:!0,value:void 0}),pp(this,pt,{writable:!0,value:void 0}),pp(this,Os,{writable:!0,value:{x:0,y:0}}),jC(this,Yh,e),jC(this,pt,n)}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;lr(this,wp,mE).call(this,{x:at(this,pt).navigableHeaders()?at(this,pt).countRowHeaders():0,y:at(this,pt).navigableHeaders()?at(this,pt).countColHeaders():0});const i=at(this,pt).createCellCoords(e,n);let o=at(this,Yh).current().highlight;const s=at(this,pt).visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){const{width:u,height:c}=lr(this,KC,Hx).call(this),{row:d,col:g}=lr(this,vp,wE).call(this,o),p=at(this,pt).fixedRowsBottom(),C=at(this,pt).minSpareRows(),E=at(this,pt).minSpareCols(),I=at(this,pt).autoWrapRow(),M=at(this,pt).autoWrapCol(),y=at(this,pt).createCellCoords(d+i.row,g+i.col);if(y.row>=c){const G=gi(r&&C>0&&p===0),X=y.col+1,re=at(this,pt).createCellCoords(y.row-c,X>=u?X-u:X);this.runLocalHooks("beforeColumnWrap",G,lr(this,ks,Ua).call(this,re),X>=u),G.value?this.runLocalHooks("insertRowRequire",at(this,pt).countRenderableRows()):M&&y.assign(re)}else if(y.row<0){const G=gi(M),X=y.col-1,re=at(this,pt).createCellCoords(c+y.row,X<0?u+X:X);this.runLocalHooks("beforeColumnWrap",G,lr(this,ks,Ua).call(this,re),X<0),M&&y.assign(re)}if(y.col>=u){const G=gi(r&&E>0),X=y.row+1,re=at(this,pt).createCellCoords(X>=c?X-c:X,y.col-u);this.runLocalHooks("beforeRowWrap",G,lr(this,ks,Ua).call(this,re),X>=c),G.value?this.runLocalHooks("insertColRequire",at(this,pt).countRenderableColumns()):I&&y.assign(re)}else if(y.col<0){const G=gi(I),X=y.row-1,re=at(this,pt).createCellCoords(X<0?c+X:X,u+y.col);this.runLocalHooks("beforeRowWrap",G,lr(this,ks,Ua).call(this,re),X<0),I&&y.assign(re)}const{rowDir:$,colDir:q}=lr(this,Cp,pE).call(this,y);a=$,l=q,o=lr(this,ks,Ua).call(this,y)}return this.runLocalHooks("afterTransformStart",o,a,l),o}transformEnd(e,n){lr(this,wp,mE).call(this,{x:at(this,pt).navigableHeaders()?at(this,pt).countRowHeaders():0,y:at(this,pt).navigableHeaders()?at(this,pt).countColHeaders():0});const r=at(this,pt).createCellCoords(e,n),i=at(this,Yh).current(),o=at(this,pt).visualToRenderableCoords(i.highlight),s=i.to.clone();let a=0,l=0;if(this.runLocalHooks("beforeTransformEnd",r),o.row!==null&&o.col!==null){const{row:u,col:c}=lr(this,vp,wE).call(this,i.to),d=at(this,pt).createCellCoords(u+r.row,c+r.col),{rowDir:g,colDir:p}=lr(this,Cp,pE).call(this,d);a=g,l=p;const C=lr(this,ks,Ua).call(this,d);r.row===0&&r.col!==0?s.col=C.col:r.row!==0&&r.col===0?s.row=C.row:(s.row=C.row,s.col=C.col)}return this.runLocalHooks("afterTransformEnd",s,a,l),s}}function mE(t){let{x:e,y:n}=t;jC(this,Os,{x:e,y:n})}function pE(t){const{width:e,height:n}=lr(this,KC,Hx).call(this);let r=0,i=0;return t.row<0?(r=-1,t.row=0):t.row>0&&t.row>=n&&(r=1,t.row=n-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:r,colDir:i}}function Hx(){return{width:at(this,Os).x+at(this,pt).countRenderableColumns(),height:at(this,Os).y+at(this,pt).countRenderableRows()}}function wE(t){const{row:e,col:n}=at(this,pt).visualToRenderableCoords(t);return at(this,pt).createCellCoords(at(this,Os).y+e,at(this,Os).x+n)}function Ua(t){const e=t.clone();return e.col=t.col-at(this,Os).x,e.row=t.row-at(this,Os).y,at(this,pt).renderableToVisualCoords(e)}_t(xx,wr);const mX=xx,qg=0,Xg=1,Dx=2,Mb=3,pX=[Mb,Dx],wX=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],Sp=Symbol("root"),CE=Symbol("child");function Bl(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Sp;if(e!==Sp&&e!==CE)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),r=e===Sp;let i=qg;if(n){const o=t[0];t.length===0?i=Xg:r&&o instanceof HS?i=Mb:r&&Array.isArray(o)?i=Bl(o,CE):t.length>=2&&t.length<=4&&!t.some((a,l)=>!wX[l].includes(typeof a))&&(i=Dx)}return i}function Lc(t){let{createCellCoords:e,createCellRange:n,keepDirection:r=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!pX.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===Mb;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),It(u)&&(u=a),It(c)&&(c=l),!r){const p=a,C=l,E=u,I=c;a=Math.min(p,E),l=Math.min(C,I),u=Math.max(p,E),c=Math.max(C,I)}const d=e(a,l),g=e(u,c);return n(d,d,g)}}function CX(t){const e=Bl(t.getSelected());if(e===qg||e===Xg)return[];const n=Lc(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;H(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.col,0),c=l.col-u+1;H(Array.from(new Array(c),(d,g)=>u+g),d=>{r.has(d)||r.add(d)})});const i=Array.from(r).sort((s,a)=>s-a);return nn(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function vX(t){const e=Bl(t.getSelected());if(e===qg||e===Xg)return[];const n=Lc(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;H(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.row,0),c=l.row-u+1;H(Array.from(new Array(c),(d,g)=>u+g),d=>{r.has(d)||r.add(d)})});const i=Array.from(r).sort((s,a)=>s-a);return nn(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function SX(t,e,n){yX(t,e),e.set(t,n)}function yX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qo(t,e,n){return e=bX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bX(t){var e=RX(t,"string");return typeof e=="symbol"?e:String(e)}function RX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vE(t,e,n){var r=Nx(t,e,"set");return EX(t,r,n),n}function EX(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function SE(t,e){var n=Nx(t,e,"get");return TX(t,n)}function Nx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function TX(t,e){return e.get?e.get.call(t):e.value}var bu=new WeakMap;class Lx{constructor(e,n){var r=this;qo(this,"settings",void 0),qo(this,"tableProps",void 0),qo(this,"inProgress",!1),qo(this,"selectedRange",new dX((i,o,s)=>this.tableProps.createCellRange(i,o,s))),qo(this,"highlight",void 0),qo(this,"transformation",void 0),qo(this,"selectedByRowHeader",new Set),qo(this,"selectedByColumnHeader",new Set),SX(this,bu,{writable:!0,value:!1}),this.settings=e,this.tableProps=n,this.highlight=new lX({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[cS()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),this.transformation=new mX(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),countRowHeaders:()=>this.tableProps.countRowHeaders(),countColHeaders:()=>this.tableProps.countColHeaders(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformStart",...o)}),this.transformation.addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformStart",...o)}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformEnd",...o)}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformEnd",...o)}),this.transformation.addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertRowRequire",...o)}),this.transformation.addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertColRequire",...o)}),this.transformation.addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeRowWrap",...o)}),this.transformation.addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeColumnWrap",...o)})}getSelectedRange(){return this.selectedRange}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}isInProgress(){return this.inProgress}setRangeStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=It(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=e.clone();this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,a),(!o||o&&!s&&It(n))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,r)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const n=e.clone(),r=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((r>0||i>0)&&(r===0&&n.col<0&&!o||i===0&&n.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const s=this.selectedRange.current();this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single"?(s.setFrom(s.highlight),s.setTo(s.highlight)):s.setTo(n),r>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet");const a=this.highlight.getFocus();a.clear(),this.highlight.isEnabledFor(US,s.highlight)&&a.add(this.selectedRange.current().highlight).commit().syncWith(s);const l=this.getLayerLevel();l<this.highlight.layerLevel&&(H(this.highlight.getAreas(),y=>void y.clear()),H(this.highlight.getLayeredAreas(),y=>void y.clear()),H(this.highlight.getRowHeaders(),y=>void y.clear()),H(this.highlight.getColumnHeaders(),y=>void y.clear()),H(this.highlight.getActiveRowHeaders(),y=>void y.clear()),H(this.highlight.getActiveColumnHeaders(),y=>void y.clear()),H(this.highlight.getActiveCornerHeaders(),y=>void y.clear()),H(this.highlight.getRowHighlights(),y=>void y.clear()),H(this.highlight.getColumnHighlights(),y=>void y.clear())),this.highlight.useLayerLevel(l);const u=this.highlight.createArea(),c=this.highlight.createLayeredArea(),d=this.highlight.createRowHeader(),g=this.highlight.createColumnHeader(),p=this.highlight.createActiveRowHeader(),C=this.highlight.createActiveColumnHeader(),E=this.highlight.createActiveCornerHeader(),I=this.highlight.createRowHighlight(),M=this.highlight.createColumnHighlight();if(u.clear(),c.clear(),d.clear(),g.clear(),p.clear(),C.clear(),E.clear(),I.clear(),M.clear(),this.highlight.isEnabledFor(BS,s.highlight)&&(this.isMultiple()||l>=1)&&(u.add(s.from).add(s.to).commit(),c.add(s.from).add(s.to).commit(),l===1)){const y=this.selectedRange.previous();this.highlight.useLayerLevel(l-1),this.highlight.createArea().add(y.from).commit().syncWith(y),this.highlight.createLayeredArea().add(y.from).commit().syncWith(y),this.highlight.useLayerLevel(l)}if(this.highlight.isEnabledFor(VS,s.highlight)){if(!s.isSingleHeader()){const q=this.tableProps.createCellCoords(Math.max(s.from.row,0),-1),G=this.tableProps.createCellCoords(s.to.row,-1),X=this.tableProps.createCellCoords(-1,Math.max(s.from.col,0)),re=this.tableProps.createCellCoords(-1,s.to.col);this.settings.selectionMode==="single"?(d.add(q).commit(),g.add(X).commit(),I.add(q).commit(),M.add(X).commit()):(d.add(q).add(G).commit(),g.add(X).add(re).commit(),I.add(q).add(G).commit(),M.add(X).add(re).commit())}const y=!SE(this,bu)&&this.isEntireRowSelected()&&(i>0&&i===s.getWidth()||i===0&&this.isSelectedByRowHeader()),$=!SE(this,bu)&&this.isEntireColumnSelected()&&(r>0&&r===s.getHeight()||r===0&&this.isSelectedByColumnHeader());y&&p.add(this.tableProps.createCellCoords(Math.max(s.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(s.to.row,0),-1)).commit(),$&&C.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(s.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(s.to.col,0))).commit(),y&&$&&E.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}this.runLocalHooks("afterSetRangeEnd",e)}isMultiple(){const e=gi(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(e,n,r))}transformEnd(e,n){this.setRangeEnd(this.transformation.transformEnd(e,n))}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=r?-l:0,c=n?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let d=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:g,disableHeadersHighlight:p}=i;vE(this,bu,p),g&&Number.isInteger(g==null?void 0:g.row)&&Number.isInteger(g==null?void 0:g.col)&&(d=this.tableProps.createCellCoords(pr(g.row,u,o-1),pr(g.col,c,s-1)));const C=this.tableProps.createCellCoords(u,c),E=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.setRangeStartOnly(C,void 0,d),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(E),this.finish(),vE(this,bu,!1)}selectCells(e){var n=this;const r=Bl(e);if(r===Xg)return!1;if(r===qg)throw new Error(bt`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=Lc(r,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),H(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone()),this.finish()})),a}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),d=this.tableProps.createCellCoords(s-1,o),g=this.tableProps.createCellRange(c,c,d).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(g){const p=l===0?0:pr(r,u,-1),C=s-1,E=this.tableProps.createCellCoords(p,i),I=this.tableProps.createCellCoords(C,o),M=this.tableProps.createCellCoords(pr(r,u,s-1),i);this.runLocalHooks("beforeSelectColumns",E,I,M),E.row=p,I.row=C,this.setRangeStartOnly(E,void 0,M),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(I),this.runLocalHooks("afterSelectColumns",E,I,M),this.finish()}return g}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(n,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){const d=s===0?0:pr(r,a,-1),g=o-1,p=this.tableProps.createCellCoords(e,d),C=this.tableProps.createCellCoords(n,g),E=this.tableProps.createCellCoords(e,pr(r,a,o-1));this.runLocalHooks("beforeSelectRows",p,C,E),p.col=d,C.col=g,this.setRangeStartOnly(p,void 0,E),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(C),this.runLocalHooks("afterSelectRows",p,C,E),this.finish()}return c}refresh(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const n=this.highlight.getFocus(),r=this.getLayerLevel();n.commit().syncWith(this.selectedRange.current());for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),d=this.highlight.createActiveCornerHeader(),g=this.highlight.createRowHighlight(),p=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),d.commit(),g.commit(),p.commit()}this.highlight.useLayerLevel(r)}}_t(Lx,wr);const _X=Lx,yE=/^(\r\n|\n\r|\r|\n)/,MX=/^[^\t\r\n]+/,bE=/^\t/;function OX(t){const e=[[""]];if(t.length===0)return e;let n=0,r=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(bE))t=t.replace(bE,""),n+=1,e[r][n]="";else if(t.match(yE))t=t.replace(yE,""),n=0,r+=1,e[r]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(MX);o=s?s[0]:"",t=t.slice(o.length)}e[r][n]=o}return e}function cc(t){let e,n,r,i,o="",s;for(e=0,n=t.length;e<n;e+=1){for(i=t[e].length,r=0;r<i;r+=1)r>0&&(o+="	"),s=t[e][r],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==n-1&&(o+=`
`)}return o}function Fs(t,e,n){return e=AX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function AX(t){var e=IX(t,"string");return typeof e=="symbol"?e:String(e)}function IX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Pl{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,r){Fs(this,"hot",void 0),Fs(this,"metaManager",void 0),Fs(this,"tableMeta",void 0),Fs(this,"dataSource",void 0),Fs(this,"duckSchema",void 0),Fs(this,"colToPropCache",void 0),Fs(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=n,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,n){let i=0,o=0,s=!1;if(typeof n=="function"){const a=Fg(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,n.length)}for(r=0;r<i;r++){const a=s?n(r):n[r];if(qe(a)){if(typeof a.data<"u"){const l=s?o:r;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return ZS(this.dataSource)}recursiveDuckColumns(e,n,r){let i=n,o=r,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&Ze(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&Re(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(Re(n))return this.hot.toVisualColumn(n);const r=this.hot.toVisualColumn(e);return r===null?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Vl(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,n,r)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,d=this.getSchema().length,g=[];for(;a<n&&o+a<c;){let C=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?C=Vn(this.getSchema()):(C=[],xe(d-1,()=>C.push(null))):this.hot.dataType==="function"?C=this.tableMeta.dataSchema(l+a):(C={},th(C,this.getSchema())),g.push(C),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,g);const p=this.hot.toVisualRow(s);return this.hot.countSourceRows()===g.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):r!=="auto"&&this.metaManager.createRow(s,n)),this.hot.runHooks("afterCreateRow",p,a,r),this.hot.forceFullRender=!0,{delta:a,startPhysicalIndex:s}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.hot.runHooks("beforeCreateCol",l,n,r)===!1)return{delta:0};let c=a;l<this.hot.countCols()&&(c=this.hot.toPhysicalColumn(l));const d=this.hot.countSourceRows();let g=this.hot.countCols(),p=0,C=c;i==="end"&&(C=Math.min(C+1,a));const E=C;for(;p<n&&g<s;){if(typeof l!="number"||l>=g)if(d>0)for(let M=0;M<d;M+=1)typeof o[M]>"u"&&(o[M]=[]),o[M].push(null);else o.push([null]);else for(let M=0;M<d;M++)o[M].splice(C,0,null);p+=1,C+=1,g+=1}this.hot.columnIndexMapper.insertIndexes(l,p),p>0&&(e==null?this.metaManager.createColumn(null,p):r!=="auto"&&this.metaManager.createColumn(E,n));const I=this.hot.toVisualColumn(E);return this.hot.runHooks("afterCreateCol",I,p,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:p,startPhysicalIndex:E}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-n;const o=this.visualRowsToPhysical(i,n),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,r)===!1)return!1;const l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=Re(this.tableMeta.columns)||Re(this.tableMeta.dataSchema);this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&c===!1&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,d)=>d-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,r),this.hot.forceFullRender=!0,!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-n:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,n),s=o.slice(0).sort((d,g)=>g-d);if(this.hot.runHooks("beforeRemoveCol",i,n,o,r)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let d=0;d<u;d++)l&&o[0]!==o[d]-d&&(l=!1);if(l)for(let d=0,g=this.hot.countSourceRows();d<g;d++)c[d].splice(o[0],n),d===0&&this.metaManager.removeColumn(o[0],n);else for(let d=0,g=this.hot.countSourceRows();d<g;d++)for(let p=0;p<u;p++)c[d].splice(s[p],1),d===0&&this.metaManager.removeColumn(s[p],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,n,o,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,n,r){const i=this.hot.getDataAtCol(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];RC(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return $I(l),this.hot.populateFromArray(n,e,l,null,null,"spliceCol"),o}spliceRow(e,n,r){const i=this.hot.getSourceDataAtRow(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];RC(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return this.hot.populateFromArray(e,n,[l],null,null,"spliceRow"),o}spliceData(e,n,r){if(this.hot.runHooks("beforeDataSplice",e,n,r)!==!1){const o=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,n,r){let i=this.hot.runHooks("filterData",e,n,r);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>r.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,n){const r=this.hot.toPhysicalRow(e);let i=this.dataSource[r];const o=this.hot.runHooks("modifyRowData",r);i=isNaN(o)?o:i;let s=null;if(i&&i.hasOwnProperty&&Vt(i,n))s=i[n];else if(typeof n=="string"&&n.indexOf(".")>-1){const a=n.split(".");let l=i;if(!l)return null;for(let u=0,c=a.length;u<c;u++)if(l=l[a[u]],typeof l>"u")return null;s=l}else typeof n=="function"&&(s=n(this.dataSource.slice(r,r+1)[0]));if(this.hot.hasHook("modifyData")){const a=gi(s);this.hot.runHooks("modifyData",r,this.propToCol(n),a,"get"),a.isTouched()&&(s=a.value)}return s}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,r){const i=this.hot.toPhysicalRow(e);let o=r,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const l=gi(o);this.hot.runHooks("modifyData",i,this.propToCol(n),l,"set"),l.isTouched()&&(o=l.value)}if(s&&s.hasOwnProperty&&Vt(s,n))s[n]=o;else if(typeof n=="string"&&n.indexOf(".")>-1){const l=n.split(".");let u=s,c=0,d;for(c=0,d=l.length-1;c<d;c++)typeof u[l[c]]>"u"&&(u[l[c]]={}),u=u[l[c]];u[l[c]]=o}else typeof n=="function"?n(this.dataSource.slice(i,i+1)[0],o):s[n]=o}visualRowsToPhysical(e,n){const r=this.hot.countSourceRows(),i=[];let o=(r+e)%r,s=n,a;for(;o<r&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,n){const r=this.hot.countCols(),i=[];let o=(r+e)%r,s=n;for(;o<r&&s;){const a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,Pl.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,r){const i=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=r===Pl.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,d=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),g=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=d;o++){a=[];const p=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,n.col);s<=g&&p!==null;s++)a.push(c.call(this,o,this.colToProp(s)));p!==null&&i.push(a)}return i}getText(e,n){return cc(this.getRange(e,n,Pl.DESTINATION_RENDERER))}getCopyableText(e,n){return cc(this.getRange(e,n,Pl.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const PX=Pl,{register:xX,getItem:HX,hasItem:$x,getNames:DX,getValues:zae}=yi("cellTypes");function Ob(t){if(!$x(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return HX(t)}function $r(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:r,validator:i}=e;n&&dr(t,n),r&&ki(t,r),i&&Il(t,i),xX(t,e)}function NX(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!Vt(e,t)}function Zg(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const r=typeof e.type=="string"?Ob(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Ze(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!qe(r))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};Ze(r,(o,s)=>{if(NX(s,n)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),un(t,i)}function LX(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}Bo(n,t);for(let r=0;r<e.length;r++)n.prototype[e[r]]=void 0;return n}function ef(t){return Number.isInteger(t)&&t>=0}function tf(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function Gh(t){return t==null}const kx=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,r;for(e=0,n=this.countRows();e<n;e++)if(r=this.getDataAtCell(e,t),mn(r)===!1)return!1;return!0},isEmptyRow(t){let e,n,r,i;for(e=0,n=this.countCols();e<n;e++)if(r=this.getDataAtCell(t,e),mn(r)===!1)return typeof r=="object"?(i=this.getCellMeta(t,e),kg(this.getSchema()[i.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function RE(t,e,n){return e=$X(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $X(t){var e=kX(t,"string");return typeof e=="symbol"?e:String(e)}function kX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function FX(){return class{}}class WX{constructor(e){RE(this,"metaCtor",FX()),RE(this,"meta",void 0),this.meta=this.metaCtor.prototype,un(this.meta,kx()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;un(this.meta,e),Zg(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function VX(t,e,n){return e=BX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function BX(t){var e=UX(t,"string");return typeof e=="symbol"?e:String(e)}function UX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class YX{constructor(e){VX(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){un(this.meta,e),Zg(this.meta,e,e)}}let Fx;function zh(t,e,n){return e=GX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GX(t){var e=zX(t,"string");return typeof e=="symbol"?e:String(e)}function zX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}Fx=Symbol.iterator;class Vf{constructor(e){zh(this,"valueFactory",void 0),zh(this,"data",[]),zh(this,"index",[]),zh(this,"holes",new Set),this.valueFactory=e}obtain(e){tf(()=>ef(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let r;if(n>=0)r=this.data[n],r===void 0&&(r=this.valueFactory(e),this.data[n]=r);else if(r=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=r,this.index[e]=i}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;tf(()=>ef(e)||Gh(e),"Expecting an unsigned number or null/undefined argument.");const r=[],i=this.data.length;for(let s=0;s<n;s++)r.push(i+s),this.data.push(void 0);const o=Gh(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...r,...this.index.slice(o)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;tf(()=>ef(e)||Gh(e),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(Gh(e)?this.index.length-n:e,n);for(let i=0;i<r.length;i++){const o=r[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return _r(this.data,(e,n)=>!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const i=this._getKeyByStorageIndex(r);i!==-1&&e.push([i,this.data[r]])}let n=0;return{next:()=>{if(n<e.length){const r=e[n];return n+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Fx](){return this.entries()}}function EE(t,e,n){return e=jX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jX(t){var e=KX(t,"string");return typeof e=="symbol"?e:String(e)}function KX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const qX=["data","width"];class XX{constructor(e){EE(this,"globalMeta",void 0),EE(this,"metas",new Vf(()=>this._createMeta())),this.globalMeta=e,this.metas=new Vf(()=>this._createMeta())}updateMeta(e,n){const r=this.getMeta(e);un(r,n),Zg(r,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return LX(this.globalMeta.getMetaConstructor(),qX).prototype}}function TE(t,e,n){return e=ZX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ZX(t){var e=QX(t,"string");return typeof e=="symbol"?e:String(e)}function QX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class JX{constructor(e){TE(this,"columnMeta",void 0),TE(this,"metas",new Vf(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,r){const i=this.getMeta(e,n);un(i,r),Zg(i,r)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,n)}getMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);return r===void 0?i:i[r]}setMeta(e,n,r,i){var o;const s=this.metas.obtain(e).obtain(n);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(r),s[r]=i}removeMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);delete i[r]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let r=0;r<n.length;r++)e.push(...n[r].values());return e}getMetasAtRow(e){tf(()=>ef(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new Vf(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class Wx{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new WX(e),this.tableMeta=new YX(this.globalMeta),this.columnMeta=new XX(this.globalMeta),this.cellMeta=new JX(this.columnMeta),r.forEach(i=>new i(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,r){let{visualRow:i,visualColumn:o}=r;const s=this.cellMeta.getMeta(e,n);return s.visualRow=i,s.visualCol=o,s.row=e,s.col=n,this.runLocalHooks("afterGetCellMeta",s),s}getCellMetaKeyValue(e,n,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,r)}setCellMeta(e,n,r,i){this.cellMeta.setMeta(e,n,r,i)}updateCellMeta(e,n,r){this.cellMeta.updateMeta(e,n,r)}removeCellMeta(e,n,r){this.cellMeta.removeMeta(e,n,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}_t(Wx,wr);function _E(t,e,n,r){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=r,d=Wn(a),g=i.getSettings();Array.isArray(g.dataSchema)?i.dataType="array":At(g.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${d}`,t,c,l);const p=new PX(i,t,u);if(e(p),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const C=p.getSchema();t=[];let E,I=0,M=0;for(I=0,M=g.startRows;I<M;I++)if((i.dataType==="object"||i.dataType==="function")&&g.dataSchema)E=Vn(C),t.push(E);else if(i.dataType==="array")E=Vn(C[0]),t.push(E);else{E=[];for(let y=0,$=g.startCols;y<$;y++)E.push(null);t.push(E)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),g.data=t,p.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=p.colToProp.bind(p),s.propToCol=p.propToCol.bind(p),s.countCachedColumns=p.countCachedColumns.bind(p),n(p),i.runHooks(`after${d}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&Ne(i.rootElement,[GI(-1),Hg(i.countCols()+(i.view?i.countRowHeaders():0))])}function ME(t,e,n){return e=e4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function e4(t){var e=t4(t,"string");return typeof e=="symbol"?e:String(e)}function t4(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class n4{constructor(e){ME(this,"metaManager",void 0),ME(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",n=>this.extendCellMeta(n)),_e.getSingleton().add("beforeRender",n=>{n&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:r,col:i}=e;if((n=this.metaSyncMemo.get(r))!==null&&n!==void 0&&n.has(i))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=Vt(e,"type")?e.type:null;let c=At(e.cells)?e.cells(r,i,l):null;if(u)if(c){var d;c.type=(d=c.type)!==null&&d!==void 0?d:u}else c={type:u};c&&this.metaManager.updateCellMeta(r,i,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(i)}}function yp(t,e,n){return e=r4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r4(t){var e=i4(t,"string");return typeof e=="symbol"?e:String(e)}function i4(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class o4{constructor(e){yp(this,"metaManager",void 0),yp(this,"usageTracker",new Set),yp(this,"propDescriptors",new Map([["ariaTags",{onChange(n,r,i){if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable instance was initialized.`)}}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange(n,r,i){if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}}]])),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{target:r,onChange:i=()=>{}}=e,o=typeof r=="string",s=o?r:n,a=`_${s}`;this.metaManager.globalMeta.meta[a]=this.metaManager.globalMeta.meta[s],this.installPropWatcher(n,a,i),o&&this.installPropWatcher(r,a,i)})}installPropWatcher(e,n,r){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),r.call(i,e,o,s),this[n]=o},enumerable:!0,configurable:!0})}}const Vx="gridDefault",Ab="editorManager.handlingEditor",s4={name:"editorCloseAndSave",callback(t,e,n){const r=t._getEditorManager();r.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),r.moveSelectionAfterEnter(n.includes("shift"))}},a4={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},l4={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},u4={name:"editorOpen",callback(t,e,n){const r=t._getEditorManager(),{highlight:i}=t.getSelectedRangeLast();i.isHeader()||(t.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter():r.openEditor(null,e,!0):r.moveSelectionAfterEnter(n.includes("shift")),Kr(e))}};function c4(){return[s4,a4,l4,u4]}const h4={name:"extendCellsSelectionDown",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(1,0)}},d4={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.min(e.row+t.countVisibleRows(),t.countRows()-1),r=t.rowIndexMapper.getNearestNotHiddenIndex(n,-1);if(r!==null){const i=t._createCellCoords(r,e.col),o=e.row-t.view.getFirstFullyVisibleRow(),s=Math.min(i.row-o,t.countRows()-1);t.selection.setRangeEnd(i),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}},f4={name:"extendCellsSelectionLeft",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,-1*t.getDirectionFactor())}},g4={name:"extendCellsSelectionRight",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,t.getDirectionFactor())}},m4={name:"extendCellsSelectionToColumns",callback(t){const{highlight:e,from:n,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()?t.selection.selectAll(!0,!0):t.selectColumns(n.col,r.col,e.row)}},p4={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(t.countRows()-1,-1);e.setRangeStart(i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col))}}},w4={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r}=t.getSelectedRangeLast();r.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},C4={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r}=t.getSelectedRangeLast();r.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,n.getNearestNotHiddenIndex(0,1)))}},v4={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);e.setRangeStart(i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a))}}},S4={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);e.setRangeStart(i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a))}}},y4={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(0,1);e.setRangeStart(i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col))}}},b4={name:"extendCellsSelectionToRows",callback(t){const{highlight:e,from:n,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()?t.selection.selectAll(!0,!0):t.selectRows(n.row,r.row,e.col)}},R4={name:"extendCellsSelectionUp",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(-1,0)}},E4={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.max(e.row-t.countVisibleRows(),0),r=t.rowIndexMapper.getNearestNotHiddenIndex(n,1);if(r!==null){const i=t._createCellCoords(r,e.col),o=e.row-t.view.getFirstFullyVisibleRow(),s=Math.max(i.row-o,0);t.selection.setRangeEnd(i),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}};function T4(){return[h4,d4,f4,g4,m4,p4,w4,C4,v4,S4,y4,b4,R4,E4]}const _4={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.transformStart(1,0)}},M4={name:"moveCellSelectionDownByViewportHeight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight;let i=t.countVisibleRows()+n;r===t.countRows()-1?i=1:r+i>t.countRows()&&(i=t.countRows()-r-1),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},O4={name:"moveCellSelectionInlineEnd",callback(t,e){const n=t.getSettings(),r=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.transformStart(-r.row,-r.col)}},A4={name:"moveCellSelectionInlineStart",callback(t,e){const n=t.getSettings(),r=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.transformStart(r.row,r.col)}},I4={name:"moveCellSelectionLeft",callback(t){t.selection.transformStart(0,-1*t.getDirectionFactor())}},P4={name:"moveCellSelectionRight",callback(t){t.selection.transformStart(0,t.getDirectionFactor())}},x4={name:"moveCellSelectionToMostBottom",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);n===null&&(n=-1),t.selection.setRangeStart(t._createCellCoords(n,e))}},H4={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=r.getNearestNotHiddenIndex(t.countCols()-1,-1);e.setRangeStart(t._createCellCoords(o,s))}},D4={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},N4={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,r=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,o=n.getNearestNotHiddenIndex(r,1);e.setRangeStart(t._createCellCoords(i,o))}},L4={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,r=t.getSelectedRangeLast().highlight.row;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.setRangeStart(t._createCellCoords(r,i))}},$4={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:r}=t.getSelectedRangeLast().highlight;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.setRangeStart(t._createCellCoords(r,i))}},k4={name:"moveCellSelectionToMostTop",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);n===null&&(n=-t.countColHeaders()),t.selection.setRangeStart(t._createCellCoords(n,e))}},F4={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(i,1),a=r.getNearestNotHiddenIndex(o,1);e.setRangeStart(t._createCellCoords(s,a))}},W4={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.transformStart(-1,0)}},V4={name:"moveCellSelectionUpByViewportHight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight;let i=-(t.countVisibleRows()+n);r===-n?i=-1:r+i<n&&(i=-(r+n)),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function B4(){return[_4,M4,O4,A4,I4,P4,x4,H4,D4,N4,L4,$4,k4,F4,W4,V4]}const U4={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},Y4={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.view.getFirstFullyVisibleRow()-1,r=t.view.getFirstFullyVisibleColumn()-1,i=t.view.getLastFullyVisibleRow()+1,o=t.view.getLastFullyVisibleColumn()+1,s=t._createCellCoords(n,r),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},G4={name:"selectAllCells",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},z4={name:"selectAllCellsAndHeaders",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},j4={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:r}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(n,r),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==n||l!==r)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}},K4=[...c4(),...T4(),...B4(),U4,Y4,G4,z4,j4];function Bx(t){const e={};return K4.forEach(n=>{let{name:r,callback:i}=n;e[r]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function q4(t){const e=t.getShortcutManager().addContext("editor"),n=Bx(t),r={group:Ab};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],r)}function X4(t){const e=t.getShortcutManager().addContext("grid"),n=Bx(t),r={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return Re(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:Vx};e.addShortcuts([{keys:[["F2"]],callback:i=>n.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorOpen(i,o)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:Ab,runOnlyIf:()=>Re(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells()},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>!t.getSelectedRangeLast().highlight.isHeader()&&t.getSelectedRangeLast().getCellsCount()>1},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:()=>n.moveCellSelectionInlineStart()},{keys:[["Shift","Tab"]],preventDefault:!1,callback:()=>n.moveCellSelectionInlineEnd()},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],r)}function Z4(t){[q4,X4].forEach(e=>e(t))}function Q4(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=t.rootElement,r=OE(t),i=OE(t);return r.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),n.firstChild.before(r),n.lastChild.after(i),{activate(){t._registerTimeout(()=>{r.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{r.tabIndex=-1,i.tabIndex=-1},10)}}}function OE(t){const n=t.rootDocument.createElement("input");return n.type="text",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&Ne(n,[Gi(),Vo()]),n}function J4(t){let e;const{activate:n,deactivate:r}=Q4(t,{onFocusFromTop(){var u;const c=(u=e)!==null&&u!==void 0?u:AE(t);c&&(t.runHooks("modifyFocusOnTabNavigation","from_above",c),t.selectCell(c.row,c.col)),t.listen()},onFocusFromBottom(){var u;const c=(u=e)!==null&&u!==void 0?u:IE(t);c&&(t.runHooks("modifyFocusOnTabNavigation","from_below",c),t.selectCell(c.row,c.col)),t.listen()}}),i={wrapped:!1,flipped:!1};let o=!0,s=!1;t.addHook("afterListen",()=>r()),t.addHook("afterUnlisten",()=>n()),t.addHook("afterSelection",(u,c,d,g,p)=>{if(s&&i.wrapped&&i.flipped&&(p.value=!0),o){var C;e=(C=t.getSelectedRangeLast())===null||C===void 0?void 0:C.highlight}}),t.addHook("beforeRowWrap",(u,c,d)=>{i.wrapped=!0,i.flipped=d});function a(){i.wrapped=!1,i.flipped=!1,t.deselectCell(),t.unlisten()}const l={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:Vx,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...l,callback:()=>{s=!0,t.getSelectedRangeLast()&&!t.getSettings().tabNavigation&&(o=!1)},position:"before"},{...l,callback:u=>{const{tabNavigation:c,autoWrapRow:d}=t.getSettings();if(s=!1,o=!0,!c||!t.selection.isSelected()||d&&i.wrapped&&i.flipped||!d&&i.wrapped)return d&&i.wrapped&&i.flipped&&(e=u.shiftKey?AE(t):IE(t)),a(),!1;u.preventDefault()},position:"after"}])}function AE(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:r}=t.getSettings();let i=r&&t.countColHeaders()>0?-t.countColHeaders():0,o=r&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=n.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function IE(t){var e,n;const{rowIndexMapper:r,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=r.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=r.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(n=i.getVisualFromRenderableIndex(a))!==null&&n!==void 0?n:a)}const PE=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),jh=t=>t.map(e=>{const n=e.toLowerCase();return PE.has(n)?PE.get(n):n}).sort().join("+"),e6=t=>t.split("+"),xE=new RegExp("^(?:Key|Digit)([A-Z0-9])$"),t6=new Set(["Backquote","Minus","Equal","BracketLeft","BracketRight","Backslash","Semicolon","Quote","Comma","Period","Slash"]),bp=t=>{let{key:e,code:n}=t,r=e;return xE.test(n)?r=n.replace(xE,"$1"):t6.has(n)&&(r=n),r.toLowerCase()},Ux=Symbol("shortcut-context");function Yx(t){return qe(t)&&t.__kindOf===Ux}const n6=t=>{const e=Bg({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:l,callback:u,group:c,runOnlyIf:d=()=>!0,captureCtrl:g=!1,preventDefault:p=!0,stopPropagation:C=!1,relativeToGroup:E,position:I,forwardToContext:M}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(It(c))throw new Error("You need to define the shortcut's group.");if(At(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(bt`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const y={callback:u,group:c,runOnlyIf:d,captureCtrl:g,preventDefault:p,stopPropagation:C};Re(E)&&([y.relativeToGroup,y.position]=[E,I]),Yx(M)&&(y.forwardToContext=M),l.forEach($=>{const q=jh($);if(e.hasItem(q)){const X=e.getItem(q);let re=X.findIndex(v=>v.group===E);re!==-1?I==="before"?re-=1:re+=1:re=X.length,X.splice(re,0,y)}else e.addItem(q,[y])})},r=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{Ze(u,(d,g)=>{Object.prototype.hasOwnProperty.call(c,g)===!1&&(c[g]=u[g])}),n(c)})},i=l=>{const u=jh(l);e.removeItem(u)};return{__kindOf:Ux,addShortcut:n,addShortcuts:r,getShortcuts:l=>{const u=jh(l),c=e.getItem(u);return Re(c)?c.slice():[]},hasShortcut:l=>{const u=jh(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[d,g]=c;const p=g.filter(C=>C.group!==l);p.length===0?i(e6(d)):(g.length=0,g.push(...p))})}}};function r6(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const i6=["meta","alt","shift","control"],Ru=r6();let Kh=0;function o6(t,e,n,r,i){const o=p=>i6.includes(p),s=function(p){let C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const E=[];return p.altKey&&E.push("alt"),C&&(p.ctrlKey||p.metaKey)?E.push("control/meta"):(p.ctrlKey&&E.push("control"),p.metaKey&&E.push("meta")),p.shiftKey&&E.push("shift"),E},a=p=>{if(e(p)===!1)return;const C=n(p);if(p.keyCode===229||C===!1||us(p))return;const E=bp(p);let I=[];o(E)||(I=s(p));const M=[E].concat(I);!i(p,M)&&(Hc()&&I.includes("meta")||!Hc()&&I.includes("control"))&&i(p,[E].concat(s(p,!0))),r(p)},l=p=>{const C=bp(p);o(C)&&Ru.press(C)},u=p=>{const C=bp(p);o(C)&&Ru.release(C)},c=()=>{Ru.releaseAll()};return{mount:()=>{let p=t;for(Kh+=1;p;)Kh===1&&(p.document.documentElement.addEventListener("keydown",l),p.document.documentElement.addEventListener("keyup",u)),p.document.documentElement.addEventListener("keydown",a),p.document.documentElement.addEventListener("blur",c),p=Ic(p)},unmount:()=>{let p=t;for(Kh-=1;p;)Kh===0&&(p.document.documentElement.removeEventListener("keydown",l),p.document.documentElement.removeEventListener("keyup",u)),p.document.documentElement.removeEventListener("keydown",a),p.document.documentElement.removeEventListener("blur",c),p=Ic(p)},isPressed:p=>Ru.isPressed(p),releasePressedKeys:()=>Ru.releaseAll()}}const s6=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:r,afterKeyDown:i}=t;const o=Bg({errorIdExists:C=>`The "${C}" context name is already registered.`});let s="grid";const a=C=>{const E=n6(C);return o.addItem(C,E),E},l=()=>s,u=C=>o.getItem(C),c=C=>{if(!o.hasItem(C))throw new Error(bt`You've tried to activate the "${C}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=C};let d=!1;const g=function(C,E){let I=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const M=Yx(I)?I:u(I);let y=!1;if(!M.hasShortcut(E))return y;const $=M.getShortcuts(E);for(let q=0;q<$.length;q++){const{callback:G,runOnlyIf:X,preventDefault:re,stopPropagation:v,captureCtrl:S,forwardToContext:b}=$[q];if(X(C)===!0){if(d=S,y=G(C,E)===!1,d=!1,re&&C.preventDefault(),v&&(Kr(C),C.stopPropagation()),y)break;b&&g(C,E,b)}}return y},p=o6(e,n,r,i,g);return p.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!d&&(p.isPressed("control")||p.isPressed("meta")),releasePressedKeys:()=>p.releasePressedKeys(),destroy:()=>p.unmount()}};let Rp=null;const Ep=new Map;function Gx(t,e){var n,r=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=!1,s=this;const a=new Mr(s);let l,u,c,d,g,p=!0;B3(i)&&V3(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const C=(n=e==null?void 0:e.layoutDirection)!==null&&n!==void 0?n:"inherit",E=["rtl","ltr"].includes(C)?C:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",E),this.isRtl=function(){return E==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},e.language=Gq(e.language);const I=new Wx(s,e,[n4,o4]),M=I.getTableMeta(),y=I.getGlobalMeta(),$=Bg();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),Jd(this)&&VI(e.licenseKey,t),this.guid=`ht_${oS()}`,Ep.set(this.guid,this),this.columnIndexMapper=new GC,this.rowIndexMapper=new GC,this.columnIndexMapper.addLocalHook("indexesSequenceChange",h=>{s.runHooks("afterColumnSequenceChange",h)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",h=>{s.runHooks("afterRowSequenceChange",h)}),u=new iq(s),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const q=h=>{const{row:f,col:m}=h;return s._createCellCoords(f>=0?s.rowIndexMapper.getRenderableFromVisualIndex(f):f,m>=0?s.columnIndexMapper.getRenderableFromVisualIndex(m):m)},G=h=>{const{row:f,col:m}=h;return s._createCellCoords(f>=0?s.rowIndexMapper.getVisualFromRenderableIndex(f):f,m>=0?s.columnIndexMapper.getVisualFromRenderableIndex(m):m)};let X=new _X(M,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:h=>l.propToCol(h),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(h,f)=>s._createCellCoords(h,f),createCellRange:(h,f,m)=>s._createCellRange(h,f,m),visualToRenderableCoords:q,renderableToVisualCoords:G,isDisabledCellSelection:(h,f)=>h<0||f<0?s.getSettings().disableVisualSelection:s.getCellMeta(h,f).disableVisualSelection});this.selection=X;const re=h=>{let{hiddenIndexesChanged:f}=h;f&&this.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",re),this.rowIndexMapper.addLocalHook("cacheUpdated",re),this.selection.addLocalHook("afterSetRangeEnd",h=>{const f=gi(!1),m=this.selection.getSelectedRange(),{from:T,to:O}=m.current(),_=m.size()-1;this.runHooks("afterSelection",T.row,T.col,O.row,O.col,f,_),this.runHooks("afterSelectionByProp",T.row,s.colToProp(T.col),O.row,s.colToProp(O.col),f,_);let Y=!0;o&&(Y=!1),f.isTouched()&&(Y=!f.value);const U=this.selection.selectedRange.current(),ie=this.selection.isSelectedByAnyHeader(),se=this.selection.isSelectedByRowHeader(),oe=this.selection.isSelectedByColumnHeader();if(Y!==!1)if(ie)se?this.scrollViewportTo({row:h.row}):oe&&this.scrollViewportTo({col:h.col});else if(U&&!this.selection.isMultiple()){const{row:de,col:Ce}=U.from;de<0&&Ce>=0?this.scrollViewportTo({col:Ce}):Ce<0&&de>=0?this.scrollViewportTo({row:de}):this.scrollViewportTo({row:de,col:Ce})}else this.scrollViewportTo(h.toObject());se&&oe?ce(this.rootElement,["ht__selection--rows","ht__selection--columns"]):se?(Ye(this.rootElement,"ht__selection--columns"),ce(this.rootElement,"ht__selection--rows")):oe?(Ye(this.rootElement,"ht__selection--rows"),ce(this.rootElement,"ht__selection--columns")):Ye(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",h=>{const f=h.length-1,{from:m,to:T}=h[f];this.runHooks("afterSelectionEnd",m.row,m.col,T.row,T.col,f),this.runHooks("afterSelectionEndByProp",m.row,s.colToProp(m.col),T.row,s.colToProp(T.col),f)}),this.selection.addLocalHook("afterIsMultipleSelection",h=>{const f=this.runHooks("afterIsMultipleSelection",h.value);h.value&&(h.value=f)}),this.selection.addLocalHook("afterDeselect",()=>{d.destroyEditor(),this._refreshBorders(),Ye(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var h=arguments.length,f=new Array(h),m=0;m<h;m++)f[m]=arguments[m];return r.runHooks("beforeSetRangeStart",...f)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var h=arguments.length,f=new Array(h),m=0;m<h;m++)f[m]=arguments[m];return r.runHooks("beforeSetRangeStartOnly",...f)}).addLocalHook("beforeSetRangeEnd",function(){for(var h=arguments.length,f=new Array(h),m=0;m<h;m++)f[m]=arguments[m];return r.runHooks("beforeSetRangeEnd",...f)}).addLocalHook("beforeSelectColumns",function(){for(var h=arguments.length,f=new Array(h),m=0;m<h;m++)f[m]=arguments[m];return r.runHooks("beforeSelectColumns",...f)}).addLocalHook("afterSelectColumns",function(){for(var h=arguments.length,f=new Array(h),m=0;m<h;m++)f[m]=arguments[m];return r.runHooks("afterSelectColumns",...f)}).addLocalHook("beforeSelectRows",function(){for(var h=arguments.length,f=new Array(h),m=0;m<h;m++)f[m]=arguments[m];return r.runHooks("beforeSelectRows",...f)}).addLocalHook("afterSelectRows",function(){for(var h=arguments.length,f=new Array(h),m=0;m<h;m++)f[m]=arguments[m];return r.runHooks("afterSelectRows",...f)}).addLocalHook("beforeModifyTransformStart",function(){for(var h=arguments.length,f=new Array(h),m=0;m<h;m++)f[m]=arguments[m];return r.runHooks("modifyTransformStart",...f)}).addLocalHook("afterModifyTransformStart",function(){for(var h=arguments.length,f=new Array(h),m=0;m<h;m++)f[m]=arguments[m];return r.runHooks("afterModifyTransformStart",...f)}).addLocalHook("beforeModifyTransformEnd",function(){for(var h=arguments.length,f=new Array(h),m=0;m<h;m++)f[m]=arguments[m];return r.runHooks("modifyTransformEnd",...f)}).addLocalHook("afterModifyTransformEnd",function(){for(var h=arguments.length,f=new Array(h),m=0;m<h;m++)f[m]=arguments[m];return r.runHooks("afterModifyTransformEnd",...f)}).addLocalHook("beforeRowWrap",function(){for(var h=arguments.length,f=new Array(h),m=0;m<h;m++)f[m]=arguments[m];return r.runHooks("beforeRowWrap",...f)}).addLocalHook("beforeColumnWrap",function(){for(var h=arguments.length,f=new Array(h),m=0;m<h;m++)f[m]=arguments[m];return r.runHooks("beforeColumnWrap",...f)}).addLocalHook("insertRowRequire",h=>this.alter("insert_row_above",h,1,"auto")).addLocalHook("insertColRequire",h=>this.alter("insert_col_start",h,1,"auto")),c={alter(h,f){var m,T;let O=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,_=arguments.length>3?arguments[3]:void 0,Y=arguments.length>4?arguments[4]:void 0;const U=ie=>{if(ie.length===0)return[];const se=[...ie];return se.sort((de,Ce)=>{let[pe]=de,[we]=Ce;return pe===we?0:pe>we?1:-1}),nn(se,(de,Ce)=>{let[pe,we]=Ce;const ee=de[de.length-1],[ye,$e]=ee,Ae=ye+$e;if(pe<=Ae){const Fe=Math.max(we-(Ae-pe),0);ee[1]+=Fe}else de.push([pe,we]);return de},[se[0]])};switch(h){case"insert_row_below":case"insert_row_above":const ie=s.countSourceRows();if(M.maxRows===ie)return;const se=h==="insert_row_below"?"below":"above";f=(m=f)!==null&&m!==void 0?m:se==="below"?ie:0;const{delta:oe,startPhysicalIndex:de}=l.createRow(f,O,{source:_,mode:se});if(oe){const $e=X.selectedRange.current(),Ae=$e==null?void 0:$e.from,Fe=Ae==null?void 0:Ae.row,Ie=s.toVisualRow(de);if(X.isSelectedByCorner())X.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(Re(Fe)&&Fe>=Ie){const{row:R,col:A}=$e.to;let N=Ae.col;X.isSelectedByRowHeader()&&(N=-1),X.getSelectedRange().pop(),X.setRangeStartOnly(s._createCellCoords(Fe+oe,N),!0),X.setRangeEnd(s._createCellCoords(R+oe,A))}else s._refreshBorders()}break;case"insert_col_start":case"insert_col_end":const Ce=h==="insert_col_end"?"end":"start";f=(T=f)!==null&&T!==void 0?T:Ce==="end"?s.countSourceCols():0;const{delta:pe,startPhysicalIndex:we}=l.createCol(f,O,{source:_,mode:Ce});if(pe){if(Array.isArray(M.colHeaders)){const R=[s.toVisualColumn(we),0];R.length+=pe,Array.prototype.splice.apply(M.colHeaders,R)}const $e=X.selectedRange.current(),Ae=$e==null?void 0:$e.from,Fe=Ae==null?void 0:Ae.col,Ie=s.toVisualColumn(we);if(X.isSelectedByCorner())X.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(Re(Fe)&&Fe>=Ie){const{row:R,col:A}=$e.to;let N=Ae.row;X.isSelectedByColumnHeader()&&(N=-1),X.getSelectedRange().pop(),X.setRangeStartOnly(s._createCellCoords(N,Fe+pe),!0),X.setRangeEnd(s._createCellCoords(R,A+pe))}else s._refreshBorders()}break;case"remove_row":const ee=$e=>{let Ae=0;H($e,Fe=>{let[Ie,R]=Fe;const A=mn(Ie)?s.countRows()-1:Math.max(Ie-Ae,0);if(Number.isInteger(Ie)&&(Ie=Math.max(Ie-Ae,0)),!l.removeRow(Ie,R,_))return;const J=s.countRows(),F=M.fixedRowsTop;F>=A+1&&(M.fixedRowsTop-=Math.min(R,F-A));const Q=M.fixedRowsBottom;Q&&A>=J-Q&&(M.fixedRowsBottom-=Math.min(R,Q)),Ae+=R})};Array.isArray(f)?ee(U(f)):ee([[f,O]]),c.adjustRowsAndCols(),s._refreshBorders();break;case"remove_col":const ye=$e=>{let Ae=0;H($e,Fe=>{let[Ie,R]=Fe;const A=mn(Ie)?s.countCols()-1:Math.max(Ie-Ae,0);let N=s.toPhysicalColumn(A);if(Number.isInteger(Ie)&&(Ie=Math.max(Ie-Ae,0)),!l.removeCol(Ie,R,_))return;const F=M.fixedColumnsStart;F>=A+1&&(M.fixedColumnsStart-=Math.min(R,F-A)),Array.isArray(M.colHeaders)&&(typeof N>"u"&&(N=-1),M.colHeaders.splice(N,R)),Ae+=R})};Array.isArray(f)?ye(U(f)):ye([[f,O]]),c.adjustRowsAndCols(),s._refreshBorders();break;default:throw new Error(`There is no such action "${h}"`)}Y||c.adjustRowsAndCols()},adjustRowsAndCols(){const h=M.minRows,f=M.minSpareRows,m=M.minCols,T=M.minSpareCols;if(s.countRows()===0&&s.countCols()===0&&X.deselect(),h){const O=s.countRows();O<h&&l.createRow(O,h-O,{source:"auto"})}if(f){const O=s.countEmptyRows(!0);if(O<f){const _=f-O,Y=Math.min(_,M.maxRows-s.countSourceRows());l.createRow(s.countRows(),Y,{source:"auto"})}}{let O;(m||T)&&(O=s.countEmptyCols(!0));let _=s.countCols();if(m&&!M.columns&&_<m){const Y=m-_;O+=Y,l.createCol(_,Y,{source:"auto"})}if(T&&!M.columns&&s.dataType==="array"&&O<T){_=s.countCols();const Y=T-O,U=Math.min(Y,M.maxCols-_);l.createCol(_,U,{source:"auto"})}}if(X.isSelected()){const O=s.countRows(),_=s.countCols();H(X.selectedRange,Y=>{let U=!1,ie=Y.from.row,se=Y.from.col,oe=Y.to.row,de=Y.to.col;ie>O-1?(ie=O-1,U=!0,oe>ie&&(oe=ie)):oe>O-1&&(oe=O-1,U=!0,ie>oe&&(ie=oe)),se>_-1?(se=_-1,U=!0,de>se&&(de=se)):de>_-1&&(de=_-1,U=!0,se>de&&(se=de)),U&&s.selectCell(ie,se,oe,de)})}s.view&&s.view.adjustElementsSize()},populateFromArray(h,f,m,T,O){let _,Y,U,ie;const se=[],oe={},de=[],Ce=h.row,pe=h.col;if(Y=f.length,Y===0)return!1;let we=0,ee=0;switch(qe(m)&&(we=m.col-pe+1,ee=m.row-Ce+1),O){case"shift_down":const ye=sc(f),$e=ye.length,Ae=Math.max($e,we),Fe=s.getData().slice(Ce),Ie=sc(Fe).slice(pe,pe+Ae);for(U=0;U<Ae;U+=1)if(U<$e){for(_=0,Y=ye[U].length;_<ee-Y;_+=1)ye[U].push(ye[U][_%Y]);U<Ie.length?de.push(ye[U].concat(Ie[U])):de.push(ye[U].concat(new Array(Fe.length).fill(null)))}else de.push(ye[U%$e].concat(Ie[U]));s.populateFromArray(Ce,pe,sc(de));break;case"shift_right":const R=f.length,A=Math.max(R,ee),N=s.getData().slice(Ce).map(ne=>ne.slice(pe));for(_=0;_<A;_+=1)if(_<R){for(U=0,ie=f[_].length;U<we-ie;U+=1)f[_].push(f[_][U%ie]);if(_<N.length)for(let ne=0;ne<N[_].length;ne+=1)f[_].push(N[_][ne]);else f[_].push(...new Array(N[0].length).fill(null))}else f.push(f[_%Y].slice(0,A).concat(N[_]));s.populateFromArray(Ce,pe,f);break;case"overwrite":default:oe.row=h.row,oe.col=h.col;let J=0,F=0,Q=!0,K;const j=function(fe){let Ee=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const He=f[fe%f.length];return Ee!==null?He[Ee%He.length]:He},te=f.length,Z=m?m.row-h.row+1:0;for(m?Y=Z:Y=Math.max(te,Z),_=0;_<Y&&!(m&&oe.row>m.row&&Z>te||!M.allowInsertRow&&oe.row>s.countRows()-1||oe.row>=M.maxRows);_++){const ne=_-J,fe=j(ne).length,Ee=m?m.col-h.col+1:0;if(m?ie=Ee:ie=Math.max(fe,Ee),oe.col=h.col,K=s.getCellMeta(oe.row,oe.col),(T==="CopyPaste.paste"||T==="Autofill.fill")&&K.skipRowOnPaste){J+=1,oe.row+=1,Y+=1;continue}for(F=0,U=0;U<ie&&!(m&&oe.col>m.col&&Ee>fe||!M.allowInsertColumn&&oe.col>s.countCols()-1||oe.col>=M.maxCols);U++){if(K=s.getCellMeta(oe.row,oe.col),(T==="CopyPaste.paste"||T==="Autofill.fill")&&K.skipColumnOnPaste){F+=1,oe.col+=1,ie+=1;continue}if(K.readOnly&&T!=="UndoRedo.undo"){oe.col+=1;continue}const He=U-F;let ke=j(ne,He),Ge=s.getDataAtCell(oe.row,oe.col);if(ke!==null&&typeof ke=="object")if(Array.isArray(ke)&&Ge===null&&(Ge=[]),Ge===null||typeof Ge!="object")Q=!1;else{const Rt=Vl(Array.isArray(Ge)?Ge:Ge[0]||Ge),Qe=Vl(Array.isArray(ke)?ke:ke[0]||ke);kg(Rt,Qe)||Array.isArray(Rt)&&Array.isArray(Qe)?ke=Vn(ke):Q=!1}else Ge!==null&&typeof Ge=="object"&&(Q=!1);Q&&se.push([oe.row,oe.col,ke]),Q=!0,oe.col+=1}oe.row+=1}s.setDataAtCell(se,null,null,T||"populateFromArray");break}}};function v(h){const f=Sx(h);_b(f)?(s.runHooks("beforeLanguageChange",f),y.language=f,s.runHooks("afterLanguageChange",f)):yx(h)}function S(h,f){const m=h==="className"?s.rootElement:s.table;if(p)ce(m,f);else{let T=[],O=[];y[h]&&(T=Array.isArray(y[h])?y[h]:TC(y[h])),f&&(O=Array.isArray(f)?f:TC(f));const _=EC(T,O),Y=EC(O,T);_.length&&Ye(m,_),Y.length&&ce(m,Y)}y[h]=f}this.init=function(){u.setData(M.data),s.runHooks("beforeInit"),(Mo()||yS())&&ce(s.rootElement,"mobile"),this.updateSettings(M,!0),this.view=new q3(this),d=iz.getInstance(s,M,X),g=new az(s),Jd(this)&&J4(s),s.runHooks("init"),this.forceFullRender=!0,this.view.render(),p&&s.rootElement.offsetParent===null&&rP(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.render(),s.view.adjustElementsSize()}),typeof p=="object"&&(s.runHooks("afterChange",p[0],p[1]),p=!1),s.runHooks("afterInit")};function b(){let h=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,h=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&h===!1&&(h=!0,this.onQueueEmpty(this.valid))}}}function L(h){const f=h.replace(",",".");return isNaN(parseFloat(f))===!1?parseFloat(f):h}function P(h,f,m){if(!h.length)return;const T=s.getActiveEditor(),O=new b;let _=!0;O.onQueueEmpty=Y=>{T&&_&&T.cancelChanges(),m(Y)};for(let Y=h.length-1;Y>=0;Y--){const[U,ie,,se]=h[Y],oe=l.propToCol(ie),de=s.getCellMeta(U,oe);de.type==="numeric"&&typeof se=="string"&&OP(se)&&(h[Y][3]=L(se)),s.getCellValidator(de)&&(O.addValidatorToQueue(),s.validateCell(h[Y][3],de,function(Ce,pe){return function(we){if(typeof we!="boolean")throw new Error("Validation error: result is not boolean");if(we===!1&&pe.allowInvalid===!1){_=!1,h.splice(Ce,1),pe.valid=!0;const ee=s.getCell(pe.visualRow,pe.visualCol);ee!==null&&Ye(ee,M.invalidCellClassName)}O.removeValidatorFormQueue()}}(Y,de),f))}O.checkIfQueueIsEmpty()}function x(h,f){let m=h.length-1;if(m<0)return;for(;m>=0;m--){let O=!1;if(h[m]===null){h.splice(m,1);continue}if(!((h[m][2]===null||h[m][2]===void 0)&&(h[m][3]===null||h[m][3]===void 0))){if(M.allowInsertRow)for(;h[m][0]>s.countRows()-1;){const{delta:_}=l.createRow(void 0,void 0,{source:f});if(_===0){O=!0;break}}if(s.dataType==="array"&&(!M.columns||M.columns.length===0)&&M.allowInsertColumn)for(;l.propToCol(h[m][1])>s.countCols()-1;){const{delta:_}=l.createCol(void 0,void 0,{source:f});if(_===0){O=!0;break}}O||l.set(h[m][0],h[m][1],h[m][3])}}s.forceFullRender=!0,c.adjustRowsAndCols(),s.runHooks("beforeChangeRender",h,f),d.lockEditor(),s._refreshBorders(null),d.unlockEditor(),s.view.adjustElementsSize(),s.runHooks("afterChange",h,f||"edit");const T=s.getActiveEditor();T&&Re(T.refreshValue)&&T.refreshValue()}this._createCellCoords=function(h,f){return s.view._wt.createCellCoords(h,f)},this._createCellRange=function(h,f,m){return s.view._wt.createCellRange(h,f,m)},this.validateCell=function(h,f,m,T){let O=s.getCellValidator(f);function _(Y){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||f.hidden===!0){m(Y);return}const ie=f.visualCol,se=f.visualRow,oe=s.getCell(se,ie,!0);if(oe&&oe.nodeName!=="TH"){const de=s.rowIndexMapper.getRenderableFromVisualIndex(se),Ce=s.columnIndexMapper.getRenderableFromVisualIndex(ie);s.view._wt.getSetting("cellRenderer",de,Ce,oe)}m(Y)}WI(O)&&(O=function(Y){return function(U,ie){ie(Y.test(U))}}(O)),At(O)?(h=s.runHooks("beforeValidate",h,f.visualRow,f.prop,T),s._registerImmediate(()=>{O.call(f,h,Y=>{s&&(Y=s.runHooks("afterValidate",Y,h,f.visualRow,f.prop,T),f.valid=Y,_(Y),s.runHooks("postAfterValidate",Y,h,f.visualRow,f.prop,T))})})):s._registerImmediate(()=>{f.valid=!0,_(f.valid,!1)})};function W(h,f,m){return Array.isArray(h)?h:[[h,f,m]]}function D(h,f){const m=s.getActiveEditor(),T=s.runHooks("beforeChange",h,f||"edit"),O=h.filter(_=>_!==null);return T===!1||O.length===0?(m&&m.cancelChanges(),[]):O}this.setDataAtCell=function(h,f,m,T){const O=W(h,f,m),_=[];let Y=T,U,ie,se;for(U=0,ie=O.length;U<ie;U++){if(typeof O[U]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof O[U][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");O[U][1]>=this.countCols()?se=O[U][1]:se=l.colToProp(O[U][1]),_.push([O[U][0],se,u.getAtCell(this.toPhysicalRow(O[U][0]),O[U][1]),O[U][2]])}!Y&&typeof h=="object"&&(Y=f);const oe=D(_,T);s.runHooks("afterSetDataAtCell",oe,Y),P(oe,Y,()=>{x(oe,Y)})},this.setDataAtRowProp=function(h,f,m,T){const O=W(h,f,m),_=[];let Y=T,U,ie;for(U=0,ie=O.length;U<ie;U++)_.push([O[U][0],O[U][1],u.getAtCell(this.toPhysicalRow(O[U][0]),O[U][1]),O[U][2]]);!Y&&typeof h=="object"&&(Y=f);const se=D(_,T);s.runHooks("afterSetDataAtRowProp",se,Y),P(se,Y,()=>{x(se,Y)})},this.listen=function(){s&&!s.isListening()&&(Ep.forEach(h=>{s!==h&&h.unlisten()}),Rp=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Rp=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return Rp===s.guid},this.destroyEditor=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;s._refreshBorders(h,f)},this.populateFromArray=function(h,f,m,T,O,_,Y){if(!(typeof m=="object"&&typeof m[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const U=typeof T=="number"?s._createCellCoords(T,O):null;return c.populateFromArray(s._createCellCoords(h,f),m,U,_,Y)},this.spliceCol=function(h,f,m){for(var T=arguments.length,O=new Array(T>3?T-3:0),_=3;_<T;_++)O[_-3]=arguments[_];return l.spliceCol(h,f,m,...O)},this.spliceRow=function(h,f,m){for(var T=arguments.length,O=new Array(T>3?T-3:0),_=3;_<T;_++)O[_-3]=arguments[_];return l.spliceRow(h,f,m,...O)},this.getSelected=function(){if(X.isSelected())return Xe(X.getSelectedRange(),h=>{let{from:f,to:m}=h;return[f.row,f.col,m.row,m.col]})},this.getSelectedLast=function(){const h=this.getSelected();let f;return h&&h.length>0&&(f=h[h.length-1]),f},this.getSelectedRange=function(){if(X.isSelected())return Array.from(X.getSelectedRange())},this.getSelectedRangeLast=function(){const h=this.getSelectedRange();let f;return h&&h.length>0&&(f=h[h.length-1]),f},this.emptySelectedCells=function(h){if(!X.isSelected()||this.countRows()===0||this.countCols()===0)return;const f=[];H(X.getSelectedRange(),m=>{if(m.isSingleHeader())return;const T=m.getTopStartCorner(),O=m.getBottomEndCorner();xe(T.row,O.row,_=>{xe(T.col,O.col,Y=>{this.getCellMeta(_,Y).readOnly||f.push([_,Y,null])})})}),f.length>0&&this.setDataAtCell(f,h)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const h=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(h,0),!this.isRenderSuspended()&&h===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(d.lockEditor(),this._refreshBorders(null),d.unlockEditor()))},this.batchRender=function(h){this.suspendRender();const f=h();return this.resumeRender(),f},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const f=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(f,0),(!this.isExecutionSuspended()&&f===this.executionSuspendedCounter||h)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(h){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const m=h();return this.resumeExecution(f),m},this.batch=function(h){this.suspendRender(),this.suspendExecution();const f=h();return this.resumeExecution(),this.resumeRender(),f},this.refreshDimensions=function(){if(!s.view)return;const{width:h,height:f}=s.view.getLastSize(),{width:m,height:T}=s.rootElement.getBoundingClientRect(),O=m!==h||T!==f;s.runHooks("beforeRefreshDimensions",{width:h,height:f},{width:m,height:T},O)!==!1&&((O||s.view._wt.wtOverlays.scrollableElement===s.rootWindow)&&(s.view.setLastSize(m,T),s.render()),s.runHooks("afterRefreshDimensions",{width:h,height:f},{width:m,height:T},O))},this.updateData=function(h,f){_E(h,m=>{l=m},m=>{l=m,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),c.adjustRowsAndCols()},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"updateData",source:f,metaManager:I,firstRun:p})},this.loadData=function(h,f){_E(h,m=>{l=m},()=>{I.clearCellsCache(),s.initIndexMappers(),c.adjustRowsAndCols(),p&&(p=[null,"loadData"])},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"loadData",source:f,metaManager:I,firstRun:p})},this.getInitialColumnCount=function(){const h=M.columns;let f=0;if(Array.isArray(h))f=h.length;else if(At(h))if(s.dataType==="array"){const m=this.countSourceCols();for(let T=0;T<m;T+=1)h(T)&&(f+=1)}else(s.dataType==="object"||s.dataType==="function")&&(f=l.colToPropCache.length);else if(Re(M.dataSchema)){const m=l.getSchema();f=Array.isArray(m)?m.length:Fg(m)}else f=this.countSourceCols();return f},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(h,f,m,T){return It(h)?l.getAll():l.getRange(s._createCellCoords(h,f),s._createCellCoords(m,T),l.DESTINATION_RENDERER)},this.getCopyableText=function(h,f,m,T){return l.getCopyableText(s._createCellCoords(h,f),s._createCellCoords(m,T))},this.getCopyableData=function(h,f){return l.getCopyable(h,l.colToProp(f))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(h){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const m=(p?s.loadData:s.updateData).bind(this);let T=!1,O,_;if(Re(h.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(Re(h.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(Re(h.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(O in h)O==="data"||(O==="language"?v(h.language):O==="className"?S("className",h.className):O==="tableClassName"&&s.table?(S("tableClassName",h.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames()):_e.getSingleton().isRegistered(O)||_e.getSingleton().isDeprecated(O)?(At(h[O])||Array.isArray(h[O]))&&(h[O].initialHook=!0,s.addHook(O,h[O])):!f&&Vt(h,O)&&(y[O]=h[O]));h.data===void 0&&M.data===void 0?m(null,"updateSettings"):h.data!==void 0?m(h.data,"updateSettings"):h.columns!==void 0&&(l.createMap(),s.initIndexMappers());const Y=s.countCols(),U=M.columns;if(U&&At(U)&&(T=!0),(h.cell!==void 0||h.cells!==void 0||h.columns!==void 0)&&I.clearCache(),Y>0)for(O=0,_=0;O<Y;O++){if(U){const oe=T?U(O):U[_];oe&&I.updateColumnMeta(_,oe)}_+=1}Re(h.cell)&&Ze(h.cell,oe=>{s.setCellMetaObject(oe.row,oe.col,oe)}),s.runHooks("afterCellMetaReset");let ie=s.rootElement.style.height;ie!==""&&(ie=parseInt(s.rootElement.style.height,10));let se=h.height;if(At(se)&&(se=se()),f&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style")),se===null){const oe=s.rootElement.getAttribute("data-initialstyle");oe&&(oe.indexOf("height")>-1||oe.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",oe):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else se!==void 0&&(s.rootElement.style.height=isNaN(se)?`${se}`:`${se}px`,s.rootElement.style.overflow="hidden");if(typeof h.width<"u"){let oe=h.width;At(oe)&&(oe=oe()),s.rootElement.style.width=isNaN(oe)?`${oe}`:`${oe}px`}f||(s.view&&(s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames()),s.runHooks("afterUpdateSettings",h)),c.adjustRowsAndCols(),s.view&&!p&&(s.forceFullRender=!0,d.lockEditor(),s._refreshBorders(null),s.view._wt.wtOverlays.adjustElementsSize(),d.unlockEditor()),!f&&s.view&&(ie===""||se===""||se===void 0)&&ie!==se&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const h=s.getSelectedLast();if(M.getValue){if(At(M.getValue))return M.getValue.call(s);if(h)return s.getData()[h[0][0]][M.getValue]}else if(h)return s.getDataAtCell(h[0],h[1])},this.getSettings=function(){return M},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(h,f,m,T,O){c.alter(h,f,m,T,O)},this.getCell=function(h,f){let m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,T=f,O=h;if(f>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(f)))return null;T=this.columnIndexMapper.getRenderableFromVisualIndex(f)}if(h>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(h)))return null;O=this.rowIndexMapper.getRenderableFromVisualIndex(h)}return O===null||T===null?null:s.view.getCellAtCoords(s._createCellCoords(O,T),m)},this.getCoords=function(h){const f=this.view._wt.wtTable.getCoords(h);if(f===null)return null;const{row:m,col:T}=f;let O=m,_=T;return m>=0&&(O=this.rowIndexMapper.getVisualFromRenderableIndex(m)),T>=0&&(_=this.columnIndexMapper.getVisualFromRenderableIndex(T)),s._createCellCoords(O,_)},this.colToProp=function(h){return l.colToProp(h)},this.propToCol=function(h){return l.propToCol(h)},this.toVisualRow=h=>this.rowIndexMapper.getVisualFromPhysicalIndex(h),this.toVisualColumn=h=>this.columnIndexMapper.getVisualFromPhysicalIndex(h),this.toPhysicalRow=h=>this.rowIndexMapper.getPhysicalFromVisualIndex(h),this.toPhysicalColumn=h=>this.columnIndexMapper.getPhysicalFromVisualIndex(h),this.getDataAtCell=function(h,f){return l.get(h,l.colToProp(f))},this.getDataAtRowProp=function(h,f){return l.get(h,f)},this.getDataAtCol=function(h){const f=[],m=l.getRange(s._createCellCoords(0,h),s._createCellCoords(M.data.length-1,h),l.DESTINATION_RENDERER);for(let T=0;T<m.length;T+=1)for(let O=0;O<m[T].length;O+=1)f.push(m[T][O]);return f},this.getDataAtProp=function(h){const f=[],m=l.getRange(s._createCellCoords(0,l.propToCol(h)),s._createCellCoords(M.data.length-1,l.propToCol(h)),l.DESTINATION_RENDERER);for(let T=0;T<m.length;T+=1)for(let O=0;O<m[T].length;O+=1)f.push(m[T][O]);return f},this.getSourceData=function(h,f,m,T){let O;return h===void 0?O=u.getData():O=u.getByRange(s._createCellCoords(h,f),s._createCellCoords(m,T)),O},this.getSourceDataArray=function(h,f,m,T){let O;return h===void 0?O=u.getData(!0):O=u.getByRange(s._createCellCoords(h,f),s._createCellCoords(m,T),!0),O},this.getSourceDataAtCol=function(h){return u.getAtColumn(h)},this.setSourceDataAtCell=function(h,f,m,T){const O=W(h,f,m),_=this.hasHook("afterSetSourceDataAtCell"),Y=[];_&&H(O,ie=>{let[se,oe,de]=ie;Y.push([se,oe,u.getAtCell(se,oe),de])}),H(O,ie=>{let[se,oe,de]=ie;u.setAtCell(se,oe,de)}),_&&this.runHooks("afterSetSourceDataAtCell",Y,T),this.render();const U=s.getActiveEditor();U&&Re(U.refreshValue)&&U.refreshValue()},this.getSourceDataAtRow=function(h){return u.getAtRow(h)},this.getSourceDataAtCell=function(h,f){return u.getAtCell(h,f)},this.getDataAtRow=function(h){return l.getRange(s._createCellCoords(h,0),s._createCellCoords(h,this.countCols()-1),l.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(h,f,m,T){const O=h===void 0?[0,0,this.countRows(),this.countCols()]:[h,f,m,T],[_,Y]=O;let[,,U,ie]=O,se=null,oe=null;U===void 0&&(U=_),ie===void 0&&(ie=Y);let de="mixed";return xe(Math.max(Math.min(_,U),0),Math.max(_,U),Ce=>{let pe=!0;return xe(Math.max(Math.min(Y,ie),0),Math.max(Y,ie),we=>(oe=this.getCellMeta(Ce,we).type,se?pe=se===oe:se=oe,pe)),de=pe?oe:"mixed",pe}),de},this.removeCellMeta=function(h,f,m){const[T,O]=[this.toPhysicalRow(h),this.toPhysicalColumn(f)];let _=I.getCellMetaKeyValue(T,O,m);s.runHooks("beforeRemoveCellMeta",h,f,m,_)!==!1&&(I.removeCellMeta(T,O,m),s.runHooks("afterRemoveCellMeta",h,f,m,_)),_=null},this.spliceCellsMeta=function(h){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var m=arguments.length,T=new Array(m>2?m-2:0),O=2;O<m;O++)T[O-2]=arguments[O];if(T.length>0&&!Array.isArray(T[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");f>0&&I.removeRow(this.toPhysicalRow(h),f),T.length>0&&H(T.reverse(),_=>{I.createRow(this.toPhysicalRow(h)),H(_,(Y,U)=>this.setCellMetaObject(h,U,Y))}),s.render()},this.setCellMetaObject=function(h,f,m){typeof m=="object"&&Ze(m,(T,O)=>{this.setCellMeta(h,f,O,T)})},this.setCellMeta=function(h,f,m,T){if(s.runHooks("beforeSetCellMeta",h,f,m,T)===!1)return;let _=h,Y=f;h<this.countRows()&&(_=this.toPhysicalRow(h)),f<this.countCols()&&(Y=this.toPhysicalColumn(f)),I.setCellMeta(_,Y,m,T),s.runHooks("afterSetCellMeta",h,f,m,T)},this.getCellsMeta=function(){return I.getCellsMeta()},this.getCellMeta=function(h,f){let m=this.toPhysicalRow(h),T=this.toPhysicalColumn(f);return m===null&&(m=h),T===null&&(T=f),I.getCellMeta(m,T,{visualRow:h,visualColumn:f})},this.getCellMetaAtRow=function(h){return I.getCellsMetaAtRow(h)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||M.columns)},this.getCellRenderer=function(h,f){const m=typeof h=="number"?s.getCellMeta(h,f).renderer:h.renderer;return typeof m=="string"?Nf(m):It(m)?Nf("text"):m},this.getCellEditor=function(h,f){const m=typeof h=="number"?s.getCellMeta(h,f).editor:h.editor;return typeof m=="string"?xf(m):It(m)?xf("text"):m},this.getCellValidator=function(h,f){const m=typeof h=="number"?s.getCellMeta(h,f).validator:h.validator;return typeof m=="string"?OS(m):m},this.validateCells=function(h){this._validateCells(h)},this.validateRows=function(h,f){if(!Array.isArray(h))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(f,h)},this.validateColumns=function(h,f){if(!Array.isArray(h))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(f,void 0,h)},this._validateCells=function(h,f,m){const T=new b;h&&(T.onQueueEmpty=h);let O=s.countRows()-1;for(;O>=0;){if(f!==void 0&&f.indexOf(O)===-1){O-=1;continue}let _=s.countCols()-1;for(;_>=0;){if(m!==void 0&&m.indexOf(_)===-1){_-=1;continue}T.addValidatorToQueue(),s.validateCell(s.getDataAtCell(O,_),s.getCellMeta(O,_),Y=>{if(typeof Y!="boolean")throw new Error("Validation error: result is not boolean");Y===!1&&(T.valid=!1),T.removeValidatorFormQueue()},"validateCells"),_-=1}O-=1}T.checkIfQueueIsEmpty()},this.getRowHeader=function(h){let f=M.rowHeaders,m=h;return m!==void 0&&(m=s.runHooks("modifyRowHeader",m)),m===void 0?(f=[],xe(s.countRows()-1,T=>{f.push(s.getRowHeader(T))})):Array.isArray(f)&&f[m]!==void 0?f=f[m]:At(f)?f=f(m):f&&typeof f!="string"&&typeof f!="number"&&(f=m+1),f},this.hasRowHeaders=function(){return!!M.rowHeaders},this.hasColHeaders=function(){if(M.colHeaders!==void 0&&M.colHeaders!==null)return!!M.colHeaders;for(let h=0,f=s.countCols();h<f;h++)if(s.getColHeader(h))return!0;return!1},this.getColHeader=function(h){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const m=s.runHooks("modifyColHeader",h);if(m===void 0){const U=[],ie=s.countCols();for(let se=0;se<ie;se++)U.push(s.getColHeader(se));return U}let T=M.colHeaders;const O=function(U){const ie=[],se=s.countCols();let oe=0;for(;oe<se;oe++)At(M.columns)&&M.columns(oe)&&ie.push(oe);return ie[U]},_=s.toPhysicalColumn(m),Y=O(_);return M.colHeaders===!1?T=null:M.columns&&At(M.columns)&&M.columns(Y)&&M.columns(Y).title?T=M.columns(Y).title:M.columns&&M.columns[_]&&M.columns[_].title?T=M.columns[_].title:Array.isArray(M.colHeaders)&&M.colHeaders[_]!==void 0?T=M.colHeaders[_]:At(M.colHeaders)?T=M.colHeaders(_):M.colHeaders&&typeof M.colHeaders!="string"&&typeof M.colHeaders!="number"&&(T=Yg(m)),T=s.runHooks("modifyColumnHeaderValue",T,h,f),T},this._getColWidthFromSettings=function(h){let f;if(h>=0&&(f=s.getCellMeta(0,h).width),(f===void 0||f===M.width)&&(f=M.colWidths),f!=null){switch(typeof f){case"object":f=f[h];break;case"function":f=f(h);break}typeof f=="string"&&(f=parseInt(f,10))}return f},this.getColWidth=function(h){let f=s._getColWidthFromSettings(h);return f=s.runHooks("modifyColWidth",f,h),f===void 0&&(f=IS.DEFAULT_WIDTH),f},this._getRowHeightFromSettings=function(h){let f=M.rowHeights;if(f!=null){switch(typeof f){case"object":f=f[h];break;case"function":f=f(h);break}typeof f=="string"&&(f=parseInt(f,10))}return f},this.getRowHeight=function(h){let f=s._getRowHeightFromSettings(h);return f=s.runHooks("modifyRowHeight",f,h),f},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){const h=M.maxCols,f=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(h,f)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,f=0;return Df(s.countRows()-1,m=>{if(s.isEmptyRow(m))f+=1;else if(h===!0)return!1}),f},this.countEmptyCols=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,f=0;return Df(s.countCols()-1,m=>{if(s.isEmptyCol(m))f+=1;else if(h===!0)return!1}),f},this.isEmptyRow=function(h){return M.isEmptyRow.call(s,h)},this.isEmptyCol=function(h){return M.isEmptyCol.call(s,h)},this.selectCell=function(h,f,m,T){let O=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,_=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return It(h)||It(f)?!1:this.selectCells([[h,f,m,T]],O,_)},this.selectCells=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;f===!1&&(o=!0);const T=X.selectCells(h);return T&&m&&s.listen(),o=!1,T},this.selectColumns=function(h){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h,m=arguments.length>2?arguments[2]:void 0;return X.selectColumns(h,f,m)},this.selectRows=function(h){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h,m=arguments.length>2?arguments[2]:void 0;return X.selectRows(h,f,m)},this.deselectCell=function(){X.deselect()},this.selectAll=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h,m=arguments.length>2?arguments[2]:void 0;o=!0,X.selectAll(h,f,m),o=!1};const B=(h,f)=>h.getNearestNotHiddenIndex(f,1,!0);this.scrollViewportTo=function(h){var f;if(typeof h=="number"){var m;h={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(m=arguments[4])!==null&&m!==void 0?m:!0}}const{row:T,col:O,verticalSnap:_,horizontalSnap:Y,considerHiddenIndexes:U}=(f=h)!==null&&f!==void 0?f:{};let ie,se,oe,de;_!==void 0&&(ie=_==="top",se=!ie),Y!==void 0&&(oe=Y==="start",de=!oe);let Ce=T,pe=O;if(U===void 0||U){const ye=Number.isInteger(T)&&T>=0,$e=Number.isInteger(O)&&O>=0,Ae=ye?B(this.rowIndexMapper,T):void 0,Fe=$e?B(this.columnIndexMapper,O):void 0;if(Ae===null||Fe===null)return!1;Ce=ye?s.rowIndexMapper.getRenderableFromVisualIndex(Ae):T,pe=$e?s.columnIndexMapper.getRenderableFromVisualIndex(Fe):O}const we=Number.isInteger(Ce),ee=Number.isInteger(pe);return we&&Ce>=0&&ee&&pe>=0?s.view.scrollViewport(s._createCellCoords(Ce,pe),ie,de,se,oe):we&&Ce>=0&&(ee&&pe<0||!ee)?s.view.scrollViewportVertically(Ce,ie,se):ee&&pe>=0&&(we&&Ce<0||!we)?s.view.scrollViewportHorizontally(pe,de,oe):!1},this.scrollToFocusedCell=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",h);const{highlight:f}=this.getSelectedRangeLast();this.scrollViewportTo(f.toObject())?this.view.render():(this.removeHook("afterScroll",h),this._registerImmediate(()=>h()))},this.destroy=function(){if(s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),u&&u.destroy(),u=null,this.getShortcutManager().destroy(),I.clearCache(),Ep.delete(this.guid),Jd(s)){const h=this.rootDocument.querySelector(".hot-display-license-info");h&&h.parentNode.removeChild(h)}vi(s.rootElement),a.destroy(),d&&d.destroy(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),$.getItems().forEach(h=>{let[,f]=h;f.destroy()}),$.clear(),s.runHooks("afterDestroy")},!0),_e.getSingleton().destroy(s),Ze(s,(h,f,m)=>{At(h)?m[f]=z(f):f!=="guid"&&(m[f]=null)}),s.isDestroyed=!0,l&&l.destroy(),l=null,c=null,X=null,d=null,s=null};function z(h){return()=>{throw new Error(`The "${h}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return d.getActiveEditor()},this.getPlugin=function(h){const f=Wn(h);return f==="UndoRedo"?this.undoRedo:$.getItem(f)},this.getPluginName=function(h){return h===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:$.getId(h)},this.getInstance=function(){return s},this.addHook=function(h,f){_e.getSingleton().add(h,f,s)},this.hasHook=function(h){return _e.getSingleton().has(h,s)||_e.getSingleton().has(h)},this.addHookOnce=function(h,f){_e.getSingleton().once(h,f,s)},this.removeHook=function(h,f){_e.getSingleton().remove(h,f,s)},this.runHooks=function(h,f,m,T,O,_,Y){return _e.getSingleton().run(s,h,f,m,T,O,_,Y)},this.getTranslatedPhrase=function(h,f){return Mx(M.language,h,f)},this.toHTML=()=>HC(this),this.toTableElement=()=>{const h=this.rootDocument.createElement("div");return h.insertAdjacentHTML("afterbegin",HC(this)),h.firstElementChild},this.timeouts=[],this._registerTimeout=function(h){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,m=h;typeof m=="function"&&(m=setTimeout(m,f)),this.timeouts.push(m)},this._clearTimeouts=function(){H(this.timeouts,h=>{clearTimeout(h)})},this.immediates=[],this._registerImmediate=function(h){this.immediates.push(setImmediate(h))},this._clearImmediates=function(){H(this.immediates,h=>{clearImmediate(h)})},this._refreshBorders=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;d.destroyEditor(h),s.view.render(),f&&X.isSelected()&&d.prepareEditor()},this._getEditorManager=function(){return d},this.isRtl=function(){return s.rootWindow.getComputedStyle(s.rootElement).direction==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1};const w=s6({handleEvent(){return s.isListening()},beforeKeyDown:h=>this.runHooks("beforeKeyDown",h),afterKeyDown:h=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",h)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",h=>{h.ctrlKey===!1&&h.metaKey===!1&&w.releasePressedKeys()}),this.getShortcutManager=function(){return w},this.getFocusManager=function(){return g},MS().forEach(h=>{const f=nh(h);$.addItem(h,new f(this))}),Z4(s),w.setActiveContextName("grid"),_e.getSingleton().run(s,"construct")}const a6="hooksRefRegisterer",zx={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){H(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Ze(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};Ji(zx,"MIXIN_NAME",a6,{writable:!1,enumerable:!1});const l6=zx;function ti(t,e,n){return e=u6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u6(t){var e=c6(t,"string");return typeof e=="symbol"?e:String(e)}function c6(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const h6="base",gn=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),qC="baseEditor";class Ql{static get EDITOR_TYPE(){return h6}constructor(e){ti(this,"hot",void 0),ti(this,"state",gn.VIRGIN),ti(this,"_opened",!1),ti(this,"_fullEditMode",!1),ti(this,"_closeCallback",null),ti(this,"TD",null),ti(this,"row",null),ti(this,"col",null),ti(this,"prop",null),ti(this,"originalValue",null),ti(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,r,i,o,s){this.TD=i,this.row=e,this.col=n,this.prop=r,this.originalValue=o,this.cellProperties=s,this.state=gn.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let r,i,o,s;if(n){const d=this.hot.getSelectedLast();r=Math.max(Math.min(d[0],d[2]),0),i=Math.max(Math.min(d[1],d[3]),0),o=Math.max(d[0],d[2]),s=Math.max(d[1],d[3])}else[r,i,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",r,i);Array.isArray(a)&&([r,i]=a);const u=this.hot.getShortcutManager().getContext("editor"),c={runOnlyIf:()=>Re(this.hot.getSelected()),group:qC};this.isInFullEditMode()&&u.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],c),this.hot.populateFromArray(r,i,e,o,s,"edit")}beginEditing(e,n){if(this.state!==gn.VIRGIN)return;const r=this.hot,i=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=r.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(r.view.scrollViewport(r._createCellCoords(i,o)),this.state=gn.EDITING,this.isInFullEditMode()){const s=typeof e=="string"?e:Zt(this.originalValue);this.setValue(s)}this.open(n),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(e,n,r){let i;if(r){const a=this._closeCallback;this._closeCallback=l=>{a&&a(l),r(l),this.hot.view.render()}}if(this.isWaiting())return;const s=this.hot.getShortcutManager().getContext("editor");if(s.removeShortcutsByGroup(qC),s.removeShortcutsByGroup(Vg),this.state===gn.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===gn.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const a=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof a=="string"?String.prototype.trim.call(a||""):a]]:i=[[a]],this.state=gn.WAITING,this.saveValue(i,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",l=>{this.state=gn.FINISHED,this.discardEditor(l)}):(this.state=gn.FINISHED,this.discardEditor(!0))}}cancelChanges(){this.state=gn.FINISHED,this.discardEditor()}discardEditor(e){this.state===gn.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=gn.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=gn.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===gn.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:r,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=ln(n),a=yt(n),l=ln(this.hot.rootElement),u=yt(this.hot.rootElement),c=r.topOverlay.holder,d=r.inlineStartOverlay.holder,g=c!==o?c.scrollTop:0,p=d!==o?d.scrollLeft:0,C=o.innerWidth-l.left-u,{wtTable:E}=(e=r.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,I=E.name,M=["master","inline_start"].includes(I)?g:0,y=["master","top","bottom"].includes(I)?p:0,$=s.top===l.top?0:1;let q=s.top-l.top-$-M,G=0;this.hot.isRtl()?G=o.innerWidth-s.left-a-C-1+y:G=s.left-l.left-1-y,["top","top_inline_start_corner"].includes(I)&&(q+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(I)&&(G+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const X=this.hot.hasColHeaders(),re=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),v=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),b=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(X&&re<=0||re===b)&&(q+=1),v<=0&&(G+=1);const L=i.rowsRenderCalculator.startPosition,P=i.columnsRenderCalculator.startPosition,x=Math.abs(r.inlineStartOverlay.getScrollPosition()),W=r.topOverlay.getScrollPosition(),D=Cn(this.hot.rootDocument);let B=n.offsetTop;if(["inline_start","master"].includes(I)&&(B+=L-W),["bottom","bottom_inline_start_corner"].includes(I)){const{wtViewport:se,wtTable:oe}=r.bottomOverlay.clone;B+=se.getWorkspaceHeight()-oe.getHeight()-D}let z=n.offsetLeft;this.hot.isRtl()?(z>=0?z=E.getWidth()-n.offsetLeft:z=Math.abs(z),z+=P-x-a):["top","master","bottom"].includes(I)&&(z+=P-x);const w=No(this.TD,this.hot.rootWindow),h=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",f=parseInt(w[h],10)>0?0:1,m=parseInt(w.borderTopWidth,10)>0?0:1,T=yt(n)+f,O=Bt(n)+m,_=tP(c)?D:0,Y=nP(d)?D:0,U=this.hot.view.maximumVisibleElementWidth(z)-_+f,ie=Math.max(this.hot.view.maximumVisibleElementHeight(B)-Y+m,23);return{top:q,start:G,height:O,maxHeight:ie,width:T,maxWidth:U}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}_t(Ql,l6);function HE(t,e,n){t.addEventListener(e,n,!1)}function DE(t,e,n){t.removeEventListener(e,n,!1)}function NE(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function d6(t){const e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},n=t.body,r=t.createTextNode(""),i=t.createElement("span");let o;function s(){r.textContent=o.value,i.style.position="absolute",i.style.fontSize=NE(o).fontSize,i.style.fontFamily=NE(o).fontFamily,i.style.whiteSpace="pre",n.appendChild(i);const c=i.clientWidth+2;n.removeChild(i);const d=o.style;d.height=`${e.minHeight}px`,e.minWidth>c?d.width=`${e.minWidth}px`:c>e.maxWidth?d.width=`${e.maxWidth}px`:d.width=`${c}px`;const g=o.scrollHeight?o.scrollHeight-1:0;e.minHeight>g?d.height=`${e.minHeight}px`:e.maxHeight<g?(d.height=`${e.maxHeight}px`,d.overflowY="visible"):d.height=`${g}px`}function a(){t.defaultView.setTimeout(s,0)}function l(c){if(c&&c.minHeight)if(c.minHeight==="inherit")e.minHeight=o.clientHeight;else{const d=parseInt(c.minHeight,10);isNaN(d)||(e.minHeight=d)}if(c&&c.maxHeight)if(c.maxHeight==="inherit")e.maxHeight=o.clientHeight;else{const d=parseInt(c.maxHeight,10);isNaN(d)||(e.maxHeight=d)}if(c&&c.minWidth)if(c.minWidth==="inherit")e.minWidth=o.clientWidth;else{const d=parseInt(c.minWidth,10);isNaN(d)||(e.minWidth=d)}if(c&&c.maxWidth)if(c.maxWidth==="inherit")e.maxWidth=o.clientWidth;else{const d=parseInt(c.maxWidth,10);isNaN(d)||(e.maxWidth=d)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(r))}function u(c,d){let g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;o=c,l(d),o.nodeName==="TEXTAREA"&&(o.style.resize="none",o.style.overflowY="",o.style.height=`${e.minHeight}px`,o.style.minWidth=`${e.minWidth}px`,o.style.maxWidth=`${e.maxWidth}px`,o.style.overflowY="hidden"),g&&(HE(o,"input",s),HE(o,"keydown",a)),s()}return{init:u,resize:s,unObserve(){DE(o,"input",s),DE(o,"keydown",a)}}}function LE(t,e){const n=fS(e),r=e.value.split(`
`);let i=n,o=0;for(let s=0;s<r.length;s++){const a=r[s];s!==0&&(o+=r[s-1].length+1);const l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),n<=l)break}Qc(e,i)}function Ws(t,e,n){return e=f6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f6(t){var e=g6(t,"string");return typeof e=="symbol"?e:String(e)}function g6(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const m6="ht_editor_visible",qh="ht_editor_hidden",$E="textEditor",p6="text";class Ha extends Ql{static get EDITOR_TYPE(){return p6}constructor(e){super(e),Ws(this,"eventManager",new Mr(this)),Ws(this,"autoResize",d6(this.hot.rootDocument)),Ws(this,"TEXTAREA",void 0),Ws(this,"textareaStyle",void 0),Ws(this,"TEXTAREA_PARENT",void 0),Ws(this,"textareaParentStyle",void 0),Ws(this,"layerClass",void 0),this.eventManager=new Mr(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),KI(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,n,r,i,o,s){const a=this.state;if(super.prepare(e,n,r,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&(this.TEXTAREA.value=""),a!==gn.FINISHED&&this.hideEditableElement()}}beginEditing(e,n){this.state===gn.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),Qc(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Ne(this.TEXTAREA,[["data-hot-input",""],Kl(-1)]),this.hot.getSettings().ariaTags&&Ne(this.TEXTAREA,[Vo()]),ce(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),ce(this.TEXTAREA_PARENT,"handsontableInputHolder"),Ve(this.TEXTAREA_PARENT,this.layerClass)&&Ye(this.TEXTAREA_PARENT,this.layerClass),ce(this.TEXTAREA_PARENT,qh),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){pP()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Ye(this.TEXTAREA_PARENT,this.layerClass),ce(this.TEXTAREA_PARENT,qh)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;xe(e.length-1,r=>{const i=e[r];if(Ve(i,"handsontableEditor"))return n=!0,!1}),Ve(this.TEXTAREA_PARENT,qh)&&Ye(this.TEXTAREA_PARENT,qh),n?(this.layerClass=m6,ce(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),ce(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==gn.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:r,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const l=No(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const u=No(this.TEXTAREA),c=parseInt(u.paddingLeft,10)+parseInt(u.paddingRight,10),d=parseInt(u.paddingTop,10)+parseInt(u.paddingBottom,10),g=i-c,p=s-d,C=o-c,E=a-d;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(g,C),minHeight:Math.min(p,E),maxWidth:C,maxHeight:E},!0)}bindEvents(){SS()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===gn.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===gn.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("editor"),r=e.getContext("grid"),i={runOnlyIf:()=>Re(this.hot.getSelected()),group:$E},o=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Tab"],["Shift","Tab"],["PageUp"],["PageDown"]],forwardToContext:r,callback:()=>{}},{keys:[["Control","Enter"]],callback:()=>(o(),!1),runOnlyIf:s=>!this.hot.selection.isMultiple()&&!s.altKey},{keys:[["Meta","Enter"]],callback:()=>(o(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(o(),!1)},{keys:[["Home"]],callback:(s,a)=>{let[l]=a;LE(l,this.TEXTAREA)}},{keys:[["End"]],callback:(s,a)=>{let[l]=a;LE(l,this.TEXTAREA)}}],i)}unregisterShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");n.removeShortcutsByGroup(Vg),n.removeShortcutsByGroup($E),n.removeShortcutsByGroup(qC)}}const w6="base";function sh(t,e,n,r,i,o,s){const a=s.ariaTags,l=[],u=[],c=[],d=[];s.className&&ce(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&d.push(p0())):a&&c.push(p0()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&d.push(w0())):(u.push(s.invalidCellClassName),a&&c.push(w0()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),Ye(e,u),ce(e,l),Ia(e,c),Ne(e,d)}sh.RENDERER_TYPE=w6;const C6="text";function Go(t,e,n,r,i,o,s){sh.apply(this,[t,e,n,r,i,o,s]);let a=o;if(!a&&s.placeholder&&(a=s.placeholder),a=Zt(a),s.trimWhitespace&&(a=a.trim()),s.rendererTemplate){vi(e);const l=t.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=s.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=t.getSourceDataAtRow(n),e.appendChild(l)}else Ts(e,a)}Go.RENDERER_TYPE=C6;const v6="text",jx={CELL_TYPE:v6,editor:Ha,renderer:Go};$r(jx);Be.editors={BaseEditor:Ql};function Be(t,e){const n=new Gx(t,e||{},qS);return n.init(),n}Be.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Gx(t,e,qS)};Be.DefaultSettings=kx();Be.hooks=_e.getSingleton();Be.CellCoords=$f;Be.CellRange=HS;Be.packageName="handsontable";Be.buildDate="30/11/2023 10:10:40";Be.version="14.0.0";Be.languages={dictionaryKeys:kq,getLanguageDictionary:_x,getLanguagesDictionaries:Uq,registerLanguageDictionary:Tx,getTranslatedPhrase:Mx};const kE="handsontableEditor",S6="handsontable";class Ib extends Ha{static get EDITOR_TYPE(){return S6}open(){super.open(),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Qc(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,afterOnCellMouseDown(u,c){const d=this.getSourceData(c.row,c.col);d!==void 0&&a.setValue(d),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&un(l,s.handsontable),this.htOptions=l}beginEditing(e,n){const r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,n,r)}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const r={group:kE,relativeToGroup:Vg,position:"before"},i=(o,s)=>{const a=this.htEditor;if(o!==void 0&&(o<0||a.flipped&&o>a.countRows()-1?a.deselectCell():a.selectCell(o,0),a.getData().length))return s.preventDefault(),Kr(s),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const s=this.htEditor;let a,l;return!s.getSelectedLast()&&s.flipped?a=s.countRows()-1:s.getSelectedLast()&&(s.flipped?(l=s.getSelectedLast()[0],a=Math.max(0,l-1)):(l=s.getSelectedLast()[0],a=l-1)),i(a,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const s=this.htEditor;let a,l;if(!s.getSelectedLast()&&!s.flipped)a=0;else if(s.getSelectedLast()){if(s.flipped)a=s.getSelectedLast()[0]+1;else if(!s.flipped){const u=s.countRows()-1;l=s.getSelectedLast()[0],a=Math.min(u,l+1)}}return i(a,o)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(kE)}}function y6(t,e,n){b6(t,e),e.set(t,n)}function b6(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xh(t,e,n){return e=R6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function R6(t){var e=E6(t,"string");return typeof e=="symbol"?e:String(e)}function E6(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function FE(t,e){var n=T6(t,e,"get");return _6(t,n)}function T6(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function _6(t,e){return e.get?e.get.call(t):e.value}const M6="autocomplete";var Tp=new WeakMap;class Pb extends Ib{constructor(){super(...arguments),Xh(this,"query",null),Xh(this,"strippedChoices",[]),Xh(this,"rawChoices",[]),y6(this,Tp,{writable:!0,value:this.hot.guid.slice(0,9)}),Xh(this,"sortByRelevance",function(e,n,r){const i=[],o=[],s=e.length;let a=n.length,l,u,c,d;if(s===0){for(c=0;c<a;c++)o.push(c);return o}for(c=0;c<a;c++){if(u=MC(Zt(n[c])),r)d=u.indexOf(e);else{const g=this.cellProperties.locale;d=u.toLocaleLowerCase(g).indexOf(e.toLocaleLowerCase(g))}d!==-1&&(l=u.length-d-s,i.push({baseIndex:c,index:d,charsLeft:l,value:u}))}for(i.sort((g,p)=>{if(p.index===-1)return-1;if(g.index===-1)return 1;if(g.index<p.index)return-1;if(p.index<g.index)return 1;if(g.index===p.index){if(g.charsLeft<p.charsLeft)return-1;if(g.charsLeft>p.charsLeft)return 1}return 0}),c=0,a=i.length;c<a;c++)o.push(i[c].baseIndex);return o})}static get EDITOR_TYPE(){return M6}getValue(){const e=this.rawChoices.find(n=>this.stripValueIfNeeded(n)===this.TEXTAREA.value);return Re(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),ce(this.htContainer,"autocompleteEditor"),ce(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&Ne(this.TEXTAREA,[YY(),FY(),YI("listbox"),qY()])}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.hot.getSettings().ariaTags&&Ne(this.TEXTAREA,[Ur("false"),XY(`${FE(this,Tp)}-listbox-${e}-${n}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,r=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=r==null?void 0:r.length,{row:o,col:s}=this;this.showEditableElement(),this.focus();let a=Cn();a===0&&Hc()&&(a+=15),this.addHook("beforeKeyDown",l=>this.onBeforeKeyDown(l)),this.htEditor.updateSettings({colWidths:e?[yt(this.TEXTAREA)-2]:void 0,width:e?yt(this.TEXTAREA)+a:void 0,autoColumnSize:!0,renderer:(l,u,c,d,g,p,C)=>{Go(l,u,c,d,g,p,C);const{filteringCaseSensitive:E,allowHtml:I,locale:M}=this.cellProperties,y=this.query;let $=Zt(p),q,G;$&&!I&&(q=E===!0?$.indexOf(y):$.toLocaleLowerCase(M).indexOf(y.toLocaleLowerCase(M)),q!==-1&&(G=$.substr(q,y.length),$=$.replace(G,`<strong>${G}</strong>`))),n&&Ne(u,[WY(),...r?[eG(i)]:[],...r?[tG(r.indexOf(p)+1)]:[],["id",`${this.htEditor.rootElement.id}_${c}-${d}`]]),u.innerHTML=$},afterSelection:(l,u)=>{if(n){const c=this.htEditor.getCell(l,u,!0);Ne(c,[cS()]),Ne(this.TEXTAREA,...ZY(c.id))}}}),n&&(Ne(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...Gi()),Ne(this.htEditor.rootElement,[UI(),QY("polite"),JY("text"),["id",`${FE(this,Tp)}-listbox-${o}-${s}`]]),Ne(this.TEXTAREA,...Ur("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&Ne(this.TEXTAREA,[Ur("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=fS(this.TEXTAREA),r=eP(this.TEXTAREA),i=this.cellProperties.sortByRelevance,o=this.cellProperties.filter;let s=null,a=null,l=e;i&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(s)?s.length:0;if(o===!1)u&&(a=s[0]);else{const c=[];for(let d=0,g=l.length;d<g&&!(i&&u<=d);d++)u?c.push(l[s[d]]):c.push(l[d]);a=0,l=c}this.strippedChoices=l,this.htEditor.loadData(sc([l])),l.length===0?this.htEditor.rootElement.style.display="none":(this.htEditor.rootElement.style.display="",this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),Qc(this.TEXTAREA,n,n===r?void 0:r)}flipDropdownIfNeeded(){const e=va(this.hot.view._wt.wtTable.TABLE),n=e===this.hot.rootWindow,r=this.cellProperties.preventOverflow;if(n||!n&&(r||r==="horizontal"))return!1;const i=ln(this.TEXTAREA),o=Bt(this.TEXTAREA),s=this.getDropdownHeight(),a=e.scrollTop,l=Bt(this.hot.view._wt.wtTable.THEAD),u=ln(e),c=i.top-u.top-l+a,d=e.scrollHeight-c-l-o,g=s>d&&c>d;return g?this.flipDropdown(s):this.unflipDropdown(),this.limitDropdownIfNeeded(g?c:d,s),g}limitDropdownIfNeeded(e,n){if(n>e){let r=0,i=0,o=0,s=null;do o=this.htEditor.getRowHeight(i)||this.htEditor.view._wt.getSetting("defaultRowHeight"),r+=o,i+=1;while(r<e);s=r-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-s}px`),this.setDropdownHeight(r-o)}}flipDropdown(e){const n=this.htEditor.rootElement.style;n.position="absolute",n.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownHeight(){const e=this.htEditor.getColWidth(0)+Cn(this.hot.rootDocument)+2,n=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:n?void 0:e}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){const e=this.htEditor.getRowHeight(0)||23,n=this.cellProperties.visibleRows;return this.strippedChoices.length>=n?n*e:this.strippedChoices.length*e+8}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,r=Xe(e,o=>Zt(o));return Xe(r,o=>n?o:MC(o))}allowKeyEventPropagation(e){const n=this.htEditor.getSelectedRangeLast(),r={row:n?n.from.row:-1};let i=!1;return e===Pe.ARROW_DOWN&&r.row>0&&r.row<this.htEditor.countRows()-1&&(i=!0),e===Pe.ARROW_UP&&r.row>-1&&(i=!0),i}onBeforeKeyDown(e){if(wP(e.keyCode)||e.keyCode===Pe.BACKSPACE||e.keyCode===Pe.DELETE||e.keyCode===Pe.INSERT){let n=10;if(e.keyCode===Pe.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}const O6="checkbox";class Kx extends Ql{static get EDITOR_TYPE(){return O6}beginEditing(e,n){if(n&&n.type==="mouseup"){const r=this.TD.querySelector('input[type="checkbox"]');Ve(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}var Bf={},A6={get exports(){return Bf},set exports(t){Bf=t}};const I6=pN(SY);/*!
 * Pikaday
 *
 * Copyright Â© 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */(function(t,e){(function(n,r){var i;{try{i=I6}catch{}t.exports=r(i)}})(Xu,function(n){var r=typeof n=="function",i=!!window.addEventListener,o=window.document,s=window.setTimeout,a=function(w,h,f,m){i?w.addEventListener(h,f,!!m):w.attachEvent("on"+h,f)},l=function(w,h,f,m){i?w.removeEventListener(h,f,!!m):w.detachEvent("on"+h,f)},u=function(w){return w.trim?w.trim():w.replace(/^\s+|\s+$/g,"")},c=function(w,h){return(" "+w.className+" ").indexOf(" "+h+" ")!==-1},d=function(w,h){c(w,h)||(w.className=w.className===""?h:w.className+" "+h)},g=function(w,h){w.className=u((" "+w.className+" ").replace(" "+h+" "," "))},p=function(w){return/Array/.test(Object.prototype.toString.call(w))},C=function(w){return/Date/.test(Object.prototype.toString.call(w))&&!isNaN(w.getTime())},E=function(w){var h=w.getDay();return h===0||h===6},I=function(w){return w%4===0&&w%100!==0||w%400===0},M=function(w,h){return[31,I(w)?29:28,31,30,31,30,31,31,30,31,30,31][h]},y=function(w){C(w)&&w.setHours(0,0,0,0)},$=function(w,h){return w.getTime()===h.getTime()},q=function(w,h,f){var m,T;for(m in h)T=w[m]!==void 0,T&&typeof h[m]=="object"&&h[m]!==null&&h[m].nodeName===void 0?C(h[m])?f&&(w[m]=new Date(h[m].getTime())):p(h[m])?f&&(w[m]=h[m].slice(0)):w[m]=q({},h[m],f):(f||!T)&&(w[m]=h[m]);return w},G=function(w,h,f){var m;o.createEvent?(m=o.createEvent("HTMLEvents"),m.initEvent(h,!0,!1),m=q(m,f),w.dispatchEvent(m)):o.createEventObject&&(m=o.createEventObject(),m=q(m,f),w.fireEvent("on"+h,m))},X=function(w){return w.month<0&&(w.year-=Math.ceil(Math.abs(w.month)/12),w.month+=12),w.month>11&&(w.year+=Math.floor(Math.abs(w.month)/12),w.month-=12),w},re={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},v=function(w,h,f){for(h+=w.firstDay;h>=7;)h-=7;return f?w.i18n.weekdaysShort[h]:w.i18n.weekdays[h]},S=function(w){var h=[],f="false";if(w.isEmpty)if(w.showDaysInNextAndPreviousMonths)h.push("is-outside-current-month"),w.enableSelectionDaysInNextAndPreviousMonths||h.push("is-selection-disabled");else return'<td class="is-empty"></td>';return w.isDisabled&&h.push("is-disabled"),w.isToday&&h.push("is-today"),w.isSelected&&(h.push("is-selected"),f="true"),w.hasEvent&&h.push("has-event"),w.isInRange&&h.push("is-inrange"),w.isStartRange&&h.push("is-startrange"),w.isEndRange&&h.push("is-endrange"),'<td data-day="'+w.day+'" class="'+h.join(" ")+'" aria-selected="'+f+'"><button class="pika-button pika-day" type="button" data-pika-year="'+w.year+'" data-pika-month="'+w.month+'" data-pika-day="'+w.day+'">'+w.day+"</button></td>"},b=function(w,h){w.setHours(0,0,0,0);var f=w.getDate(),m=w.getDay(),T=h,O=T-1,_=7,Y=function(de){return(de+_-1)%_};w.setDate(f+O-Y(m));var U=new Date(w.getFullYear(),0,T),ie=24*60*60*1e3,se=(w.getTime()-U.getTime())/ie,oe=1+Math.round((se-O+Y(U.getDay()))/_);return oe},L=function(w,h,f,m){var T=new Date(f,h,w),O=r?n(T).isoWeek():b(T,m);return'<td class="pika-week">'+O+"</td>"},P=function(w,h,f,m){return'<tr class="pika-row'+(f?" pick-whole-week":"")+(m?" is-selected":"")+'">'+(h?w.reverse():w).join("")+"</tr>"},x=function(w){return"<tbody>"+w.join("")+"</tbody>"},W=function(w){var h,f=[];for(w.showWeekNumber&&f.push("<th></th>"),h=0;h<7;h++)f.push('<th scope="col"><abbr title="'+v(w,h)+'">'+v(w,h,!0)+"</abbr></th>");return"<thead><tr>"+(w.isRTL?f.reverse():f).join("")+"</tr></thead>"},D=function(w,h,f,m,T,O){var _,Y,U,ie=w._o,se=f===ie.minYear,oe=f===ie.maxYear,de='<div id="'+O+'" class="pika-title" role="heading" aria-live="assertive">',Ce,pe,we=!0,ee=!0;for(U=[],_=0;_<12;_++)U.push('<option value="'+(f===T?_-h:12+_-h)+'"'+(_===m?' selected="selected"':"")+(se&&_<ie.minMonth||oe&&_>ie.maxMonth?' disabled="disabled"':"")+">"+ie.i18n.months[_]+"</option>");for(Ce='<div class="pika-label">'+ie.i18n.months[m]+'<select class="pika-select pika-select-month" tabindex="-1">'+U.join("")+"</select></div>",p(ie.yearRange)?(_=ie.yearRange[0],Y=ie.yearRange[1]+1):(_=f-ie.yearRange,Y=1+f+ie.yearRange),U=[];_<Y&&_<=ie.maxYear;_++)_>=ie.minYear&&U.push('<option value="'+_+'"'+(_===f?' selected="selected"':"")+">"+_+"</option>");return pe='<div class="pika-label">'+f+ie.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+U.join("")+"</select></div>",ie.showMonthAfterYear?de+=pe+Ce:de+=Ce+pe,se&&(m===0||ie.minMonth>=m)&&(we=!1),oe&&(m===11||ie.maxMonth<=m)&&(ee=!1),h===0&&(de+='<button class="pika-prev'+(we?"":" is-disabled")+'" type="button">'+ie.i18n.previousMonth+"</button>"),h===w._o.numberOfMonths-1&&(de+='<button class="pika-next'+(ee?"":" is-disabled")+'" type="button">'+ie.i18n.nextMonth+"</button>"),de+="</div>"},B=function(w,h,f){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+f+'">'+W(w)+x(h)+"</table>"},z=function(w){var h=this,f=h.config(w);h._onMouseDown=function(T){if(h._v){T=T||window.event;var O=T.target||T.srcElement;if(O)if(c(O,"is-disabled")||(c(O,"pika-button")&&!c(O,"is-empty")&&!c(O.parentNode,"is-disabled")?(h.setDate(new Date(O.getAttribute("data-pika-year"),O.getAttribute("data-pika-month"),O.getAttribute("data-pika-day"))),f.bound&&s(function(){h.hide(),f.blurFieldOnSelect&&f.field&&f.field.blur()},100)):c(O,"pika-prev")?h.prevMonth():c(O,"pika-next")&&h.nextMonth()),c(O,"pika-select"))h._c=!0;else if(T.preventDefault)T.preventDefault();else return T.returnValue=!1,!1}},h._onChange=function(T){T=T||window.event;var O=T.target||T.srcElement;O&&(c(O,"pika-select-month")?h.gotoMonth(O.value):c(O,"pika-select-year")&&h.gotoYear(O.value))},h._onKeyChange=function(T){if(T=T||window.event,h.isVisible())switch(T.keyCode){case 13:case 27:f.field&&f.field.blur();break;case 37:h.adjustDate("subtract",1);break;case 38:h.adjustDate("subtract",7);break;case 39:h.adjustDate("add",1);break;case 40:h.adjustDate("add",7);break;case 8:case 46:h.setDate(null);break}},h._parseFieldValue=function(){if(f.parse)return f.parse(f.field.value,f.format);if(r){var T=n(f.field.value,f.format,f.formatStrict);return T&&T.isValid()?T.toDate():null}else return new Date(Date.parse(f.field.value))},h._onInputChange=function(T){var O;T.firedBy!==h&&(O=h._parseFieldValue(),C(O)&&h.setDate(O),h._v||h.show())},h._onInputFocus=function(){h.show()},h._onInputClick=function(){h.show()},h._onInputBlur=function(){var T=o.activeElement;do if(c(T,"pika-single"))return;while(T=T.parentNode);h._c||(h._b=s(function(){h.hide()},50)),h._c=!1},h._onClick=function(T){T=T||window.event;var O=T.target||T.srcElement,_=O;if(O){!i&&c(O,"pika-select")&&(O.onchange||(O.setAttribute("onchange","return;"),a(O,"change",h._onChange)));do if(c(_,"pika-single")||_===f.trigger)return;while(_=_.parentNode);h._v&&O!==f.trigger&&_!==f.trigger&&h.hide()}},h.el=o.createElement("div"),h.el.className="pika-single"+(f.isRTL?" is-rtl":"")+(f.theme?" "+f.theme:""),a(h.el,"mousedown",h._onMouseDown,!0),a(h.el,"touchend",h._onMouseDown,!0),a(h.el,"change",h._onChange),f.keyboardInput&&a(o,"keydown",h._onKeyChange),f.field&&(f.container?f.container.appendChild(h.el):f.bound?o.body.appendChild(h.el):f.field.parentNode.insertBefore(h.el,f.field.nextSibling),a(f.field,"change",h._onInputChange),f.defaultDate||(f.defaultDate=h._parseFieldValue(),f.setDefaultDate=!0));var m=f.defaultDate;C(m)?f.setDefaultDate?h.setDate(m,!0):h.gotoDate(m):h.gotoDate(new Date),f.bound?(this.hide(),h.el.className+=" is-bound",a(f.trigger,"click",h._onInputClick),a(f.trigger,"focus",h._onInputFocus),a(f.trigger,"blur",h._onInputBlur)):this.show()};return z.prototype={config:function(w){this._o||(this._o=q({},re,!0));var h=q(this._o,w,!0);h.isRTL=!!h.isRTL,h.field=h.field&&h.field.nodeName?h.field:null,h.theme=typeof h.theme=="string"&&h.theme?h.theme:null,h.bound=!!(h.bound!==void 0?h.field&&h.bound:h.field),h.trigger=h.trigger&&h.trigger.nodeName?h.trigger:h.field,h.disableWeekends=!!h.disableWeekends,h.disableDayFn=typeof h.disableDayFn=="function"?h.disableDayFn:null;var f=parseInt(h.numberOfMonths,10)||1;if(h.numberOfMonths=f>4?4:f,C(h.minDate)||(h.minDate=!1),C(h.maxDate)||(h.maxDate=!1),h.minDate&&h.maxDate&&h.maxDate<h.minDate&&(h.maxDate=h.minDate=!1),h.minDate&&this.setMinDate(h.minDate),h.maxDate&&this.setMaxDate(h.maxDate),p(h.yearRange)){var m=new Date().getFullYear()-10;h.yearRange[0]=parseInt(h.yearRange[0],10)||m,h.yearRange[1]=parseInt(h.yearRange[1],10)||m}else h.yearRange=Math.abs(parseInt(h.yearRange,10))||re.yearRange,h.yearRange>100&&(h.yearRange=100);return h},toString:function(w){return w=w||this._o.format,C(this._d)?this._o.toString?this._o.toString(this._d,w):r?n(this._d).format(w):this._d.toDateString():""},getMoment:function(){return r?n(this._d):null},setMoment:function(w,h){r&&n.isMoment(w)&&this.setDate(w.toDate(),h)},getDate:function(){return C(this._d)?new Date(this._d.getTime()):null},setDate:function(w,h){if(!w)return this._d=null,this._o.field&&(this._o.field.value="",G(this._o.field,"change",{firedBy:this})),this.draw();if(typeof w=="string"&&(w=new Date(Date.parse(w))),!!C(w)){var f=this._o.minDate,m=this._o.maxDate;C(f)&&w<f?w=f:C(m)&&w>m&&(w=m),this._d=new Date(w.getTime()),y(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),G(this._o.field,"change",{firedBy:this})),!h&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function(w){var h=!0;if(C(w)){if(this.calendars){var f=new Date(this.calendars[0].year,this.calendars[0].month,1),m=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),T=w.getTime();m.setMonth(m.getMonth()+1),m.setDate(m.getDate()-1),h=T<f.getTime()||m.getTime()<T}h&&(this.calendars=[{month:w.getMonth(),year:w.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(w,h){var f=this.getDate()||new Date,m=parseInt(h)*24*60*60*1e3,T;w==="add"?T=new Date(f.valueOf()+m):w==="subtract"&&(T=new Date(f.valueOf()-m)),this.setDate(T)},adjustCalendars:function(){this.calendars[0]=X(this.calendars[0]);for(var w=1;w<this._o.numberOfMonths;w++)this.calendars[w]=X({month:this.calendars[0].month+w,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(w){isNaN(w)||(this.calendars[0].month=parseInt(w,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(w){isNaN(w)||(this.calendars[0].year=parseInt(w,10),this.adjustCalendars())},setMinDate:function(w){w instanceof Date?(y(w),this._o.minDate=w,this._o.minYear=w.getFullYear(),this._o.minMonth=w.getMonth()):(this._o.minDate=re.minDate,this._o.minYear=re.minYear,this._o.minMonth=re.minMonth,this._o.startRange=re.startRange),this.draw()},setMaxDate:function(w){w instanceof Date?(y(w),this._o.maxDate=w,this._o.maxYear=w.getFullYear(),this._o.maxMonth=w.getMonth()):(this._o.maxDate=re.maxDate,this._o.maxYear=re.maxYear,this._o.maxMonth=re.maxMonth,this._o.endRange=re.endRange),this.draw()},setStartRange:function(w){this._o.startRange=w},setEndRange:function(w){this._o.endRange=w},draw:function(w){if(!(!this._v&&!w)){var h=this._o,f=h.minYear,m=h.maxYear,T=h.minMonth,O=h.maxMonth,_="",Y;this._y<=f&&(this._y=f,!isNaN(T)&&this._m<T&&(this._m=T)),this._y>=m&&(this._y=m,!isNaN(O)&&this._m>O&&(this._m=O));for(var U=0;U<h.numberOfMonths;U++)Y="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),_+='<div class="pika-lendar">'+D(this,U,this.calendars[U].year,this.calendars[U].month,this.calendars[0].year,Y)+this.render(this.calendars[U].year,this.calendars[U].month,Y)+"</div>";this.el.innerHTML=_,h.bound&&h.field.type!=="hidden"&&s(function(){h.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),h.bound&&h.field.setAttribute("aria-label",h.ariaLabel)}},adjustPosition:function(){var w,h,f,m,T,O,_,Y,U,ie,se,oe;if(!this._o.container){if(this.el.style.position="absolute",w=this._o.trigger,h=w,f=this.el.offsetWidth,m=this.el.offsetHeight,T=window.innerWidth||o.documentElement.clientWidth,O=window.innerHeight||o.documentElement.clientHeight,_=window.pageYOffset||o.body.scrollTop||o.documentElement.scrollTop,se=!0,oe=!0,typeof w.getBoundingClientRect=="function")ie=w.getBoundingClientRect(),Y=ie.left+window.pageXOffset,U=ie.bottom+window.pageYOffset;else for(Y=h.offsetLeft,U=h.offsetTop+h.offsetHeight;h=h.offsetParent;)Y+=h.offsetLeft,U+=h.offsetTop;(this._o.reposition&&Y+f>T||this._o.position.indexOf("right")>-1&&Y-f+w.offsetWidth>0)&&(Y=Y-f+w.offsetWidth,se=!1),(this._o.reposition&&U+m>O+_||this._o.position.indexOf("top")>-1&&U-m-w.offsetHeight>0)&&(U=U-m-w.offsetHeight,oe=!1),this.el.style.left=Y+"px",this.el.style.top=U+"px",d(this.el,se?"left-aligned":"right-aligned"),d(this.el,oe?"bottom-aligned":"top-aligned"),g(this.el,se?"right-aligned":"left-aligned"),g(this.el,oe?"top-aligned":"bottom-aligned")}},render:function(w,h,f){var m=this._o,T=new Date,O=M(w,h),_=new Date(w,h,1).getDay(),Y=[],U=[];y(T),m.firstDay>0&&(_-=m.firstDay,_<0&&(_+=7));for(var ie=h===0?11:h-1,se=h===11?0:h+1,oe=h===0?w-1:w,de=h===11?w+1:w,Ce=M(oe,ie),pe=O+_,we=pe;we>7;)we-=7;pe+=7-we;for(var ee=!1,ye=0,$e=0;ye<pe;ye++){var Ae=new Date(w,h,1+(ye-_)),Fe=C(this._d)?$(Ae,this._d):!1,Ie=$(Ae,T),R=m.events.indexOf(Ae.toDateString())!==-1,A=ye<_||ye>=O+_,N=1+(ye-_),J=h,F=w,Q=m.startRange&&$(m.startRange,Ae),K=m.endRange&&$(m.endRange,Ae),j=m.startRange&&m.endRange&&m.startRange<Ae&&Ae<m.endRange,te=m.minDate&&Ae<m.minDate||m.maxDate&&Ae>m.maxDate||m.disableWeekends&&E(Ae)||m.disableDayFn&&m.disableDayFn(Ae);A&&(ye<_?(N=Ce+N,J=ie,F=oe):(N=N-O,J=se,F=de));var Z={day:N,month:J,year:F,hasEvent:R,isSelected:Fe,isToday:Ie,isDisabled:te,isEmpty:A,isStartRange:Q,isEndRange:K,isInRange:j,showDaysInNextAndPreviousMonths:m.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:m.enableSelectionDaysInNextAndPreviousMonths};m.pickWholeWeek&&Fe&&(ee=!0),U.push(S(Z)),++$e===7&&(m.showWeekNumber&&U.unshift(L(ye-_,h,w,m.firstWeekOfYearMinDays)),Y.push(P(U,m.isRTL,m.pickWholeWeek,ee)),U=[],$e=0,ee=!1)}return B(m,Y,f)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),g(this.el,"is-hidden"),this._o.bound&&(a(o,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var w=this._v;w!==!1&&(this._o.bound&&l(o,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),d(this.el,"is-hidden"),this._v=!1,w!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){var w=this._o;this.hide(),l(this.el,"mousedown",this._onMouseDown,!0),l(this.el,"touchend",this._onMouseDown,!0),l(this.el,"change",this._onChange),w.keyboardInput&&l(o,"keydown",this._onKeyChange),w.field&&(l(w.field,"change",this._onInputChange),w.bound&&(l(w.trigger,"click",this._onInputClick),l(w.trigger,"focus",this._onInputFocus),l(w.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},z})})(A6);function Zh(t,e,n){return e=P6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function P6(t){var e=x6(t,"string");return typeof e=="symbol"?e:String(e)}function x6(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const qx="date",WE="dateEditor";class Xx extends Ha{constructor(){super(...arguments),Zh(this,"defaultDateFormat","DD/MM/YYYY"),Zh(this,"isCellEdited",!1),Zh(this,"parentDestroyed",!1),Zh(this,"$datePicker",null)}static get EDITOR_TYPE(){return qx}init(){if(typeof le!="function")throw new Error("You need to include moment.js to your project.");if(typeof Bf!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),ce(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);const e=new Mr(this);e.addEventListener(this.datePicker,"mousedown",n=>{Ve(n.target,"pika-day")&&this.hideDatepicker(),n.stopPropagation()}),e.addEventListener(this.TEXTAREA,"keydown",n=>{["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(n.code)&&n.preventDefault()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.hot.getShortcutManager().getContext("editor");super.open(),this.showDatepicker(e),r.addShortcut({keys:[["Enter"]],callback:i=>{i.stopPropagation()},group:WE})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{this.hot._refreshBorders()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(WE),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e){const r=this.originalValue;r!==void 0&&this.setValue(r)}super.finishEditing(e,n)}showDatepicker(e){const n=this.TD.getBoundingClientRect(),r=this.cellProperties.dateFormat||this.defaultDateFormat,i=this.hot.view.isMouseDown(),o=e?bS(e.keyCode):!1;let s;this.datePicker.style.display="block",this.$datePicker=new Bf(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+n.top+Bt(this.TD)}px`;let a=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?a=n.right-yt(this.datePicker):a=n.left,this.datePickerStyle.left=`${a}px`,this.originalValue?(s=this.originalValue,le(s,r,!0).isValid()&&this.$datePicker.setMoment(le(s,r),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!o&&!i&&this.setValue("")):this.cellProperties.defaultDate?(s=this.cellProperties.defaultDate,le(s,r,!0).isValid()&&this.$datePicker.setMoment(le(s,r),!0),!o&&!i&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const e=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&th(n,this.cellProperties.datePickerConfig);const r=n.onSelect,i=n.onClose;return n.field=e,n.trigger=e,n.container=this.datePicker,n.bound=!1,n.format=n.format||this.defaultDateFormat,n.reposition=n.reposition||!1,n.isRTL=!1,n.onSelect=o=>{let s=o;isNaN(s.getTime())||(s=le(s).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(s),r&&r()},n.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),i&&i()},n}}const H6="dropdown";class xb extends Pb{static get EDITOR_TYPE(){return H6}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}_e.getSingleton().add("beforeValidate",function(t,e,n){const r=this.getCellMeta(e,this.propToCol(n));r.editor===xb&&r.strict===void 0&&(r.filter=!1,r.strict=!0)});const D6="numeric";class Zx extends Ha{static get EDITOR_TYPE(){return D6}}const N6="password";class Qx extends Ha{static get EDITOR_TYPE(){return N6}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.hot.getSettings().ariaTags&&Ne(this.TEXTAREA,[Vo()]),vi(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const _p="ht_editor_visible",VE="selectEditor",L6="select";class Jx extends Ql{static get EDITOR_TYPE(){return L6}init(){this.select=this.hot.rootDocument.createElement("SELECT"),ce(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",Ve(this.select,_p)&&Ye(this.select,_p),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),vi(this.select),Ze(l,(u,c)=>{const d=this.hot.rootDocument.createElement("OPTION");d.value=c,Pa(d,u),this.select.appendChild(d)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let r=0,i=e.length;r<i;r++)n[e[r]]=e[r];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==gn.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:r,height:i}=this.getEditedCellRect(),o=this.select.style;o.height=`${i}px`,o.width=`${r}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${n}px`,o.margin="0px",ce(this.select,_p)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={group:VE};this.isInFullEditMode()!==!1&&n.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(VE)}}const $6="time";class eH extends Ha{static get EDITOR_TYPE(){return $6}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.TEXTAREA.dir="ltr"}}function k6(){dr(Ql),dr(Pb),dr(Kx),dr(Xx),dr(xb),dr(Ib),dr(Zx),dr(Qx),dr(Jx),dr(Ha),dr(eH)}const F6="html";function Hb(t,e,n,r,i,o,s){sh.apply(this,[t,e,n,r,i,o,s]),Pa(e,o??"",!1)}Hb.RENDERER_TYPE=F6;const W6="autocomplete";function Jl(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=s.allowHtml?Hb:Go,u=a.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...Vo()),u.appendChild(a.createTextNode(String.fromCharCode(9660))),l.apply(this,[t,e,n,r,i,o,s]),e.firstChild||e.appendChild(a.createTextNode(String.fromCharCode(160))),e.insertBefore(u,e.firstChild),ce(e,"htAutocomplete"),!t.acArrowListener){const d=new Mr(t);t.acArrowListener=function(g){Ve(g.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,r),e)},d.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{d.destroy()})}}Jl.RENDERER_TYPE=W6;const BE=new WeakMap,UE=new WeakMap,V6="htBadValue",Ul="data-row",Yl="data-col",B6="checkboxRenderer",tH="checkbox";_e.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:r,type:i,row:o,column:s,prop:a}=e;if(i===tH){if(r){const{value:l,property:u}=r;let c=n;if(l)c=typeof l=="function"?l(o,s,a,n):l;else if(u){const d=this.getDataAtRowProp(o,u);c=d!==null?d:n}t=c}return t}});function Db(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=t.getSettings().ariaTags;sh.apply(this,[t,e,n,r,i,o,s]),U6(t);let u=Y6(a);const c=s.label;let d=!1;if(typeof s.checkedTemplate>"u"&&(s.checkedTemplate=!0),typeof s.uncheckedTemplate>"u"&&(s.uncheckedTemplate=!1),vi(e),o===s.checkedTemplate||Zt(o).toLocaleLowerCase(s.locale)===Zt(s.checkedTemplate).toLocaleLowerCase(s.locale)?u.checked=!0:o===s.uncheckedTemplate||Zt(o).toLocaleLowerCase(s.locale)===Zt(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?u.checked=!1:mn(o)?ce(u,"noValue"):(u.style.display="none",ce(u,V6),d=!0),Ne(u,[[Ul,n],[Yl,r]]),l&&Ne(u,[lS(u.checked?t.getTranslatedPhrase(Eb):t.getTranslatedPhrase(Tb)),KY(u.checked),VY()]),!d&&c){let E="";if(c.value)E=typeof c.value=="function"?c.value.call(this,n,r,i,o):c.value;else if(c.property){const M=t.getDataAtRowProp(n,c.property);E=M!==null?M:""}const I=G6(a,E,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(I),e.appendChild(u)):(I.appendChild(u),u=I):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(I)):(I.insertBefore(u,I.firstChild),u=I))}(!c||c&&!c.separated)&&e.appendChild(u),d&&e.appendChild(a.createTextNode("#bad-value#")),BE.has(t)||(BE.set(t,!0),g());function g(){const I=t.getShortcutManager().getContext("grid"),M={group:B6};I.addShortcuts([{keys:[["space"]],callback:()=>(p(),!C())},{keys:[["enter"]],callback:()=>(p(),!C()),runOnlyIf:()=>t.getSettings().enterBeginsEditing},{keys:[["delete"],["backspace"]],callback:()=>(p(!0),!C()),relativeToGroup:Ab,position:"before"}],M)}function p(){let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const I=t.getSelectedRange();if(I)for(let M=0;M<I.length;M++){const{row:y,col:$}=I[M].getTopStartCorner(),{row:q,col:G}=I[M].getBottomEndCorner(),X=[];for(let re=y;re<=q;re+=1)for(let v=$;v<=G;v+=1){const S=t.getCellMeta(re,v);if(S.type!=="checkbox")return;if(S.readOnly===!0)continue;typeof S.checkedTemplate>"u"&&(S.checkedTemplate=!0),typeof S.uncheckedTemplate>"u"&&(S.uncheckedTemplate=!1);const b=t.getDataAtCell(re,v);E===!1?[S.checkedTemplate,S.checkedTemplate.toString()].includes(b)?X.push([re,v,S.uncheckedTemplate]):[S.uncheckedTemplate,S.uncheckedTemplate.toString(),null,void 0].includes(b)&&X.push([re,v,S.checkedTemplate]):X.push([re,v,S.uncheckedTemplate])}X.length>0&&t.setDataAtCell(X)}}function C(){const E=t.getSelectedRange();if(E){for(let I=0;I<E.length;I++){const M=E[I].getTopStartCorner(),y=E[I].getBottomEndCorner();for(let $=M.row;$<=y.row;$++)for(let q=M.col;q<=y.col;q++){const G=t.getCellMeta($,q);if(G.type!=="checkbox")return!1;const X=t.getCell($,q);if(X==null)return!0;if(X.querySelectorAll("input[type=checkbox]").length>0&&!G.readOnly)return!0}}return!1}}}Db.RENDERER_TYPE=tH;function U6(t){let e=UE.get(t);if(!e){const{rootElement:n}=t;e=new Mr(t),e.addEventListener(n,"click",r=>j6(r,t)),e.addEventListener(n,"mouseup",r=>z6(r,t)),e.addEventListener(n,"change",r=>K6(r,t)),UE.set(t,e)}return e}function Y6(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function G6(t,e,n){const r=t.createElement("label");return r.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`,r.appendChild(t.createTextNode(e)),r.cloneNode(!0)}function z6(t,e){const{target:n}=t;Nb(n)&&(!n.hasAttribute(Ul)||!n.hasAttribute(Yl)||setTimeout(e.listen,10))}function j6(t,e){const{target:n}=t;if(!Nb(n)||!n.hasAttribute(Ul)||!n.hasAttribute(Yl))return;const r=parseInt(n.getAttribute(Ul),10),i=parseInt(n.getAttribute(Yl),10);e.getCellMeta(r,i).readOnly&&t.preventDefault()}function K6(t,e){const{target:n}=t;if(!Nb(n)||!n.hasAttribute(Ul)||!n.hasAttribute(Yl))return;const r=parseInt(n.getAttribute(Ul),10),i=parseInt(n.getAttribute(Yl),10),o=e.getCellMeta(r,i);if(!o.readOnly){let s=null;t.target.checked?s=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:s=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(r,i,s)}}function Nb(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}function Qh(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var XC={},q6={get exports(){return XC},set exports(t){XC=t}};(function(t,e){(function(n){t.exports=n()})(function(){return function n(r,i,o){function s(u,c){if(!i[u]){if(!r[u]){var d=typeof Qh=="function"&&Qh;if(!c&&d)return d(u,!0);if(a)return a(u,!0);var g=new Error("Cannot find module '"+u+"'");throw g.code="MODULE_NOT_FOUND",g}var p=i[u]={exports:{}};r[u][0].call(p.exports,function(C){return s(r[u][1][C]||C)},p,p.exports,n,r,i,o)}return i[u].exports}for(var a=typeof Qh=="function"&&Qh,l=0;l<o.length;l++)s(o[l]);return s}({1:[function(n,r,i){(function(o){var s,a=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,l=Math.ceil,u=Math.floor,c="[BigNumber Error] ",d=c+"Number primitive has more than 15 significant digits: ",g=1e14,p=14,C=9007199254740991,E=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],I=1e7,M=1e9;function y(S){var b=0|S;return 0<S||S===b?b:b-1}function $(S){for(var b,L,P=1,x=S.length,W=S[0]+"";P<x;){for(b=S[P++]+"",L=p-b.length;L--;b="0"+b);W+=b}for(x=W.length;W.charCodeAt(--x)===48;);return W.slice(0,x+1||1)}function q(S,b){var L,P,x=S.c,W=b.c,D=S.s,B=b.s,z=S.e,w=b.e;if(!D||!B)return null;if(L=x&&!x[0],P=W&&!W[0],L||P)return L?P?0:-B:D;if(D!=B)return D;if(L=D<0,P=z==w,!x||!W)return P?0:!x^L?1:-1;if(!P)return w<z^L?1:-1;for(B=(z=x.length)<(w=W.length)?z:w,D=0;D<B;D++)if(x[D]!=W[D])return x[D]>W[D]^L?1:-1;return z==w?0:w<z^L?1:-1}function G(S,b,L,P){if(S<b||L<S||S!==(S<0?l(S):u(S)))throw Error(c+(P||"Argument")+(typeof S=="number"?S<b||L<S?" out of range: ":" not an integer: ":" not a primitive number: ")+String(S))}function X(S){var b=S.c.length-1;return y(S.e/p)==b&&S.c[b]%2!=0}function re(S,b){return(1<S.length?S.charAt(0)+"."+S.slice(1):S)+(b<0?"e":"e+")+b}function v(S,b,L){var P,x;if(b<0){for(x=L+".";++b;x+=L);S=x+S}else if(++b>(P=S.length)){for(x=L,b-=P;--b;x+=L);S+=x}else b<P&&(S=S.slice(0,b)+"."+S.slice(b));return S}(s=function S(b){var L,P,x,W,D,B,z,w,h,f,m=ee.prototype={constructor:ee,toString:null,valueOf:null},T=new ee(1),O=20,_=4,Y=-7,U=21,ie=-1e7,se=1e7,oe=!1,de=1,Ce=0,pe={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},we="0123456789abcdefghijklmnopqrstuvwxyz";function ee(R,A){var N,J,F,Q,K,j,te,Z,ne=this;if(!(ne instanceof ee))return new ee(R,A);if(A==null){if(R instanceof ee)return ne.s=R.s,ne.e=R.e,void(ne.c=(R=R.c)?R.slice():R);if((j=typeof R=="number")&&0*R==0){if(ne.s=1/R<0?(R=-R,-1):1,R===~~R){for(Q=0,K=R;10<=K;K/=10,Q++);return ne.e=Q,void(ne.c=[R])}Z=String(R)}else{if(Z=String(R),!a.test(Z))return x(ne,Z,j);ne.s=Z.charCodeAt(0)==45?(Z=Z.slice(1),-1):1}-1<(Q=Z.indexOf("."))&&(Z=Z.replace(".","")),0<(K=Z.search(/e/i))?(Q<0&&(Q=K),Q+=+Z.slice(K+1),Z=Z.substring(0,K)):Q<0&&(Q=Z.length)}else{if(G(A,2,we.length,"Base"),Z=String(R),A==10)return Fe(ne=new ee(R instanceof ee?R:Z),O+ne.e+1,_);if(j=typeof R=="number"){if(0*R!=0)return x(ne,Z,j,A);if(ne.s=1/R<0?(Z=Z.slice(1),-1):1,ee.DEBUG&&15<Z.replace(/^0\.0*|\./,"").length)throw Error(d+R);j=!1}else ne.s=Z.charCodeAt(0)===45?(Z=Z.slice(1),-1):1;for(N=we.slice(0,A),Q=K=0,te=Z.length;K<te;K++)if(N.indexOf(J=Z.charAt(K))<0){if(J=="."){if(Q<K){Q=te;continue}}else if(!F&&(Z==Z.toUpperCase()&&(Z=Z.toLowerCase())||Z==Z.toLowerCase()&&(Z=Z.toUpperCase()))){F=!0,K=-1,Q=0;continue}return x(ne,String(R),j,A)}-1<(Q=(Z=P(Z,A,10,ne.s)).indexOf("."))?Z=Z.replace(".",""):Q=Z.length}for(K=0;Z.charCodeAt(K)===48;K++);for(te=Z.length;Z.charCodeAt(--te)===48;);if(Z=Z.slice(K,++te)){if(te-=K,j&&ee.DEBUG&&15<te&&(C<R||R!==u(R)))throw Error(d+ne.s*R);if(se<(Q=Q-K-1))ne.c=ne.e=null;else if(Q<ie)ne.c=[ne.e=0];else{if(ne.e=Q,ne.c=[],K=(Q+1)%p,Q<0&&(K+=p),K<te){for(K&&ne.c.push(+Z.slice(0,K)),te-=p;K<te;)ne.c.push(+Z.slice(K,K+=p));Z=Z.slice(K),K=p-Z.length}else K-=te;for(;K--;Z+="0");ne.c.push(+Z)}}else ne.c=[ne.e=0]}function ye(R,A,N,J){var F,Q,K,j,te;if(N==null?N=_:G(N,0,8),!R.c)return R.toString();if(F=R.c[0],K=R.e,A==null)te=$(R.c),te=J==1||J==2&&(K<=Y||U<=K)?re(te,K):v(te,K,"0");else if(Q=(R=Fe(new ee(R),A,N)).e,j=(te=$(R.c)).length,J==1||J==2&&(A<=Q||Q<=Y)){for(;j<A;te+="0",j++);te=re(te,Q)}else if(A-=K,te=v(te,Q,"0"),j<Q+1){if(0<--A)for(te+=".";A--;te+="0");}else if(0<(A+=Q-j))for(Q+1==j&&(te+=".");A--;te+="0");return R.s<0&&F?"-"+te:te}function $e(R,A){for(var N,J=1,F=new ee(R[0]);J<R.length;J++){if(!(N=new ee(R[J])).s){F=N;break}A.call(F,N)&&(F=N)}return F}function Ae(R,A,N){for(var J=1,F=A.length;!A[--F];A.pop());for(F=A[0];10<=F;F/=10,J++);return(N=J+N*p-1)>se?R.c=R.e=null:R.c=N<ie?[R.e=0]:(R.e=N,A),R}function Fe(R,A,N,J){var F,Q,K,j,te,Z,ne,fe=R.c,Ee=E;if(fe){e:{for(F=1,j=fe[0];10<=j;j/=10,F++);if((Q=A-F)<0)Q+=p,K=A,ne=(te=fe[Z=0])/Ee[F-K-1]%10|0;else if((Z=l((Q+1)/p))>=fe.length){if(!J)break e;for(;fe.length<=Z;fe.push(0));te=ne=0,K=(Q%=p)-p+(F=1)}else{for(te=j=fe[Z],F=1;10<=j;j/=10,F++);ne=(K=(Q%=p)-p+F)<0?0:te/Ee[F-K-1]%10|0}if(J=J||A<0||fe[Z+1]!=null||(K<0?te:te%Ee[F-K-1]),J=N<4?(ne||J)&&(N==0||N==(R.s<0?3:2)):5<ne||ne==5&&(N==4||J||N==6&&(0<Q?0<K?te/Ee[F-K]:0:fe[Z-1])%10&1||N==(R.s<0?8:7)),A<1||!fe[0])return fe.length=0,J?(A-=R.e+1,fe[0]=Ee[(p-A%p)%p],R.e=-A||0):fe[0]=R.e=0,R;if(Q==0?(fe.length=Z,j=1,Z--):(fe.length=Z+1,j=Ee[p-Q],fe[Z]=0<K?u(te/Ee[F-K]%Ee[K])*j:0),J)for(;;){if(Z==0){for(Q=1,K=fe[0];10<=K;K/=10,Q++);for(K=fe[0]+=j,j=1;10<=K;K/=10,j++);Q!=j&&(R.e++,fe[0]==g&&(fe[0]=1));break}if(fe[Z]+=j,fe[Z]!=g)break;fe[Z--]=0,j=1}for(Q=fe.length;fe[--Q]===0;fe.pop());}R.e>se?R.c=R.e=null:R.e<ie&&(R.c=[R.e=0])}return R}function Ie(R){var A,N=R.e;return N===null?R.toString():(A=$(R.c),A=N<=Y||U<=N?re(A,N):v(A,N,"0"),R.s<0?"-"+A:A)}return ee.clone=S,ee.ROUND_UP=0,ee.ROUND_DOWN=1,ee.ROUND_CEIL=2,ee.ROUND_FLOOR=3,ee.ROUND_HALF_UP=4,ee.ROUND_HALF_DOWN=5,ee.ROUND_HALF_EVEN=6,ee.ROUND_HALF_CEIL=7,ee.ROUND_HALF_FLOOR=8,ee.EUCLID=9,ee.config=ee.set=function(R){var A,N;if(R!=null){if(typeof R!="object")throw Error(c+"Object expected: "+R);if(R.hasOwnProperty(A="DECIMAL_PLACES")&&(G(N=R[A],0,M,A),O=N),R.hasOwnProperty(A="ROUNDING_MODE")&&(G(N=R[A],0,8,A),_=N),R.hasOwnProperty(A="EXPONENTIAL_AT")&&((N=R[A])&&N.pop?(G(N[0],-M,0,A),G(N[1],0,M,A),Y=N[0],U=N[1]):(G(N,-M,M,A),Y=-(U=N<0?-N:N))),R.hasOwnProperty(A="RANGE"))if((N=R[A])&&N.pop)G(N[0],-M,-1,A),G(N[1],1,M,A),ie=N[0],se=N[1];else{if(G(N,-M,M,A),!N)throw Error(c+A+" cannot be zero: "+N);ie=-(se=N<0?-N:N)}if(R.hasOwnProperty(A="CRYPTO")){if((N=R[A])!==!!N)throw Error(c+A+" not true or false: "+N);if(N){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw oe=!N,Error(c+"crypto unavailable");oe=N}else oe=N}if(R.hasOwnProperty(A="MODULO_MODE")&&(G(N=R[A],0,9,A),de=N),R.hasOwnProperty(A="POW_PRECISION")&&(G(N=R[A],0,M,A),Ce=N),R.hasOwnProperty(A="FORMAT")){if(typeof(N=R[A])!="object")throw Error(c+A+" not an object: "+N);pe=N}if(R.hasOwnProperty(A="ALPHABET")){if(typeof(N=R[A])!="string"||/^.$|[+-.\s]|(.).*\1/.test(N))throw Error(c+A+" invalid: "+N);we=N}}return{DECIMAL_PLACES:O,ROUNDING_MODE:_,EXPONENTIAL_AT:[Y,U],RANGE:[ie,se],CRYPTO:oe,MODULO_MODE:de,POW_PRECISION:Ce,FORMAT:pe,ALPHABET:we}},ee.isBigNumber=function(R){return R instanceof ee||R&&R._isBigNumber===!0||!1},ee.maximum=ee.max=function(){return $e(arguments,m.lt)},ee.minimum=ee.min=function(){return $e(arguments,m.gt)},ee.random=(W=9007199254740992,D=Math.random()*W&2097151?function(){return u(Math.random()*W)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(R){var A,N,J,F,Q,K=0,j=[],te=new ee(T);if(R==null?R=O:G(R,0,M),F=l(R/p),oe)if(crypto.getRandomValues){for(A=crypto.getRandomValues(new Uint32Array(F*=2));K<F;)9e15<=(Q=131072*A[K]+(A[K+1]>>>11))?(N=crypto.getRandomValues(new Uint32Array(2)),A[K]=N[0],A[K+1]=N[1]):(j.push(Q%1e14),K+=2);K=F/2}else{if(!crypto.randomBytes)throw oe=!1,Error(c+"crypto unavailable");for(A=crypto.randomBytes(F*=7);K<F;)9e15<=(Q=281474976710656*(31&A[K])+1099511627776*A[K+1]+4294967296*A[K+2]+16777216*A[K+3]+(A[K+4]<<16)+(A[K+5]<<8)+A[K+6])?crypto.randomBytes(7).copy(A,K):(j.push(Q%1e14),K+=7);K=F/7}if(!oe)for(;K<F;)(Q=D())<9e15&&(j[K++]=Q%1e14);for(F=j[--K],R%=p,F&&R&&(Q=E[p-R],j[K]=u(F/Q)*Q);j[K]===0;j.pop(),K--);if(K<0)j=[J=0];else{for(J=-1;j[0]===0;j.splice(0,1),J-=p);for(K=1,Q=j[0];10<=Q;Q/=10,K++);K<p&&(J-=p-K)}return te.e=J,te.c=j,te}),ee.sum=function(){for(var R=1,A=arguments,N=new ee(A[0]);R<A.length;)N=N.plus(A[R++]);return N},P=function(){var R="0123456789";function A(N,J,F,Q){for(var K,j,te=[0],Z=0,ne=N.length;Z<ne;){for(j=te.length;j--;te[j]*=J);for(te[0]+=Q.indexOf(N.charAt(Z++)),K=0;K<te.length;K++)te[K]>F-1&&(te[K+1]==null&&(te[K+1]=0),te[K+1]+=te[K]/F|0,te[K]%=F)}return te.reverse()}return function(N,J,F,Q,K){var j,te,Z,ne,fe,Ee,He,ke,Ge=N.indexOf("."),Rt=O,Qe=_;for(0<=Ge&&(ne=Ce,Ce=0,N=N.replace(".",""),Ee=(ke=new ee(J)).pow(N.length-Ge),Ce=ne,ke.c=A(v($(Ee.c),Ee.e,"0"),10,F,R),ke.e=ke.c.length),Z=ne=(He=A(N,J,F,K?(j=we,R):(j=R,we))).length;He[--ne]==0;He.pop());if(!He[0])return j.charAt(0);if(Ge<0?--Z:(Ee.c=He,Ee.e=Z,Ee.s=Q,He=(Ee=L(Ee,ke,Rt,Qe,F)).c,fe=Ee.r,Z=Ee.e),Ge=He[te=Z+Rt+1],ne=F/2,fe=fe||te<0||He[te+1]!=null,fe=Qe<4?(Ge!=null||fe)&&(Qe==0||Qe==(Ee.s<0?3:2)):ne<Ge||Ge==ne&&(Qe==4||fe||Qe==6&&1&He[te-1]||Qe==(Ee.s<0?8:7)),te<1||!He[0])N=fe?v(j.charAt(1),-Rt,j.charAt(0)):j.charAt(0);else{if(He.length=te,fe)for(--F;++He[--te]>F;)He[te]=0,te||(++Z,He=[1].concat(He));for(ne=He.length;!He[--ne];);for(Ge=0,N="";Ge<=ne;N+=j.charAt(He[Ge++]));N=v(N,Z,j.charAt(0))}return N}}(),L=function(){function R(J,F,Q){var K,j,te,Z,ne=0,fe=J.length,Ee=F%I,He=F/I|0;for(J=J.slice();fe--;)ne=((j=Ee*(te=J[fe]%I)+(K=He*te+(Z=J[fe]/I|0)*Ee)%I*I+ne)/Q|0)+(K/I|0)+He*Z,J[fe]=j%Q;return ne&&(J=[ne].concat(J)),J}function A(J,F,Q,K){var j,te;if(Q!=K)te=K<Q?1:-1;else for(j=te=0;j<Q;j++)if(J[j]!=F[j]){te=J[j]>F[j]?1:-1;break}return te}function N(J,F,Q,K){for(var j=0;Q--;)J[Q]-=j,j=J[Q]<F[Q]?1:0,J[Q]=j*K+J[Q]-F[Q];for(;!J[0]&&1<J.length;J.splice(0,1));}return function(J,F,Q,K,j){var te,Z,ne,fe,Ee,He,ke,Ge,Rt,Qe,mt,Et,eo,Ar,xt,rn,bi,_n=J.s==F.s?1:-1,Jt=J.c,Mt=F.c;if(!(Jt&&Jt[0]&&Mt&&Mt[0]))return new ee(J.s&&F.s&&(Jt?!Mt||Jt[0]!=Mt[0]:Mt)?Jt&&Jt[0]==0||!Mt?0*_n:_n/0:NaN);for(Rt=(Ge=new ee(_n)).c=[],_n=Q+(Z=J.e-F.e)+1,j||(j=g,Z=y(J.e/p)-y(F.e/p),_n=_n/p|0),ne=0;Mt[ne]==(Jt[ne]||0);ne++);if(Mt[ne]>(Jt[ne]||0)&&Z--,_n<0)Rt.push(1),fe=!0;else{for(Ar=Jt.length,rn=Mt.length,_n+=2,1<(Ee=u(j/(Mt[ne=0]+1)))&&(Mt=R(Mt,Ee,j),Jt=R(Jt,Ee,j),rn=Mt.length,Ar=Jt.length),eo=rn,mt=(Qe=Jt.slice(0,rn)).length;mt<rn;Qe[mt++]=0);bi=Mt.slice(),bi=[0].concat(bi),xt=Mt[0],Mt[1]>=j/2&&xt++;do{if(Ee=0,(te=A(Mt,Qe,rn,mt))<0){if(Et=Qe[0],rn!=mt&&(Et=Et*j+(Qe[1]||0)),1<(Ee=u(Et/xt)))for(j<=Ee&&(Ee=j-1),ke=(He=R(Mt,Ee,j)).length,mt=Qe.length;A(He,Qe,ke,mt)==1;)Ee--,N(He,rn<ke?bi:Mt,ke,j),ke=He.length,te=1;else Ee==0&&(te=Ee=1),ke=(He=Mt.slice()).length;if(ke<mt&&(He=[0].concat(He)),N(Qe,He,mt,j),mt=Qe.length,te==-1)for(;A(Mt,Qe,rn,mt)<1;)Ee++,N(Qe,rn<mt?bi:Mt,mt,j),mt=Qe.length}else te===0&&(Ee++,Qe=[0]);Rt[ne++]=Ee,Qe[0]?Qe[mt++]=Jt[eo]||0:(Qe=[Jt[eo]],mt=1)}while((eo++<Ar||Qe[0]!=null)&&_n--);fe=Qe[0]!=null,Rt[0]||Rt.splice(0,1)}if(j==g){for(ne=1,_n=Rt[0];10<=_n;_n/=10,ne++);Fe(Ge,Q+(Ge.e=ne+Z*p-1)+1,K,fe)}else Ge.e=Z,Ge.r=+fe;return Ge}}(),B=/^(-?)0([xbo])(?=\w[\w.]*$)/i,z=/^([^.]+)\.$/,w=/^\.([^.]+)$/,h=/^-?(Infinity|NaN)$/,f=/^\s*\+(?=[\w.])|^\s+|\s+$/g,x=function(R,A,N,J){var F,Q=N?A:A.replace(f,"");if(h.test(Q))R.s=isNaN(Q)?null:Q<0?-1:1,R.c=R.e=null;else{if(!N&&(Q=Q.replace(B,function(K,j,te){return F=(te=te.toLowerCase())=="x"?16:te=="b"?2:8,J&&J!=F?K:j}),J&&(F=J,Q=Q.replace(z,"$1").replace(w,"0.$1")),A!=Q))return new ee(Q,F);if(ee.DEBUG)throw Error(c+"Not a"+(J?" base "+J:"")+" number: "+A);R.c=R.e=R.s=null}},m.absoluteValue=m.abs=function(){var R=new ee(this);return R.s<0&&(R.s=1),R},m.comparedTo=function(R,A){return q(this,new ee(R,A))},m.decimalPlaces=m.dp=function(R,A){var N,J,F;if(R!=null)return G(R,0,M),A==null?A=_:G(A,0,8),Fe(new ee(this),R+this.e+1,A);if(!(N=this.c))return null;if(J=((F=N.length-1)-y(this.e/p))*p,F=N[F])for(;F%10==0;F/=10,J--);return J<0&&(J=0),J},m.dividedBy=m.div=function(R,A){return L(this,new ee(R,A),O,_)},m.dividedToIntegerBy=m.idiv=function(R,A){return L(this,new ee(R,A),0,1)},m.exponentiatedBy=m.pow=function(R,A){var N,J,F,Q,K,j,te,Z,ne=this;if((R=new ee(R)).c&&!R.isInteger())throw Error(c+"Exponent not an integer: "+Ie(R));if(A!=null&&(A=new ee(A)),K=14<R.e,!ne.c||!ne.c[0]||ne.c[0]==1&&!ne.e&&ne.c.length==1||!R.c||!R.c[0])return Z=new ee(Math.pow(+Ie(ne),K?2-X(R):+Ie(R))),A?Z.mod(A):Z;if(j=R.s<0,A){if(A.c?!A.c[0]:!A.s)return new ee(NaN);(J=!j&&ne.isInteger()&&A.isInteger())&&(ne=ne.mod(A))}else{if(9<R.e&&(0<ne.e||ne.e<-1||(ne.e==0?1<ne.c[0]||K&&24e7<=ne.c[1]:ne.c[0]<8e13||K&&ne.c[0]<=9999975e7)))return Q=ne.s<0&&X(R)?-0:0,-1<ne.e&&(Q=1/Q),new ee(j?1/Q:Q);Ce&&(Q=l(Ce/p+2))}for(te=K?(N=new ee(.5),j&&(R.s=1),X(R)):(F=Math.abs(+Ie(R)))%2,Z=new ee(T);;){if(te){if(!(Z=Z.times(ne)).c)break;Q?Z.c.length>Q&&(Z.c.length=Q):J&&(Z=Z.mod(A))}if(F){if((F=u(F/2))===0)break;te=F%2}else if(Fe(R=R.times(N),R.e+1,1),14<R.e)te=X(R);else{if((F=+Ie(R))==0)break;te=F%2}ne=ne.times(ne),Q?ne.c&&ne.c.length>Q&&(ne.c.length=Q):J&&(ne=ne.mod(A))}return J?Z:(j&&(Z=T.div(Z)),A?Z.mod(A):Q?Fe(Z,Ce,_,void 0):Z)},m.integerValue=function(R){var A=new ee(this);return R==null?R=_:G(R,0,8),Fe(A,A.e+1,R)},m.isEqualTo=m.eq=function(R,A){return q(this,new ee(R,A))===0},m.isFinite=function(){return!!this.c},m.isGreaterThan=m.gt=function(R,A){return 0<q(this,new ee(R,A))},m.isGreaterThanOrEqualTo=m.gte=function(R,A){return(A=q(this,new ee(R,A)))===1||A===0},m.isInteger=function(){return!!this.c&&y(this.e/p)>this.c.length-2},m.isLessThan=m.lt=function(R,A){return q(this,new ee(R,A))<0},m.isLessThanOrEqualTo=m.lte=function(R,A){return(A=q(this,new ee(R,A)))===-1||A===0},m.isNaN=function(){return!this.s},m.isNegative=function(){return this.s<0},m.isPositive=function(){return 0<this.s},m.isZero=function(){return!!this.c&&this.c[0]==0},m.minus=function(R,A){var N,J,F,Q,K=this,j=K.s;if(A=(R=new ee(R,A)).s,!j||!A)return new ee(NaN);if(j!=A)return R.s=-A,K.plus(R);var te=K.e/p,Z=R.e/p,ne=K.c,fe=R.c;if(!te||!Z){if(!ne||!fe)return ne?(R.s=-A,R):new ee(fe?K:NaN);if(!ne[0]||!fe[0])return fe[0]?(R.s=-A,R):new ee(ne[0]?K:_==3?-0:0)}if(te=y(te),Z=y(Z),ne=ne.slice(),j=te-Z){for((F=(Q=j<0)?(j=-j,ne):(Z=te,fe)).reverse(),A=j;A--;F.push(0));F.reverse()}else for(J=(Q=(j=ne.length)<(A=fe.length))?j:A,j=A=0;A<J;A++)if(ne[A]!=fe[A]){Q=ne[A]<fe[A];break}if(Q&&(F=ne,ne=fe,fe=F,R.s=-R.s),0<(A=(J=fe.length)-(N=ne.length)))for(;A--;ne[N++]=0);for(A=g-1;j<J;){if(ne[--J]<fe[J]){for(N=J;N&&!ne[--N];ne[N]=A);--ne[N],ne[J]+=g}ne[J]-=fe[J]}for(;ne[0]==0;ne.splice(0,1),--Z);return ne[0]?Ae(R,ne,Z):(R.s=_==3?-1:1,R.c=[R.e=0],R)},m.modulo=m.mod=function(R,A){var N,J,F=this;return R=new ee(R,A),!F.c||!R.s||R.c&&!R.c[0]?new ee(NaN):!R.c||F.c&&!F.c[0]?new ee(F):(de==9?(J=R.s,R.s=1,N=L(F,R,0,3),R.s=J,N.s*=J):N=L(F,R,0,de),(R=F.minus(N.times(R))).c[0]||de!=1||(R.s=F.s),R)},m.multipliedBy=m.times=function(R,A){var N,J,F,Q,K,j,te,Z,ne,fe,Ee,He,ke,Ge,Rt,Qe=this,mt=Qe.c,Et=(R=new ee(R,A)).c;if(!(mt&&Et&&mt[0]&&Et[0]))return!Qe.s||!R.s||mt&&!mt[0]&&!Et||Et&&!Et[0]&&!mt?R.c=R.e=R.s=null:(R.s*=Qe.s,mt&&Et?(R.c=[0],R.e=0):R.c=R.e=null),R;for(J=y(Qe.e/p)+y(R.e/p),R.s*=Qe.s,(te=mt.length)<(fe=Et.length)&&(ke=mt,mt=Et,Et=ke,F=te,te=fe,fe=F),F=te+fe,ke=[];F--;ke.push(0));for(Ge=g,Rt=I,F=fe;0<=--F;){for(N=0,Ee=Et[F]%Rt,He=Et[F]/Rt|0,Q=F+(K=te);F<Q;)N=((Z=Ee*(Z=mt[--K]%Rt)+(j=He*Z+(ne=mt[K]/Rt|0)*Ee)%Rt*Rt+ke[Q]+N)/Ge|0)+(j/Rt|0)+He*ne,ke[Q--]=Z%Ge;ke[Q]=N}return N?++J:ke.splice(0,1),Ae(R,ke,J)},m.negated=function(){var R=new ee(this);return R.s=-R.s||null,R},m.plus=function(R,A){var N,J=this,F=J.s;if(A=(R=new ee(R,A)).s,!F||!A)return new ee(NaN);if(F!=A)return R.s=-A,J.minus(R);var Q=J.e/p,K=R.e/p,j=J.c,te=R.c;if(!Q||!K){if(!j||!te)return new ee(F/0);if(!j[0]||!te[0])return te[0]?R:new ee(j[0]?J:0*F)}if(Q=y(Q),K=y(K),j=j.slice(),F=Q-K){for((N=0<F?(K=Q,te):(F=-F,j)).reverse();F--;N.push(0));N.reverse()}for((F=j.length)-(A=te.length)<0&&(N=te,te=j,j=N,A=F),F=0;A;)F=(j[--A]=j[A]+te[A]+F)/g|0,j[A]=g===j[A]?0:j[A]%g;return F&&(j=[F].concat(j),++K),Ae(R,j,K)},m.precision=m.sd=function(R,A){var N,J,F;if(R!=null&&R!==!!R)return G(R,1,M),A==null?A=_:G(A,0,8),Fe(new ee(this),R,A);if(!(N=this.c))return null;if(J=(F=N.length-1)*p+1,F=N[F]){for(;F%10==0;F/=10,J--);for(F=N[0];10<=F;F/=10,J++);}return R&&this.e+1>J&&(J=this.e+1),J},m.shiftedBy=function(R){return G(R,-C,C),this.times("1e"+R)},m.squareRoot=m.sqrt=function(){var R,A,N,J,F,Q=this,K=Q.c,j=Q.s,te=Q.e,Z=O+4,ne=new ee("0.5");if(j!==1||!K||!K[0])return new ee(!j||j<0&&(!K||K[0])?NaN:K?Q:1/0);if((N=(j=Math.sqrt(+Ie(Q)))==0||j==1/0?(((A=$(K)).length+te)%2==0&&(A+="0"),j=Math.sqrt(+A),te=y((te+1)/2)-(te<0||te%2),new ee(A=j==1/0?"1e"+te:(A=j.toExponential()).slice(0,A.indexOf("e")+1)+te)):new ee(j+"")).c[0]){for((j=(te=N.e)+Z)<3&&(j=0);;)if(F=N,N=ne.times(F.plus(L(Q,F,Z,1))),$(F.c).slice(0,j)===(A=$(N.c)).slice(0,j)){if(N.e<te&&--j,(A=A.slice(j-3,j+1))!="9999"&&(J||A!="4999")){+A&&(+A.slice(1)||A.charAt(0)!="5")||(Fe(N,N.e+O+2,1),R=!N.times(N).eq(Q));break}if(!J&&(Fe(F,F.e+O+2,0),F.times(F).eq(Q))){N=F;break}Z+=4,j+=4,J=1}}return Fe(N,N.e+O+1,_,R)},m.toExponential=function(R,A){return R!=null&&(G(R,0,M),R++),ye(this,R,A,1)},m.toFixed=function(R,A){return R!=null&&(G(R,0,M),R=R+this.e+1),ye(this,R,A)},m.toFormat=function(R,A,N){var J;if(N==null)R!=null&&A&&typeof A=="object"?(N=A,A=null):R&&typeof R=="object"?(N=R,R=A=null):N=pe;else if(typeof N!="object")throw Error(c+"Argument not an object: "+N);if(J=this.toFixed(R,A),this.c){var F,Q=J.split("."),K=+N.groupSize,j=+N.secondaryGroupSize,te=N.groupSeparator||"",Z=Q[0],ne=Q[1],fe=this.s<0,Ee=fe?Z.slice(1):Z,He=Ee.length;if(j&&(F=K,K=j,He-=j=F),0<K&&0<He){for(F=He%K||K,Z=Ee.substr(0,F);F<He;F+=K)Z+=te+Ee.substr(F,K);0<j&&(Z+=te+Ee.slice(F)),fe&&(Z="-"+Z)}J=ne?Z+(N.decimalSeparator||"")+((j=+N.fractionGroupSize)?ne.replace(new RegExp("\\d{"+j+"}\\B","g"),"$&"+(N.fractionGroupSeparator||"")):ne):Z}return(N.prefix||"")+J+(N.suffix||"")},m.toFraction=function(R){var A,N,J,F,Q,K,j,te,Z,ne,fe,Ee,He=this,ke=He.c;if(R!=null&&(!(j=new ee(R)).isInteger()&&(j.c||j.s!==1)||j.lt(T)))throw Error(c+"Argument "+(j.isInteger()?"out of range: ":"not an integer: ")+Ie(j));if(!ke)return new ee(He);for(A=new ee(T),Z=N=new ee(T),J=te=new ee(T),Ee=$(ke),Q=A.e=Ee.length-He.e-1,A.c[0]=E[(K=Q%p)<0?p+K:K],R=!R||0<j.comparedTo(A)?0<Q?A:Z:j,K=se,se=1/0,j=new ee(Ee),te.c[0]=0;ne=L(j,A,0,1),(F=N.plus(ne.times(J))).comparedTo(R)!=1;)N=J,J=F,Z=te.plus(ne.times(F=Z)),te=F,A=j.minus(ne.times(F=A)),j=F;return F=L(R.minus(N),J,0,1),te=te.plus(F.times(Z)),N=N.plus(F.times(J)),te.s=Z.s=He.s,fe=L(Z,J,Q*=2,_).minus(He).abs().comparedTo(L(te,N,Q,_).minus(He).abs())<1?[Z,J]:[te,N],se=K,fe},m.toNumber=function(){return+Ie(this)},m.toPrecision=function(R,A){return R!=null&&G(R,1,M),ye(this,R,A,2)},m.toString=function(R){var A,N=this,J=N.s,F=N.e;return F===null?J?(A="Infinity",J<0&&(A="-"+A)):A="NaN":(A=R==null?F<=Y||U<=F?re($(N.c),F):v($(N.c),F,"0"):R===10?v($((N=Fe(new ee(N),O+F+1,_)).c),N.e,"0"):(G(R,2,we.length,"Base"),P(v($(N.c),F,"0"),10,R,J,!0)),J<0&&N.c[0]&&(A="-"+A)),A},m.valueOf=m.toJSON=function(){return Ie(this)},m._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(m[Symbol.toStringTag]="BigNumber",m[Symbol.for("nodejs.util.inspect.custom")]=m.valueOf),b!=null&&ee.set(b),ee}()).default=s.BigNumber=s,r!==void 0&&r.exports?r.exports=s:(o||(o=typeof self<"u"&&self?self:window),o.BigNumber=s)})(this)},{}],2:[function(n,r,i){r.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(o){var s=o%10;return~~(o%100/10)==1?"th":s===1?"st":s===2?"nd":s===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(n,r,i){function o(y,$){return function(q){if(Array.isArray(q))return q}(y)||function(q,G){var X=[],re=!0,v=!1,S=void 0;try{for(var b,L=q[Symbol.iterator]();!(re=(b=L.next()).done)&&(X.push(b.value),!G||X.length!==G);re=!0);}catch(P){v=!0,S=P}finally{try{re||L.return==null||L.return()}finally{if(v)throw S}}return X}(y,$)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var s=n("./globalState"),a=n("./validating"),l=n("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],c={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},d={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function g(y){var $=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},q=2<arguments.length?arguments[2]:void 0;if(typeof $=="string"&&($=l.parseFormat($)),!a.validateFormat($))return"ERROR: invalid format";var G=$.prefix||"",X=$.postfix||"",re=function(v,S,b){switch(S.output){case"currency":return S=M(S,s.currentCurrencyDefaultFormat()),function(we,ee,ye){var $e=ye.currentCurrency(),Ae=Object.assign({},d,ee),Fe=void 0,Ie="",R=!!Ae.totalLength||!!Ae.forceAverage||Ae.average,A=ee.currencyPosition||$e.position,N=ee.currencySymbol||$e.symbol;Ae.spaceSeparated&&(Ie=" "),A==="infix"&&(Fe=Ie+N+Ie);var J=I({instance:we,providedFormat:ee,state:ye,decimalSeparator:Fe});return A==="prefix"&&(J=we._value<0&&Ae.negative==="sign"?"-".concat(Ie).concat(N).concat(J.slice(1)):N+Ie+J),A&&A!=="postfix"||(J=J+(Ie=R?"":Ie)+N),J}(v,S,s);case"percent":return S=M(S,s.currentPercentageDefaultFormat()),function(we,ee,ye,$e){var Ae=ee.prefixSymbol,Fe=I({instance:$e(100*we._value),providedFormat:ee,state:ye}),Ie=Object.assign({},d,ee);return Ae?"%".concat(Ie.spaceSeparated?" ":"").concat(Fe):"".concat(Fe).concat(Ie.spaceSeparated?" ":"","%")}(v,S,s,b);case"byte":return S=M(S,s.currentByteDefaultFormat()),T=v,_=s,Y=b,U=(O=S).base||"binary",ie=c[U],se=p(T._value,ie.suffixes,ie.scale),oe=se.value,de=se.suffix,Ce=I({instance:Y(oe),providedFormat:O,state:_,defaults:_.currentByteDefaultFormat()}),pe=_.currentAbbreviations(),"".concat(Ce).concat(pe.spaced?" ":"").concat(de);case"time":return S=M(S,s.currentTimeDefaultFormat()),w=v,h=Math.floor(w._value/60/60),f=Math.floor((w._value-60*h*60)/60),m=Math.round(w._value-60*h*60-60*f),"".concat(h,":").concat(f<10?"0":"").concat(f,":").concat(m<10?"0":"").concat(m);case"ordinal":return S=M(S,s.currentOrdinalDefaultFormat()),L=v,P=S,W=(x=s).currentOrdinal(),D=Object.assign({},d,P),B=I({instance:L,providedFormat:P,state:x}),z=W(L._value),"".concat(B).concat(D.spaceSeparated?" ":"").concat(z);case"number":default:return I({instance:v,providedFormat:S,numbro:b})}var L,P,x,W,D,B,z,w,h,f,m,T,O,_,Y,U,ie,se,oe,de,Ce,pe}(y,$,q);return re=(re=G+re)+X}function p(y,$,q){var G=$[0],X=Math.abs(y);if(q<=X){for(var re=1;re<$.length;++re){var v=Math.pow(q,re),S=Math.pow(q,re+1);if(v<=X&&X<S){G=$[re],y/=v;break}}G===$[0]&&(y/=Math.pow(q,$.length-1),G=$[$.length-1])}return{value:y,suffix:G}}function C(y){for(var $="",q=0;q<y;q++)$+="0";return $}function E(y,$){return y.toString().indexOf("e")!==-1?function(q,G){var X=q.toString(),re=o(X.split("e"),2),v=re[0],S=re[1],b=o(v.split("."),2),L=b[0],P=b[1],x=P===void 0?"":P;if(0<+S)X=L+x+C(S-x.length);else{var W=".";W=+L<0?"-0".concat(W):"0".concat(W);var D=(C(-S-1)+Math.abs(L)+x).substr(0,G);D.length<G&&(D+=C(G-D.length)),X=W+D}return 0<+S&&0<G&&(X+=".".concat(C(G))),X}(y,$):(Math.round(+"".concat(y,"e+").concat($))/Math.pow(10,$)).toFixed($)}function I(y){var $=y.instance,q=y.providedFormat,G=y.state,X=G===void 0?s:G,re=y.decimalSeparator,v=y.defaults,S=v===void 0?X.currentDefaults():v,b=$._value;if(b===0&&X.hasZeroFormat())return X.getZeroFormat();if(!isFinite(b))return b.toString();var L,P,x,W,D,B,z,w,h=Object.assign({},d,S,q),f=h.totalLength,m=f?0:h.characteristic,T=h.optionalCharacteristic,O=h.forceAverage,_=!!f||!!O||h.average,Y=f?-1:_&&q.mantissa===void 0?0:h.mantissa,U=!f&&(q.optionalMantissa===void 0?Y===-1:h.optionalMantissa),ie=h.trimMantissa,se=h.thousandSeparated,oe=h.spaceSeparated,de=h.negative,Ce=h.forceSign,pe=h.exponential,we="";if(_){var ee=function(R){var A=R.value,N=R.forceAverage,J=R.abbreviations,F=R.spaceSeparated,Q=F!==void 0&&F,K=R.totalLength,j=K===void 0?0:K,te="",Z=Math.abs(A),ne=-1;if(Z>=Math.pow(10,12)&&!N||N==="trillion"?(te=J.trillion,A/=Math.pow(10,12)):Z<Math.pow(10,12)&&Z>=Math.pow(10,9)&&!N||N==="billion"?(te=J.billion,A/=Math.pow(10,9)):Z<Math.pow(10,9)&&Z>=Math.pow(10,6)&&!N||N==="million"?(te=J.million,A/=Math.pow(10,6)):(Z<Math.pow(10,6)&&Z>=Math.pow(10,3)&&!N||N==="thousand")&&(te=J.thousand,A/=Math.pow(10,3)),te&&(te=(Q?" ":"")+te),j){var fe=A.toString().split(".")[0];ne=Math.max(j-fe.length,0)}return{value:A,abbreviation:te,mantissaPrecision:ne}}({value:b,forceAverage:O,abbreviations:X.currentAbbreviations(),spaceSeparated:oe,totalLength:f});b=ee.value,we+=ee.abbreviation,f&&(Y=ee.mantissaPrecision)}if(pe){var ye=(P=(L={value:b,characteristicPrecision:m}).value,x=L.characteristicPrecision,W=x===void 0?0:x,D=o(P.toExponential().split("e"),2),B=D[0],z=D[1],w=+B,W&&1<W&&(w*=Math.pow(10,W-1),z=0<=(z=+z-(W-1))?"+".concat(z):z),{value:w,abbreviation:"e".concat(z)});b=ye.value,we=ye.abbreviation+we}var $e,Ae,Fe,Ie=function(R,A,N,J,F){if(J===-1)return R;var Q=E(A,J),K=o(Q.toString().split("."),2),j=K[0],te=K[1],Z=te===void 0?"":te;if(Z.match(/^0+$/)&&(N||F))return j;var ne=Z.match(/0+$/);return F&&ne?"".concat(j,".").concat(Z.toString().slice(0,ne.index)):Q.toString()}(b.toString(),b,U,Y,ie);return Ie=function(R,A,N,J,F){var Q=J.currentDelimiters(),K=Q.thousands;F=F||Q.decimal;var j=Q.thousandsSize||3,te=R.toString(),Z=te.split(".")[0],ne=te.split(".")[1];return N&&(A<0&&(Z=Z.slice(1)),function(fe,Ee){for(var He=[],ke=0,Ge=fe;0<Ge;Ge--)ke===Ee&&(He.unshift(Ge),ke=0),ke++;return He}(Z.length,j).forEach(function(fe,Ee){Z=Z.slice(0,fe+Ee)+K+Z.slice(fe+Ee)}),A<0&&(Z="-".concat(Z))),te=ne?Z+F+ne:Z}(Ie=function(R,A,N,J){var F=R,Q=o(F.toString().split("."),2),K=Q[0],j=Q[1];if(K.match(/^-?0$/)&&N)return j?"".concat(K.replace("0",""),".").concat(j):K.replace("0","");if(K.length<J)for(var te=J-K.length,Z=0;Z<te;Z++)F="0".concat(F);return F.toString()}(Ie,0,T,m),b,se,X,re),(_||pe)&&(Ie=Ie+we),(Ce||b<0)&&($e=Ie,Fe=de,Ie=(Ae=b)===0?$e:+$e==0?$e.replace("-",""):0<Ae?"+".concat($e):Fe==="sign"?$e:"(".concat($e.replace("-",""),")")),Ie}function M(y,$){if(!y)return $;var q=Object.keys(y);return q.length===1&&q[0]==="output"?$:y}r.exports=function(y){return{format:function(){for(var $=arguments.length,q=new Array($),G=0;G<$;G++)q[G]=arguments[G];return g.apply(void 0,q.concat([y]))},getByteUnit:function(){for(var $=arguments.length,q=new Array($),G=0;G<$;G++)q[G]=arguments[G];return function(X){var re=c.general;return p(X._value,re.suffixes,re.scale).suffix}.apply(void 0,q.concat([y]))},getBinaryByteUnit:function(){for(var $=arguments.length,q=new Array($),G=0;G<$;G++)q[G]=arguments[G];return function(X){var re=c.binary;return p(X._value,re.suffixes,re.scale).suffix}.apply(void 0,q.concat([y]))},getDecimalByteUnit:function(){for(var $=arguments.length,q=new Array($),G=0;G<$;G++)q[G]=arguments[G];return function(X){var re=c.decimal;return p(X._value,re.suffixes,re.scale).suffix}.apply(void 0,q.concat([y]))},formatOrDefault:M}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(n,r,i){var o=n("./en-US"),s=n("./validating"),a=n("./parsing"),l={},u=void 0,c={},d=null,g={};function p(E){u=E}function C(){return c[u]}l.languages=function(){return Object.assign({},c)},l.currentLanguage=function(){return u},l.currentCurrency=function(){return C().currency},l.currentAbbreviations=function(){return C().abbreviations},l.currentDelimiters=function(){return C().delimiters},l.currentOrdinal=function(){return C().ordinal},l.currentDefaults=function(){return Object.assign({},C().defaults,g)},l.currentOrdinalDefaultFormat=function(){return Object.assign({},l.currentDefaults(),C().ordinalFormat)},l.currentByteDefaultFormat=function(){return Object.assign({},l.currentDefaults(),C().byteFormat)},l.currentPercentageDefaultFormat=function(){return Object.assign({},l.currentDefaults(),C().percentageFormat)},l.currentCurrencyDefaultFormat=function(){return Object.assign({},l.currentDefaults(),C().currencyFormat)},l.currentTimeDefaultFormat=function(){return Object.assign({},l.currentDefaults(),C().timeFormat)},l.setDefaults=function(E){E=a.parseFormat(E),s.validateFormat(E)&&(g=E)},l.getZeroFormat=function(){return d},l.setZeroFormat=function(E){return d=typeof E=="string"?E:null},l.hasZeroFormat=function(){return d!==null},l.languageData=function(E){if(E){if(c[E])return c[E];throw new Error('Unknown tag "'.concat(E,'"'))}return C()},l.registerLanguage=function(E){var I=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!s.validateLanguage(E))throw new Error("Invalid language data");c[E.languageTag]=E,I&&p(E.languageTag)},l.setLanguage=function(E){var I=1<arguments.length&&arguments[1]!==void 0?arguments[1]:o.languageTag;if(!c[E]){var M=E.split("-")[0],y=Object.keys(c).find(function($){return $.split("-")[0]===M});return c[y]?void p(y):void p(I)}p(E)},l.registerLanguage(o),u=o.languageTag,r.exports=l},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(n,r,i){r.exports=function(o){return{loadLanguagesInNode:function(s){return a=o,void s.forEach(function(l){var u=void 0;try{u=n("../languages/".concat(l))}catch{console.error('Unable to load "'.concat(l,'". No matching language file found.'))}u&&a.registerLanguage(u)});var a}}}},{}],6:[function(n,r,i){var o=n("bignumber.js");function s(a,l,u){var c=new o(a._value),d=l;return u.isNumbro(l)&&(d=l._value),d=new o(d),a._value=c.minus(d).toNumber(),a}r.exports=function(a){return{add:function(l,u){return d=u,g=a,p=new o((c=l)._value),C=d,g.isNumbro(d)&&(C=d._value),C=new o(C),c._value=p.plus(C).toNumber(),c;var c,d,g,p,C},subtract:function(l,u){return s(l,u,a)},multiply:function(l,u){return d=u,g=a,p=new o((c=l)._value),C=d,g.isNumbro(d)&&(C=d._value),C=new o(C),c._value=p.times(C).toNumber(),c;var c,d,g,p,C},divide:function(l,u){return d=u,g=a,p=new o((c=l)._value),C=d,g.isNumbro(d)&&(C=d._value),C=new o(C),c._value=p.dividedBy(C).toNumber(),c;var c,d,g,p,C},set:function(l,u){return c=l,g=d=u,a.isNumbro(d)&&(g=d._value),c._value=g,c;var c,d,g},difference:function(l,u){return c=u,s(g=(d=a)(l._value),c,d),Math.abs(g._value);var c,d,g}}}},{"bignumber.js":1}],7:[function(n,r,i){function o(I,M){for(var y=0;y<M.length;y++){var $=M[y];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(I,$.key,$)}}var s=n("./globalState"),a=n("./validating"),l=n("./loading")(E),u=n("./unformatting"),c=n("./formatting")(E),d=n("./manipulating")(E),g=n("./parsing"),p=function(){function I($){(function(q,G){if(!(q instanceof G))throw new TypeError("Cannot call a class as a function")})(this,I),this._value=$}var M,y;return M=I,(y=[{key:"clone",value:function(){return E(this._value)}},{key:"format",value:function(){var $=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return c.format(this,$)}},{key:"formatCurrency",value:function($){return typeof $=="string"&&($=g.parseFormat($)),($=c.formatOrDefault($,s.currentCurrencyDefaultFormat())).output="currency",c.format(this,$)}},{key:"formatTime",value:function(){var $=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return $.output="time",c.format(this,$)}},{key:"binaryByteUnits",value:function(){return c.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return c.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return c.getByteUnit(this)}},{key:"difference",value:function($){return d.difference(this,$)}},{key:"add",value:function($){return d.add(this,$)}},{key:"subtract",value:function($){return d.subtract(this,$)}},{key:"multiply",value:function($){return d.multiply(this,$)}},{key:"divide",value:function($){return d.divide(this,$)}},{key:"set",value:function($){return d.set(this,C($))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&o(M.prototype,y),I}();function C(I){var M=I;return E.isNumbro(I)?M=I._value:typeof I=="string"?M=E.unformat(I):isNaN(I)&&(M=NaN),M}function E(I){return new p(C(I))}E.version="2.1.2",E.isNumbro=function(I){return I instanceof p},E.language=s.currentLanguage,E.registerLanguage=s.registerLanguage,E.setLanguage=s.setLanguage,E.languages=s.languages,E.languageData=s.languageData,E.zeroFormat=s.setZeroFormat,E.defaultFormat=s.currentDefaults,E.setDefaults=s.setDefaults,E.defaultCurrencyFormat=s.currentCurrencyDefaultFormat,E.validate=a.validate,E.loadLanguagesInNode=l.loadLanguagesInNode,E.unformat=u.unformat,r.exports=E},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(n,r,i){r.exports={parseFormat:function(o){var s,a,l,u,c,d,g,p,C,E,I,M,y,$,q,G,X,re,v,S,b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof o!="string"?o:(a=b,o=(l=(s=o).match(/^{([^}]*)}/))?(a.prefix=l[1],s.slice(l[0].length)):s,c=b,function(L,P){if(L.indexOf("$")===-1){if(L.indexOf("%")===-1)return L.indexOf("bd")!==-1?(P.output="byte",P.base="general"):L.indexOf("b")!==-1?(P.output="byte",P.base="binary"):L.indexOf("d")!==-1?(P.output="byte",P.base="decimal"):L.indexOf(":")===-1?L.indexOf("o")!==-1&&(P.output="ordinal"):P.output="time";P.output="percent"}else P.output="currency"}(o=(d=(u=o).match(/{([^}]*)}$/))?(c.postfix=d[1],u.slice(0,-d[0].length)):u,b),g=b,(p=o.match(/[1-9]+[0-9]*/))&&(g.totalLength=+p[0]),C=b,(E=o.split(".")[0].match(/0+/))&&(C.characteristic=E[0].length),function(L,P){if(L.indexOf(".")!==-1){var x=L.split(".")[0];P.optionalCharacteristic=x.indexOf("0")===-1}}(o,b),I=b,o.indexOf("a")!==-1&&(I.average=!0),y=b,(M=o).indexOf("K")!==-1?y.forceAverage="thousand":M.indexOf("M")!==-1?y.forceAverage="million":M.indexOf("B")!==-1?y.forceAverage="billion":M.indexOf("T")!==-1&&(y.forceAverage="trillion"),function(L,P){var x=L.split(".")[1];if(x){var W=x.match(/0+/);W&&(P.mantissa=W[0].length)}}(o,b),q=b,($=o).match(/\[\.]/)?q.optionalMantissa=!0:$.match(/\./)&&(q.optionalMantissa=!1),G=b,o.indexOf(",")!==-1&&(G.thousandSeparated=!0),X=b,o.indexOf(" ")!==-1&&(X.spaceSeparated=!0),v=b,(re=o).match(/^\+?\([^)]*\)$/)&&(v.negative="parenthesis"),re.match(/^\+?-/)&&(v.negative="sign"),S=b,o.match(/^\+/)&&(S.forceSign=!0),b)}}},{}],9:[function(n,r,i){var o=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function s(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function a(l,u){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",d=3<arguments.length?arguments[3]:void 0,g=4<arguments.length?arguments[4]:void 0,p=5<arguments.length?arguments[5]:void 0,C=6<arguments.length?arguments[6]:void 0;if(l!=="")return l===g?0:function E(I,M){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",$=3<arguments.length?arguments[3]:void 0,q=4<arguments.length?arguments[4]:void 0,G=5<arguments.length?arguments[5]:void 0,X=6<arguments.length?arguments[6]:void 0;if(!isNaN(+I))return+I;var re="",v=I.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(v!==I)return-1*E(v,M,y,$,q,G,X);for(var S=0;S<o.length;S++){var b=o[S];if((re=I.replace(b.key,""))!==I)return E(re,M,y,$,q,G,X)*b.factor}if((re=I.replace("%",""))!==I)return E(re,M,y,$,q,G,X)/100;var L=parseFloat(I);if(!isNaN(L)){var P=$(L);if(P&&P!=="."&&(re=I.replace(new RegExp("".concat(s(P),"$")),""))!==I)return E(re,M,y,$,q,G,X);var x={};Object.keys(G).forEach(function(f){x[G[f]]=f});for(var W=Object.keys(x).sort().reverse(),D=W.length,B=0;B<D;B++){var z=W[B],w=x[z];if((re=I.replace(z,""))!==I){var h=void 0;switch(w){case"thousand":h=Math.pow(10,3);break;case"million":h=Math.pow(10,6);break;case"billion":h=Math.pow(10,9);break;case"trillion":h=Math.pow(10,12)}return E(re,M,y,$,q,G,X)*h}}}}(function(E,I){var M=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",y=E.replace(M,"");return y=(y=y.replace(new RegExp("([0-9])".concat(s(I.thousands),"([0-9])"),"g"),"$1$2")).replace(I.decimal,".")}(l,u,c),u,c,d,g,p,C)}r.exports={unformat:function(l,u){var c,d,g,p=n("./globalState"),C=p.currentDelimiters(),E=p.currentCurrency().symbol,I=p.currentOrdinal(),M=p.getZeroFormat(),y=p.currentAbbreviations(),$=void 0;if(typeof l=="string")$=function(q,G){if(!q.indexOf(":")||G.thousands===":")return!1;var X=q.split(":");if(X.length!==3)return!1;var re=+X[0],v=+X[1],S=+X[2];return!isNaN(re)&&!isNaN(v)&&!isNaN(S)}(l,C)?(c=l.split(":"),d=+c[0],g=+c[1],+c[2]+60*g+3600*d):a(l,C,E,I,M,y,u);else{if(typeof l!="number")return;$=l}if($!==void 0)return $}}},{"./globalState":4}],10:[function(n,r,i){function o(C){return function(E){if(Array.isArray(E)){for(var I=0,M=new Array(E.length);I<E.length;I++)M[I]=E[I];return M}}(C)||function(E){if(Symbol.iterator in Object(E)||Object.prototype.toString.call(E)==="[object Arguments]")return Array.from(E)}(C)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(C){return(s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(E){return typeof E}:function(E){return E&&typeof Symbol=="function"&&E.constructor===Symbol&&E!==Symbol.prototype?"symbol":typeof E})(C)}var a=n("./unformatting"),l=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(C,E){return E.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(C){return C.output==="byte"}},characteristic:{type:"number",restriction:function(C){return 0<=C},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(C){return 0<=C},message:"value must be positive"},{restriction:function(C,E){return!E.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(C){return 0<=C},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(C,E){return E.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:function(C){return C.match(l)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function d(C){return!!a.unformat(C)}function g(C,E,I){var M=3<arguments.length&&arguments[3]!==void 0&&arguments[3],y=Object.keys(C).map(function($){if(!E[$])return console.error("".concat(I," Invalid key: ").concat($)),!1;var q=C[$],G=E[$];if(typeof G=="string"&&(G={type:G}),G.type==="format"){if(!g(q,u,"[Validate ".concat($,"]"),!0))return!1}else if(s(q)!==G.type)return console.error("".concat(I," ").concat($,' type mismatched: "').concat(G.type,'" expected, "').concat(s(q),'" provided')),!1;if(G.restrictions&&G.restrictions.length)for(var X=G.restrictions.length,re=0;re<X;re++){var v=G.restrictions[re],S=v.restriction,b=v.message;if(!S(q,C))return console.error("".concat(I," ").concat($," invalid value: ").concat(b)),!1}return G.restriction&&!G.restriction(q,C)?(console.error("".concat(I," ").concat($," invalid value: ").concat(G.message)),!1):G.validValues&&G.validValues.indexOf(q)===-1?(console.error("".concat(I," ").concat($," invalid value: must be among ").concat(JSON.stringify(G.validValues),', "').concat(q,'" provided')),!1):!(G.children&&!g(q,G.children,"[Validate ".concat($,"]")))});return M||y.push.apply(y,o(Object.keys(E).map(function($){var q=E[$];if(typeof q=="string"&&(q={type:q}),q.mandatory){var G=q.mandatory;if(typeof G=="function"&&(G=G(C)),G&&C[$]===void 0)return console.error("".concat(I,' Missing mandatory key "').concat($,'"')),!1}return!0}))),y.reduce(function($,q){return $&&q},!0)}function p(C){return g(C,u,"[Validate format]")}r.exports={validate:function(C,E){var I=d(C),M=p(E);return I&&M},validateFormat:p,validateInput:d,validateLanguage:function(C){return g(C,c,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(q6);const Vs=XC,X6="numeric";function Lb(t,e,n,r,i,o,s){let a=o;if(er(a)){const l=s.numericFormat,u=l&&l.culture||"-",c=l&&l.pattern,d=s.className||"",g=d.length?d.split(" "):[];if(typeof u<"u"&&!Vs.languages()[u]){const p=u.replace("-",""),C=Vs.allLanguages?Vs.allLanguages[u]:Vs[p];C&&Vs.registerLanguage(C)}Vs.setLanguage(u),a=Vs(a).format(c||"0"),g.indexOf("htLeft")<0&&g.indexOf("htCenter")<0&&g.indexOf("htRight")<0&&g.indexOf("htJustify")<0&&g.push("htRight"),g.indexOf("htNumeric")<0&&g.push("htNumeric"),s.className=g.join(" "),e.dir="ltr"}Go(t,e,n,r,i,a,s)}Lb.RENDERER_TYPE=X6;const Z6="password";function $b(t,e,n,r,i,o,s){Go.apply(this,[t,e,n,r,i,o,s]);const a=s.hashLength||e.innerHTML.length,l=s.hashSymbol||"*";let u="";xe(a-1,()=>{u+=l}),Pa(e,u)}$b.RENDERER_TYPE=Z6;const Q6="time";function kb(t,e,n,r,i,o,s){Go.apply(this,[t,e,n,r,i,o,s]),e.dir="ltr"}kb.RENDERER_TYPE=Q6;function J6(){ki(Jl),ki(sh),ki(Db),ki(Hb),ki(Lb),ki($b),ki(Go),ki(kb)}const e9="autocomplete";function Qg(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,YE(n,e)):YE(n,e)(this.source):e(!0)}Qg.VALIDATOR_TYPE=e9;function YE(t,e){const n=t;return function(r){let i=!1;for(let o=0,s=r.length;o<s;o++)if(n===r[o]){i=!0;break}e(i)}}function nH(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const t9=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:nH},Symbol.toStringTag,{value:"Module"})),n9="date";function Fb(t,e){const n=RP(qx,this.instance);let r=t,i=!0;r==null&&(r="");let o=le(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=le(new Date(r)).isValid()||o;if(this.allowEmpty&&r===""&&(s=!0,o=!0),s||(i=!1),!s&&o&&(i=!0),s&&!o)if(this.correctFormat===!0){const a=r9(r,this.dateFormat),l=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(l,u,a,"dateValidator"),i=!0}else i=!1;e(i)}Fb.VALIDATOR_TYPE=n9;function r9(t,e){const n=le(nH(t)),r=le(t,e),i=t.search(/[A-z]/g)>-1;let o;return n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||i?o=n:o=r,o.format(e)}const i9="numeric";function Wb(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:er(t))}Wb.VALIDATOR_TYPE=i9;const o9=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],s9="time";function Vb(t,e){const n=this.timeFormat||"h:mm:ss a";let r=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const o=/^\d{1,2}$/.test(i);o&&(i+=":00");const s=le(i,o9,!0).isValid()?le(i):le(i,n);let a=s.isValid(),l=le(i,n,!0).isValid()&&!o;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(r=!1),!a&&l&&(r=!0),a&&!l)if(this.correctFormat===!0){const u=s.format(n),c=this.instance.toVisualRow(this.row),d=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(c,d,u,"timeValidator"),r=!0}else r=!1;e(r)}Vb.VALIDATOR_TYPE=s9;function a9(){Il(Qg),Il(Fb),Il(Wb),Il(Vb)}const l9="autocomplete",u9={CELL_TYPE:l9,editor:Pb,renderer:Jl,validator:Qg},c9="checkbox",h9={CELL_TYPE:c9,editor:Kx,renderer:Db},d9="date";function rH(t,e,n,r,i,o,s){Jl.apply(this,[t,e,n,r,i,o,s])}rH.RENDERER_TYPE=d9;const f9="date",g9={CELL_TYPE:f9,editor:Xx,renderer:rH,validator:Fb},m9="dropdown",p9={CELL_TYPE:m9,editor:xb,renderer:Jl,validator:Qg},w9="handsontable";function iH(t,e,n,r,i,o,s){Jl.apply(this,[t,e,n,r,i,o,s])}iH.RENDERER_TYPE=w9;const C9="handsontable",v9={CELL_TYPE:C9,editor:Ib,renderer:iH},S9="numeric",y9={CELL_TYPE:S9,editor:Zx,renderer:Lb,validator:Wb,dataType:"number"},b9="password",R9={CELL_TYPE:b9,editor:Qx,renderer:$b,copyable:!1},E9="select";function oH(t,e,n,r,i,o,s){Go.apply(this,[t,e,n,r,i,o,s])}oH.RENDERER_TYPE=E9;const T9="select",_9={CELL_TYPE:T9,editor:Jx,renderer:oH},M9="time",O9={CELL_TYPE:M9,editor:eH,renderer:kb,validator:Vb};function A9(){$r(u9),$r(h9),$r(g9),$r(p9),$r(v9),$r(y9),$r(R9),$r(_9),$r(jx),$r(O9)}function I9(t,e){sH(t,e),e.add(t)}function P9(t,e,n){sH(t,e),e.set(t,n)}function sH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ya(t,e,n){return e=x9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function x9(t){var e=H9(t,"string");return typeof e=="symbol"?e:String(e)}function H9(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function D9(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Ga(t,e){var n=N9(t,e,"get");return L9(t,n)}function N9(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function L9(t,e){return e.get?e.get.call(t):e.value}const GE=new Map([["plugin",Ez],["cell-type",$x],["editor",bP],["renderer",PP],["validator",xP]]),$9="base",Mp=[];let Ai=null;var Bs=new WeakMap,zE=new WeakSet;class gt{static get PLUGIN_KEY(){return $9}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(e){I9(this,zE),Ya(this,"eventManager",new Mr(this)),Ya(this,"pluginName",null),Ya(this,"pluginsInitializedCallbacks",[]),Ya(this,"isPluginsReady",!1),Ya(this,"enabled",!1),Ya(this,"initialized",!1),P9(this,Bs,{writable:!0,value:{}}),Ji(this,"hot",e,{writable:!1}),Ai=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const i=[];if(n.forEach(o=>{const[s,a]=o.split(":");if(!GE.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);GE.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");Mp.push(o)}}if(Ai||(Ai=MS()),Ai.indexOf("UndoRedo")>=0&&Ai.splice(Ai.indexOf("UndoRedo"),1),Ai.indexOf(this.pluginName)>=0&&Ai.splice(Ai.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),Ai.length===0){if(Mp.length>0){const i=[`${Mp.join(`
`)}
`,"You have to import and register them manually."].join("");throw new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}addHook(e,n){Ga(this,Bs)[e]=Ga(this,Bs)[e]||[];const r=Ga(this,Bs)[e];this.hot.addHook(e,n),r.push(n),Ga(this,Bs)[e]=r}removeHooks(e){H(Ga(this,Bs)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=Ga(this,Bs);Ze(e,(n,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){H(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=D9(this,zE,k9).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),Ze(this,(n,r)=>{r!=="hot"&&(this[r]=null)}),delete this.t,delete this.hot}}function k9(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function Us(t,e,n){return e=F9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function F9(t){var e=W9(t,"string");return typeof e=="symbol"?e:String(e)}function W9(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let V9=class{constructor(e){Us(this,"hot",null),Us(this,"container",null),Us(this,"injected",!1),Us(this,"rows",[]),Us(this,"columns",[]),Us(this,"samples",null),Us(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={row:e};this.rows.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={col:e};this.columns.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),H(this.rows,n=>{e(n.row,Bt(n.table)-1)})}getWidths(e){this.injected||this.injectTable(),H(this.columns,n=>{const{width:r}=n.table.getBoundingClientRect();e(n.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(r=>{H(r.strings,i=>{n.appendChild(this.createColElement(i.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),r.appendChild(i)),this.samples.forEach(o=>{H(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a);l.col=a,l.row=e;const u=this.hot.getCellRenderer(l),c=n.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),r.appendChild(c)})}),r}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");r.push([-1,i]),n.appendChild(i)}this.samples.forEach(i=>{H(i.strings,o=>{const s=o.col,a=e.createElement("th");r.push([s,a]),n.appendChild(a)})}),this.table.tHead.appendChild(n),H(r,i=>{const[o,s]=i;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment();return this.samples.forEach(i=>{H(i.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e);a.col=e,a.row=s;const l=this.hot.getCellRenderer(a),u=n.createElement("td"),c=n.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),r.appendChild(c)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const r=this.hot.rootDocument.createElement("col");let i=0;n>=0&&e>=0&&(i=this.hot.getCellMeta(n,e).colspan);let o=this.hot.view._wt.wtTable.getStretchedColumnWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)o+=this.hot.view._wt.wtTable.getStretchedColumnWidth(s);return r.style.width=`${o}px`,r}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("table"),o=n.createElement("thead"),s=n.createElement("tbody"),a=n.createElement("colgroup"),l=n.createElement("tr"),u=n.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&s.appendChild(l),i.appendChild(s),ce(i,e),r.appendChild(i),{fragment:r,table:i,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return ce(i,o),r.appendChild(i),{fragment:r,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};const Bb=V9;function Jh(t,e,n){return e=B9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function B9(t){var e=U9(t,"string");return typeof e=="symbol"?e:String(e)}function U9(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ub{static get SAMPLE_COUNT(){return 3}constructor(e){Jh(this,"samples",null),Jh(this,"dataFactory",null),Jh(this,"customSampleCount",null),Jh(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:Ub.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,r){const i=new Map,{from:o,to:s}=typeof r=="number"?{from:r,to:r}:r;return xe(o,s,a=>{const l=this.generateSample(e,n,a);i.set(a,l)}),i}generateSample(e,n,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,o=e==="row"?"col":"row",s=[];return xe(n.from,n.to,a=>{const l=e==="row"?this.dataFactory(r,a):this.dataFactory(a,r);if(l===!1)return;const{value:u,bundleSeed:c}=l,d=typeof c=="string"&&c.length>0;let g;d?g=c:qe(u)?g=`${Object.keys(u).length}`:Array.isArray(u)?g=`${u.length}`:g=`${Zt(u).length}`,i.has(g)||i.set(g,{needed:this.getSampleCount(),strings:[]});const p=i.get(g);p.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||d)&&(p.strings.push({value:u,[o]:a}),s.push(u),p.needed-=1)}),i}}const aH=Ub;function za(t,e){lH(t,e),e.add(t)}function Y9(t,e,n){lH(t,e),e.set(t,n)}function lH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ja(t,e,n){return e=G9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function G9(t){var e=z9(t,"string");return typeof e=="symbol"?e:String(e)}function z9(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function j9(t,e,n){var r=uH(t,e,"set");return K9(t,r,n),n}function K9(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function ed(t,e){var n=uH(t,e,"get");return q9(t,n)}function uH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function q9(t,e){return e.get?e.get.call(t):e.value}function Ys(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}_e.getSingleton().register("modifyAutoColumnSizeSeed");const Eu="autoColumnSize",X9=10,Z9="autoColumnSize";var El=new WeakMap,jE=new WeakSet,KE=new WeakSet,qE=new WeakSet,Op=new WeakSet,XE=new WeakSet,ZE=new WeakSet;class hc extends gt{static get PLUGIN_KEY(){return Eu}static get PLUGIN_PRIORITY(){return X9}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),za(this,ZE),za(this,XE),za(this,Op),za(this,qE),za(this,KE),za(this,jE),ja(this,"ghostTable",new Bb(this.hot)),ja(this,"samplesGenerator",new aH((n,r)=>{const i=this.hot.getCellMeta(n,r);let o="";i.spanned||(o=this.hot.getDataAtCell(n,r));let s="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(s=this.hot.runHooks("modifyAutoColumnSizeSeed",s,i,o)),{value:o,bundleSeed:s}})),ja(this,"firstCalculation",!0),ja(this,"inProgress",!1),ja(this,"measuredColumns",0),ja(this,"columnWidthsMap",new Ps),Y9(this,El,{writable:!0,value:[]}),this.hot.columnIndexMapper.registerMap(Z9,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,r,i)=>Ys(this,Op,QE).call(this,n,r,i))}isEnabled(){return this.hot.getSettings()[Eu]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Eu];n&&n.useHeaders!==null&&n.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",n.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ys(e,KE,J9).call(e,...i)}),this.addHook("beforeChangeRender",r=>Ys(this,qE,e8).call(this,r)),this.addHook("afterFormulasValuesUpdate",r=>Ys(this,ZE,n8).call(this,r)),this.addHook("beforeViewRender",r=>Ys(this,jE,Q9).call(this,r)),this.addHook("modifyColWidth",(r,i)=>this.getColumnWidth(i,r)),this.addHook("afterInit",()=>Ys(this,XE,t8).call(this)),super.enablePlugin()}updatePlugin(){const e=this.findColumnsWhereHeaderWasChanged();e.length&&(this.clearCache(e),this.calculateVisibleColumnsWidth()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,r)=>Ys(this,Op,QE).call(this,e,n,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const n=this.hot.renderCall,r=this.getFirstVisibleColumn(),i=this.getLastVisibleColumn();r===-1||i===-1||this.calculateColumnsWidth({from:r,to:i},void 0,n)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;xe(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);if(a===null&&(a=s),r||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a)){const l=this.samplesGenerator.generateColumnSamples(s,o);H(l,u=>{let[c,d]=u;return this.ghostTable.addColumn(c,d)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((s,a)=>{const l=this.hot.toPhysicalColumn(s);this.columnWidthsMap.setValueAtIndex(l,a)})},!0),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=0;const r=this.hot.countCols()-1;let i=null;this.inProgress=!0;const o=()=>{if(!this.hot){Dc(i),this.inProgress=!1;return}this.calculateColumnsWidth({from:n,to:Math.min(n+hc.CALCULATION_STEP,r)},e),n=n+hc.CALCULATION_STEP+1,n<r?i=Ug(o):(Dc(i),this.inProgress=!1,this.hot.view.adjustElementsSize())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateColumnsWidth({from:0,to:s},e),this.firstCalculation=!1,n=s+1),n<r?o():this.inProgress=!1}setSamplingOptions(){const e=this.hot.getSettings()[Eu],n=e&&Vt(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&Vt(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllColumnsWidth(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}getSyncCalculationLimit(){const e=this.hot.getSettings()[Eu];let n=hc.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return qe(e)&&(n=e.syncLimit,sS(n)?n=TS(r,n):n>>=0),Math.min(n,r)}getColumnWidth(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=n;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof i=="number"&&(i=Math.max(i,IS.DEFAULT_WIDTH))),i}getFirstVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const n=e.wtTable.getFirstVisibleColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}if(e.wtViewport.columnsRenderCalculator){const n=e.wtTable.getFirstRenderedColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}getLastVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const n=e.wtTable.getLastVisibleColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}if(e.wtViewport.columnsRenderCalculator){const n=e.wtTable.getLastRenderedColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}findColumnsWhereHeaderWasChanged(){const e=this.hot.getColHeader();return nn(e,(r,i,o)=>{const s=ed(this,El).length;return(s-1<o||ed(this,El)[o]!==i)&&r.push(o),s-1<o?ed(this,El).push(i):ed(this,El)[o]=i,r},[])}clearCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];e.length?this.hot.batchExecution(()=>{H(e,n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!_r(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function Q9(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}function J9(){this.hot.view?this.recalculateAllColumnsWidth():setTimeout(()=>{this.hot&&this.recalculateAllColumnsWidth()},0)}function e8(t){const e=Xe(t,n=>{let[,r]=n;return this.hot.toPhysicalColumn(this.hot.propToCol(r))});this.clearCache(Array.from(new Set(e)))}function QE(t,e,n){let r=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function t8(){j9(this,El,this.hot.getColHeader())}function n8(t){const e=_r(t,r=>{var i;return Re((i=r.address)===null||i===void 0?void 0:i.col)}),n=Xe(e,r=>r.address.col);this.clearCache(Array.from(new Set(n)))}const fa={horizontal:"horizontal",vertical:"vertical"};function r8(t,e,n){let r,i,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",r=n(e[0],e[1]),i=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",r=n(e[0],t[3]+1),i=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",r=n(e[0],e[1]),i=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",r=n(t[2]+1,e[1]),i=n(e[2],e[3])),r&&r.normalize(),i&&i.normalize(),{directionOfDrag:o,startOfDragCoords:r,endOfDragCoords:i}}function i8(t){const e={};return t===!0?(e.directions=Object.keys(fa),e.autoInsertRow=!0):qe(t)?(Re(t.autoInsertRow)?t.direction===fa.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,Re(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(fa)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function Tu(t,e){o8(t,e),e.add(t)}function o8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ka(t,e,n){return e=s8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s8(t){var e=a8(t,"string");return typeof e=="symbol"?e:String(e)}function a8(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _u(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}_e.getSingleton().register("modifyAutofillRange");_e.getSingleton().register("beforeAutofill");_e.getSingleton().register("afterAutofill");const JE="autofill",l8=20,u8=["fillHandle"],c8="insert_row_below",h8=200;var eT=new WeakSet,tT=new WeakSet,nT=new WeakSet,rT=new WeakSet,iT=new WeakSet;class d8 extends gt{constructor(){super(...arguments),Tu(this,iT),Tu(this,rT),Tu(this,nT),Tu(this,tT),Tu(this,eT),Ka(this,"addingStarted",!1),Ka(this,"mouseDownOnCellCorner",!1),Ka(this,"mouseDragOutside",!1),Ka(this,"handleDraggedCells",0),Ka(this,"directions",[]),Ka(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return JE}static get PLUGIN_PRIORITY(){return l8}static get SETTING_KEYS(){return[JE,...u8]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>_u(this,tT,g8).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>_u(this,eT,f8).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>_u(this,nT,m8).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:r,endRow:i,endCol:o}]),a=[],l=[],u=[];return H(s,c=>{for(let d=c.startRow;d<=c.endRow;d+=1)a.indexOf(d)===-1&&a.push(d);for(let d=c.startCol;d<=c.endCol;d+=1)l.indexOf(d)===-1&&l.push(d)}),H(a,c=>{const d=[];H(l,g=>{d.push(this.hot.getCopyableData(c,g))}),u.push(d)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,r,i]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),s=o.getTopStartCorner(),a=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[s.row,s.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,n),Math.max(a.row,r),Math.max(a.col,i)],l),{directionOfDrag:c,startOfDragCoords:d,endOfDragCoords:g}=r8(l,u,(p,C)=>this.hot._createCellCoords(p,C));if(d&&d.row>-1&&d.col>-1){const p=this.getSelectionData(),C=o.clone(),E=this.hot._createCellRange(d,d,g),I=this.hot.runHooks("beforeAutofill",p,C,E,c);if(I===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let M=I;const y=I;if(["up","left"].indexOf(c)>-1&&!(y.length===1&&y[0].length===0))if(M=[],c==="up"){const $=g.row-d.row+1,q=$%y.length;for(let G=0;G<$;G++)M.push(y[(G+(y.length-q))%y.length])}else{const $=g.col-d.col+1,q=$%y[0].length;for(let G=0;G<y.length;G++){M.push([]);for(let X=0;X<$;X++)M[G].push(y[G][(X+(y[G].length-q))%y[G].length])}}this.hot.populateFromArray(d.row,d.col,M,g.row,g.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",M,C,E,c),this.hot.render()}else this.hot._refreshBorders();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),r=n.getBottomEndCorner();let i=e;if(this.directions.includes(fa.vertical)&&this.directions.includes(fa.horizontal)){const o=n.getTopStartCorner();(r.col<=e.col||o.col>=e.col)&&(i=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||o.row>e.row)&&(i=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(fa.vertical))i=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(fa.horizontal))i=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(c8,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},h8)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&n[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),r=this.hot.countRows();let i;for(let o=e[2]+1;o<r;o++){for(let l=e[1];l<=e[3];l++)if(n[o][l])return-1;const s=n[o][e[1]-1],a=n[o][e[3]+1];(s||a)&&(i=o)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...Xe(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,r=ln(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+Bt(this.hot.table),i=ln(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+yt(this.hot.table);return e.clientY>r&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>_u(this,rT,p8).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>_u(this,iT,w8).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=i8(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function f8(){this.selectAdjacent()&&this.fillIn()}function g8(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function m8(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function p8(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function w8(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function td(t,e){C8(t,e),e.add(t)}function C8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gs(t,e,n){return e=v8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function v8(t){var e=S8(t,"string");return typeof e=="symbol"?e:String(e)}function S8(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Mu(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const nd="autoRowSize",y8=40,b8="autoRowSize";var oT=new WeakSet,Ap=new WeakSet,sT=new WeakSet,aT=new WeakSet;class dc extends gt{static get PLUGIN_KEY(){return nd}static get PLUGIN_PRIORITY(){return y8}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),td(this,aT),td(this,sT),td(this,Ap),td(this,oT),Gs(this,"headerHeight",null),Gs(this,"ghostTable",new Bb(this.hot)),Gs(this,"samplesGenerator",new aH((n,r)=>{if(n>=0&&r>=0&&this.hot.getCellMeta(n,r).hidden)return!1;let i;return n>=0?i=this.hot.getDataAtCell(n,r):n===-1&&(i=this.hot.getColHeader(r)),{value:i}})),Gs(this,"firstCalculation",!0),Gs(this,"inProgress",!1),Gs(this,"measuredRows",0),Gs(this,"rowHeightsMap",new Ps),this.hot.rowIndexMapper.registerMap(b8,this.rowHeightsMap),this.addHook("beforeRowResize",(n,r,i)=>Mu(this,Ap,lT).call(this,n,r,i))}isEnabled(){const e=this.hot.getSettings()[nd];return e===!0||qe(e)}enablePlugin(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Mu(e,sT,E8).call(e,...r)}),this.addHook("beforeChangeRender",n=>Mu(this,aT,T8).call(this,n)),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("beforeViewRender",n=>Mu(this,oT,R8).call(this,n)),this.addHook("modifyRowHeight",(n,r)=>this.getRowHeight(r,n)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,n,r)=>Mu(this,Ap,lT).call(this,e,n,r))}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const s=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(s.get(-1))}xe(i.from,i.to,s=>{if(r||this.rowHeightsMap.getValueAtIndex(s)===null){const a=this.samplesGenerator.generateRowSamples(s,o);H(a,l=>{let[u,c]=l;return this.ghostTable.addRow(u,c)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((s,a)=>{s<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(s),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=0;const r=this.hot.countRows()-1;let i=null;this.inProgress=!0;const o=()=>{if(!this.hot){Dc(i),this.inProgress=!1;return}this.calculateRowsHeight({from:n,to:Math.min(n+dc.CALCULATION_STEP,r)},e),n=n+dc.CALCULATION_STEP+1,n<r?i=Ug(o):(Dc(i),this.inProgress=!1,this.hot.view.adjustElementsSize(!0),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateRowsHeight({from:0,to:s},e),this.firstCalculation=!1,n=s+1),n<r?o():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}setSamplingOptions(){const e=this.hot.getSettings()[nd],n=e&&Vt(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&Vt(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllRowsHeight(){_s(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}getSyncCalculationLimit(){const e=this.hot.getSettings()[nd];let n=dc.SYNC_CALCULATION_LIMIT;const r=this.hot.countRows()-1;return qe(e)&&(n=e.syncLimit,sS(n)?n=TS(r,n):n>>=0),Math.min(n,r)}getRowHeight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0;const r=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let i=n;return r!==null&&r>(n||0)&&(i=r),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getFirstVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getFirstRenderedRow():-1}getLastVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getLastVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getLastRenderedRow():-1}clearCache(){this.headerHeight=null,this.rowHeightsMap.init()}clearCacheByRange(e){const{from:n,to:r}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{xe(Math.min(n,r),Math.max(n,r),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!_r(this.rowHeightsMap.getValues().slice(0,this.measuredRows),e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function R8(){const t=this.hot.renderCall,e=this.hot.getSettings().fixedRowsBottom,n=this.getFirstVisibleRow(),r=this.getLastVisibleRow();if(!(n===-1||r===-1)){if(this.calculateRowsHeight({from:n,to:r},void 0,t),e){const i=this.hot.countRows()-1;this.calculateRowsHeight({from:i-e,to:i})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}function lT(t,e,n){let r=t;return n&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}function E8(){this.hot.view?this.recalculateAllRowsHeight():this.hot._registerTimeout(()=>{this.hot&&this.recalculateAllRowsHeight()})}function T8(t){let e=null;t.length===1?e=t[0][0]:t.length>1&&(e={from:t[0][0],to:t[t.length-1][0]}),e!==null&&this.clearCacheByRange(e)}const{getListWithInsertedItems:_8,getListWithRemovedItems:M8}=mx("physicallyIndexed");class O8 extends xa{constructor(){super(e=>e)}insert(e,n){const r=ny(this.indexedValues,n);this.indexedValues=_8(r,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=M8(this.indexedValues,e);this.indexedValues=ty(n,e),super.remove(e)}}const A8=O8,{getListWithInsertedItems:I8,getListWithRemovedItems:P8}=mx("physicallyIndexed");class x8 extends xa{constructor(){super(e=>e)}insert(e,n){this.indexedValues=I8(this.indexedValues,e,n,(r,i)=>this.getNextValue(i)),super.insert(e,n)}remove(e){this.indexedValues=P8(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}const H8=x8;function D8(t,e){N8(t,e),e.add(t)}function N8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function L8(t,e,n){return e=$8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $8(t){var e=k8(t,"string");return typeof e=="symbol"?e:String(e)}function k8(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function F8(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Ip="bindRowsWithHeaders",W8=210,V8="loose",B8=new Map([["loose",A8],["strict",H8]]);var uT=new WeakSet;class U8 extends gt{constructor(){super(...arguments),D8(this,uT),L8(this,"headerIndexes",null)}static get PLUGIN_KEY(){return Ip}static get PLUGIN_PRIORITY(){return W8}isEnabled(){return!!this.hot.getSettings()[Ip]}enablePlugin(){if(this.enabled)return;let e=this.hot.getSettings()[Ip];typeof e!="string"&&(e=V8);const n=B8.get(e);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",r=>F8(this,uT,Y8).call(this,r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function Y8(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function rd(t,e){cH(t,e),e.add(t)}function G8(t,e,n){cH(t,e),e.set(t,n)}function cH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cT(t,e,n){return e=z8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function z8(t){var e=j8(t,"string");return typeof e=="symbol"?e:String(e)}function j8(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hT(t,e){var n=hH(t,e,"get");return K8(t,n)}function K8(t,e){return e.get?e.get.call(t):e.value}function id(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Pp(t,e,n){var r=hH(t,e,"set");return q8(t,r,n),n}function hH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function q8(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const nf="collapsibleColumns",X8=290,Z8=["nestedHeaders"],Ll="collapsibleIndicator",dT=nf,fT=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var qa=new WeakMap,gT=new WeakSet,mT=new WeakSet,pT=new WeakSet,wT=new WeakSet;class Q8 extends gt{constructor(){super(...arguments),rd(this,wT),rd(this,pT),rd(this,mT),rd(this,gT),cT(this,"nestedHeadersPlugin",null),cT(this,"headerStateManager",null),G8(this,qa,{writable:!0,value:null})}static get PLUGIN_KEY(){return nf}static get PLUGIN_PRIORITY(){return X8}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[nf,...Z8]}isEnabled(){return!!this.hot.getSettings()[nf]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||Pt("You need to configure the Nested Headers plugin in order to use collapsible headers."),Pp(this,qa,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>id(this,pT,t7).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return id(e,wT,n7).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return id(e,gT,J8).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(r,i,o)=>id(this,mT,e7).call(this,r,i,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Pp(this,qa,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:r}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:o,columnIndex:s}=(e=this.headerStateManager.getHeaderTreeNodeData(n,r))!==null&&e!==void 0?e:{};i&&(o?this.expandSection({row:n,col:s}):this.collapseSection({row:n,col:s}))},runOnlyIf:()=>{var e;return(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight.isHeader()},group:dT})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(dT)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(s){s&&s.parentNode.removeChild(s)};xe(0,e-1,s=>{const a=n.childNodes[s],l=r.childNodes[s],u=i?i.childNodes[s]:null;xe(0,a.childNodes.length-1,c=>{let d=a.childNodes[c].querySelector(`.${Ll}`);o(d),l&&l.childNodes[c]&&(d=l.childNodes[c].querySelector(`.${Ll}`),o(d)),i&&u&&u.childNodes[c]&&(d=u.childNodes[c].querySelector(`.${Ll}`),o(d))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(r=>{const{collapsible:i,origColspan:o,headerLevel:s,columnIndex:a,isCollapsed:l}=r;if(i===!0&&o>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(s),col:a}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!fT.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const r=_r(e,g=>{let{row:p}=g;return p<0});let i=r.length>0;H(r,g=>{var p;let{row:C,col:E}=g;const{collapsible:I,isCollapsed:M}=(p=this.headerStateManager.getHeaderSettings(C,E))!==null&&p!==void 0?p:{};if(!I||M&&n==="collapse"||!M&&n==="expand")return i=!1,!1});const o=[],s=[];i&&H(r,g=>{let{row:p,col:C}=g;const{colspanCompensation:E,affectedColumns:I,rollbackModification:M}=this.headerStateManager.triggerNodeModification(n,p,C);E>0&&(s.push(...I),o.push(M))});const a=this.getCollapsedColumns();let l=[];n==="collapse"?l=iS([...a,...s]):n==="expand"&&(l=_r(a,g=>!s.includes(g)));const u=fT.get(n);if(this.hot.runHooks(u.beforeHook,a,l,i)===!1){H(o,g=>{g()});return}this.hot.batchExecution(()=>{H(s,g=>{hT(this,qa).setValueAtIndex(this.hot.toPhysicalColumn(g),u.hideColumn)})},!0);const d=this.getCollapsedColumns().length!==a.length;this.hot.runHooks(u.afterHook,a,l,i,d),this.hot.render(),this.hot.view.adjustElementsSize(!0)}getCollapsedColumns(){return hT(this,qa).getHiddenIndexes()}destroy(){Pp(this,qa,null),super.destroy()}}function J8(t,e,n){var r;const{collapsible:i,origColspan:o,isCollapsed:s}=(r=this.headerStateManager.getHeaderSettings(n,t))!==null&&r!==void 0?r:{},a=i&&o>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${Ll}`);if(Ia(e,[Ur("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),ce(u,Ll),e.querySelector("div:first-child").appendChild(u)),Ye(u,["collapsed","expanded"]),s?(ce(u,"collapsed"),Ts(u,"+"),l&&Ne(e,...Ur(!1))):(ce(u,"expanded"),Ts(u,"-"),l&&Ne(e,...Ur(!0))),l&&Ne(u,...Vo());else{var c;(c=u)===null||c===void 0||c.remove()}}function e7(t,e){Ve(t.target,Ll)&&(Ve(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):Ve(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),Kr(t))}function t7(){this.updatePlugin()}function n7(t,e){e||this.updatePlugin()}function zs(t,e,n){return e=r7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r7(t){var e=i7(t,"string");return typeof e=="symbol"?e:String(e)}function i7(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const o7=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],s7=!1,a7=!0,l7=!0;class u7{constructor(e,n){zs(this,"hot",void 0),zs(this,"sortingStates",new zg),zs(this,"sortEmptyCells",s7),zs(this,"indicator",a7),zs(this,"headerAction",l7),zs(this,"compareFunctionFactory",void 0),zs(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){qe(e)&&Ze(e,(n,r)=>{o7.includes(r)&&(this[r]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[r]=n;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return qe(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[r,i]=n;return{column:this.hot.toVisualColumn(r),...i}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(Re(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}const Uf="asc",Yf="desc",dH="colHeader";function c7(t){if(qe(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[Uf,Yf].includes(n)}function h7(t){if(t.some(n=>c7(n)===!1))return!1;const e=t.map(n=>{let{column:r}=n;return r});return new Set(e).size===e.length}function CT(t){if(t!==Yf)return t===Uf?Yf:Uf}function fH(t){return t.querySelector(`.${dH}`)}function gH(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function Yb(t,e,n){return t===-1&&e>=0&&Ms(n)===!1}const d7="ascending",f7="descending",mH="indicatorDisabled",pH="columnSorting",wH="sortAction",CH=new Map([[Uf,d7],[Yf,f7]]);function g7(t,e,n,r){const i=[pH];if(r&&i.push(wH),n===!1)return i.push(mH),i;const o=t.getSortOrderOfColumn(e);return Re(o)&&i.push(CH.get(o)),i}function m7(){return Array.from(CH.values()).concat(wH,mH,pH)}function vH(t,e,n){const r=e.locale;return function(i,o){const{sortEmptyCells:s}=n;return typeof i=="string"&&(i=i.toLocaleLowerCase(r)),typeof o=="string"&&(o=o.toLocaleLowerCase(r)),i===o?ji:mn(i)?mn(o)?ji:s&&t==="asc"?qt:Xt:mn(o)?s&&t==="asc"?Xt:qt:isNaN(i)&&!isNaN(o)?t==="asc"?Xt:qt:!isNaN(i)&&isNaN(o)||(isNaN(i)||isNaN(o)||(i=parseFloat(i),o=parseFloat(o)),i<o)?t==="asc"?qt:Xt:i>o?t==="asc"?Xt:qt:ji}}const SH="default";function p7(t,e,n){return function(r,i){const o=parseFloat(r),s=parseFloat(i),{sortEmptyCells:a}=n;if(o===s||isNaN(o)&&isNaN(s))return ji;if(a){if(mn(r))return t==="asc"?qt:Xt;if(mn(i))return t==="asc"?Xt:qt}return isNaN(o)?Xt:isNaN(s)?qt:o<s?t==="asc"?qt:Xt:o>s?t==="asc"?Xt:qt:ji}}const w7="numeric";function C7(t,e,n){const r=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:o}=n;return function(s,a){const l=mn(s),u=mn(a),c=l?i:s,d=u?i:a,g=c===i||c===r,p=d===i||d===r;if(o===!1){if(l&&u===!1)return Xt;if(l===!1&&u)return qt}return g===!1&&p?t==="asc"?qt:Xt:g&&p===!1?t==="asc"?Xt:qt:g===!1&&p===!1?vH(t,e,n)(s,a):c===i&&d===r?t==="asc"?qt:Xt:c===r&&d===i?t==="asc"?Xt:qt:ji}}const v7="checkbox";function S7(t,e,n){return function(r,i){const{sortEmptyCells:o}=n;if(r===i)return ji;if(mn(r))return mn(i)?ji:o&&t==="asc"?qt:Xt;if(mn(i))return o&&t==="asc"?Xt:qt;const s=e.dateFormat,a=le(r,s),l=le(i,s);return a.isValid()?l.isValid()?l.isAfter(a)?t==="asc"?qt:Xt:l.isBefore(a)?t==="asc"?Xt:qt:ji:qt:Xt}}const y7="date",{register:Jg,getItem:vT,hasItem:b7}=yi("sorting.compareFunctionFactory"),{register:yH,getItem:R7}=yi("sorting.mainSortComparator");function bH(t){return b7(t)?vT(t):vT(SH)}Jg(w7,p7);Jg(v7,C7);Jg(y7,S7);Jg(SH,vH);const ji=0,qt=-1,Xt=1;function E7(t,e){const n=R7(e);for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];t.sort(n(...i))}function T7(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function(a){const l=t[a],u=e[a],c=i[a],d=o[a],g=u.columnSorting;return(g.compareFunctionFactory?g.compareFunctionFactory:bH(u.type))(l,u,g)(c,d)}(0)}}function od(t,e){_7(t,e),e.add(t)}function _7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sd(t,e,n){return e=M7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function M7(t){var e=O7(t,"string");return typeof e=="symbol"?e:String(e)}function O7(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Tl(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Gf="columnSorting",A7=50,zf="append",I7="replace",ST=Gf;yH(Gf,T7);_e.getSingleton().register("beforeColumnSort");_e.getSingleton().register("afterColumnSort");var rf=new WeakSet,yT=new WeakSet,bT=new WeakSet,RT=new WeakSet;class RH extends gt{constructor(){super(...arguments),od(this,RT),od(this,bT),od(this,yT),od(this,rf),sd(this,"columnStatesManager",null),sd(this,"columnMetaCache",null),sd(this,"pluginKey",Gf),sd(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return Gf}static get PLUGIN_PRIORITY(){return A7}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new u7(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new Ps(n=>{let r=this.hot.toVisualColumn(n);return r===null&&(r=n),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,r)=>Tl(this,yT,P7).call(this,n,r)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tl(e,RT,H7).call(e,...r)}),this.addHook("afterOnCellMouseDown",(n,r)=>this.onAfterOnCellMouseDown(n,r)),this.addHook("afterInit",()=>Tl(this,rf,ZC).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tl(e,bT,x7).call(e,...r)}),this.hot.view&&Tl(this,rf,ZC).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,r)=>{const i=fH(r);gH(n,r)===!1||i===null||this.updateHeaderClasses(i)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();e.row===-1&&e.col>=0&&this.sort(this.getColumnNextConfig(e.col))},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()},group:ST})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(ST)}sort(e){const n=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",n,r,i)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new px),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",n,i?r:n,i),i&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return Re(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return h7(e)&&e.every(r=>{let{column:i}=r;return i<=n&&i>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),r=i=>{let{column:o,...s}=i;return{column:this.hot.toPhysicalColumn(o),...s}};n.initialConfig=Xe(e,r),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,r=i=>{let{column:o,...s}=i;return{column:this.hot.toVisualColumn(o),...s}};return Re(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=Xe(n.initialConfig,r)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(Re(n)){const i=CT(n);return Re(i)?{column:e,sortOrder:i}:void 0}const r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:CT()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:zf;const r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=r!==-1,o=this.getSortConfig(),s=this.getColumnNextConfig(e);if(i){if(It(s))return[...o.slice(0,r),...o.slice(r+1)];if(n===zf)return[...o.slice(0,r),...o.slice(r+1),s];if(n===I7)return[...o.slice(0,r),s,...o.slice(r+1)]}return Re(s)?o.concat(s):o}getPluginColumnConfig(e){if(qe(e)){const n=e[this.pluginKey];if(qe(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(i);return Array.isArray(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns[e])):At(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns(e))):Object.assign(r,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),r=Object.create(n);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(e.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}const n=[],r=this.hot.countRows(),i=u=>Xe(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(r);u+=1)n.push([this.hot.toPhysicalRow(u)].concat(i(u)));const o=Xe(n,u=>u[0]);E7(n,this.pluginKey,Xe(e,u=>u.sortOrder),Xe(e,u=>this.getFirstCellSettings(u.column)));for(let u=n.length;u<r;u+=1)n.push([u].concat(i(u)));const s=Xe(n,u=>u[0]),a=new Map(Xe(o,(u,c)=>[u,s[c]])),l=Xe(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(qe(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||qe(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if(Ye(e,m7()),this.enabled!==!1){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];ce(e,g7(...r))}}onUpdateSettings(e){super.onUpdateSettings(),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),Re(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&Ve(e.target,dH)}onAfterOnCellMouseDown(e,n){Yb(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col)),this.sort(this.getColumnNextConfig(n.col)))}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function ZC(){const t=this.getAllSavedSortSettings();if(qe(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function P7(t,e){const n=fH(e);if(gH(t,e)===!1||n===null)return;const r=this.getFirstCellSettings(t)[this.pluginKey],i=r.indicator,o=r.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,i,o),this.hot.getSettings().ariaTags){const s=this.columnStatesManager.getSortOrderOfColumn(t);Ne(e,...jY(s?`${s}ending`:"none"))}}function x7(t){t===!0&&this.hot.view&&Tl(this,rf,ZC).call(this)}function H7(t,e,n,r){Yb(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function js(t,e,n){return e=D7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function D7(t){var e=N7(t,"string");return typeof e=="symbol"?e:String(e)}function N7(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class L7{constructor(e,n){js(this,"plugin",void 0),js(this,"hot",void 0),js(this,"endpoints",[]),js(this,"settings",void 0),js(this,"settingsType","array"),js(this,"currentEndpoint",null),js(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),H(r,i=>{const o={};this.assignSetting(i,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,o,"reversedRowCoords",!1),this.assignSetting(i,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"sourceColumn",i.destinationColumn),this.assignSetting(i,o,"type","sum"),this.assignSetting(i,o,"forceNumeric",!1),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"customFunction",null),this.assignSetting(i,o,"readOnly",!0),this.assignSetting(i,o,"roundFloat",!1),n.push(o)}),n}assignSetting(e,n,r,i){if(r==="ranges"&&e[r]===void 0){n[r]=i;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(i instanceof Error)throw i;n[r]=i}else r==="destinationRow"&&n.reversedRowCoords?n[r]=this.hot.countRows()-e[r]-1:n[r]=e[r]}resetSetupBeforeStructureAlteration(e,n,r){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();H(o,s=>{i==="row"&&s.destinationRow>=n&&(e==="insert_row"?s.alterRowOffset=r:e==="remove_row"&&(s.alterRowOffset=-1*r)),i==="col"&&s.destinationColumn>=n&&(e==="insert_col"?s.alterColumnOffset=r:e==="remove_col"&&(s.alterColumnOffset=-1*r))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,n,r,i,o){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const g=()=>(this.hot.removeHook("beforeViewRender",g),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",g);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,d=n;H(u,g=>{a==="row"&&g.destinationRow>=d&&(g.alterRowOffset=l*r),a==="col"&&g.destinationColumn>=d&&(g.alterColumnOffset=l*r)}),this.resetAllEndpoints(u,!c),c?H(u,g=>{this.extendEndpointRanges(g,d,i[0],i.length),this.recreatePhysicalRanges(g),this.clearOffsetInformation(g)}):H(u,g=>{this.shiftEndpointCoordinates(g,d)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,r,i){H(e.ranges,o=>{o[1]&&(n>=o[0]&&n<=o[1]?r>o[1]?o[1]+=i:r<o[0]&&(o[0]-=i):r>=o[0]&&r<=o[1]&&(o[1]-=i,n<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,r=[],i=[];H(n,o=>{const s=[];if(o[1])for(let a=o[0];a<=o[1];a++)s.push(this.hot.toPhysicalRow(a));else s.push(this.hot.toPhysicalRow(o[0]));i.push(s)}),H(i,o=>{let s=[];H(o,(a,l)=>{l===0?s.push(a):o[l]!==o[l-1]+1&&(s.push(o[l-1]),r.push(s),s=[],s.push(a)),l===o.length-1&&(s.push(a),r.push(s))})}),e.ranges=r}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,H(e.ranges,r=>{H(r,(i,o)=>{i>=n&&(r[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const o=i.alterRowOffset||0,s=i.alterColumnOffset||0;return i.destinationRow+o>=this.hot.countRows()||i.destinationColumn+s>=this.hot.countCols()})||(this.cellsToSetCache=[],H(e,i=>{this.resetEndpointValue(i,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],H(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],H(e,(r,i,o)=>{`${r[2]||""}`!=`${r[3]}`&&H(this.getAllEndpoints(),(s,a)=>{this.hot.propToCol(o[i][1])===s.sourceColumn&&n.indexOf(a)===-1&&n.push(a)})}),H(n,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?r:0)),this.hot.toVisualColumn(e.destinationColumn+(n?i:0)),""])}setEndpointValue(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const s=this.hot.getCellMeta(o,e.destinationColumn);(n==="init"||s.readOnly!==e.readOnly)&&(s.readOnly=e.readOnly,s.className="columnSummaryResult")}e.roundFloat&&!isNaN(e.result)&&(e.result=e.result.toFixed(e.roundFloat)),r?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){Pt("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}const $7=L7;function xp(t){return t==null||isNaN(t)}function Hp(t,e){k7(t,e),e.add(t)}function k7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function F7(t,e,n){return e=W7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function W7(t){var e=V7(t,"string");return typeof e=="symbol"?e:String(e)}function V7(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Dp(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Np="columnSummary",B7=220;var ET=new WeakSet,TT=new WeakSet,_T=new WeakSet;class U7 extends gt{constructor(){super(...arguments),Hp(this,_T),Hp(this,TT),Hp(this,ET),F7(this,"endpoints",null)}static get PLUGIN_KEY(){return Np}static get PLUGIN_PRIORITY(){return B7}isEnabled(){return!!this.hot.getSettings()[Np]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[Np],this.endpoints=new $7(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Dp(e,ET,Y7).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Dp(e,TT,G7).call(e,...r)}),this.addHook("beforeCreateRow",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,r,null,i)),this.addHook("beforeCreateCol",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,r,null,i)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,r,null,i)),this.addHook("afterCreateCol",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,r,null,i)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Dp(e,_T,z7).call(e,...r)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return Ze(e.ranges,r=>{n+=this.getPartialSum(r,e.sourceColumn)}),n}getPartialSum(e,n){let r=0,i=e[1]||e[0],o=null,s=0;do{if(o=this.getCellValue(i,n),o=xp(o)?null:o,o!==null){const a=(`${o}`.split(".")[1]||[]).length||1;a>s&&(s=a)}r+=o||0,i-=1}while(i>=e[0]);return Math.round(r*10**s)/10**s}calculateMinMax(e,n){let r=null;return Ze(e.ranges,i=>{const o=this.getPartialMinMax(i,e.sourceColumn,n);if(r===null&&o!==null&&(r=o),o!==null)switch(n){case"min":r=Math.min(r,o);break;case"max":r=Math.max(r,o);break}}),r===null?"Not enough data":r}getPartialMinMax(e,n,r){let i=null,o=e[1]||e[0],s;do{if(s=this.getCellValue(o,n),s=xp(s)?null:s,i===null)i=s;else if(s!==null)switch(r){case"min":i=Math.min(i,s);break;case"max":i=Math.max(i,s);break}o-=1}while(o>=e[0]);return i}countEmpty(e,n){let r,i=0,o=e[1]||e[0];do r=this.getCellValue(o,n),r=xp(r)?null:r,r===null&&(i+=1),o-=1;while(o>=e[0]);return i}countEntries(e){let n=0;const r=e.ranges;return Ze(r,i=>{const o=i[1]===void 0?1:i[1]-i[0]+1,s=this.countEmpty(i,e.sourceColumn);n+=o,n-=s}),n}calculateAverage(e){const n=this.calculateSum(e),r=this.countEntries(e);return n/r}getCellValue(e,n){const r=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(n);let o=this.hot.getSourceDataAtCell(e,n),s="";if(r!==null&&i!==null&&(s=this.hot.getCellMeta(r,i).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(bt`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}}function Y7(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}function G7(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function z7(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function Xa(t,e,n){return e=j7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function j7(t){var e=K7(t,"string");return typeof e=="symbol"?e:String(e)}function K7(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xl{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n){Xa(this,"rootDocument",void 0),Xa(this,"isRtl",!1),Xa(this,"container",null),Xa(this,"editor",void 0),Xa(this,"editorStyle",void 0),Xa(this,"hidden",!0),this.rootDocument=e,this.isRtl=n,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hide()}setPosition(e,n){this.editorStyle.left=`${e}px`,this.editorStyle.top=`${n}px`}setSize(e,n){if(e&&n){const r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${n}px`}}getSize(){return{width:yt(this.getInputElement()),height:Bt(this.getInputElement())}}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){this.editorStyle.display="block",this.hidden=!1}hide(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}isVisible(){return this.editorStyle.display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return this.rootDocument.activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return e.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),ce(this.container,xl.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),ce(e,xl.CLASS_EDITOR),ce(n,xl.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),this.container.appendChild(e),e}getInputElement(){return this.editor.querySelector(`.${xl.CLASS_INPUT}`)}destroy(){const e=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,e&&e.removeChild(this.container)}}const q7=xl;function Lp(t,e,n){return e=X7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function X7(t){var e=Z7(t,"string");return typeof e=="symbol"?e:String(e)}function Z7(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Q7=250,J7=250;class EH{constructor(e){Lp(this,"wasLastActionShow",!0),Lp(this,"showDebounced",null),Lp(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},J7)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Q7;this.showDebounced=$g(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}_t(EH,wr);const e5=EH;function t5(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function n5(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function Ks(t,e){const n={};return H(t,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&(n[i]||(n[i]=[]),n[i][o]=e(i,o))})}),n}function ss(t,e,n,r,i){H(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&r5(s,a,e,n,r,i)})})}function r5(t,e,n,r,i,o){const s=i(t,e);let a=r;s.className&&(n==="vertical"?a=t5(s.className,r):a=n5(s.className,r)),o(t,e,"className",a)}function So(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function Vi(t,e){let n=!1;return Array.isArray(t)&&H(t,r=>(r.forAll((i,o)=>{if(i>=0&&o>=0&&e(i,o))return n=!0,!1}),n)),n}function em(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:r}=e.defaultView,{top:i,left:o}=r.getBoundingClientRect();n.top=i,n.left=o}return n}const et="---------";function i5(){return{name:et}}const Wr="alignment";function o5(){return{key:Wr,name(){return this.getTranslatedPhrase(Oy)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${Wr}:left`,name(){let t=this.getTranslatedPhrase(Ay);return Vi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htLeft")!==-1)return!0})&&(t=So(t)),t},callback(){const t=this.getSelectedRange(),e=Ks(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,t,n,r),ss(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Wr}:center`,name(){let t=this.getTranslatedPhrase(Iy);return Vi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htCenter")!==-1)return!0})&&(t=So(t)),t},callback(){const t=this.getSelectedRange(),e=Ks(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,t,n,r),ss(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Wr}:right`,name(){let t=this.getTranslatedPhrase(Py);return Vi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htRight")!==-1)return!0})&&(t=So(t)),t},callback(){const t=this.getSelectedRange(),e=Ks(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,t,n,r),ss(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Wr}:justify`,name(){let t=this.getTranslatedPhrase(xy);return Vi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htJustify")!==-1)return!0})&&(t=So(t)),t},callback(){const t=this.getSelectedRange(),e=Ks(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,t,n,r),ss(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{name:et},{key:`${Wr}:top`,name(){let t=this.getTranslatedPhrase(Hy);return Vi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htTop")!==-1)return!0})&&(t=So(t)),t},callback(){const t=this.getSelectedRange(),e=Ks(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,t,n,r),ss(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Wr}:middle`,name(){let t=this.getTranslatedPhrase(Dy);return Vi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htMiddle")!==-1)return!0})&&(t=So(t)),t},callback(){const t=this.getSelectedRange(),e=Ks(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,r),ss(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Wr}:bottom`,name(){let t=this.getTranslatedPhrase(Ny);return Vi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htBottom")!==-1)return!0})&&(t=So(t)),t},callback(){const t=this.getSelectedRange(),e=Ks(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,t,n,r),ss(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1}]}}}const tm="clear_column";function s5(){return{key:tm,name(){return this.getTranslatedPhrase(gy)},callback(t,e){const n=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:!this.selection.isSelectedByColumnHeader()}}}const ah="col_left";function a5(){return{key:ah,name(){return this.getTranslatedPhrase(ay)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?this.countCols()===0:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const lh="col_right";function l5(){return{key:lh,name(){return this.getTranslatedPhrase(ly)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const uh="make_read_only";function u5(){return{key:uh,name(){let t=this.getTranslatedPhrase(fy);return Vi(this.getSelectedRange(),(n,r)=>this.getCellMeta(n,r).readOnly)&&(t=So(t)),t},callback(){const t=this.getSelectedRange(),e=Vi(t,(n,r)=>this.getCellMeta(n,r).readOnly);H(t,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&this.setCellMeta(r,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const nm="redo";function c5(){return{key:nm,name(){return this.getTranslatedPhrase(dy)},callback(){this.redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const ch="remove_col";function h5(){return{key:ch,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(cy,e)},callback(){this.alter("remove_col",CX(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const rm="remove_row";function d5(){return{key:rm,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(uy,e)},callback(){this.alter("remove_row",vX(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const im="row_above";function f5(){return{key:im,name(){return this.getTranslatedPhrase(oy)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?this.countRows()===0:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const om="row_below";function g5(){return{key:om,name(){return this.getTranslatedPhrase(sy)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const $c="no_items";function m5(){return{key:$c,name(){return this.getTranslatedPhrase(iy)},disabled:!0,isCommand:!1}}const sm="undo";function p5(){return{key:sm,name(){return this.getTranslatedPhrase(hy)},callback(){this.undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const w5=[im,om,ah,lh,tm,rm,ch,sm,nm,uh,Wr,et,$c],C5={[et]:i5,[$c]:m5,[im]:f5,[om]:g5,[ah]:a5,[lh]:l5,[tm]:s5,[rm]:d5,[ch]:h5,[sm]:p5,[nm]:c5,[uh]:u5,[Wr]:o5};function TH(){const t={};return Ze(C5,(e,n)=>{t[n]=e()}),t}function v5(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(Ty):this.getTranslatedPhrase(Ey)},callback(){const e=this.getSelectedRangeLast();this.deselectCell(),t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function S5(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(_y)},callback(){this.getSelectedRangeLast().forAll((n,r)=>{n>=0&&r>=0&&t.removeCommentAtCell(n,r,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function y5(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(My);return Vi(this.getSelectedRange(),(r,i)=>t.getCommentMeta(r,i,of))?So(e):e},callback(){this.getSelectedRangeLast().forAll((n,r)=>{if(n>=0&&r>=0){const i=!!t.getCommentMeta(n,r,of);t.updateCommentMeta(n,r,{[of]:!i})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Ii(t,e){_H(t,e),e.add(t)}function qs(t,e,n){_H(t,e),e.set(t,n)}function _H(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function b5(t,e,n){return e=R5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function R5(t){var e=E5(t,"string");return typeof e=="symbol"?e:String(e)}function E5(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Pi(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Oo(t,e,n){var r=MH(t,e,"set");return T5(t,r,n),n}function T5(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function it(t,e){var n=MH(t,e,"get");return _5(t,n)}function MH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function _5(t,e){return e.get?e.get.call(t):e.value}const fc="comments",M5=60,yo="comment",ec="value",OH="style",of="readOnly",ad=fc,QC=`plugin:${fc}`;var Nt=new WeakMap,li=new WeakMap,am=new WeakMap,sf=new WeakMap,jf=new WeakMap,JC=new WeakMap,Kf=new WeakMap,MT=new WeakSet,OT=new WeakSet,AT=new WeakSet,IT=new WeakSet,PT=new WeakSet,xT=new WeakSet,HT=new WeakSet,DT=new WeakSet,NT=new WeakSet,LT=new WeakSet;class O5 extends gt{constructor(){super(...arguments),Ii(this,LT),Ii(this,NT),Ii(this,DT),Ii(this,HT),Ii(this,xT),Ii(this,PT),Ii(this,IT),Ii(this,AT),Ii(this,OT),Ii(this,MT),b5(this,"range",{}),qs(this,Nt,{writable:!0,value:null}),qs(this,li,{writable:!0,value:null}),qs(this,am,{writable:!0,value:!1}),qs(this,sf,{writable:!0,value:!1}),qs(this,jf,{writable:!0,value:{}}),qs(this,JC,{writable:!0,value:null}),qs(this,Kf,{writable:!0,value:""})}static get PLUGIN_KEY(){return fc}static get PLUGIN_PRIORITY(){return M5}isEnabled(){return!!this.hot.getSettings()[fc]}enablePlugin(){this.enabled||(it(this,Nt)||Oo(this,Nt,new q7(this.hot.rootDocument,this.hot.isRtl())),it(this,li)||Oo(this,li,new e5(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",e=>this.addToContextMenu(e)),this.addHook("afterRenderer",(e,n,r,i,o,s)=>Pi(this,IT,x5).call(this,e,s)),this.addHook("afterScroll",()=>Pi(this,LT,k5).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",e=>Pi(this,NT,$5).call(this,e)),it(this,li).addLocalHook("hide",()=>this.hide()),it(this,li).addLocalHook("show",(e,n)=>this.showAtCell(e,n)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){it(this,li).updateDelay(this.getDisplayDelaySetting()),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),r=e.addContext(QC);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeLast();Oo(this,sf,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(QC),this.hot._registerTimeout(()=>{Oo(this,sf,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&!it(this,Nt).isVisible()},group:ad}),r.addShortcut({keys:[["Escape"]],callback:()=>{it(this,Nt).setValue(it(this,Kf)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&it(this,Nt).isVisible()},group:ad}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&it(this,Nt).isVisible()},group:ad})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(ad)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",r=>Pi(this,OT,I5).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Pi(this,MT,A5).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Pi(this,AT,P5).call(this)),this.eventManager.addEventListener(n,"focus",()=>Pi(this,xT,D5).call(this)),this.eventManager.addEventListener(n,"blur",()=>Pi(this,PT,H5).call(this)),this.eventManager.addEventListener(n,"mousedown",r=>Pi(this,HT,N5).call(this,r)),this.eventManager.addEventListener(n,"mouseup",r=>Pi(this,DT,L5).call(this,r))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=Es(e.target,"TD","TBODY");return!!(n&&Ve(n,"htCommentCell")&&Es(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=it(this,Nt).getValue();let r="";e!=null?r=e:n!=null&&(r=n);const i=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(i,o,{[ec]:r}),this.hot.render()}setCommentAtCell(e,n,r){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,yo),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(r)}getComment(){const e=this.range.from.row,n=this.range.from.col;return this.getCommentMeta(e,n,ec)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,ec)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:n,col:r}}=this.range;if(n<0||n>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return it(this,li).cancelHiding(),it(this,Nt).setValue((e=i[yo]?i[yo][ec]:null)!==null&&e!==void 0?e:""),it(this,Nt).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){it(this,Nt).hide()}refreshEditor(){var e,n;if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!it(this,Nt).isVisible()))return;const{rowIndexMapper:i,columnIndexMapper:o}=this.hot,{row:s,col:a}=this.range.from;let l=i.getRenderableFromVisualIndex(s),u=o.getRenderableFromVisualIndex(a);const c=l===null;it(this,Nt).setPosition(0,0),l===null&&(l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s,-1))),u===null&&(u=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(a,-1)));const d=l===null,g=u===null;l=(e=l)!==null&&e!==void 0?e:0,u=(n=u)!==null&&n!==void 0?n:0;const{rootWindow:p,view:{_wt:C}}=this.hot,{wtTable:E}=C,I=C.getCell({row:l,col:u},!0),M=this.getCommentMeta(s,a,OH);M?it(this,Nt).setSize(M.width,M.height):it(this,Nt).resetSize();const y=g?0:E.getStretchedColumnWidth(u),$=c&&!d?Bt(I):0,{left:q,top:G,width:X,height:re}=I.getBoundingClientRect(),{width:v,height:S}=it(this,Nt).getSize(),{innerWidth:b,innerHeight:L}=this.hot.rootWindow,P=this.hot.rootDocument.documentElement;let x=q+p.scrollX+y,W=G+p.scrollY+$;this.hot.isRtl()&&(x-=v+y),this.hot.isLtr()&&q+X+v>b?x=q+p.scrollX-v-1:this.hot.isRtl()&&x<-(P.scrollWidth-P.clientWidth)&&(x=q+p.scrollX+y+1),G+S>L&&(W-=S-re+1),it(this,Nt).setPosition(x,W),it(this,Nt).setReadOnlyState(this.getCommentMeta(s,a,of))}focusEditor(){it(this,Nt).focus()}updateCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n)[yo];let o;i?(o=Vn(i),th(o,r)):o=r,this.hot.setCellMeta(e,n,yo,o)}getCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n);if(i[yo])return i[yo][r]}addToContextMenu(e){e.items.push({name:et},v5(this),S5(this),y5(this))}getDisplayDelaySetting(){const e=this.hot.getSettings()[fc];if(qe(e))return e.displayDelay}getEditorInputElement(){return it(this,Nt).getInputElement()}destroy(){it(this,Nt)&&it(this,Nt).destroy(),it(this,li)&&it(this,li).destroy(),super.destroy()}}function A5(t){if(!(!this.hot.view||!this.hot.view._wt)&&!it(this,am)&&!this.targetIsCommentTextArea(t)){const e=Es(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function I5(t){const{rootDocument:e}=this.hot;if(!(it(this,am)||it(this,Nt).isFocused()||Ve(t.target,"wtBorder")||it(this,JC)===t.target||!it(this,Nt)))if(Oo(this,JC,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));it(this,li).show(n)}else vs(t.target,e)&&!this.targetIsCommentTextArea(t)&&it(this,li).hide()}function P5(){Oo(this,am,!1)}function x5(t,e){e[yo]&&e[yo][ec]&&ce(t,e.commentedCellClassName)}function H5(){Oo(this,Kf,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function D5(){Oo(this,Kf,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(QC)}function N5(t){Oo(this,jf,{width:yt(t.target),height:Bt(t.target)})}function L5(t){const e=yt(t.target),n=Bt(t.target);(e!==it(this,jf).width+1||n!==it(this,jf).height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,{[OH]:{width:e,height:n}})}function $5(t){it(this,Nt).isVisible()&&Kr(t)}function k5(){it(this,sf)||this.hide()}var $T=g1,F5=TypeError,W5=function(t,e){if(!delete t[e])throw new F5("Cannot delete property "+$T(e)+" of "+$T(t))},V5=Ma,B5=pg,U5=Cg,Y5=O1,G5=W5,z5=A1,j5=[].unshift(0)!==1,K5=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}},q5=j5||!K5();V5({target:"Array",proto:!0,arity:1,forced:q5},{unshift:function(e){var n=B5(this),r=U5(n),i=arguments.length;if(i){z5(r+i);for(var o=r;o--;){var s=o+i;o in n?n[s]=n[o]:G5(n,s)}for(var a=0;a<i;a++)n[a]=arguments[a]}return Y5(n,r+i)}});function $p(t,e,n){return e=X5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function X5(t){var e=Z5(t,"string");return typeof e=="symbol"?e:String(e)}function Z5(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class AH{constructor(e){$p(this,"hot",void 0),$p(this,"commands",{}),$p(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=Q5(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||Vt(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),r.unshift(o.join(":")),H(u,c=>c.apply(this.hot,r))}}function Q5(t,e){let n;return H(e,r=>{const i=r.key?r.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return n=r,!1}),n}function kp(t,e,n){return e=J5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function J5(t){var e=eZ(t,"string");return typeof e=="symbol"?e:String(e)}function eZ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class IH{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;kp(this,"hot",void 0),kp(this,"predefinedItems",TH()),kp(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,Ze(e,(r,i)=>{let o="";r.name===et?(n[et]=r,o=et):isNaN(parseInt(i,10))?(r.key=r.key===void 0?i:r.key,n[i]=r,o=r.key):(n[r.key]=r,o=r.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return tZ(e,this.defaultOrderPattern,this.predefinedItems)}}function tZ(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),qe(i)?Ze(i,(o,s)=>{let a=n[typeof o=="string"?o:s];a||(a=o),qe(o)?un(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),r.push(a)}):H(i,(o,s)=>{let a=n[o];!a&&w5.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),qe(o)&&un(a,o),a.key===void 0&&(a.key=s),r.push(a))}),r}function Xo(t,e,n){return e=nZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nZ(t){var e=rZ(t,"string");return typeof e=="symbol"?e:String(e)}function rZ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class iZ{constructor(e,n){Xo(this,"top",void 0),Xo(this,"topRelative",void 0),Xo(this,"left",void 0),Xo(this,"leftRelative",void 0),Xo(this,"scrollTop",void 0),Xo(this,"scrollLeft",void 0),Xo(this,"cellHeight",void 0),Xo(this,"cellWidth",void 0);const r=n.scrollY,i=n.scrollX;let o,s,a,l,u,c;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=r,a+=i):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-r,l=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=r,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function Ou(t,e,n){oZ(t,e),e.set(t,n)}function oZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nt(t,e){var n=PH(t,e,"get");return sZ(t,n)}function sZ(t,e){return e.get?e.get.call(t):e.value}function ld(t,e,n){var r=PH(t,e,"set");return aZ(t,r,n),n}function PH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function aZ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var jn=new WeakMap,Zo=new WeakMap,An=new WeakMap,Fp=new WeakMap,Za=new WeakMap;class lZ{constructor(e){Ou(this,jn,{writable:!0,value:void 0}),Ou(this,Zo,{writable:!0,value:void 0}),Ou(this,An,{writable:!0,value:void 0}),Ou(this,Fp,{writable:!0,value:!1}),Ou(this,Za,{writable:!0,value:{above:0,below:0,left:0,right:0}}),ld(this,Fp,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return nt(this,Za)[e]=n,this}setElement(e){return ld(this,jn,e),this}setParentElement(e){return ld(this,Zo,e),this}updatePosition(e){ld(this,An,new iZ(e,nt(this,jn).ownerDocument.defaultView)),nt(this,Fp)?(nt(this,An).fitsBelow(nt(this,jn))?this.setPositionBelowCursor():nt(this,An).fitsAbove(nt(this,jn))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){nt(this,jn).dir==="rtl"?nt(this,An).fitsOnLeft(nt(this,jn))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():nt(this,An).fitsOnRight(nt(this,jn))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=nt(this,Za).above+nt(this,An).top-nt(this,jn).offsetHeight;nt(this,Zo)&&(e=nt(this,An).top+nt(this,An).cellHeight-nt(this,jn).offsetHeight+3),nt(this,jn).style.top=`${e}px`}setPositionBelowCursor(){let e=nt(this,Za).below+nt(this,An).top+1;nt(this,Zo)&&(e=nt(this,An).top-1),nt(this,jn).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=nt(this,An).left;if(nt(this,Zo)){const{right:n}=nt(this,Zo).getBoundingClientRect();e+=nt(this,An).cellWidth+n-(nt(this,An).left+nt(this,An).cellWidth)}else e+=nt(this,Za).right;nt(this,jn).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=nt(this,Za).left+nt(this,An).left-nt(this,jn).offsetWidth;if(nt(this,Zo)){const{left:n}=nt(this,Zo).getBoundingClientRect();e-=nt(this,An).left-n}nt(this,jn).style.left=`${e}px`}}function xH(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:r=()=>{},onClear:i=()=>{}}=t;const o=new Set;let s=pr(e,-1,C()-1);function a(I,M){const y=C()-1;return I<0&&(I=y),I>y&&(I=0),o.has(I)?-1:(o.add(I),r(I,!1)===!1&&(I=a(M===1?++I:--I,M)),I)}function l(I){I>-1&&I<C()&&r(I,!0)!==!1&&(s=I)}function u(){return s}function c(){C()>0&&(o.clear(),s=a(0,1))}function d(){C()>0&&(o.clear(),s=a(C()-1,-1))}function g(){C()>0&&(o.clear(),s=a(++s,1))}function p(){C()>0&&(o.clear(),s=a(--s,-1))}function C(){return Math.max(n(),0)}function E(){o.clear(),s=e,i()}return{setCurrentPage:l,getCurrentPage:u,toFirstItem:c,toLastItem:d,toNextItem:g,toPreviousItem:p,getSize:C,clear:E}}function uZ(t){return Xe(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function ev(t){return Vt(t,"submenu")}function tv(t){return new RegExp(et,"i").test(t.name)}function af(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function kT(t){return Vt(t,"disableSelection")}function cZ(t){return Ve(t,"htSeparator")}function hZ(t){return Ve(t,"htSubmenu")}function dZ(t){return Ve(t,"htDisabled")}function fZ(t){return Ve(t,"htSelectionDisabled")}function gZ(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function HH(t,e){const n=t.slice(0);for(let r=0;r<n.length&&n[r].name===e;)n.shift();return n}function mZ(t,e){let n=t.slice(0);return n.reverse(),n=HH(n,e),n.reverse(),n}function pZ(t){const e=[];return H(t,(n,r)=>{r>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function wZ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:et,n=t.slice(0);return n=HH(n,e),n=mZ(n,e),n=pZ(n),n}function CZ(t){return xH({size:()=>t.countRows(),onItemSelect(e,n){const r=t.getCell(e,0);if(!r||cZ(r)||dZ(r)||fZ(r))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function vZ(t){return[{keys:[["Tab"],["Shift","Tab"],["Control/Meta","A"]],forwardToContext:t.hot.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const e=t.hotMenu.getSelectedLast();if(e){const n=t.openSubMenu(e[0]);n&&n.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{t.hotMenu.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:e=>{const n=t.hotMenu.getSelectedLast();n&&(t.hotMenu.getSourceDataAtRow(n[0]).submenu?t.openSubMenu(n[0]).getNavigator().toFirstItem():(t.executeCommand(e),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{t.hotMenu.getSelectedLast()?t.hotMenu.selection.transformStart(-t.hotMenu.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{t.hotMenu.getSelectedLast()?t.hotMenu.selection.transformStart(t.hotMenu.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const DH="menu",FT=DH;function SZ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];r(vZ(t)),e.forEach(u=>{let{shortcuts:c,contextName:d}=u;i(c,d)});function r(u,c){a(c).addShortcuts(u,{group:DH})}function i(u,c){const d=a(c);u.forEach(g=>{let{keys:p}=g;p.forEach(C=>d.removeShortcutsByKeys(C))}),n.push({shortcuts:u,contextName:c}),r(u,c)}function o(){return[...n]}function s(u){return u?`${FT}:${u}`:FT}function a(u){var c;const d=t.hotMenu.getShortcutManager(),g=s(u);return(c=d.getContext(g))!==null&&c!==void 0?c:d.addContext(g)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:i,getCustomShortcuts:o,getContext:a,listen:l}}function yZ(t){return(e,n,r,i,o,s)=>{if(n.hasAttribute("ghost-table"))return;const a=e.getSourceDataAtRow(r),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s;if(vi(n),ce(l,"htItemWrapper"),t.getSettings().ariaTags){const c=!af(a,t)&&!kT(a)&&!tv(a);Ne(n,[kY(),lS(u),...c?[Kl(-1)]:[],...af(a,t)?[GY()]:[],...ev(a)?[Ur(!1)]:[]])}n.className="",n.appendChild(l),tv(a)?ce(n,"htSeparator"):typeof a.renderer=="function"?(ce(n,"htCustomMenuRenderer"),n.appendChild(a.renderer(e,l,r,i,o,u))):Pa(l,u),af(a,t)?ce(n,"htDisabled"):kT(a)?ce(n,"htSelectionDisabled"):ev(a)&&ce(n,"htSubmenu")}}function WT(t,e,n){bZ(t,e),e.set(t,n)}function bZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xi(t,e,n){return e=RZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function RZ(t){var e=EZ(t,"string");return typeof e=="symbol"?e:String(e)}function EZ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function VT(t,e,n){var r=NH(t,e,"set");return TZ(t,r,n),n}function TZ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Au(t,e){var n=NH(t,e,"get");return _Z(t,n)}function NH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function _Z(t,e){return e.get?e.get.call(t):e.value}const BT=215;var Iu=new WeakMap,ud=new WeakMap;class eu{constructor(e,n){var r=this;xi(this,"hot",void 0),xi(this,"options",void 0),xi(this,"eventManager",new Mr(this)),xi(this,"container",void 0),xi(this,"positioner",void 0),xi(this,"hotMenu",null),xi(this,"hotSubMenus",{}),xi(this,"parentMenu",void 0),xi(this,"menuItems",null),xi(this,"origOutsideClickDeselects",null),WT(this,Iu,{writable:!0,value:void 0}),WT(this,ud,{writable:!0,value:void 0}),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:BT,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new lZ(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.parentMenu.runLocalHooks("afterSelectionChange",...o)})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=Ic(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return Au(this,Iu)}getKeyboardShortcutsCtrl(){return Au(this,ud)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=$g(a=>this.openSubMenu(a),300),n=this.options.minWidth||BT;let r=!1,i=_r(this.menuItems,a=>(a.key===$c&&(r=!0),gZ(a,this.hot)));if(i.length<1&&!r)i.push(TH()[$c]);else if(i.length===0)return;i=wZ(i,et);let o=!1;const s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return Re(a)&&a<n?n:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:yZ(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,beforeOnCellMouseOver:(a,l)=>{Au(this,Iu).setCurrentPage(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},rowHeights:a=>i[a].name===et?1:23,afterOnCellContextMenu:a=>{a.preventDefault(),IC()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,d)=>{this.hotMenu.view.isMouseDown()&&(d.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!IC()||!Ms(a))&&o&&this.hasSelectedItem()&&(Mo()||yS()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),VT(this,Iu,CZ(this.hotMenu)),VT(this,ud,SZ(this)),Au(this,ud).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(Au(this,Iu).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedLast();if(n){const r=this.parentMenu.hotMenu.getCell(n[0],0);Ne(r,[Ur(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!hZ(n))return!1;const r=this.hotMenu.getSourceDataAtRow(e),i=new eu(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(r.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=i,this.hot.getSettings().ariaTags&&Ne(n,[Ur(!0)]),i}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[n.key];if(r){r.destroy(),delete this.hotSubMenus[n.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Ne(i,[Ur(!1)])}}closeAllSubMenus(){H(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const r=this.hot.getSelectedRange(),i=r?uZ(r):[];this.runLocalHooks("executeCommand",n.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,e)}isCommandPassive(e){return e.isCommand===!1||tv(e)||af(e,this.hot)||ev(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let r=e,i;return r&&(At(r)&&(r=r.call(this.hot),r===null||It(r)?r="":r=r.toString()),r=r.replace(/[^A-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,i=n.querySelector(`.${this.options.className}.${r}`)),i||(i=n.createElement("div"),ce(i,`htMenu ${this.options.className}`),r&&ce(i,r),this.options.container.appendChild(i)),i}onAfterInit(){const{wtTable:e}=this.hotMenu.view._wt,n=this.hotMenu.getSettings().data,r=e.hider.style,i=e.holder.style,o=parseInt(r.width,10),s=nn(n,(a,l)=>a+(l.name===et?1:26),0);i.width=`${o+3}px`,i.height=`${s+3}px`,r.height=i.height,this.hot.getSettings().ariaTags&&Ne(this.hotMenu.rootElement,[$Y(),Kl(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!vs(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!vs(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&Ve(e.target,"htCore")&&vs(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}_t(eu,wr);function cd(t,e){MZ(t,e),e.add(t)}function MZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wp(t,e,n){return e=OZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function OZ(t){var e=AZ(t,"string");return typeof e=="symbol"?e:String(e)}function AZ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hd(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const tc="contextMenu",IZ=70,UT=tc;_e.getSingleton().register("afterContextMenuDefaultOptions");_e.getSingleton().register("beforeContextMenuShow");_e.getSingleton().register("afterContextMenuShow");_e.getSingleton().register("afterContextMenuHide");_e.getSingleton().register("afterContextMenuExecute");var YT=new WeakSet,GT=new WeakSet,zT=new WeakSet,jT=new WeakSet;class lm extends gt{constructor(){super(...arguments),cd(this,jT),cd(this,zT),cd(this,GT),cd(this,YT),Wp(this,"commandExecutor",new AH(this.hot)),Wp(this,"itemsFactory",null),Wp(this,"menu",null)}static get PLUGIN_KEY(){return tc}static get PLUGIN_PRIORITY(){return IZ}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[im,om,et,ah,lh,et,rm,ch,et,sm,nm,et,uh,et,Wr]}isEnabled(){return!!this.hot.getSettings()[tc]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[tc];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new eu(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>hd(this,GT,xZ).call(this)),this.menu.addLocalHook("afterOpen",()=>hd(this,zT,HZ).call(this)),this.menu.addLocalHook("afterClose",()=>hd(this,jT,DZ).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",r=>hd(this,YT,PZ).call(this,r)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),r=em(this.menu.container,this.hot.rootDocument);this.open({left:n.left+r.left,top:n.top+r.top-1+n.height},{left:n.width,above:-n.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:UT})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(UT)}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.prepareMenuItems(),this.menu.open(),Ze(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new IH(this.hot,lm.DEFAULT_ITEMS);const e=this.hot.getSettings()[tc],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),H(r,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function PZ(t){const e=this.hot.getSettings(),n=e.rowHeaders,r=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),Ve(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||r)&&!i(o)&&!(Ve(o,"current")&&Ve(o,"wtBorder"))))return;const s=em(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function xZ(){this.hot.runHooks("beforeContextMenuShow",this)}function HZ(){this.hot.runHooks("afterContextMenuShow",this)}function DZ(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}lm.SEPARATOR={name:et};function NZ(t){return{key:"copy",name(){return this.getTranslatedPhrase(my)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function LZ(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),n=e?pr(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(Cy,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function $Z(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),n=e?pr(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(wy,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function kZ(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),n=e?pr(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(py,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function FZ(t){return{key:"cut",name(){return this.getTranslatedPhrase(vy)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class WZ{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class VZ{constructor(){this.clipboardData=new WZ}}function KT(t,e){LH(t,e),e.add(t)}function Qa(t,e,n){LH(t,e),e.set(t,n)}function LH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dd(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Xn(t,e){var n=$H(t,e,"get");return BZ(t,n)}function BZ(t,e){return e.get?e.get.call(t):e.value}function Ja(t,e,n){var r=$H(t,e,"set");return UZ(t,r,n),n}function $H(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function UZ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Qo=new WeakMap,Vp=new WeakMap,Pu=new WeakMap,nv=new WeakMap,rv=new WeakMap,xu=new WeakMap,fd=new WeakSet,qT=new WeakSet;class YZ{constructor(e){let{countRows:n,countColumns:r,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;KT(this,qT),KT(this,fd),Qa(this,Qo,{writable:!0,value:void 0}),Qa(this,Vp,{writable:!0,value:void 0}),Qa(this,Pu,{writable:!0,value:void 0}),Qa(this,nv,{writable:!0,value:void 0}),Qa(this,rv,{writable:!0,value:void 0}),Qa(this,xu,{writable:!0,value:void 0}),Ja(this,Vp,n),Ja(this,Pu,r),Ja(this,nv,i),Ja(this,rv,o),Ja(this,xu,s)}setSelectedRange(e){Ja(this,Qo,e)}getCellsRange(){if(Xn(this,Vp).call(this)===0||Xn(this,Pu).call(this)===0)return null;const{row:e,col:n}=Xn(this,Qo).getTopStartCorner(),{row:r,col:i}=Xn(this,Qo).getBottomEndCorner(),o=dd(this,qT,GZ).call(this,e,r),s=dd(this,fd,Bp).call(this,n,i);return{isRangeTrimmed:r!==o||i!==s,startRow:e,startCol:n,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(Xn(this,Pu).call(this)===0||Xn(this,xu).call(this)===0)return null;const{col:e}=Xn(this,Qo).getTopStartCorner(),{col:n}=Xn(this,Qo).getBottomEndCorner(),r=dd(this,fd,Bp).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(Xn(this,Pu).call(this)===0||Xn(this,xu).call(this)===0)return null;const{col:e}=Xn(this,Qo).getTopStartCorner(),{col:n}=Xn(this,Qo).getBottomEndCorner(),r=dd(this,fd,Bp).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-Xn(this,xu).call(this),startCol:e,endRow:-1,endCol:r}}}function Bp(t,e){return Math.min(e,Math.max(t+Xn(this,rv).call(this)-1,t))}function GZ(t,e){return Math.min(e,Math.max(t+Xn(this,nv).call(this)-1,t))}function kH(t){const e=[],n=[];return H(t,r=>{const i=Math.min(r.startRow,r.endRow),o=Math.max(r.startRow,r.endRow);xe(i,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(r.startCol,r.endCol),a=Math.max(r.startCol,r.endCol);xe(s,a,l=>{n.indexOf(l)===-1&&n.push(l)})}),{rows:e,columns:n}}function lo(t,e){FH(t,e),e.add(t)}function Xs(t,e,n){FH(t,e),e.set(t,n)}function FH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hu(t,e,n){return e=zZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zZ(t){var e=jZ(t,"string");return typeof e=="symbol"?e:String(e)}function jZ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vr(t,e){var n=WH(t,e,"get");return KZ(t,n)}function KZ(t,e){return e.get?e.get.call(t):e.value}function ci(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function uo(t,e,n){var r=WH(t,e,"set");return qZ(t,r,n),n}function WH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function qZ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}_e.getSingleton().register("afterCopyLimit");_e.getSingleton().register("modifyCopyableRange");_e.getSingleton().register("beforeCut");_e.getSingleton().register("afterCut");_e.getSingleton().register("beforePaste");_e.getSingleton().register("afterPaste");_e.getSingleton().register("beforeCopy");_e.getSingleton().register("afterCopy");const gd="copyPaste",XZ=80,ZZ=["fragmentSelection"],XT=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var iv=new WeakMap,ov=new WeakMap,sv=new WeakMap,el=new WeakMap,md=new WeakMap,pd=new WeakMap,tl=new WeakMap,Up=new WeakSet,ZT=new WeakSet,VH=new WeakSet,Gb=new WeakSet,QT=new WeakSet,JT=new WeakSet,e_=new WeakSet,t_=new WeakSet,n_=new WeakSet;class QZ extends gt{constructor(){super(...arguments),lo(this,n_),lo(this,t_),lo(this,e_),lo(this,JT),lo(this,QT),lo(this,Gb),lo(this,VH),lo(this,ZT),lo(this,Up),Hu(this,"columnsLimit",1/0),Hu(this,"rowsLimit",1/0),Hu(this,"pasteMode","overwrite"),Hu(this,"uiContainer",this.hot.rootDocument.body),Xs(this,iv,{writable:!0,value:!1}),Xs(this,ov,{writable:!0,value:!1}),Xs(this,sv,{writable:!0,value:!1}),Xs(this,el,{writable:!0,value:"cells-only"}),Xs(this,md,{writable:!0,value:!1}),Xs(this,pd,{writable:!0,value:!1}),Xs(this,tl,{writable:!0,value:new YZ({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})}),Hu(this,"copyableRanges",[])}static get PLUGIN_KEY(){return gd}static get SETTING_KEYS(){return[gd,...ZZ]}static get PLUGIN_PRIORITY(){return XZ}isEnabled(){return!!this.hot.getSettings()[gd]}enablePlugin(){var e=this;if(this.enabled)return;const{[gd]:n}=this.hot.getSettings();if(typeof n=="object"){var r,i;this.pasteMode=(r=n.pasteMode)!==null&&r!==void 0?r:this.pasteMode,this.rowsLimit=isNaN(n.rowsLimit)?this.rowsLimit:n.rowsLimit,this.columnsLimit=isNaN(n.columnsLimit)?this.columnsLimit:n.columnsLimit,uo(this,iv,!!n.copyColumnHeaders),uo(this,ov,!!n.copyColumnGroupHeaders),uo(this,sv,!!n.copyColumnHeadersOnly),this.uiContainer=(i=n.uiContainer)!==null&&i!==void 0?i:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",o=>ci(this,QT,tQ).call(this,o)),this.addHook("afterSelectionEnd",()=>ci(this,JT,nQ).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return e.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return e.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return e.onPaste(...arguments)}),vS()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return ci(e,e_,rQ).call(e,...s)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return ci(e,t_,iQ).call(e,...s)}),this.addHook("afterSelection",()=>ci(this,n_,oQ).call(this))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";uo(this,el,e),uo(this,md,!0),ci(this,Up,r_).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){uo(this,pd,!0),ci(this,Up,r_).call(this,"cut")}getRangedCopyableData(e){return cc(this.getRangedData(e))}getRangedData(e){const n=[],{rows:r,columns:i}=kH(e);return H(r,o=>{const s=[];H(i,a=>{o<0?s.push(this.hot.getColHeader(a,o)):s.push(this.hot.getCopyableData(o,a))}),n.push(s)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const r=new VZ;e&&r.clipboardData.setData("text/plain",e),n&&r.clipboardData.setData("text/html",n),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}vr(this,tl).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);vr(this,el)==="column-headers-only"?n.set("headers",vr(this,tl).getMostBottomColumnHeadersRange()):(vr(this,el)==="with-column-headers"?n.set("headers",vr(this,tl).getMostBottomColumnHeadersRange()):vr(this,el)==="with-column-group-headers"&&n.set("headers",vr(this,tl).getAllColumnHeadersRange()),n.set("cells",vr(this,tl).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=i;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=n.get("cells");if(r!==null&&r.isRangeTrimmed){const{startRow:i,startCol:o,endRow:s,endCol:a}=r;this.hot.runHooks("afterCopyLimit",s-i+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const r=e.length,i=e[0].length,o=[],{row:s,col:a}=n.getTopStartCorner(),{row:l,col:u}=n.getBottomEndCorner();let c=s,d=a,g=s,p=a;for(;o.length<r||c<=l;){const{skipRowOnPaste:C,visualRow:E}=this.hot.getCellMeta(c,a);if(c=E+1,C===!0)continue;g=E,d=a;const I=[],M=o.length%r;for(;I.length<i||d<=u;){const{skipColumnOnPaste:y,visualCol:$}=this.hot.getCellMeta(s,d);if(d=$+1,y===!0)continue;p=$;const q=I.length%i;I.push(e[M][q])}o.push(I)}return this.hot.populateFromArray(s,a,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,a,g,p]}onCopy(e){if(!this.hot.isListening()&&!vr(this,md)||this.isEditorOpened())return;this.setCopyableText(),uo(this,md,!1);const n=this.getRangedData(this.copyableRanges),r=ci(this,ZT,JZ).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",n,this.copyableRanges,r)){const o=cc(n);if(e&&e.clipboardData){const s=DC(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",o),e.clipboardData.setData("text/html",[XT,s].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",o);this.hot.runHooks("afterCopy",n,this.copyableRanges,r)}uo(this,el,"cells-only"),e.preventDefault()}onCut(e){if(!this.hot.isListening()&&!vr(this,pd)||this.isEditorOpened())return;this.setCopyableText(),uo(this,pd,!1);const n=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",n,this.copyableRanges)){const i=cc(n);if(e&&e.clipboardData){const o=DC(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",i),e.clipboardData.setData("text/html",[XT,o].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",i);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",n,this.copyableRanges)}e.preventDefault()}onPaste(e){if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected())return;e&&e.preventDefault&&e.preventDefault();let n;if(e&&typeof e.clipboardData<"u"){const a=xg(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});a&&/(<table)|(<TABLE)/g.test(a)?n=MP(a,this.hot.rootDocument).data:n=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(n=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof n=="string"&&(n=OX(n)),n===void 0||n&&n.length===0||this.hot.runHooks("beforePaste",n,this.copyableRanges)===!1)return;const[r,i,o,s]=this.populateValues(n);this.hot.selectCell(r,i,Math.min(this.hot.countRows()-1,o),Math.min(this.hot.countCols()-1,s)),this.hot.runHooks("afterPaste",n,this.copyableRanges)}destroy(){super.destroy()}}function r_(t){if(vS()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:r}=e.highlight,i=this.hot.getCell(n,r,!0);i&&iP(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function JZ(t){const{rows:e}=kH(t);let n=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)n+=1;return{columnHeadersCount:n}}function eQ(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r&&mS(r)}}}function BH(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r!=null&&r.hasAttribute("contenteditable")&&pS(r)}}}function tQ(t){t.items.push({name:"---------"},NZ(this)),vr(this,iv)&&t.items.push(kZ(this)),vr(this,ov)&&t.items.push($Z(this)),vr(this,sv)&&t.items.push(LZ(this)),t.items.push(FZ(this))}function nQ(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function rQ(){ci(this,Gb,BH).call(this)}function iQ(){ci(this,VH,eQ).call(this)}function oQ(){ci(this,Gb,BH).call(this)}function UH(t,e){return`border_row${t}col${e}`}function nc(){return{width:1,color:"#000"}}function Ao(){return{hide:!0}}function sQ(){return{width:1,color:"#000",cornerVisible:!1}}function Yp(t){if(Re(t.start)||Re(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(Re(t.end)||Re(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function Du(t){return Re(t.start)&&(t.left=t.start),Re(t.end)&&(t.right=t.end),t}function Gp(t,e){return{id:UH(t,e),border:sQ(),row:t,col:e,top:Ao(),bottom:Ao(),start:Ao(),end:Ao()}}function aQ(t,e){return Vt(e,"border")&&e.border&&(t.border=e.border),Vt(e,"top")&&Re(e.top)&&(e.top?(qe(e.top)||(e.top=nc()),t.top=e.top):(e.top=Ao(),t.top=e.top)),Vt(e,"bottom")&&Re(e.bottom)&&(e.bottom?(qe(e.bottom)||(e.bottom=nc()),t.bottom=e.bottom):(e.bottom=Ao(),t.bottom=e.bottom)),Vt(e,"start")&&Re(e.start)&&(e.start?(qe(e.start)||(e.start=nc()),t.start=e.start):(e.start=Ao(),t.start=e.start)),Vt(e,"end")&&Re(e.end)&&(e.end?(qe(e.end)||(e.end=nc()),t.end=e.end):(e.end=Ao(),t.end=e.end)),t}function Lo(t,e){let n=!1;return H(t.getSelectedRange(),r=>{r.forAll((i,o)=>{if(i<0||o<0)return;const s=t.getCellMeta(i,o).borders;if(s)if(e){if(!Vt(s[e],"hide")||s[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function um(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function lQ(t){return t.some(e=>Re(e.left)||Re(e.right))}function uQ(t){return t.some(e=>Re(e.start)||Re(e.end))}const cQ=new Map([["left","start"],["right","end"]]);function hQ(t){var e;return(e=cQ.get(t))!==null&&e!==void 0?e:t}function dQ(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(Fy);return Lo(this,"bottom")&&(e=um(e)),e},callback(e,n){const r=Lo(this,"bottom");t.prepareBorder(n,"bottom",r)}}}function fQ(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(Wy);return Lo(this,e)&&(n=um(n)),n},callback(n,r){const i=Lo(this,e);t.prepareBorder(r,e,i)}}}function gQ(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(Vy)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!Lo(this)}}}function mQ(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(ky);return Lo(this,e)&&(n=um(n)),n},callback(n,r){const i=Lo(this,e);t.prepareBorder(r,e,i)}}}function pQ(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase($y);return Lo(this,"top")&&(e=um(e)),e},callback(e,n){const r=Lo(this,"top");t.prepareBorder(n,"top",r)}}}function i_(t,e){wQ(t,e),e.add(t)}function wQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function CQ(t,e,n){return e=vQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vQ(t){var e=SQ(t,"string");return typeof e=="symbol"?e:String(e)}function SQ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function o_(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const lf="customBorders",yQ=90;var s_=new WeakSet,a_=new WeakSet;class bQ extends gt{constructor(){super(...arguments),i_(this,a_),i_(this,s_),CQ(this,"savedBorders",[])}static get PLUGIN_KEY(){return lf}static get PLUGIN_PRIORITY(){return yQ}isEnabled(){return!!this.hot.getSettings()[lf]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>o_(this,s_,RQ).call(this,e)),this.addHook("init",()=>o_(this,a_,EQ).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let r=["top","bottom","start","end"],i=null;n&&(this.checkSettingsCohesion([n]),r=Object.keys(n),i=Yp(n));const o=Bl(e),s=Lc(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});H(e,a=>{s(a).forAll((l,u)=>{H(r,c=>{this.prepareBorderFromCustomAdded(l,u,i,hQ(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=Bl(e),r=Lc(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return H(e,o=>{r(o).forAll((s,a)=>{H(this.savedBorders,l=>{l.row===s&&l.col===a&&i.push(Du(l))})})}),i}clearBorders(e){e?this.setBorders(e):(H(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,n,r,i){const o=this.hot.countRows(),s=this.hot.countCols();if(e>=o||n>=s)return;let a=Gp(e,n);r&&(a=aQ(a,r),H(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,r),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",Du(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,n){const r=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);xe(e.from.row,r,o=>{xe(e.from.col,i,s=>{const a=Gp(o,s);let l=0;o===e.from.row&&Vt(n,"top")&&(l+=1,a.top=n.top),o===e.to.row&&Vt(n,"bottom")&&(l+=1,a.bottom=n.bottom),s===e.from.col&&Vt(n,"start")&&(l+=1,a.start=n.start),s===e.to.col&&Vt(n,"end")&&(l+=1,a.end=n.end),l>0&&(this.hot.setCellMeta(o,s,"borders",Du(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,n){const r=UH(e,n);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,r,i){let o=this.hot.getCellMeta(e,n).borders;!o||o.border===void 0?o=Gp(e,n):o=Yp(o),i?(o[r]=Ao(),this.countHide(o)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",Du(o)))):(o[r]=nc(),this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",Du(o)))}prepareBorder(e,n,r){H(e,i=>{let{start:o,end:s}=i;if(o.row===s.row&&o.col===s.col)n==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,n,r);else switch(n){case"noBorders":xe(o.col,s.col,a=>{xe(o.row,s.row,l=>{this.removeAllBorders(l,a)})});break;case"top":xe(o.col,s.col,a=>{this.setBorder(o.row,a,n,r)});break;case"bottom":xe(o.col,s.col,a=>{this.setBorder(s.row,a,n,r)});break;case"start":xe(o.row,s.row,a=>{this.setBorder(a,o.col,n,r)});break;case"end":xe(o.row,s.row,a=>{this.setBorder(a,s.col,n,r)});break}})}createCustomBorders(e){H(e,n=>{const r=Yp(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,r):this.prepareBorderFromCustomAdded(n.row,n.col,r)})}countHide(e){const{top:n,bottom:r,start:i,end:o}=e;return nn([n,r,i,o],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const n=Xe(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){H(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){H(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=Xe(this.savedBorders,r=>r.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):H(this.savedBorders,(i,o)=>{if(e.id===i.id)return this.savedBorders[o]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,r){let i=!1;return H(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){const s=this.hot.view._wt.selectionManager.getBorderInstances(o);return H(s,a=>{a.toggleHiddenClass(n,r)}),i=!0,!1}}),i}checkCustomSelections(e,n,r){const i=this.countHide(e);let o=!1;return i===4?(this.removeAllBorders(e.row,e.col),o=!0):H(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){if(s.visualCellRange=n,s.commit(),r){const a=this.hot.view._wt.selectionManager.getBorderInstances(s);H(a,l=>{l.changeBorderStyle(r,e)})}return o=!0,!1}}),o}changeBorderSettings(){const e=this.hot.getSettings()[lf];if(Array.isArray(e)){const n=Vn(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=lQ(e),r=uQ(e);if(n&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function RQ(t){this.hot.getSettings()[lf]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(Ly)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[pQ(this),mQ(this),dQ(this),fQ(this),gQ(this)]}})}function EQ(){this.changeBorderSettings()}function TQ(t,e){_Q(t,e),e.add(t)}function _Q(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zp(t,e,n){return e=MQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function MQ(t){var e=OQ(t,"string");return typeof e=="symbol"?e:String(e)}function OQ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function l_(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const u_="dragToScroll",AQ=100;var jp=new WeakSet;class IQ extends gt{constructor(){super(...arguments),TQ(this,jp),zp(this,"boundaries",null),zp(this,"callback",null),zp(this,"listening",!1)}static get PLUGIN_KEY(){return u_}static get PLUGIN_PRIORITY(){return AQ}isEnabled(){return!!this.hot.getSettings()[u_]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>l_(this,jp,c_).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>l_(this,jp,c_).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(e){this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let r=0,i=0;n<this.boundaries.top?i=n-this.boundaries.top:n>this.boundaries.bottom&&(i=n-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",r=>this.onMouseMove(r)),n=Ic(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function c_(t){if(Ms(t))return;const e=this.hot.view._wt.wtTable.holder;e!==this.hot.rootWindow&&(this.setBoundaries(e.getBoundingClientRect()),this.setCallback((n,r)=>{n<0?e.scrollLeft-=50:n>0&&(e.scrollLeft+=50),r<0?e.scrollTop-=20:r>0&&(e.scrollTop+=20)}),this.listen())}function Zs(t,e){PQ(t,e),e.add(t)}function PQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kp(t,e,n){return e=xQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xQ(t){var e=HQ(t,"string");return typeof e=="symbol"?e:String(e)}function HQ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function as(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}_e.getSingleton().register("afterDropdownMenuDefaultOptions");_e.getSingleton().register("beforeDropdownMenuShow");_e.getSingleton().register("afterDropdownMenuShow");_e.getSingleton().register("afterDropdownMenuHide");_e.getSingleton().register("afterDropdownMenuExecute");const uf="dropdownMenu",DQ=230,av="changeType",qp=uf;var zb=new WeakSet,h_=new WeakSet,d_=new WeakSet,f_=new WeakSet,g_=new WeakSet,m_=new WeakSet,p_=new WeakSet;class cm extends gt{static get PLUGIN_KEY(){return uf}static get PLUGIN_PRIORITY(){return DQ}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[ah,lh,et,ch,et,tm,et,uh,et,Wr]}constructor(e){super(e),Zs(this,p_),Zs(this,m_),Zs(this,g_),Zs(this,f_),Zs(this,d_),Zs(this,h_),Zs(this,zb),Kp(this,"commandExecutor",new AH(this.hot)),Kp(this,"itemsFactory",null),Kp(this,"menu",null),this.hot.addHook("afterGetColHeader",(n,r)=>as(this,d_,LQ).call(this,n,r))}isEnabled(){return this.hot.getSettings()[uf]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new IH(this.hot,cm.DEFAULT_ITEMS);const n=this.hot.getSettings()[uf],r={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const i=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new eu(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>as(this,f_,$Q).call(this)),this.menu.addLocalHook("afterOpen",()=>as(this,g_,kQ).call(this)),this.menu.addLocalHook("afterSubmenuOpen",o=>as(this,m_,FQ).call(this,o)),this.menu.addLocalHook("afterClose",()=>as(this,p_,WQ).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return e.executeCommand.call(e,...s)}),H(i,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:r}=this.hot.getSelectedRangeLast();if((r.isHeader()&&r.row===-1||r.isCell())&&r.col>=0){this.hot.selectColumns(r.col,r.col,-1);const{from:i}=this.hot.getSelectedRangeLast(),o=em(this.menu.container,this.hot.rootDocument),s=this.hot.getCell(-1,i.col,!0),a=s.getBoundingClientRect();this.open({left:a.left+o.left,top:a.top+s.offsetHeight+o.top},{left:a.width}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:qp},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:qp}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(qp)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>as(this,h_,NQ).call(this,e))}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),Ze(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function YH(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function NQ(t){if(t.stopPropagation(),Ve(t.target,av)){const e=em(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+3+e.top},{left:n.width})}}function LQ(t,e){const n=e.parentNode;if(!n)return;const r=n.parentNode.childNodes,i=Array.prototype.indexOf.call(r,n);if(t<0||i!==r.length-1)return;const o=e.querySelector(`.${av}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}const s=this.hot.rootDocument.createElement("button");s.className=av,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(Ne(s,[Vo(),lS(" ")]),Ne(e,[YI("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function $Q(){this.hot.runHooks("beforeDropdownMenuShow",this)}function kQ(){this.hot.runHooks("afterDropdownMenuShow",this),as(this,zb,YH).call(this,this.menu)}function FQ(t){as(this,zb,YH).call(this,t)}function WQ(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}cm.SEPARATOR={name:et};function w_(t,e,n){return e=VQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function VQ(t){var e=BQ(t,"string");return typeof e=="symbol"?e:String(e)}function BQ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class UQ{constructor(e){w_(this,"hot",void 0),w_(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:r,endCol:i}=this._getDataRange(),o=this.options,s=[];return xe(e,r,a=>{const l=[];!o.exportHiddenRows&&this._isHiddenRow(a)||(xe(n,i,u=>{!o.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),s.push(l))}),s}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:r}=this._getDataRange(),i=this.hot.getRowHeader();xe(n,r,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(i[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:r}=this._getDataRange(),i=this.hot.getColHeader();xe(n,r,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(i[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[r=0,i=0,o=n,s=e]=this.options.range;return r=Math.max(r,0),i=Math.max(i,0),o=Math.min(o,n),s=Math.min(s,e),{startRow:r,startCol:i,endRow:o,endCol:s}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}const YQ=UQ;function C_(t,e,n){return e=GQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GQ(t){var e=zQ(t,"string");return typeof e=="symbol"?e:String(e)}function zQ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jb{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){C_(this,"dataProvider",void 0),C_(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=tr(this.constructor.DEFAULT_OPTIONS);const r=new Date;return n=un(tr(jb.DEFAULT_OPTIONS),n),n=un(n,e),n.filename=aS(n.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),n}}const jQ=jb,KQ=String.fromCharCode(13),qQ=String.fromCharCode(34),XQ=String.fromCharCode(10);class ZQ extends jQ{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}export(){const e=this.options,n=this.dataProvider.getData();let r=this.dataProvider.getColumnHeaders();const i=r.length>0,o=this.dataProvider.getRowHeaders(),s=o.length>0;let a=e.bom?String.fromCharCode(65279):"";return i&&(r=Xe(r,l=>this._escapeCell(l,!0)),s&&(a+=e.columnDelimiter),a+=r.join(e.columnDelimiter),a+=e.rowDelimiter),H(n,(l,u)=>{u>0&&(a+=e.rowDelimiter),s&&(a+=this._escapeCell(o[u])+e.columnDelimiter),a+=l.map(c=>this._escapeCell(c)).join(e.columnDelimiter)}),a}_escapeCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=Zt(e);return r!==""&&(n||r.indexOf(KQ)>=0||r.indexOf(qQ)>=0||r.indexOf(XQ)>=0||r.indexOf(this.options.columnDelimiter)>=0)&&(r=r.replace(new RegExp('"',"g"),'""'),r=`"${r}"`),r}}const QQ=ZQ,JQ="csv",lv={[JQ]:QQ};function eJ(t,e,n){return typeof lv[t]=="function"?new lv[t](e,n):null}const tJ="exportFile",nJ=240;class rJ extends gt{static get PLUGIN_KEY(){return tJ}static get PLUGIN_PRIORITY(){return nJ}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:r,rootWindow:i}=this.hot,o=this._createTypeFormatter(e,n),s=this._createBlob(o),a=i.URL||i.webkitURL,l=r.createElement("a"),u=`${o.options.filename}.${o.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(s);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),r.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),r.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,u)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!lv[e])throw new Error(`Export format type "${e}" is not supported.`);return eJ(e,new YQ(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function nl(t,e,n){return e=iJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iJ(t){var e=oJ(t,"string");return typeof e=="symbol"?e:String(e)}function oJ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hh{constructor(e,n){let{id:r,stateless:i=!0}=n;nl(this,"hot",void 0),nl(this,"id",void 0),nl(this,"elements",[]),nl(this,"hidden",!1),nl(this,"stateId",""),nl(this,"state",void 0),this.hot=e,this.id=r,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new zg)}getElements(){return this.elements}reset(){H(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),H(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}_t(hh,wr);const kc={};function As(t,e){if(!kc[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:r}=kc[t];let i=e;return r.inputValuesDecorator&&(i=r.inputValuesDecorator(i)),function(o){return n.apply(o.meta.instance,[].concat([o],[i]))}}function ga(t){if(!kc[t])throw Error(`Filter condition "${t}" does not exist.`);return kc[t].descriptor}function cn(t,e,n){n.key=t,kc[t]={condition:e,descriptor:n}}const Tn="none";function sJ(){return!0}cn(Tn,sJ,{name:jg,inputsCount:0,showOperators:!1});const gc="empty";function aJ(t){return mn(t.value)}cn(gc,aJ,{name:Ky,inputsCount:0,showOperators:!0});const cf="not_empty";function lJ(t,e){return!As(gc,e)(t)}cn(cf,lJ,{name:qy,inputsCount:0,showOperators:!0});const mc="eq";function uJ(t,e){let[n]=e;return Zt(t.value).toLocaleLowerCase(t.meta.locale)===Zt(n)}cn(mc,uJ,{name:Xy,inputsCount:1,showOperators:!0});const hf="neq";function cJ(t,e){return!As(mc,e)(t)}cn(hf,cJ,{name:Zy,inputsCount:1,showOperators:!0});const GH="gt";function hJ(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>r}cn(GH,hJ,{name:nb,inputsCount:1,showOperators:!0});const zH="gte";function dJ(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>=r}cn(zH,dJ,{name:rb,inputsCount:1,showOperators:!0});const jH="lt";function fJ(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<r}cn(jH,fJ,{name:ib,inputsCount:1,showOperators:!0});const KH="lte";function gJ(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<=r}cn(KH,gJ,{name:ob,inputsCount:1,showOperators:!0});const Kb="date_after";function mJ(t,e){let[n]=e;const r=le(t.value,t.meta.dateFormat),i=le(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)>=0}cn(Kb,mJ,{name:lb,inputsCount:1,showOperators:!0});const qb="date_before";function pJ(t,e){let[n]=e;const r=le(t.value,t.meta.dateFormat),i=le(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)<=0}cn(qb,pJ,{name:ub,inputsCount:1,showOperators:!0});const qf="between";function wJ(t,e){let[n,r]=e,i=n,o=r;if(t.meta.type==="numeric"){const s=parseFloat(i,10),a=parseFloat(o,10);i=Math.min(s,a),o=Math.max(s,a)}else if(t.meta.type==="date"){const s=As(qb,[o]),a=As(Kb,[i]);return s(t)&&a(t)}return t.value>=i&&t.value<=o}cn(qf,wJ,{name:sb,inputsCount:2,showOperators:!0});const qH="not_between";function CJ(t,e){return!As(qf,e)(t)}cn(qH,CJ,{name:ab,inputsCount:2,showOperators:!0});const XH="begins_with";function vJ(t,e){let[n]=e;return Zt(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Zt(n))}cn(XH,vJ,{name:Qy,inputsCount:1,showOperators:!0});const ZH="ends_with";function SJ(t,e){let[n]=e;return Zt(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Zt(n))}cn(ZH,SJ,{name:Jy,inputsCount:1,showOperators:!0});const Xb="contains";function yJ(t,e){let[n]=e;return Zt(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Zt(n))>=0}cn(Xb,yJ,{name:eb,inputsCount:1,showOperators:!0});const QH="not_contains";function bJ(t,e){return!As(Xb,e)(t)}cn(QH,bJ,{name:tb,inputsCount:1,showOperators:!0});const JH="date_tomorrow";function RJ(t){const e=le(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(le().subtract(-1,"days").startOf("day"),"d"):!1}cn(JH,RJ,{name:hb,inputsCount:0});const eD="date_today";function EJ(t){const e=le(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(le().startOf("day"),"d"):!1}cn(eD,EJ,{name:cb,inputsCount:0});const tD="date_yesterday";function TJ(t){const e=le(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(le().subtract(1,"days").startOf("day"),"d"):!1}cn(tD,TJ,{name:db,inputsCount:0});BP();function _J(t,e){let n=t;return n===""&&(n=`(${e})`),n}const uv=new Set([1]).has(1),MJ=uv&&typeof Array.from=="function";function dh(t){let e=t;return uv&&(e=new Set(e)),function(n){let r;return uv?r=e.has(n):r=!!~e.indexOf(n),r}}function nD(t){return t??""}function cv(t){let e=t;return MJ?e=Array.from(new Set(e)):e=iS(e),e=e.sort((n,r)=>typeof n=="number"&&typeof r=="number"?n-r:n===r?0:n>r?1:-1),e}function v_(t,e,n,r){const i=[],o=t===e;let s;return o||(s=dh(e)),H(t,a=>{let l=!1;(o||s(a))&&(l=!0);const u={checked:l,value:a,visualValue:_J(a,n)};r&&r(u),i.push(u)}),i}const ma="by_value";function OJ(t,e){let[n]=e;return n(t.value)}cn(ma,OJ,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[dh(e)]},showOperators:!1});const Fc={};function AJ(t){if(!Fc[t])throw Error(`Operation with id "${t}" does not exist.`);const e=Fc[t].func;return function(n,r){return e(n,r)}}function IJ(t){return Fc[t].name}function Zb(t,e,n){Fc[t]={name:e,func:n}}const bs="conjunction",PJ=mb;function xJ(t,e){return t.every(n=>n.func(e))}Zb(bs,PJ,xJ);const Xf="disjunction",HJ=Kg;function DJ(t,e){return t.some(n=>n.func(e))}Zb(Xf,HJ,DJ);const Qb="disjunctionWithExtraCondition",NJ=Kg;function LJ(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}Zb(Qb,NJ,LJ);const $J="numeric",rD="text",kJ="date",S_={[$J]:[Tn,et,gc,cf,et,mc,hf,et,GH,zH,jH,KH,qf,qH],[rD]:[Tn,et,gc,cf,et,mc,hf,et,XH,ZH,et,Xb,QH],[kJ]:[Tn,et,gc,cf,et,mc,hf,et,qb,Kb,qf,et,JH,eD,tD]};function FJ(t){const e=[];let n=t;return S_[n]||(n=rD),H(S_[n],r=>{let i;r===et?i={name:et}:i=tr(ga(r)),e.push(i)}),e}function Nu(t,e,n){return e=WJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function WJ(t){var e=VJ(t,"string");return typeof e=="symbol"?e:String(e)}function VJ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Xp="built",Zp="building",y_=["click","input","keydown","keypress","keyup","focus","blur","change"];let mi=class iD{static get DEFAULTS(){return tr({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){Nu(this,"hot",void 0),Nu(this,"eventManager",new Mr(this)),Nu(this,"options",void 0),Nu(this,"_element",void 0),Nu(this,"buildState",void 0),this.hot=e,this.options=un(iD.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===Zp?this._element:this.buildState===Xp?(this.update(),this._element):(this.buildState=Zp,this.build(),this.buildState=Xp,this._element)}isBuilt(){return this.buildState===Xp}translateIfPossible(e){return typeof e=="string"&&e.startsWith(ir)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,r)=>{this.eventManager.addEventListener(n,r,i=>this.runLocalHooks(r,i,this))};if(this.buildState||(this.buildState=Zp),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&ce(this._element,this.options.className),this.options.children.length)H(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),Ze(this.options,(r,i)=>{n[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(n[i]=this.translateIfPossible(r))}),this._element.appendChild(n),H(y_,r=>e(n,r))}else H(y_,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};_t(mi,wr);function BJ(t,e){oD(t,e),e.add(t)}function UJ(t,e,n){oD(t,e),e.set(t,n)}function oD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wd(t,e){var n=sD(t,e,"get");return YJ(t,n)}function YJ(t,e){return e.get?e.get.call(t):e.value}function GJ(t,e,n){var r=sD(t,e,"set");return zJ(t,r,n),n}function sD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function zJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function jJ(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var rl=new WeakMap,b_=new WeakSet;class Rs extends mi{static get DEFAULTS(){return tr({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,un(Rs.DEFAULTS,n)),BJ(this,b_),UJ(this,rl,{writable:!0,value:void 0}),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>jJ(this,b_,KJ).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");GJ(this,rl,this._element.firstChild),ce(this._element,"htUIInput"),ce(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(wd(this,rl).type=this.options.type,wd(this,rl).placeholder=this.translateIfPossible(this.options.placeholder),wd(this,rl).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&wd(this,rl).focus()}}function KJ(t){this.options.value=t.target.value}function Qp(t,e){aD(t,e),e.add(t)}function Lu(t,e,n){aD(t,e),e.set(t,n)}function aD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function il(t,e,n){var r=lD(t,e,"set");return qJ(t,r,n),n}function qJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Jp(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Ut(t,e){var n=lD(t,e,"get");return XJ(t,n)}function lD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function XJ(t,e){return e.get?e.get.call(t):e.value}var pn=new WeakMap,Cd=new WeakMap,vd=new WeakMap,ew=new WeakMap,Sd=new WeakMap,R_=new WeakSet,E_=new WeakSet,T_=new WeakSet;class Wc extends mi{static get DEFAULTS(){return tr({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,un(Wc.DEFAULTS,n)),Qp(this,T_),Qp(this,E_),Qp(this,R_),Lu(this,pn,{writable:!0,value:null}),Lu(this,Cd,{writable:!0,value:[]}),Lu(this,vd,{writable:!0,value:void 0}),Lu(this,ew,{writable:!0,value:void 0}),Lu(this,Sd,{writable:!0,value:void 0}),this.registerHooks()}getMenu(){return Ut(this,pn)}registerHooks(){this.addLocalHook("click",()=>Jp(this,T_,JJ).call(this))}setItems(e){il(this,Cd,this.translateNames(e)),Ut(this,pn)&&Ut(this,pn).setMenuItems(Ut(this,Cd))}translateNames(e){return H(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),il(this,pn,new eu(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),Ut(this,pn).setMenuItems(Ut(this,Cd));const e=new mi(this.hot,{className:"htUISelectCaption"}),n=new mi(this.hot,{className:"htUISelectDropdown"});il(this,vd,e),il(this,ew,e.element),il(this,Sd,n),this.hot.getSettings().ariaTags&&(Ne(n.element,[Vo()]),Ne(this._element,[UI()])),H([e,n],r=>this._element.appendChild(r.element)),Ut(this,pn).addLocalHook("select",r=>Jp(this,R_,ZJ).call(this,r)),Ut(this,pn).addLocalHook("afterClose",()=>Jp(this,E_,QJ).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=Ut(this,pn).hot.getTranslatedPhrase(jg),Ut(this,ew).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();Ut(this,pn)&&(Ut(this,pn).open(),Ut(this,pn).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),Ut(this,pn).getNavigator().toFirstItem(),Ut(this,pn).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){Ut(this,pn)&&Ut(this,pn).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){Ut(this,pn)&&(Ut(this,pn).destroy(),il(this,pn,null)),Ut(this,vd)&&Ut(this,vd).destroy(),Ut(this,Sd)&&Ut(this,Sd).destroy(),super.destroy()}}function ZJ(t){t.name!==et&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function QJ(){this.runLocalHooks("afterClose")}function JJ(){this.openOptions()}function __(t,e){eee(t,e),e.add(t)}function eee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function M_(t,e,n){return e=tee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tee(t){var e=nee(t,"string");return typeof e=="symbol"?e:String(e)}function nee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function O_(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var A_=new WeakSet,I_=new WeakSet;class hv extends hh{constructor(e,n){super(e,{id:n.id,stateless:!1}),__(this,I_),__(this,A_),M_(this,"name",""),M_(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new Wc(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new Rs(this.hot,{placeholder:yb})),this.elements.push(new Rs(this.hot,{placeholder:bb})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>O_(this,A_,ree).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),H(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>O_(this,I_,iee).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=tr(e.command);n.name.startsWith(Qt)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),H(e.args,(r,i)=>{if(i>n.inputsCount-1)return!1;const o=this.getInputElement(i);o.setValue(r),o[n.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||ga(Tn),n=[];return H(this.getInputElements(),(r,i)=>{e.inputsCount>i&&n.push(r.getValue())}),{command:e,args:n}}updateState(e,n){const r=ga(e?e.name:Tn);this.state.setValueAtIndex(n,{command:r,args:e?e.args:[]}),e||H(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof Wc)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof Rs)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{ce(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&ce(n.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return ce(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),H(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[ga(Tn)];if(e!==null){const{visualIndex:r}=e;n=FJ(this.hot.getDataType(0,r,this.hot.countRows(),r))}H(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function ree(t){H(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function iee(t){Xl(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Kr(t))}function P_(t,e,n){oee(t,e),e.set(t,n)}function oee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $u(t,e){var n=uD(t,e,"get");return see(t,n)}function see(t,e){return e.get?e.get.call(t):e.value}function x_(t,e,n){var r=uD(t,e,"set");return aee(t,r,n),n}function uD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function aee(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var ol=new WeakMap,tw=new WeakMap;class Zf extends mi{static get DEFAULTS(){return tr({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,un(Zf.DEFAULTS,n)),P_(this,ol,{writable:!0,value:void 0}),P_(this,tw,{writable:!0,value:void 0})}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),x_(this,tw,e),x_(this,ol,this._element.firstChild),$u(this,ol).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&($u(this,tw).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return $u(this,ol).checked}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&($u(this,ol).checked=e)}focus(){this.isBuilt()&&$u(this,ol).focus()}}function lee(t,e){uee(t,e),e.add(t)}function uee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cee(t,e,n){return e=hee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hee(t){var e=dee(t,"string");return typeof e=="symbol"?e:String(e)}function dee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fee(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const H_=0;var D_=new WeakSet;class gee extends hh{constructor(e,n){super(e,{id:n.id,stateless:!1}),lee(this,D_),cee(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(ce(n.parentNode,"htFiltersMenuOperators"),H(this.elements,r=>n.appendChild(r.element)),n)}}buildOperatorsElement(){const e=[bs,Xf];H(e,n=>{const r=new Zf(this.hot,{name:"operator",label:{htmlFor:n,textContent:IJ(n)},value:n,checked:n===e[H_],id:n});r.addLocalHook("change",i=>fee(this,D_,mee).call(this,i)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error(bt`Radio button with index ${e} doesn't exist.`);H(this.elements,(n,r)=>{n.setChecked(r===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof Zf&&n.isChecked());return e?e.getValue():bs}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&H(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:bs,n=arguments.length>1?arguments[1]:void 0,r=e;r===Qb&&(r=Xf),this.state.setValueAtIndex(n,r)}reset(){this.setChecked(H_)}}function mee(t){this.setState(t.target.value)}function pee(t,e,n){wee(t,e),e.set(t,n)}function wee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nw(t,e){var n=cD(t,e,"get");return Cee(t,n)}function Cee(t,e){return e.get?e.get.call(t):e.value}function vee(t,e,n){var r=cD(t,e,"set");return See(t,r,n),n}function cD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function See(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var ku=new WeakMap;class Vc extends mi{static get DEFAULTS(){return tr({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,un(Vc.DEFAULTS,n)),pee(this,ku,{writable:!0,value:void 0})}build(){super.build(),vee(this,ku,this._element.firstChild)}update(){this.isBuilt()&&(nw(this,ku).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&nw(this,ku).focus()}activate(){nw(this,ku).click()}}function yd(t,e){hD(t,e),e.add(t)}function sl(t,e,n){hD(t,e),e.set(t,n)}function hD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bd(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Ue(t,e){var n=dD(t,e,"get");return yee(t,n)}function yee(t,e){return e.get?e.get.call(t):e.value}function ni(t,e,n){var r=dD(t,e,"set");return bee(t,r,n),n}function dD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function bee(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const N_="multipleSelect.itemBox";var ui=new WeakMap,Ft=new WeakMap,rw=new WeakMap,co=new WeakMap,Jo=new WeakMap,es=new WeakMap,L_=new WeakSet,$_=new WeakSet,k_=new WeakSet,F_=new WeakSet;class Bc extends mi{static get DEFAULTS(){return tr({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,un(Bc.DEFAULTS,n)),yd(this,F_),yd(this,k_),yd(this,$_),yd(this,L_),sl(this,ui,{writable:!0,value:[]}),sl(this,Ft,{writable:!0,value:void 0}),sl(this,rw,{writable:!0,value:void 0}),sl(this,co,{writable:!0,value:void 0}),sl(this,Jo,{writable:!0,value:void 0}),sl(this,es,{writable:!0,value:void 0}),ni(this,co,new Rs(this.hot,{placeholder:Sb,className:"htUIMultipleSelectSearch"})),ni(this,Jo,new Vc(this.hot,{textContent:pb,className:"htUISelectAll"})),ni(this,es,new Vc(this.hot,{textContent:wb,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return Ue(this,Ft)}registerHooks(){Ue(this,co).addLocalHook("keydown",e=>bd(this,$_,Eee).call(this,e)),Ue(this,co).addLocalHook("input",e=>bd(this,L_,Ree).call(this,e)),Ue(this,Jo).addLocalHook("click",e=>bd(this,k_,Tee).call(this,e)),Ue(this,es).addLocalHook("click",e=>bd(this,F_,_ee).call(this,e))}setItems(e){ni(this,ui,e),Ue(this,Ft)&&Ue(this,Ft).loadData(Ue(this,ui))}setLocale(e){ni(this,rw,e)}getLocale(){return Ue(this,rw)}getItems(){return[...Ue(this,ui)]}getValue(){return Oee(Ue(this,ui))}getSearchInputElement(){return Ue(this,co)}getSelectAllElement(){return Ue(this,Jo)}getClearAllElement(){return Ue(this,es)}isSelectedAllValues(){return Ue(this,ui).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,n=e.createElement("div"),r=new mi(this.hot,{className:"htUISelectionControls",children:[Ue(this,Jo),Ue(this,es)]});this._element.appendChild(Ue(this,co).element),this._element.appendChild(r.element),this._element.appendChild(n);const i=o=>{if(!this._element)return;Ue(this,Ft)&&Ue(this,Ft).destroy(),ce(o,"htUIMultipleSelectHot"),ni(this,Ft,new this.hot.constructor(o,{data:Ue(this,ui),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(l,u,c,d,g,p)=>{l.title=p.instance.getDataAtRowProp(u,p.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{Ue(this,Ft).listen()},maxCols:1,autoWrapCol:!0,height:110,colWidths:()=>Ue(this,Ft).container.scrollWidth-Cn(e),copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),Ue(this,Ft).init();const a=Ue(this,Ft).getShortcutManager().getContext("grid");a.removeShortcutsByKeys(["Tab"]),a.removeShortcutsByKeys(["Shift","Tab"]),a.addShortcut({keys:[["Escape"]],callback:l=>{this.runLocalHooks("keydown",l,this)},group:N_}),a.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:l=>{Ue(this,Ft).deselectCell(),this.runLocalHooks("keydown",l,this),this.runLocalHooks("listTabKeydown",l,this)},group:N_})};i(n),this.hot._registerTimeout(()=>i(n),100)}focus(){this.isBuilt()&&Ue(this,Ft).listen()}reset(){Ue(this,co).reset(),Ue(this,Jo).reset(),Ue(this,es).reset()}update(){this.isBuilt()&&(Ue(this,Ft).loadData(Mee(Ue(this,ui),this.options.value)),super.update())}destroy(){Ue(this,Ft)&&Ue(this,Ft).destroy(),Ue(this,co).destroy(),Ue(this,es).destroy(),Ue(this,Jo).destroy(),ni(this,co,null),ni(this,es,null),ni(this,Jo,null),ni(this,Ft,null),ni(this,ui,null),super.destroy()}}function Ree(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;e===""?n=[...Ue(this,ui)]:n=_r(Ue(this,ui),r=>`${r.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),Ue(this,Ft).loadData(n)}function Eee(t){this.runLocalHooks("keydown",t,this),wS(Xl,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),Kr(t),Ue(this,Ft).listen(),Ue(this,Ft).selectCell(0,0))}function Tee(t){const e=[];t.preventDefault(),H(Ue(this,Ft).getSourceData(),(n,r)=>{n.checked=!0,e.push(XS(n,r)[0])}),Ue(this,Ft).setSourceDataAtCell(e)}function _ee(t){const e=[];t.preventDefault(),H(Ue(this,Ft).getSourceData(),(n,r)=>{n.checked=!1,e.push(XS(n,r)[0])}),Ue(this,Ft).setSourceDataAtCell(e)}function Mee(t,e){const n=dh(e);return Xe(t,r=>(r.checked=n(r.value),r))}function Oee(t){const e=[];return H(t,n=>{n.checked&&e.push(n.value)}),e}function Aee(t,e){Iee(t,e),e.add(t)}function Iee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pee(t,e,n){return e=xee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xee(t){var e=Hee(t,"string");return typeof e=="symbol"?e:String(e)}function Hee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Dee(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var W_=new WeakSet;class Nee extends hh{constructor(e,n){super(e,{id:n.id,stateless:!1}),Aee(this,W_),Pee(this,"name",""),this.name=n.name,this.elements.push(new Bc(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>Dee(this,W_,Lee).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===ma){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?Tn:ma},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(r,i,o,s,a)=>{const[l]=_r(i,d=>d.name===ma),u={},c=this.hot.getTranslatedPhrase(Wf);if(l){const d=cv(Xe(s(r,a),E=>E.value));o&&(l.args[0]=o);const g=[],p=v_(d,l.args[0],c,E=>{E.checked&&g.push(E.value)}),C=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,C).locale,u.args=[g],u.command=ga(ma),u.itemsSnapshot=p}else u.args=[],u.command=ga(Tn);this.state.setValueAtIndex(r,u)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof Bc)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{ce(n.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return ce(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),H(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(Wf),n=cv(this._getColumnVisibleValues()),r=v_(n,n,e);this.getMultipleSelectElement().setItems(r),super.reset(),this.getMultipleSelectElement().setValue(n);const i=this.hot.getPlugin("filters").getSelectedColumn();i!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,i.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:Xe(this.hot.getDataAtCol(e.visualIndex),n=>nD(n))}}function Lee(t){Xl(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Kr(t))}var fD;function $ee(t,e){kee(t,e),e.add(t)}function kee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fee(t,e,n){return e=Wee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wee(t){var e=Vee(t,"string");return typeof e=="symbol"?e:String(e)}function Vee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Bee(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var V_=new WeakSet;class Uc extends hh{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),$ee(this,V_),Fee(this,"name",""),this.name=n.name,this.elements.push(new Rs(this.hot,{type:"button",value:Cb,className:"htUIButton htUIButtonOK",identifier:Uc.BUTTON_OK})),this.elements.push(new Rs(this.hot,{type:"button",value:vb,className:"htUIButton htUIButtonCancel",identifier:Uc.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){H(this.elements,e=>{e.addLocalHook("click",(n,r)=>Bee(this,V_,Uee).call(this,n,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(ce(n.parentNode,"htFiltersMenuActionBar"),H(this.elements,r=>n.appendChild(r.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}fD=Uc;function Uee(t,e){e.options.identifier===fD.BUTTON_OK?this.accept():this.cancel()}function iw(t,e,n){return e=Yee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yee(t){var e=Gee(t,"string");return typeof e=="symbol"?e:String(e)}function Gee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const B_="ConditionCollection.filteringStates";class gD{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;iw(this,"hot",void 0),iw(this,"isMapRegistrable",void 0),iw(this,"filteringStates",new zg),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(B_,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var r;const i=this.filteringStates.getValueAtIndex(n),o=(r=i==null?void 0:i.conditions)!==null&&r!==void 0?r:[],s=i==null?void 0:i.operation;return this.isMatchInConditions(o,e,s)}isMatchInConditions(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:bs;return e.length?AJ(r)(e,n):!0}addCondition(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:bs,i=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,s=Xe(n.args,c=>typeof c=="string"?c.toLocaleLowerCase(o):c),a=n.name||n.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==r)throw Error(bt`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(It(Fc[r]))throw new Error(bt`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:a,args:s,func:As(a,s)}]},i):u.push({name:a,args:s,func:As(a,s)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,r;return(n=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return nn(this.filteringStates.getEntries(),(e,n)=>{let[r,{operation:i,conditions:o}]=n;return e.push({column:r,operation:i,conditions:Xe(o,s=>{let{name:a,args:l}=s;return{name:a,args:l}})}),e},[])}importAllConditions(e){this.clean(),H(e,n=>{H(n.conditions,r=>this.addCondition(n.column,r))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const r=this.getConditions(e);return n?r.some(i=>i.name===n):r.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(B_),this.filteringStates=null,this.clearLocalHooks()}}_t(gD,wr);const mD=gD;function U_(t,e,n){return e=zee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zee(t){var e=jee(t,"string");return typeof e=="symbol"?e:String(e)}function jee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Kee{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];U_(this,"conditionCollection",void 0),U_(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return H(this.conditionCollection.getFilteredColumns(),(n,r)=>{let i=this.columnDataFactory(n);r&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(n,i)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];return H(n,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&r.push(i)}),r}_getIntersectData(e,n){const r=[];return H(n,i=>{const o=i.meta.visualRow;e[o]!==void 0&&(r[o]=e[o])}),r}}const pD=Kee;function ow(t,e){qee(t,e),e.add(t)}function qee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qs(t,e,n){return e=Xee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xee(t){var e=Zee(t,"string");return typeof e=="symbol"?e:String(e)}function Zee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sw(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var Y_=new WeakSet,G_=new WeakSet,z_=new WeakSet;class wD{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];ow(this,z_),ow(this,G_),ow(this,Y_),Qs(this,"hot",void 0),Qs(this,"conditionCollection",void 0),Qs(this,"columnDataFactory",void 0),Qs(this,"changes",[]),Qs(this,"grouping",!1),Qs(this,"latestEditedColumnPosition",-1),Qs(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",i=>sw(this,Y_,Qee).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>sw(this,G_,Jee).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>sw(this,z_,ete).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,H(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const s=i.slice(0,o),a=i.slice(o);a.length&&a[0].column===e&&a.shift();const l=sP(function(c,d){let g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const p=new mD(r.hot,!1),C=[].concat(c,g);p.importAllConditions(C);const E=r.columnDataFactory(d);let I;p.isEmpty()?I=E:I=new pD(p,y=>r.columnDataFactory(y)).filter(),I=Xe(I,y=>y.meta.visualRow);const M=dh(I);return p.destroy(),_r(E,y=>M(y.meta.visualRow))})(s),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),Ze(this,(e,n)=>{this[n]=null})}}function Qee(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function Jee(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function ete(){H(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}_t(wD,wr);const tte=wD;function nte(t){return xH({initialPage:0,size:()=>t.length,onItemSelect:(n,r)=>{const i=t[n];if(i instanceof Bc)return r;if(i.element&&!_s(i.element))return!1;i.focus()}})}const Fu="filters";function rte(t,e){let n=-1;const r=nte(e),i=l=>()=>{t.isOpened()&&t.getKeyboardShortcutsCtrl().listen(Fu),r.setCurrentPage(e.indexOf(l))};e.forEach(l=>{l instanceof mi&&(l.addLocalHook("click",i(l)),l.addLocalHook("focus",i(l)),l.addLocalHook("afterClose",i(l)))}),t.addLocalHook("afterSelectionChange",l=>{l.key.startsWith("filter_")||r.clear()});function o(l){const u=t.getKeyboardShortcutsCtrl(),c=l.getKeyboardShortcutsCtrl();r.clear(),c.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:u.getContext(Fu),callback:()=>{l.isSubMenu()&&l.close(),u.listen(Fu)}}]),!l.isSubMenu()&&u.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:d=>{const g=t.getNavigator();g.getCurrentPage()>-1&&(n=g.getCurrentPage()),g.clear(),d.shiftKey?r.toPreviousItem():r.toNextItem()}},{keys:[["Escape"]],callback:()=>{t.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:d=>{const g=e[r.getCurrentPage()];g instanceof Wc&&(g.openOptions(),d.preventDefault()),g instanceof Vc&&(g.activate(),d.preventDefault()),g instanceof mi||d.preventDefault()}}],Fu)}t.addLocalHook("afterSubmenuOpen",o),t.addLocalHook("afterOpen",o);function s(){t.focus(),t.getKeyboardShortcutsCtrl().listen(Fu)}function a(){return n}return{...r,listen:s,getLastMenuPage:a}}function ho(t,e){CD(t,e),e.add(t)}function ite(t,e,n){CD(t,e),e.set(t,n)}function CD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wu(t,e,n){return e=ote(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ote(t){var e=ste(t,"string");return typeof e=="symbol"?e:String(e)}function ste(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ate(t,e,n){var r=vD(t,e,"set");return lte(t,r,n),n}function lte(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Vu(t,e){var n=vD(t,e,"get");return ute(t,n)}function vD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function ute(t,e){return e.get?e.get.call(t):e.value}function ri(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const dv="filters",cte=250,j_=dv;var Js=new WeakMap,K_=new WeakSet,q_=new WeakSet,X_=new WeakSet,Z_=new WeakSet,aw=new WeakSet,Q_=new WeakSet,lw=new WeakSet,J_=new WeakSet,eM=new WeakSet;class hte extends gt{static get PLUGIN_KEY(){return dv}static get PLUGIN_PRIORITY(){return cte}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),ho(this,eM),ho(this,J_),ho(this,lw),ho(this,Q_),ho(this,aw),ho(this,Z_),ho(this,X_),ho(this,q_),ho(this,K_),Wu(this,"dropdownMenuPlugin",null),Wu(this,"conditionCollection",null),Wu(this,"conditionUpdateObserver",null),Wu(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),Wu(this,"filtersRowsMap",null),ite(this,Js,{writable:!0,value:void 0}),this.hot.addHook("afterGetColHeader",(n,r)=>ri(this,J_,wte).call(this,n,r))}isEnabled(){return!!this.hot.getSettings()[dv]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new oh),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const e=this.hot.getSettings().dropdownMenu,n=e&&e.uiContainer||this.hot.rootDocument.body,r=s=>(s.addLocalHook("accept",()=>ri(this,aw,tM).call(this,"accept")),s.addLocalHook("cancel",()=>ri(this,aw,tM).call(this,"cancel")),s.addLocalHook("change",a=>ri(this,Q_,pte).call(this,s,a)),s),i=()=>`${this.hot.getTranslatedPhrase(fb)}:`,o=()=>`${this.hot.getTranslatedPhrase(gb)}:`;if(!this.components.get("filter_by_condition")){const s=new hv(this.hot,{id:"filter_by_condition",name:i,addSeparator:!1,menuContainer:n});s.addLocalHook("afterClose",()=>ri(this,lw,nM).call(this)),this.components.set("filter_by_condition",r(s))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new gee(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const s=new hv(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:n});s.addLocalHook("afterClose",()=>ri(this,lw,nM).call(this)),this.components.set("filter_by_condition2",r(s))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",r(new Nee(this.hot,{id:"filter_by_value",name:o}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",r(new Uc(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new mD(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new tte(this.hot,this.conditionCollection,s=>this.getDataMapAtColumn(s)),this.conditionUpdateObserver.addLocalHook("update",s=>ri(this,eM,Cte).call(this,s))),this.components.forEach(s=>s.show()),this.addHook("afterDropdownMenuDefaultOptions",s=>ri(this,Z_,mte).call(this,s)),this.addHook("afterDropdownMenuShow",()=>ri(this,q_,fte).call(this)),this.addHook("afterDropdownMenuHide",()=>ri(this,X_,gte).call(this)),this.addHook("afterChange",s=>ri(this,K_,dte).call(this,s)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!Vu(this,Js)&&this.dropdownMenuPlugin.enabled){const s=this.dropdownMenuPlugin.menu,a=[{focus:()=>{const u=s.getNavigator(),c=Vu(this,Js).getLastMenuPage();s.focus(),c>0?u.setCurrentPage(c):u.toFirstItem()}},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];ate(this,Js,rte(s,a));const l=u=>{Vu(this,Js).listen(),u.preventDefault(),Xl(u.keyCode,"TAB")&&(u.shiftKey?Vu(this,Js).toPreviousItem():Vu(this,Js).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,r)=>{n.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:j_})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(j_)}addCondition(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:bs;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:n},args:r},i)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),r=!this.conditionCollection.isEmpty();let i=[];const o=this.conditionCollection.exportAllConditions();if(this.hot.runHooks("beforeFilter",o)!==!1)if(r){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=Xe(n.filter(),u=>u.meta.visualRow);const l=dh(i);xe(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),H(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!i.length&&this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),r=[];return H(this.hot.getSourceDataAtCol(n),(i,o)=>{var s;const{row:a,col:l,visualCol:u,visualRow:c,type:d,instance:g,dateFormat:p,locale:C}=this.hot.getCellMeta(o,n),E=(s=this.hot.getDataAtCell(this.hot.toVisualRow(o),n))!==null&&s!==void 0?s:i;r.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:d,instance:g,dateFormat:p,locale:C},value:nD(E)})}),r}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),r=cv(n);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var n;const r=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(r)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,r,i){let o=e;return o===Xf&&n.command.key!==Tn&&r.command.key!==Tn&&i.command.key!==Tn?o=Qb:i.command.key!==Tn&&(n.command.key===Tn||r.command.key===Tn)&&(o=bs),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...r):this.hideComponents(...r)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new pD(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return H(i,s=>{H(n.menuItems,(a,l)=>{a.key===s.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const r=this.dropdownMenuPlugin.menu.hotMenu,i=r.getPlugin("hiddenRows");for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];const l=this.getIndexesOfComponents(...s);e?i.showRows(l):i.hideRows(l),r.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function dte(t){t&&H(t,e=>{const[,n]=e,r=this.hot.propToCol(n);this.conditionCollection.hasConditions(r)&&this.updateValueComponentCondition(r)})}function fte(){this.restoreComponents(Array.from(this.components.values()))}function gte(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function mte(t){t.items.push({name:et}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function tM(t){var e;if(t==="accept"){const r=this.getSelectedColumn();if(r===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:i}=r,o=this.components.get("filter_by_condition").getState(),s=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,s,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(i);u===-1&&(u=void 0),this.conditionCollection.removeConditions(i),o.command.key!==Tn&&(this.conditionCollection.addCondition(i,o,l,u),s.command.key!==Tn&&this.conditionCollection.addCondition(i,s,l,u)),a.command.key!==Tn&&this.conditionCollection.addCondition(i,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(i)),this.filtersRowsMap.clear(),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function pte(t,e){this.updateDependentComponentsVisibility(),t.constructor===hv&&!e.inputsCount&&this.setListeningDropdownMenu()}function nM(){this.setListeningDropdownMenu()}function wte(t,e){const n=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(n)?ce(e,"htFiltersActive"):Ye(e,"htFiltersActive")}function Cte(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:r}}=t,i=n.filter(s=>s.name===ma),o=n.filter(s=>s.name!==ma);if(i.length>=2||o.length>=3)Pt(bt`The filter conditions have been applied properly, but couldnât be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const s=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(o[0],r),this.components.get("filter_by_condition2").updateState(o[1],r),this.components.get("filter_operators").updateState(s,r),this.components.get("filter_by_value").updateState(t)}}const SD="internal-use-in-handsontable",fv={licenseKey:SD,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function yD(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[kn])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function bD(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function vte(t){var e;const n=t[kn],r=bD(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=yD(t);return{...fv,...r,...i}}function Ste(t){var e;const n=t[kn],r=bD(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=yD(t);return{...r,...i}}function yte(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function hm(){const t="engine_relationship",e=yi(kn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function Jb(){const t="shared_engine_usage",e=yi(kn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function bte(t){const e=t.getSettings(),n=e[kn],r=n==null?void 0:n.engine;if(n===!0||It(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var i;return Rte((i=r.hyperformula)!==null&&i!==void 0?i:r,e,t)}else if(typeof r=="object"&&It(r.hyperformula)){const o=hm(),s=Jb().get(r);return o.has(r)||o.set(r,[]),o.get(r).push(t),s&&s.push(t.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:SD}),(r.getConfig().leapYear1900!==fv.leapYear1900||kg(r.getConfig().nullDate,fv.nullDate)===!1)&&Pt(bt`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function Rte(t,e,n){const r=e[kn],i=vte(e),o=hm(),s=Jb();Ete(t,r.functions),Tte(t,r.language);const a=t.buildEmpty(i);return o.set(a,[n]),s.set(a,[n.guid]),_te(a,r.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function rM(t){var e;const n=hm(),r=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(r.map(i=>[i.getPlugin("formulas").sheetId,i]))}function iM(t,e){if(t){const n=hm(),r=n.get(t),i=Jb(),o=i.get(t);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),r.length===0&&n.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(i.delete(t),t.destroy()))}}function Ete(t,e){e&&e.forEach(n=>{const{name:r,plugin:i,translations:o}=n;try{t.registerFunction(r,i,o)}catch(s){Pt(s.message)}})}function Tte(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(r){Pt(r.message)}}}function _te(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:r,expression:i,scope:o,options:s}=n;try{t.addNamedExpression(r,i,o,s)}catch(a){Pt(a.message)}}),t.resumeEvaluation())}function Mte(t,e){return(It(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const RD="DD/MM/YYYY";function ED(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function Ote(t){return ED(t)?t.substr(1):t}function Ate(t){return typeof t=="string"&&t.startsWith("=")}function eR(t,e){return typeof t=="string"&&e==="date"}function TD(t,e){return le(t,e,!0).isValid()}function _D(t,e){return le(t,e,!0).format(RD)}function Ite(t,e){return le(t,RD,!0).format(e)}function MD(t,e){const r=new Date(Date.UTC(0,0,t+-1));return le(r).format(e)}function ea(t,e,n){Pte(t,e),e.set(t,n)}function Pte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dt(t,e){var n=OD(t,e,"get");return xte(t,n)}function xte(t,e){return e.get?e.get.call(t):e.value}function ts(t,e,n){var r=OD(t,e,"set");return Hte(t,r,n),n}function OD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Hte(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Bu=new WeakMap,ns=new WeakMap,Cr=new WeakMap,Rd=new WeakMap,uw=new WeakMap,cw=new WeakMap,Ed=new WeakMap;class Dte{constructor(e,n,r){ea(this,Bu,{writable:!0,value:void 0}),ea(this,ns,{writable:!0,value:void 0}),ea(this,Cr,{writable:!0,value:void 0}),ea(this,Rd,{writable:!0,value:[]}),ea(this,uw,{writable:!0,value:[]}),ea(this,cw,{writable:!0,value:void 0}),ea(this,Ed,{writable:!0,value:[]}),ts(this,Bu,e),ts(this,ns,n),ts(this,Cr,r)}setRemovedHfIndexes(e){return ts(this,Ed,e.map(n=>{const r=Dt(this,ns).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(r)})),Dt(this,Ed)}getRemovedHfIndexes(){return Dt(this,Ed)}getHfIndexFromVisualIndex(e){const n=Dt(this,ns).getIndexesSequence(),r=Dt(this,ns).getNotTrimmedIndexes();return n.indexOf(r[e])}syncMoves(e){const r=`move${Wn(Dt(this,Bu))}s`;Dt(this,Cr).getEngine().batch(()=>{e.forEach(i=>{const o=i.from!==i.to,s=i.from+1!==i.to;o&&s&&Dt(this,Cr).getEngine()[r](Dt(this,Cr).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,n,r){r!==!1&&(ts(this,uw,e.map(i=>this.getHfIndexFromVisualIndex(i))),ts(this,cw,this.getHfIndexFromVisualIndex(n)))}getMoveLine(e,n){const r=Dt(this,ns).getNumberOfIndexes(),i=Array.from(Array(r).keys()).filter(s=>e.includes(s)===!1);if(n===0){var o;return(o=i[n])!==null&&o!==void 0?o:0}return i[n-1]+1}getInitiallyCalculatedMoves(e,n){let r=this.getMoveLine(e,n);const i=[];return e.forEach(o=>{const s={from:o,to:r};i.forEach(a=>{const l=a.from>a.to,u=a.to<=s.from;a.from>s.from&&u&&l&&(s.from+=1)}),s.from>=r&&(r+=1),i.push(s)}),i}adjustedCalculatedMoves(e){return e.forEach((n,r)=>{e.slice(r+1).forEach(o=>{const s=o.from<o.to;o.from>n.from&&s&&(o.from-=1)})}),e}calculateAndSyncMoves(e,n){if(Dt(this,Cr).isPerformingUndoRedo()||e===!1||n===!1)return;const r=this.adjustedCalculatedMoves(this.getInitiallyCalculatedMoves(Dt(this,uw),Dt(this,cw)));Dt(this,Cr).getSheetId()===null?Dt(this,Cr).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){const e=`set${Wn(Dt(this,Bu))}Order`;return n=>{if(Dt(this,Cr).isPerformingUndoRedo())return;const r=Dt(this,ns).getIndexesSequence();if(n==="update"){const i=Dt(this,Rd).map(l=>r.indexOf(l)),o=Dt(this,Cr).getEngine().getSheetDimensions(Dt(this,Cr).getSheetId());let s;Dt(this,Bu)==="row"?s=o.height:s=o.width;const a=i.length;for(let l=a;l<s;l+=1)i.push(l);Dt(this,Cr).getEngine()[e](Dt(this,Cr).getSheetId(),i)}ts(this,Rd,r)}}init(){ts(this,Rd,Dt(this,ns).getIndexesSequence())}}const oM=Dte;function ta(t,e,n){Nte(t,e),e.set(t,n)}function Nte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fo(t,e){var n=AD(t,e,"get");return Lte(t,n)}function Lte(t,e){return e.get?e.get.call(t):e.value}function na(t,e,n){var r=AD(t,e,"set");return $te(t,r,n),n}function AD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function $te(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Td=new WeakMap,_d=new WeakMap,hw=new WeakMap,dw=new WeakMap,fw=new WeakMap,gw=new WeakMap,mw=new WeakMap;class kte{constructor(e,n,r){ta(this,Td,{writable:!0,value:void 0}),ta(this,_d,{writable:!0,value:void 0}),ta(this,hw,{writable:!0,value:void 0}),ta(this,dw,{writable:!0,value:!1}),ta(this,fw,{writable:!0,value:!1}),ta(this,gw,{writable:!0,value:null}),ta(this,mw,{writable:!0,value:null}),na(this,Td,new oM("row",e,this)),na(this,_d,new oM("column",n,this)),na(this,hw,r)}getForAxis(e){return e==="row"?fo(this,Td):fo(this,_d)}setPerformUndo(e){na(this,dw,e)}setPerformRedo(e){na(this,fw,e)}isPerformingUndoRedo(){return fo(this,dw)||fo(this,fw)}getSheetId(){return fo(this,mw)}getEngine(){return fo(this,gw)}getPostponeAction(){return fo(this,hw)}setupSyncEndpoint(e,n){na(this,gw,e),na(this,mw,n),fo(this,Td).init(),fo(this,_d).init()}}const Fte=kte;function kt(t,e){ID(t,e),e.add(t)}function al(t,e,n){return e=Wte(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wte(t){var e=Vte(t,"string");return typeof e=="symbol"?e:String(e)}function Vte(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pw(t,e,n){ID(t,e),e.set(t,n)}function ID(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Is(t,e,n){var r=PD(t,e,"set");return Bte(t,r,n),n}function Bte(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function $l(t,e){var n=PD(t,e,"get");return Ute(t,n)}function PD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Ute(t,e){return e.get?e.get.call(t):e.value}function Ot(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const kn="formulas",Yte=["maxRows","maxColumns","language"],Gte=260;_e.getSingleton().register("afterNamedExpressionAdded");_e.getSingleton().register("afterNamedExpressionRemoved");_e.getSingleton().register("afterSheetAdded");_e.getSingleton().register("afterSheetRemoved");_e.getSingleton().register("afterSheetRenamed");_e.getSingleton().register("afterFormulasValuesUpdate");const tu=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var $o=new WeakMap,tR=new WeakMap,Uu=new WeakMap,sM=new WeakSet,aM=new WeakSet,ww=new WeakSet,lM=new WeakSet,Cw=new WeakSet,uM=new WeakSet,cM=new WeakSet,vw=new WeakSet,hM=new WeakSet,dM=new WeakSet,fM=new WeakSet,gM=new WeakSet,mM=new WeakSet,pM=new WeakSet,wM=new WeakSet,CM=new WeakSet,vM=new WeakSet,SM=new WeakSet,yM=new WeakSet,bM=new WeakSet,RM=new WeakSet,EM=new WeakSet,TM=new WeakSet,_M=new WeakSet;class zte extends gt{constructor(){var e;super(...arguments),e=this,kt(this,_M),kt(this,TM),kt(this,EM),kt(this,RM),kt(this,bM),kt(this,yM),kt(this,SM),kt(this,vM),kt(this,CM),kt(this,wM),kt(this,pM),kt(this,mM),kt(this,gM),kt(this,fM),kt(this,dM),kt(this,hM),kt(this,vw),kt(this,cM),kt(this,uM),kt(this,Cw),kt(this,lM),kt(this,ww),kt(this,aM),kt(this,sM),pw(this,$o,{writable:!0,value:!1}),pw(this,tR,{writable:!0,value:!1}),pw(this,Uu,{writable:!0,value:[["valuesUpdated",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ot(e,yM,lne).call(e,...r)}],["namedExpressionAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ot(e,bM,une).call(e,...r)}],["namedExpressionRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ot(e,RM,cne).call(e,...r)}],["sheetAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ot(e,EM,hne).call(e,...r)}],["sheetRenamed",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ot(e,TM,dne).call(e,...r)}],["sheetRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ot(e,_M,fne).call(e,...r)}]]}),al(this,"staticRegister",yi("formulas")),al(this,"engine",null),al(this,"sheetName",null),al(this,"indexSyncer",null),al(this,"rowAxisSyncer",null),al(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return kn}static get PLUGIN_PRIORITY(){return Gte}static get SETTING_KEYS(){return[kn,...Yte]}get sheetId(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[kn]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=bte(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){Pt("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());r!==!1&&(this.sheetName=r)}this.addHook("beforeLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ot(n,ww,MM).call(n,...i)}),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ot(n,Cw,OM).call(n,...i)}),this.addHook("beforeUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ot(n,ww,MM).call(n,...i)}),this.addHook("afterUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ot(n,Cw,OM).call(n,...i)}),this.addHook("modifyData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ot(n,uM,Xte).call(n,...i)}),this.addHook("modifySourceData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ot(n,cM,Zte).call(n,...i)}),this.addHook("beforeValidate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ot(n,sM,jte).call(n,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ot(n,hM,Qte).call(n,...i)}),this.addHook("afterSetDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ot(n,vw,AM).call(n,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ot(n,vw,AM).call(n,...i)}),this.addHook("beforeCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ot(n,dM,Jte).call(n,...i)}),this.addHook("beforeCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ot(n,fM,ene).call(n,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ot(n,pM,rne).call(n,...i)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ot(n,wM,ine).call(n,...i)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ot(n,gM,tne).call(n,...i)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ot(n,mM,nne).call(n,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ot(n,CM,one).call(n,...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ot(n,vM,sne).call(n,...i)}),this.indexSyncer=new Fte(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,i,o,s)=>{this.rowAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("beforeColumnMove",(r,i,o,s)=>{this.columnAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("afterRowMove",(r,i,o,s,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("afterColumnMove",(r,i,o,s,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("beforeColumnFreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ot(n,lM,qte).call(n,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ot(n,SM,ane).call(n,...i)}),this.addHook("beforeAutofill",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ot(n,aM,Kte).call(n,...i)}),$l(this,Uu).forEach(r=>{let[i,o]=r;return this.engine.on(i,o)}),super.enablePlugin()}}disablePlugin(){$l(this,Uu).forEach(e=>{let[n,r]=e;return this.engine.off(n,r)}),iM(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=Ste(this.hot.getSettings());yte(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const r=this.hot.getSettings()[kn];if(Re(r)&&Re(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[kn].sheetName;i&&this.engine.doesSheetExist(i)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(i??void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){$l(this,Uu).forEach(e=>{var n;let[r,i]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(r,i)}),Is(this,Uu,null),iM(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(Re(n)&&!fx(n))return Pt("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return Pt("Sheet with the provided name already exists."),!1;try{const r=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(r),n),r}catch(r){return Pt(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){RS(`The sheet named \`${e}\` does not exist, switch aborted.`);return}this.sheetName=e;const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${Wn(kn)}.switchSheet`)}getCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(n);return i!==null&&o!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=new Set;e.forEach(i=>{var o;const s=i==null||(o=i.address)===null||o===void 0?void 0:o.sheet;s!==void 0&&(r.has(s)||r.add(s))}),rM(this.engine).forEach((i,o)=>{if((n||o!==this.sheetId)&&r.has(o)){var s;i.render(),(s=i.view)===null||s===void 0||s.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=o=>{var s;const{row:a,col:l,sheet:u}=(s=o==null?void 0:o.address)!==null&&s!==void 0?s:{};return Re(u)?`${u}:${a}x${l}`:""},i=new Set(n.map(o=>r(o)));e.forEach(o=>{var s,a;const{row:l,col:u}=(s=o.address)!==null&&s!==void 0?s:{};if(Re(l)===!1||Re(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=o==null||(a=o.address)===null||a===void 0?void 0:a.sheet,d=r(o);if(c!==void 0&&!i.has(d)){const g=rM(this.engine).get(c);if(!g)return;g.validateCell(g.getDataAtCell(l,u),g.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,n,r){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){Pt(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const o=this.hot.getCellMeta(e,n);return eR(r,o.type)&&(TD(r,o.dateFormat)?r=_D(r,o.dateFormat):Ate(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(i,r)}}function jte(t,e,n){const r=this.hot.propToCol(n);if(this.isFormulaCellType(e,r)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},o=this.hot.getCellMeta(e,r);let s=this.engine.getCellValue(i);return o.type==="date"&&er(s)&&(s=MD(s,o.dateFormat)),typeof s=="object"&&s!==null?s.value:s}return t}function Kte(t,e,n){const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner(),d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},g={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(g)===!1)return!1;const p=this.engine.getFillRangeData(d,g),{row:C,col:E}=d.start,{row:I,col:M}=d.end,y=I-C+1,$=M-E+1;for(let q=0;q<p.length;q+=1)for(let G=0;G<p[q].length;G+=1){const X=p[q][G],re=q%y,v=G%$,S=this.hot.getCellMeta(re,v);eR(X,S.type)&&(X.startsWith("'")?p[q][G]=X.slice(1):this.isFormulaCellType(re,v,this.sheetId)===!1&&(p[q][G]=Ite(X,S.dateFormat)))}return p}function MM(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Wn(kn))||Is(this,tR,It(this.hot.getSettings().data))}function qte(){const t=this.hot.getSourceDataArray();let e=!1;t.forEach((n,r)=>{n.forEach((i,o)=>{const s=this.hot.getCellMeta(r,o),a=s.dateFormat;eR(i,s.type)&&(e=!0,TD(i,a)?t[r][o]=_D(i,a):this.isFormulaCellType(r,o)===!1&&(t[r][o]=`'${i}`))})}),e===!0&&(Is(this,$o,!0),this.engine.setSheetContent(this.sheetId,t),Is(this,$o,!1))}function OM(t,e){if(!(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Wn(kn)))if(this.sheetName=Mte(this.engine,this.hot.getSettings()[kn].sheetName),$l(this,tR))this.switchSheet(this.sheetName);else{const r=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,r)){Is(this,$o,!0);const i=this.engine.setSheetContent(this.sheetId,r);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(i),Is(this,$o,!1)}}}function Xte(t,e,n,r){if(r!=="get"||$l(this,$o)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t);if(i===null||e===null)return;if(!this.isFormulaCellType(i,e)&&this.getCellType(i,e)!=="ARRAY"){ED(n.value)&&(n.value=Ote(n.value));return}const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let a=this.engine.getCellValue(s);const l=this.hot.getCellMeta(i,e);l.type==="date"&&er(a)&&(a=MD(a,l.dateFormat));const u=typeof a=="object"&&a!==null?a.value:a;n.value=u}function Zte(t,e,n,r){if(r!=="get"||$l(this,$o)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),o=this.hot.propToCol(e);if(i===null||o===null||!this.isFormulaCellType(i,o)&&this.getCellType(i,o)!=="ARRAY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function AM(t,e){if(tu(e))return;const n=[],r=[],i=this.engine.batch(()=>{t.forEach(o=>{let[s,a,,l]=o;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(s),d=this.hot.toPhysicalColumn(u),g={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};c!==null&&d!==null?this.syncChangeWithEngine(s,u,l):n.push([s,u,l]),r.push({address:g})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const o=this.engine.batch(()=>{n.forEach(s=>{let[a,l,u]=s;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function Qte(t,e){if(tu(e))return;const n=[],r=[];t.forEach(i=>{let[o,s,,a]=i;const l=this.hot.propToCol(s);if(!er(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){Pt(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}r.push({address:u}),n.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(n),this.validateDependentCells(n,r)}function Jte(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function ene(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function tne(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}function nne(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}function rne(t,e,n){if(tu(n))return;const r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function ine(t,e,n){if(tu(n))return;const r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function one(t,e,n,r){if(tu(r))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeRows(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function sne(t,e,n,r){if(tu(r))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeColumns(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function ane(t,e,n){var r;Is(this,$o,!0);const i=this.hot.getSourceDataArray(n,0,n+(((r=e.__children)===null||r===void 0?void 0:r.length)||0),this.hot.countSourceCols());Is(this,$o,!1),i.forEach((o,s)=>{o.forEach((a,l)=>{this.engine.setCellContents({col:l,row:n+s,sheet:this.sheetId},[[a]])})})}function lne(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function une(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function cne(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function hne(t){this.hot.runHooks("afterSheetAdded",t)}function dne(t,e){this.hot.runHooks("afterSheetRenamed",t,e)}function fne(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function gne(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[,r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(Yy,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,n.col),0),i=Math.max(e.col,n.col),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideColumns(o);const s=o[o.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function mne(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(Gy,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(!0),o-i+1===this.countCols()||this.selectColumns(i,o)},disabled:!1,hidden(){const n=Xe(t.getHiddenColumns(),d=>this.toPhysicalColumn(d));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().col,o=r.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const d=o-i+1,g=l-a+1;if(d>g){const p=u.slice(i,o+1);c.push(...p.filter(C=>n.includes(C)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const d=this.countCols()-1,g=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(d,-1));l===g&&d>o&&c.push(...u.slice(o+1))}return H(c,d=>{e.push(this.toVisualColumn(d))}),e.length===0}}}function ll(t,e){xD(t,e),e.add(t)}function IM(t,e,n){xD(t,e),e.set(t,n)}function xD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ul(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Rr(t,e){var n=HD(t,e,"get");return pne(t,n)}function pne(t,e){return e.get?e.get.call(t):e.value}function Yu(t,e,n){var r=HD(t,e,"set");return wne(t,r,n),n}function HD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function wne(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}_e.getSingleton().register("beforeHideColumns");_e.getSingleton().register("afterHideColumns");_e.getSingleton().register("beforeUnhideColumns");_e.getSingleton().register("afterUnhideColumns");const Sw="hiddenColumns",Cne=310;var zi=new WeakMap,Hi=new WeakMap,PM=new WeakSet,xM=new WeakSet,HM=new WeakSet,DM=new WeakSet,NM=new WeakSet,LM=new WeakSet;class vne extends gt{constructor(){super(...arguments),ll(this,LM),ll(this,NM),ll(this,DM),ll(this,HM),ll(this,xM),ll(this,PM),IM(this,zi,{writable:!0,value:{}}),IM(this,Hi,{writable:!0,value:null})}static get PLUGIN_KEY(){return Sw}static get PLUGIN_PRIORITY(){return Cne}isEnabled(){return!!this.hot.getSettings()[Sw]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Sw];qe(n)&&(Yu(this,zi,n),It(n.copyPasteEnabled)&&(n.copyPasteEnabled=!0)),Yu(this,Hi,new Gg),Rr(this,Hi).addLocalHook("init",()=>ul(this,LM,Tne).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Rr(this,Hi)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ul(e,NM,Ene).call(e,...i)}),this.addHook("afterGetCellMeta",(r,i,o)=>ul(this,xM,yne).call(this,r,i,o)),this.addHook("modifyColWidth",(r,i)=>ul(this,PM,Sne).call(this,r,i)),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ul(e,DM,Rne).call(e,...i)}),this.addHook("modifyCopyableRange",r=>ul(this,HM,bne).call(this,r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Yu(this,zi,{}),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;const o=Rr(this,Hi).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalColumn(u));H(l,u=>{o[u]=!1}),i=nn(o,(u,c,d)=>(c&&u.push(this.hot.toVisualColumn(d)),u),[])}this.hot.runHooks("beforeUnhideColumns",n,i,r&&s)!==!1&&(r&&s&&Rr(this,Hi).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,i,r&&s,r&&i.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{H(e,s=>{Rr(this,Hi).setValueAtIndex(this.hot.toPhysicalColumn(s),!0)})},!0),this.hot.runHooks("afterHideColumns",n,i,r,r&&i.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideColumns(n)}getHiddenColumns(){return Xe(Rr(this,Hi).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return Rr(this,Hi).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){H(this.hot.getCellsMeta(),e=>{e&&(e.skipColumnOnPaste=!1)})}destroy(){Yu(this,zi,null),Yu(this,Hi,null),super.destroy()}}function Sne(t,e){if(this.isHidden(e))return 0;if(Rr(this,zi).indicators&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function yne(t,e,n){if(Rr(this,zi).copyPasteEnabled===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenColumn");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function bne(t){if(Rr(this,zi).copyPasteEnabled)return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return H(t,r=>{let i=!0,o=0;xe(r.startCol,r.endCol,s=>{this.isHidden(s)?(i||n(r.startRow,r.endRow,o,s-1),i=!0):(i&&(o=s),s===r.endCol&&n(r.startRow,r.endRow,o,s),i=!1)})}),e}function Rne(t,e){if(!Rr(this,zi).indicators||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),ce(e,n)}function Ene(t){t.items.push({name:et},gne(this),mne(this))}function Tne(){Array.isArray(Rr(this,zi).columns)&&this.hideColumns(Rr(this,zi).columns)}function _ne(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(zy,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,n.row),0),i=Math.max(e.row,n.row),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideRows(o);const s=o[o.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function Mne(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(jy,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(!0),o-i+1===this.countRows()||this.selectRows(i,o)},disabled:!1,hidden(){const n=Xe(t.getHiddenRows(),d=>this.toPhysicalRow(d));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().row,o=r.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const d=o-i+1,g=l-a+1;if(d>g){const p=u.slice(i,o+1);c.push(...p.filter(C=>n.includes(C)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const d=this.countRows()-1,g=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(d,-1));l===g&&d>o&&c.push(...u.slice(o+1))}return H(c,d=>{e.push(this.toVisualRow(d))}),e.length===0}}}function cl(t,e){DD(t,e),e.add(t)}function $M(t,e,n){DD(t,e),e.set(t,n)}function DD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hl(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Vr(t,e){var n=ND(t,e,"get");return One(t,n)}function One(t,e){return e.get?e.get.call(t):e.value}function Gu(t,e,n){var r=ND(t,e,"set");return Ane(t,r,n),n}function ND(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Ane(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}_e.getSingleton().register("beforeHideRows");_e.getSingleton().register("afterHideRows");_e.getSingleton().register("beforeUnhideRows");_e.getSingleton().register("afterUnhideRows");const yw="hiddenRows",Ine=320;var Io=new WeakMap,Di=new WeakMap,kM=new WeakSet,FM=new WeakSet,WM=new WeakSet,VM=new WeakSet,BM=new WeakSet,UM=new WeakSet;class Pne extends gt{constructor(){super(...arguments),cl(this,UM),cl(this,BM),cl(this,VM),cl(this,WM),cl(this,FM),cl(this,kM),$M(this,Io,{writable:!0,value:{}}),$M(this,Di,{writable:!0,value:null})}static get PLUGIN_KEY(){return yw}static get PLUGIN_PRIORITY(){return Ine}isEnabled(){return!!this.hot.getSettings()[yw]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[yw];qe(n)&&(Gu(this,Io,n),It(n.copyPasteEnabled)&&(n.copyPasteEnabled=!0)),Gu(this,Di,new Gg),Vr(this,Di).addLocalHook("init",()=>hl(this,UM,$ne).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Vr(this,Di)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return hl(e,BM,Lne).call(e,...i)}),this.addHook("afterGetCellMeta",(r,i,o)=>hl(this,FM,Hne).call(this,r,i,o)),this.addHook("modifyRowHeight",(r,i)=>hl(this,kM,xne).call(this,r,i)),this.addHook("afterGetRowHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return hl(e,VM,Nne).call(e,...i)}),this.addHook("modifyCopyableRange",r=>hl(this,WM,Dne).call(this,r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),Gu(this,Io,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;const o=Vr(this,Di).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalRow(u));H(l,u=>{o[u]=!1}),i=nn(o,(u,c,d)=>(c&&u.push(this.hot.toVisualRow(d)),u),[])}this.hot.runHooks("beforeUnhideRows",n,i,r&&s)!==!1&&(r&&s&&Vr(this,Di).setValues(o),this.hot.runHooks("afterUnhideRows",n,i,r&&s,r&&i.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{H(e,s=>{Vr(this,Di).setValueAtIndex(this.hot.toPhysicalRow(s),!0)})},!0),this.hot.runHooks("afterHideRows",n,i,r,r&&i.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideRows(n)}getHiddenRows(){return Xe(Vr(this,Di).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return Vr(this,Di).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){H(this.hot.getCellsMeta(),e=>{e&&(e.skipRowOnPaste=!1)})}destroy(){Gu(this,Io,null),Gu(this,Di,null),super.destroy()}}function xne(t,e){return this.isHidden(e)?0:t}function Hne(t,e,n){if(Vr(this,Io).copyPasteEnabled===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenRow");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function Dne(t){if(Vr(this,Io).copyPasteEnabled)return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return H(t,r=>{let i=!0,o=0;xe(r.startRow,r.endRow,s=>{this.isHidden(s)?(i||n(o,s-1,r.startCol,r.endCol),i=!0):(i&&(o=s),s===r.endRow&&n(o,s,r.startCol,r.endCol),i=!1)})}),e}function Nne(t,e){if(!Vr(this,Io).indicators||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),ce(e,n)}function Lne(t){t.items.push({name:et},_ne(this),Mne(this))}function $ne(){Array.isArray(Vr(this,Io).rows)&&this.hideRows(Vr(this,Io).rows)}function kne(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(Sy)},callback(e,n){const[{start:{col:r}}]=n;t.freezeColumn(r),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function Fne(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(yy)},callback(e,n){const[{start:{col:r}}]=n;t.unfreezeColumn(r),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function YM(t,e){LD(t,e),e.add(t)}function Wne(t,e,n){LD(t,e),e.set(t,n)}function LD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gv(t,e){var n=$D(t,e,"get");return Vne(t,n)}function Vne(t,e){return e.get?e.get.call(t):e.value}function bw(t,e,n){var r=$D(t,e,"set");return Bne(t,r,n),n}function $D(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Bne(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function GM(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}_e.getSingleton().register("beforeColumnFreeze");_e.getSingleton().register("afterColumnFreeze");_e.getSingleton().register("beforeColumnUnfreeze");_e.getSingleton().register("afterColumnUnfreeze");const zM="manualColumnFreeze",Une=110;var ca=new WeakMap,jM=new WeakSet,KM=new WeakSet;class Yne extends gt{constructor(){super(...arguments),YM(this,KM),YM(this,jM),Wne(this,ca,{writable:!0,value:!1})}static get PLUGIN_KEY(){return zM}static get PLUGIN_PRIORITY(){return Une}isEnabled(){return!!this.hot.getSettings()[zM]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>GM(this,jM,Gne).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>GM(this,KM,zne).call(this,e,n)),super.enablePlugin())}disablePlugin(){bw(this,ca,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;gv(this,ca)||bw(this,ca,!0),this.hot.runHooks("beforeColumnFreeze",e,r)!==!1&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;gv(this,ca)||bw(this,ca,!0),this.hot.runHooks("beforeColumnUnfreeze",e,r)!==!1&&(r&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}}function Gne(t){t.items.push({name:"---------"},kne(this),Fne(this))}function zne(t,e){if(gv(this,ca)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(r=>r<n))return!1}}function Md(t,e,n){return e=jne(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jne(t){var e=Kne(t,"string");return typeof e=="symbol"?e:String(e)}function Kne(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Rw=0,qM=1,XM=2,dl="px";let qne=class{constructor(e){Md(this,"hot",void 0),Md(this,"_element",null),Md(this,"state",Rw),Md(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=XM}build(){this.state===Rw&&(this._element=this.hot.rootDocument.createElement("div"),this.state=qM)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=Rw}isAppended(){return this.state===XM}isBuilt(){return this.state>=qM}setPosition(e,n){er(e)&&(this._element.style.top=e+dl),er(n)&&(this._element.style[this.inlineProperty]=n+dl)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){er(e)&&(this._element.style.width=e+dl),er(n)&&(this._element.style.height=n+dl)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){er(e)&&(this._element.style.marginTop=e+dl),er(n)&&(this._element.style[`margin${Wn(this.inlineProperty)}`]=n+dl)}getOffset(){const e=this._element.style,n=`margin${Wn(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}};const kD=qne,Xne="ht__manualColumnMove--backlight";let Zne=class extends kD{build(){super.build(),ce(this._element,Xne)}};const Qne=Zne,Jne="ht__manualColumnMove--guideline";let ere=class extends kD{build(){super.build(),ce(this._element,Jne)}};const tre=ere;function fl(t,e){FD(t,e),e.add(t)}function ii(t,e,n){FD(t,e),e.set(t,n)}function FD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gr(t,e,n){var r=WD(t,e,"set");return nre(t,r,n),n}function nre(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Oe(t,e){var n=WD(t,e,"get");return rre(t,n)}function WD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function rre(t,e){return e.get?e.get.call(t):e.value}function gl(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}_e.getSingleton().register("beforeColumnMove");_e.getSingleton().register("afterColumnMove");const Ew="manualColumnMove",ire=120,ZM="ht__manualColumnMove",Qf="show-ui",mv="on-moving--columns",pv="after-selection--columns";var Qn=new WeakMap,cs=new WeakMap,Po=new WeakMap,df=new WeakMap,ps=new WeakMap,Zn=new WeakMap,Od=new WeakMap,kr=new WeakMap,_l=new WeakMap,Jf=new WeakMap,pc=new WeakMap,QM=new WeakSet,JM=new WeakSet,eO=new WeakSet,tO=new WeakSet,nO=new WeakSet,rO=new WeakSet;class ore extends gt{constructor(){super(...arguments),fl(this,rO),fl(this,nO),fl(this,tO),fl(this,eO),fl(this,JM),fl(this,QM),ii(this,Qn,{writable:!0,value:new Qne(this.hot)}),ii(this,cs,{writable:!0,value:new tre(this.hot)}),ii(this,Po,{writable:!0,value:[]}),ii(this,df,{writable:!0,value:0}),ii(this,ps,{writable:!0,value:!1}),ii(this,Zn,{writable:!0,value:{}}),ii(this,Od,{writable:!0,value:void 0}),ii(this,kr,{writable:!0,value:void 0}),ii(this,_l,{writable:!0,value:void 0}),ii(this,Jf,{writable:!0,value:void 0}),ii(this,pc,{writable:!0,value:void 0})}static get PLUGIN_KEY(){return Ew}static get PLUGIN_PRIORITY(){return ire}isEnabled(){return!!this.hot.getSettings()[Ew]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gl(e,QM,sre).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gl(e,eO,lre).call(e,...r)}),this.addHook("afterScrollVertically",()=>gl(this,nO,cre).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return gl(e,rO,hre).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),ce(this.hot.rootElement,ZM),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Ye(this.hot.rootElement,ZM),this.unregisterEvents(),Oe(this,Qn).destroy(),Oe(this,cs).destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const r=Oe(this,Od),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeColumnMove",e,n,r,i);if(gr(this,Od,void 0),o===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,n);const s=i&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,r,i,s),s}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const r=this.countFinalIndex(e,n);return gr(this,Od,n),this.moveColumns(e,r)}isMovePossible(e,n){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isColumnOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=nn(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getColumnsWidth(e,n){const r=this.hot.columnIndexMapper;let i=0;for(let o=e;o<=n;o+=1){const s=r.getRenderableFromVisualIndex(o);o<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:s!==null&&(i+=this.hot.view._wt.wtTable.getStretchedColumnWidth(s)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[Ew];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const r=[];return xe(e,n,i=>{r.push(i)}),r}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(Oe(this,kr))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof r.scrollX=="number"?r.scrollX:r.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,Oe(this,kr)-1);const s=n.hider.offsetWidth,a=n.TBODY.offsetLeft,l=Oe(this,Qn).getOffset().start,u=Oe(this,Qn).getSize().width;let c=0,d=0;if(this.hot.isRtl()){const C=this.hot.rootWindow,E=yt(this.hot.rootElement),I=C.innerWidth-Oe(this,_l)-E;d=C.innerWidth-Oe(this,Zn).eventPageX-I-(r.scrollX===void 0?i:0)}else d=Oe(this,Zn).eventPageX-(Oe(this,_l)-(r.scrollX===void 0?i:0));if(Oe(this,Jf)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(Oe(this,kr))&&(o+=i),o+=c,Oe(this,kr)<0)Oe(this,pc)>0?Oe(this,Zn).col=0:Oe(this,Zn).col=e>0?e-1:e;else if(Oe(this,Zn).TD.offsetWidth/2+o<=d){const C=Oe(this,kr)>=Oe(this,df)?Oe(this,df)-1:Oe(this,kr);Oe(this,Zn).col=C+1,o+=Oe(this,Zn).TD.offsetWidth}else Oe(this,Zn).col=Oe(this,kr);let g=d,p=o;d+u+l>=s?g=s-u-l:d+l<a+c&&(g=a+c+Math.abs(l)),o>=s-1?p=s-1:p===0?p=1:r.scrollX!==void 0&&Oe(this,kr)<Oe(this,pc)&&(p-=Oe(this,_l)<=r.scrollX?Oe(this,_l):0),Oe(this,Qn).setPosition(null,g),Oe(this,cs).setPosition(null,p)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>gl(this,JM,are).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>gl(this,tO,ure).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Oe(this,Qn).build(),Oe(this,cs).build()}destroy(){Oe(this,Qn).destroy(),Oe(this,cs).destroy(),super.destroy()}}function sre(t,e,n,r){const i=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),a=Ve(t.target,"sortAction");if(!s||!o||Oe(this,ps)||t.button!==0||a){gr(this,ps,!1),Oe(this,Po).length=0,Ye(this.hot.rootElement,[mv,Qf]);return}const l=Oe(this,cs).isBuilt()&&!Oe(this,cs).isAppended(),u=Oe(this,Qn).isBuilt()&&!Oe(this,Qn).isAppended();l&&u&&(Oe(this,cs).appendTo(i.hider),Oe(this,Qn).appendTo(i.hider));const{from:c,to:d}=s,g=Math.min(c.col,d.col),p=Math.max(c.col,d.col);if(e.row<0&&e.col>=g&&e.col<=p){r.column=!0,gr(this,ps,!0);const C=n.firstChild?vP(t,n.firstChild).x:t.offsetX;Oe(this,Zn).eventPageX=t.pageX,gr(this,kr,e.col),Oe(this,Zn).TD=n,Oe(this,Zn).col=e.col,gr(this,Po,this.prepareColumnsToMoving(g,p)),gr(this,Jf,!!this.hot.getSettings().rowHeaders),gr(this,df,this.hot.countCols()),gr(this,pc,this.hot.getSettings().fixedColumnsStart),gr(this,_l,ln(this.hot.rootElement).left);const E=Oe(this,Jf)?-1:0,I=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,M=e.col<Oe(this,pc),y=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),$=Math.abs(C-(this.hot.isRtl()?n.offsetWidth:0)),q=this.getColumnsWidth(g,e.col-1)+$,G=this.getColumnsWidth(E,g-1)+(M?y:0)+q;Oe(this,Qn).setPosition(I,G),Oe(this,Qn).setSize(this.getColumnsWidth(g,p),i.hider.offsetHeight-I),Oe(this,Qn).setOffset(null,-q),ce(this.hot.rootElement,mv)}else Ye(this.hot.rootElement,pv),gr(this,ps,!1),Oe(this,Po).length=0}function are(t){Oe(this,ps)&&(Oe(this,Zn).eventPageX=t.pageX,this.refreshPositions())}function lre(t,e,n,r){!this.hot.getSelectedRangeLast()||!Oe(this,ps)||(Oe(this,Po).indexOf(e.col)>-1?Ye(this.hot.rootElement,Qf):ce(this.hot.rootElement,Qf),r.row=!0,r.column=!0,r.cell=!0,gr(this,kr,e.col),Oe(this,Zn).TD=n)}function ure(){const t=Oe(this,Zn).col,e=Oe(this,Po).length;if(gr(this,kr,void 0),gr(this,ps,!1),Ye(this.hot.rootElement,[mv,Qf,pv]),this.hot.selection.isSelectedByColumnHeader()&&ce(this.hot.rootElement,pv),e<1||t===void 0)return;const n=Oe(this,Po)[0],r=this.hot.toPhysicalColumn(n),i=this.dragColumns(Oe(this,Po),t);if(Oe(this,Po).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const o=this.hot.toVisualColumn(r),s=o+e-1;this.hot.selectColumns(o,s)}}function cre(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,r=e+n;Oe(this,Qn).setPosition(r),Oe(this,Qn).setSize(null,t.hider.offsetHeight-r)}function hre(){this.moveBySettingsOrLoad()}function go(t,e){VD(t,e),e.add(t)}function Hn(t,e,n){VD(t,e),e.set(t,n)}function VD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mo(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function tn(t,e,n){var r=BD(t,e,"set");return dre(t,r,n),n}function dre(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Se(t,e){var n=BD(t,e,"get");return fre(t,n)}function BD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function fre(t,e){return e.get?e.get.call(t):e.value}const eg="manualColumnResize",gre=130,iO="manualColumnWidths";var bo=new WeakMap,Ad=new WeakMap,Sr=new WeakMap,tg=new WeakMap,Yi=new WeakMap,mre=new WeakMap,kl=new WeakMap,Id=new WeakMap,ur=new WeakMap,Co=new WeakMap,Ra=new WeakMap,ng=new WeakMap,wc=new WeakMap,Cc=new WeakMap,br=new WeakMap,vc=new WeakMap,oO=new WeakSet,sO=new WeakSet,aO=new WeakSet,lO=new WeakSet,uO=new WeakSet,cO=new WeakSet,hO=new WeakSet,dO=new WeakSet,fO=new WeakSet;class pre extends gt{static get PLUGIN_KEY(){return eg}static get PLUGIN_PRIORITY(){return gre}constructor(e){super(e),go(this,fO),go(this,dO),go(this,hO),go(this,cO),go(this,uO),go(this,lO),go(this,aO),go(this,sO),go(this,oO),Hn(this,bo,{writable:!0,value:null}),Hn(this,Ad,{writable:!0,value:null}),Hn(this,Sr,{writable:!0,value:[]}),Hn(this,tg,{writable:!0,value:null}),Hn(this,Yi,{writable:!0,value:null}),Hn(this,mre,{writable:!0,value:null}),Hn(this,kl,{writable:!0,value:null}),Hn(this,Id,{writable:!0,value:null}),Hn(this,ur,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),Hn(this,Co,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),Hn(this,Ra,{writable:!0,value:null}),Hn(this,ng,{writable:!0,value:!1}),Hn(this,wc,{writable:!0,value:0}),Hn(this,Cc,{writable:!0,value:null}),Hn(this,br,{writable:!0,value:void 0}),Hn(this,vc,{writable:!0,value:void 0}),ce(Se(this,ur),"manualColumnResizer"),ce(Se(this,Co),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[eg]}enablePlugin(){this.enabled||(tn(this,br,new Ps),Se(this,br).addLocalHook("init",()=>mo(this,oO,wre).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Se(this,br)),this.addHook("modifyColWidth",(e,n)=>mo(this,hO,Rre).call(this,e,n)),this.addHook("beforeStretchingColumnWidth",(e,n)=>mo(this,dO,Ere).call(this,e,n)),this.addHook("beforeColumnResize",(e,n,r)=>mo(this,fO,Tre).call(this,e,n,r)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){tn(this,vc,Se(this,br).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",iO,Se(this,br).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",iO,e),e.value}setManualSize(e,n){const r=Math.max(n,20),i=this.hot.toPhysicalColumn(e);return Se(this,br).setValueAtIndex(i,r),r}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);Se(this,br).setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode)return;tn(this,bo,e);const{_wt:n}=this.hot.view,r=n.wtTable.getCoords(Se(this,bo)),i=r.col;if(i<0)return;const o=Bt(Se(this,bo)),s=Se(this,bo).getBoundingClientRect(),a=i<n.getSetting("fixedColumnsStart");let l;a&&(l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(Se(this,bo),r.row,r.col)),l||(l=n.wtOverlays.topOverlay.getRelativeCellPosition(Se(this,bo),r.row,r.col)),tn(this,Ad,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),tn(this,Sr,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();H(c,d=>{const g=d.getTopStartCorner().col,p=d.getBottomEndCorner().col;xe(g,p,C=>{Se(this,Sr).includes(C)||Se(this,Sr).push(C)})})}Se(this,Sr).includes(Se(this,Ad))||tn(this,Sr,[Se(this,Ad)]),tn(this,Id,l.start-6),tn(this,kl,parseInt(s.width,10)),Se(this,ur).style.top=`${l.top}px`,Se(this,ur).style[this.inlineDir]=`${Se(this,Id)+Se(this,kl)}px`,Se(this,ur).style.height=`${o}px`,this.hot.rootElement.appendChild(Se(this,ur))}refreshHandlePosition(){Se(this,ur).style[this.inlineDir]=`${Se(this,Id)+Se(this,tg)}px`}setupGuidePosition(){const e=parseInt(Bt(Se(this,ur)),10),n=parseInt(Se(this,ur).style.top,10)+e,r=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);ce(Se(this,ur),"active"),ce(Se(this,Co),"active"),Se(this,Co).style.top=`${n}px`,this.refreshGuidePosition(),Se(this,Co).style.height=`${r-e}px`,this.hot.rootElement.appendChild(Se(this,Co))}refreshGuidePosition(){Se(this,Co).style[this.inlineDir]=Se(this,ur).style[this.inlineDir]}hideHandleAndGuide(){Ye(Se(this,ur),"active"),Ye(Se(this,Co),"active")}checkIfColumnHeader(e){return!!Es(e,["THEAD"],this.hot.rootElement)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},n=(r,i)=>{const o=this.hot.runHooks("beforeColumnResize",Se(this,Yi),r,!0);o!==void 0&&tn(this,Yi,o),this.hot.getSettings().stretchH==="all"?this.clearManualSize(r):this.setManualSize(r,Se(this,Yi)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",Se(this,Yi),r,!0),i&&e()};Se(this,wc)>=2&&(Se(this,Sr).length>1?(H(Se(this,Sr),i=>{n(i)}),e()):H(Se(this,Sr),i=>{n(i,!0)})),tn(this,wc,0),tn(this,Cc,null)}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",r=>mo(this,sO,Cre).call(this,r)),this.eventManager.addEventListener(n,"mousedown",r=>mo(this,aO,vre).call(this,r)),this.eventManager.addEventListener(e,"mousemove",r=>mo(this,lO,Sre).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>mo(this,uO,yre).call(this)),this.eventManager.addEventListener(Se(this,ur),"contextmenu",()=>mo(this,cO,bre).call(this))}destroy(){super.destroy()}}function wre(){const t=this.hot.getSettings()[eg],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,r)=>{Se(this,br).setValueAtIndex(r,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,r)=>{Se(this,br).setValueAtIndex(r,n)})},!0),tn(this,vc,t)):t===!0&&Array.isArray(Se(this,vc))&&this.hot.batchExecution(()=>{Se(this,vc).forEach((n,r)=>{Se(this,br).setValueAtIndex(r,n)})},!0)}function Cre(t){if(!gS(t.target)&&Se(this,ng)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(Se(this,Ra)||this.setupHandlePosition(e))}}function vre(t){Ve(t.target,"manualColumnResizer")&&(this.setupHandlePosition(Se(this,bo)),this.setupGuidePosition(),tn(this,Ra,!0),Se(this,Cc)===null&&(tn(this,Cc,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(Se(this,Cc))),tn(this,wc,Se(this,wc)+1),this.startX=t.pageX,tn(this,Yi,Se(this,kl)))}function Sre(t){if(Se(this,Ra)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();tn(this,tg,Se(this,kl)+e),H(Se(this,Sr),n=>{tn(this,Yi,this.setManualSize(n,Se(this,tg)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function yre(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(n,r)=>{this.hot.runHooks("beforeColumnResize",Se(this,Yi),n,!1),r&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",Se(this,Yi),n,!1)};Se(this,Ra)&&(this.hideHandleAndGuide(),tn(this,Ra,!1),Se(this,Yi)!==Se(this,kl)&&(Se(this,Sr).length>1?(H(Se(this,Sr),r=>{e(r)}),t()):H(Se(this,Sr),r=>{e(r,!0)})),this.setupHandlePosition(Se(this,bo)))}function bre(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(Se(this,ur)),this.hot.rootElement.removeChild(Se(this,Co)),tn(this,Ra,!1),tn(this,ng,!0),this.hot._registerImmediate(()=>{tn(this,ng,!1)})}function Rre(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalColumn(e),i=Se(this,br).getValueAtIndex(r);this.hot.getSettings()[eg]&&i&&(n=i)}return n}function Ere(t,e){let n=Se(this,br).getValueAtIndex(e);return n===null&&(n=t),n}function Tre(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function Tw(t,e,n){return e=_re(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _re(t){var e=Mre(t,"string");return typeof e=="symbol"?e:String(e)}function Mre(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const _w=0,gO=1,mO=2,ml="px";let Ore=class{constructor(e){Tw(this,"hot",void 0),Tw(this,"_element",null),Tw(this,"state",_w),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=mO}build(){this.state===_w&&(this._element=this.hot.rootDocument.createElement("div"),this.state=gO)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=_w}isAppended(){return this.state===mO}isBuilt(){return this.state>=gO}setPosition(e,n){e!==void 0&&(this._element.style.top=e+ml),n!==void 0&&(this._element.style.left=n+ml)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+ml),n&&(this._element.style.height=n+ml)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+ml),n&&(this._element.style.marginLeft=n+ml)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const UD=Ore,Are="ht__manualRowMove--backlight";class Ire extends UD{build(){super.build(),ce(this._element,Are)}}const Pre=Ire,xre="ht__manualRowMove--guideline";class Hre extends UD{build(){super.build(),ce(this._element,xre)}}const Dre=Hre;function pl(t,e){YD(t,e),e.add(t)}function wl(t,e,n){YD(t,e),e.set(t,n)}function YD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pa(t,e,n){var r=GD(t,e,"set");return Nre(t,r,n),n}function Nre(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function ze(t,e){var n=GD(t,e,"get");return Lre(t,n)}function GD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Lre(t,e){return e.get?e.get.call(t):e.value}function Cl(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}_e.getSingleton().register("beforeRowMove");_e.getSingleton().register("afterRowMove");const Mw="manualRowMove",$re=140,pO="ht__manualRowMove",rg="show-ui",wv="on-moving--rows",Cv="after-selection--rows";var Jn=new WeakMap,hs=new WeakMap,xo=new WeakMap,ws=new WeakMap,mr=new WeakMap,Pd=new WeakMap,wO=new WeakSet,CO=new WeakSet,vO=new WeakSet,SO=new WeakSet,yO=new WeakSet,bO=new WeakSet;class kre extends gt{constructor(){super(...arguments),pl(this,bO),pl(this,yO),pl(this,SO),pl(this,vO),pl(this,CO),pl(this,wO),wl(this,Jn,{writable:!0,value:new Pre(this.hot)}),wl(this,hs,{writable:!0,value:new Dre(this.hot)}),wl(this,xo,{writable:!0,value:[]}),wl(this,ws,{writable:!0,value:void 0}),wl(this,mr,{writable:!0,value:{}}),wl(this,Pd,{writable:!0,value:void 0})}static get PLUGIN_KEY(){return Mw}static get PLUGIN_PRIORITY(){return $re}isEnabled(){return!!this.hot.getSettings()[Mw]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Cl(e,wO,Fre).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Cl(e,vO,Vre).call(e,...r)}),this.addHook("afterScrollHorizontally",()=>Cl(this,yO,Ure).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Cl(e,bO,Yre).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),ce(this.hot.rootElement,pO),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Ye(this.hot.rootElement,pO),this.unregisterEvents(),ze(this,Jn).destroy(),ze(this,hs).destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const r=ze(this,Pd),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeRowMove",e,n,r,i);if(pa(this,Pd,void 0),o===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,n);const s=i&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,r,i,s),s}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const r=this.countFinalIndex(e,n);return pa(this,Pd,n),this.moveRows(e,r)}isMovePossible(e,n){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=nn(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getRowsHeight(e,n){const r=this.hot.rowIndexMapper;let i=0;for(let o=e;o<=n;o++){const s=r.getRenderableFromVisualIndex(o);s!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(s)||23)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[Mw];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),n=[];if(!e)return n;const{from:r,to:i}=e,o=Math.min(r.row,i.row),s=Math.max(r.row,i.row);return xe(o,s,a=>{n.push(a)}),n}refreshPositions(){const e=ze(this,mr).coords,n=this.hot.view.getFirstFullyVisibleRow(),r=this.hot.view.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&r<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,s=ze(this,mr).TD,a=this.hot.rootElement,l=ln(a),u=va(a),c=o.holder.scrollTop,d=this.hot.rootWindow!==u?u.scrollTop:0,g=l.top-d,p=ze(this,mr).eventPageY-g+c,C=o.hider.offsetHeight,E=o.TBODY.offsetTop,I=ze(this,Jn).getOffset().top,M=ze(this,Jn).getSize().height,y=s.offsetHeight/2,$=s.offsetHeight;let q=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const G=p>=q+y;this.isFixedRowTop(e.row)&&(q+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?ze(this,mr).row=n>0?n-1:n:G?(ze(this,mr).row=e.row+1,q+=e.row===0?$-1:$):ze(this,mr).row=e.row;let X=p,re=q;p+M+I>=C?X=C-M-I:p+I<E&&(X=E+Math.abs(I)),q>=C-1&&(re=C-1),ze(this,Jn).setPosition(X),ze(this,hs).setPosition(re)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Cl(this,CO,Wre).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Cl(this,SO,Bre).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){ze(this,Jn).build(),ze(this,hs).build()}destroy(){ze(this,Jn).destroy(),ze(this,hs).destroy(),super.destroy()}}function Fre(t,e,n,r){const{wtTable:i,wtViewport:o}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!s||ze(this,ws)||t.button!==0){pa(this,ws,!1),ze(this,xo).length=0,Ye(this.hot.rootElement,[wv,rg]);return}const l=ze(this,hs).isBuilt()&&!ze(this,hs).isAppended(),u=ze(this,Jn).isBuilt()&&!ze(this,Jn).isAppended();l&&u&&(ze(this,hs).appendTo(i.hider),ze(this,Jn).appendTo(i.hider));const{from:c,to:d}=a,g=Math.min(c.row,d.row),p=Math.max(c.row,d.row);if(e.col<0&&e.row>=g&&e.row<=p){r.row=!0,pa(this,ws,!0),ze(this,mr).eventPageY=t.pageY,ze(this,mr).coords=e,ze(this,mr).TD=n,pa(this,xo,this.prepareRowsToMoving());const C=i.holder.scrollLeft+o.getRowHeaderWidth(),E=this.getRowsHeight(g,e.row-1)+t.offsetY;ze(this,Jn).setPosition(null,C),ze(this,Jn).setSize(i.hider.offsetWidth-C,this.getRowsHeight(g,p)),ze(this,Jn).setOffset(-E,null),ce(this.hot.rootElement,wv),this.refreshPositions()}else Ye(this.hot.rootElement,Cv),pa(this,ws,!1),ze(this,xo).length=0}function Wre(t){ze(this,ws)&&(ze(this,mr).eventPageY=t.pageY,this.refreshPositions())}function Vre(t,e,n,r){!this.hot.getSelectedRangeLast()||!ze(this,ws)||(ze(this,xo).indexOf(e.row)>-1?Ye(this.hot.rootElement,rg):ce(this.hot.rootElement,rg),r.row=!0,r.column=!0,r.cell=!0,ze(this,mr).coords=e,ze(this,mr).TD=n)}function Bre(){const t=ze(this,mr).row,e=ze(this,xo).length;if(pa(this,ws,!1),Ye(this.hot.rootElement,[wv,rg,Cv]),this.hot.selection.isSelectedByRowHeader()&&ce(this.hot.rootElement,Cv),e<1||t===void 0)return;const n=ze(this,xo)[0],r=this.hot.toPhysicalRow(n),i=this.dragRows(ze(this,xo),t);if(ze(this,xo).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const o=this.hot.toVisualRow(r),s=o+e-1;this.hot.selectRows(o,s)}}function Ure(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,r=e+n;ze(this,Jn).setPosition(null,r),ze(this,Jn).setSize(t.hider.offsetWidth-r)}function Yre(){this.moveBySettingsOrLoad()}function ra(t,e){zD(t,e),e.add(t)}function Dn(t,e,n){zD(t,e),e.set(t,n)}function zD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ia(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Kt(t,e,n){var r=jD(t,e,"set");return Gre(t,r,n),n}function Gre(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function ve(t,e){var n=jD(t,e,"get");return zre(t,n)}function jD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function zre(t,e){return e.get?e.get.call(t):e.value}const ig="manualRowResize",jre=30,RO="manualRowHeights";var Fi=new WeakMap,xd=new WeakMap,yr=new WeakMap,og=new WeakMap,ds=new WeakMap,nR=new WeakMap,Fl=new WeakMap,Hd=new WeakMap,qn=new WeakMap,Li=new WeakMap,Ea=new WeakMap,sg=new WeakMap,Sc=new WeakMap,yc=new WeakMap,hi=new WeakMap,bc=new WeakMap,EO=new WeakSet,TO=new WeakSet,_O=new WeakSet,MO=new WeakSet,OO=new WeakSet,AO=new WeakSet,IO=new WeakSet;class Kre extends gt{static get PLUGIN_KEY(){return ig}static get PLUGIN_PRIORITY(){return jre}constructor(e){super(e),ra(this,IO),ra(this,AO),ra(this,OO),ra(this,MO),ra(this,_O),ra(this,TO),ra(this,EO),Dn(this,Fi,{writable:!0,value:null}),Dn(this,xd,{writable:!0,value:null}),Dn(this,yr,{writable:!0,value:[]}),Dn(this,og,{writable:!0,value:null}),Dn(this,ds,{writable:!0,value:null}),Dn(this,nR,{writable:!0,value:null}),Dn(this,Fl,{writable:!0,value:null}),Dn(this,Hd,{writable:!0,value:null}),Dn(this,qn,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),Dn(this,Li,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),Dn(this,Ea,{writable:!0,value:!1}),Dn(this,sg,{writable:!0,value:!1}),Dn(this,Sc,{writable:!0,value:0}),Dn(this,yc,{writable:!0,value:null}),Dn(this,hi,{writable:!0,value:void 0}),Dn(this,bc,{writable:!0,value:void 0}),ce(ve(this,qn),"manualRowResizer"),ce(ve(this,Li),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[ig]}enablePlugin(){this.enabled||(Kt(this,hi,new Ps),ve(this,hi).addLocalHook("init",()=>ia(this,IO,tie).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,ve(this,hi)),this.addHook("modifyRowHeight",(e,n)=>ia(this,AO,eie).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Kt(this,bc,ve(this,hi).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",RO,ve(this,hi).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",RO,e),e.value}setManualSize(e,n){const r=this.hot.toPhysicalRow(e),i=Math.max(n,FP.DEFAULT_HEIGHT);return ve(this,hi).setValueAtIndex(r,i),i}setupHandlePosition(e){Kt(this,Fi,e);const{view:n}=this.hot,{_wt:r}=n,i=r.wtTable.getCoords(ve(this,Fi)),o=i.row;if(o<0)return;const s=yt(ve(this,Fi)),a=ve(this,Fi).getBoundingClientRect(),l=o<r.getSetting("fixedRowsTop"),u=o>=n.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let c;l?c=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(ve(this,Fi),i.row,i.col):u&&(c=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(ve(this,Fi),i.row,i.col)),c||(c=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(ve(this,Fi),i.row,i.col)),Kt(this,xd,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),Kt(this,yr,[]);const d=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&d){const g=this.hot.getSelectedRange();H(g,p=>{const C=p.getTopStartCorner().row,E=p.getBottomStartCorner().row;xe(C,E,I=>{ve(this,yr).includes(I)||ve(this,yr).push(I)})})}ve(this,yr).includes(ve(this,xd))||Kt(this,yr,[ve(this,xd)]),Kt(this,Hd,c.top-6),Kt(this,Fl,parseInt(a.height,10)),ve(this,qn).style.top=`${ve(this,Hd)+ve(this,Fl)}px`,ve(this,qn).style[this.inlineDir]=`${c.start}px`,ve(this,qn).style.width=`${s}px`,this.hot.rootElement.appendChild(ve(this,qn))}refreshHandlePosition(){ve(this,qn).style.top=`${ve(this,Hd)+ve(this,og)}px`}setupGuidePosition(){const e=parseInt(yt(ve(this,qn)),10),n=parseInt(ve(this,qn).style[this.inlineDir],10)+e,r=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);ce(ve(this,qn),"active"),ce(ve(this,Li),"active"),ve(this,Li).style.top=ve(this,qn).style.top,ve(this,Li).style[this.inlineDir]=`${n}px`,ve(this,Li).style.width=`${r-e}px`,this.hot.rootElement.appendChild(ve(this,Li))}refreshGuidePosition(){ve(this,Li).style.top=ve(this,qn).style.top}hideHandleAndGuide(){Ye(ve(this,qn),"active"),Ye(ve(this,Li),"active")}checkIfRowHeader(e){var n;return Es(e,["TH"],this.hot.rootElement)&&((n=e.parentNode)===null||n===void 0||(n=n.parentNode)===null||n===void 0?void 0:n.tagName)==="TBODY"}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&ve(this,ds)<n?n:ve(this,ds)}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},n=(r,i)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);o!==void 0&&Kt(this,ds,o),this.setManualSize(r,ve(this,ds)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),i&&e()};ve(this,Sc)>=2&&(ve(this,yr).length>1?(H(ve(this,yr),i=>{n(i)}),e()):H(ve(this,yr),i=>{n(i,!0)})),Kt(this,Sc,0),Kt(this,yc,null)}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>ia(this,EO,qre).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>ia(this,TO,Xre).call(this,r)),this.eventManager.addEventListener(n,"mousemove",r=>ia(this,_O,Zre).call(this,r)),this.eventManager.addEventListener(n,"mouseup",()=>ia(this,MO,Qre).call(this)),this.eventManager.addEventListener(ve(this,qn),"contextmenu",()=>ia(this,OO,Jre).call(this))}destroy(){super.destroy()}}function qre(t){if(!gS(t.target)&&ve(this,sg)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(ve(this,Ea)||this.setupHandlePosition(e))}}function Xre(t){Ve(t.target,"manualRowResizer")&&(this.setupHandlePosition(ve(this,Fi)),this.setupGuidePosition(),Kt(this,Ea,!0),ve(this,yc)===null&&(Kt(this,yc,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(ve(this,yc))),Kt(this,Sc,ve(this,Sc)+1),Kt(this,nR,t.pageY),Kt(this,ds,ve(this,Fl)))}function Zre(t){ve(this,Ea)&&(Kt(this,og,ve(this,Fl)+(t.pageY-ve(this,nR))),H(ve(this,yr),e=>{Kt(this,ds,this.setManualSize(e,ve(this,og)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function Qre(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(n,r)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),r&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};ve(this,Ea)&&(this.hideHandleAndGuide(),Kt(this,Ea,!1),ve(this,ds)!==ve(this,Fl)&&(ve(this,yr).length>1?(H(ve(this,yr),r=>{e(r)}),t()):H(ve(this,yr),r=>{e(r,!0)})),this.setupHandlePosition(ve(this,Fi)))}function Jre(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(ve(this,qn)),this.hot.rootElement.removeChild(ve(this,Li)),Kt(this,Ea,!1),Kt(this,sg,!0),this.hot._registerImmediate(()=>{Kt(this,sg,!1)})}function eie(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalRow(e),i=ve(this,hi).getValueAtIndex(r);this.hot.getSettings()[ig]&&i&&(n=i)}return n}function tie(){const t=this.hot.getSettings()[ig],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,r)=>{ve(this,hi).setValueAtIndex(r,n)}):Array.isArray(t)?(t.forEach((n,r)=>{ve(this,hi).setValueAtIndex(r,n)}),Kt(this,bc,t)):t===!0&&Array.isArray(ve(this,bc))&&ve(this,bc).forEach((n,r)=>{ve(this,hi).setValueAtIndex(r,n)})},!0)}function oa(t,e,n){return e=nie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nie(t){var e=rie(t,"string");return typeof e=="symbol"?e:String(e)}function rie(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class iie{constructor(e,n,r,i,o,s){oa(this,"row",void 0),oa(this,"col",void 0),oa(this,"rowspan",void 0),oa(this,"colspan",void 0),oa(this,"removed",!1),oa(this,"cellCoordsFactory",void 0),oa(this,"cellRangeFactory",void 0),this.row=e,this.col=n,this.rowspan=r,this.colspan=i,this.cellCoordsFactory=o,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(e){return bt`The merged cell declared with {row: ${e.row}, col: ${e.col},\x20
      rowspan: ${e.rowspan}, colspan: ${e.colspan}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){return bt`The merged cell declared at [${e.row}, ${e.col}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){return bt`The merged cell declared at [${e.row}, ${e.col}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){return bt`The merged cell declared at [${e.row}, ${e.col}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){return e.row<0||e.col<0||e.rowspan<0||e.colspan<0}static isSingleCell(e){return e.colspan===1&&e.rowspan===1}static containsZeroSpan(e){return e.colspan===0||e.rowspan===0}static isOutOfBounds(e,n,r){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=r||e.col+e.colspan-1>=r}normalize(e){const n=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const r=e[0]||e[1],i=n+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",s=e[0]?"col":"row",a=Math.min(n,i),l=Math.max(n,i),u=this[s],c=this[s]+this[o]-1;if(u>=n&&(this[s]+=r),r>0)n<=c&&n>u&&(this[o]+=r);else if(r<0){if(a<=u&&l>=c)return this.removed=!0,!1;if(u>=a&&u<=l){const d=l-u+1,g=Math.abs(r)-d;this[s]-=g+r,this[o]-=d}else if(u<=a&&c>=l)this[o]+=r;else if(u<=a&&c>=a&&c<l){const d=c-a+1;this[o]-=d}}return!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}const Wi=iie;function vv(t,e,n,r){e?e.row===n&&e.col===r?(t.setAttribute("rowspan",e.rowspan.toString()),t.setAttribute("colspan",e.colspan.toString())):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="none"):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="")}function Ow(t,e,n){return e=oie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oie(t){var e=sie(t,"string");return typeof e=="symbol"?e:String(e)}function sie(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rR{constructor(e){Ow(this,"plugin",void 0),Ow(this,"mergedCells",[]),Ow(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){return bt`The merged cell declared at [${e.row}, ${e.col}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){const r=this.mergedCells;let i=!1;return H(r,o=>o.row<=e&&o.row+o.rowspan-1>=e&&o.col<=n&&o.col+o.colspan-1>=n?(i=o,!1):!0),i}getByRange(e){const n=this.mergedCells;let r=!1;return H(n,i=>i.row<=e.from.row&&i.row+i.rowspan-1>=e.to.row&&i.col<=e.from.col&&i.col+i.colspan-1>=e.to.col?(r=i,r):!0),r}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCells,i=[];let o=e;if(!o.includesRange){const s=this.hot._createCellCoords(o.from.row,o.from.col),a=this.hot._createCellCoords(o.to.row,o.to.col);o=this.hot._createCellRange(s,s,a)}return H(r,s=>{const a=this.hot._createCellCoords(s.row,s.col),l=this.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1),u=this.hot._createCellRange(a,a,l);n?o.overlaps(u)&&i.push(s):o.includesRange(u)&&i.push(s)}),i.length?i:!1}add(e){const n=this.mergedCells,r=e.row,i=e.col,o=e.rowspan,s=e.colspan,a=new Wi(r,i,o,s,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(r,i),u=this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),n.push(a),a):(Pt(rR.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,n){const r=this.mergedCells,i=this.get(e,n),o=i?this.mergedCells.indexOf(i):-1;return i&&o!==-1?(r.splice(o,1),i):!1}clear(){const e=this.mergedCells,n=[],r=[];H(e,i=>{const o=this.hot.getCell(i.row,i.col);o&&n.push([o,this.get(i.row,i.col),i.row,i.col])}),this.mergedCells.length=0,H(n,(i,o)=>{xe(0,i.rowspan-1,s=>{xe(0,i.colspan-1,a=>{if(a!==0||s!==0){const l=this.hot.getCell(i.row+s,i.col+a);l&&r.push([l,null,null,null])}})}),n[o][1]=null}),H(n,i=>{vv(...i)}),H(r,i=>{vv(...i)})}isOverlapping(e){const n=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(e.row,e.col),this.hot._createCellCoords(e.row+e.rowspan-1,e.col+e.colspan-1));let r=!1;return H(this.mergedCells,i=>this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(i.row,i.col),this.hot._createCellCoords(i.row+i.rowspan-1,i.col+i.colspan-1)).overlaps(n)?(r=!0,!1):!0),r}isFirstRenderableMergedCell(e,n){const r=this.get(e,n);return r&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1)===n}getFirstRenderableCoords(e,n){const r=this.get(e,n);if(!r||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(i,o)}shiftCollections(e,n,r){const i=[0,0];switch(e){case"right":i[0]+=r;break;case"left":i[0]-=r;break;case"down":i[1]+=r;break;case"up":i[1]-=r;break}H(this.mergedCells,o=>{o.shift(i,n)}),Df(this.mergedCells.length-1,0,o=>{const s=this.mergedCells[o];s&&s.removed&&this.mergedCells.splice(this.mergedCells.indexOf(s),1)})}}const aie=rR;function Aw(t,e,n){return e=lie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lie(t){var e=uie(t,"string");return typeof e=="symbol"?e:String(e)}function uie(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cie{constructor(e){Aw(this,"plugin",void 0),Aw(this,"mergedCellsCollection",void 0),Aw(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(e){if(e[0]===e[2]&&e[1]===e[3]){const n=this.mergedCellsCollection.get(e[0],e[1]);n&&(e[2]=e[0]+n.rowspan-1,e[3]=e[1]+n.colspan-1)}}getDirection(e,n){let r=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?r="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?r="up":n[1]===e[1]&&n[2]===e[2]?r="right":r="left",r}snapDragArea(e,n,r,i){const o=n.slice(0),s=this.getAutofillSize(e,n,r),[a,l,u,c]=e,g=["up","down"].indexOf(r)>-1?u-a+1:c-l+1,p=Math.floor(s/g)*g,C=s-p,E=this.getFarthestCollection(e,n,r,i);if(E){if(r==="down"){const I=E.row+E.rowspan-a-C;o[2]+I>=this.plugin.hot.countRows()?o[2]-=C:o[2]+=C?I:0}else if(r==="right"){const I=E.col+E.colspan-l-C;o[3]+I>=this.plugin.hot.countCols()?o[3]-=C:o[3]+=C?I:0}else if(r==="up"){const I=u-C-E.row+1;o[0]+I<0?o[0]+=C:o[0]-=C?I:0}else if(r==="left"){const I=c-C-E.col+1;o[1]+I<0?o[1]+=C:o[1]-=C?I:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:i,fillSize:s,dragArea:o,cycleLength:g}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),un(this.currentFillData,e)}getAutofillSize(e,n,r){const[i,o,s,a]=e,[l,u,c,d]=n;switch(r){case"up":return i-l;case"down":return c-s;case"left":return o-u;case"right":return d-a;default:return null}}getDragArea(e,n,r){const[i,o,s,a]=e,[l,u,c,d]=n;switch(r){case"up":return[l,u,i-1,a];case"down":return[s+1,o,c,a];case"left":return[l,u,s,o-1];case"right":return[i,a+1,c,d];default:return null}}getFarthestCollection(e,n,r,i){const[o,s,a,l]=e,u=["up","down"].indexOf(r)>-1,c=u?a:l,d=u?o:s,g=this.getAutofillSize(e,n,r),p=u?a-o+1:l-s+1,C=Math.floor(g/p)*p,E=g-C;let I=null,M=null,y=null;switch(r){case"up":I="includesVertically",y=c-E+1;break;case"left":I="includesHorizontally",y=c-E+1;break;case"down":I="includesVertically",y=d+E-1;break;case"right":I="includesHorizontally",y=d+E-1;break}return H(i,$=>{$[I](y)&&$.isFarther(M,r)&&(M=$)}),M}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,o=(u,c)=>{switch(i){case"up":return u.row-c>=n.from.row;case"down":return u.row+u.rowspan-1+c<=n.to.row;case"left":return u.col-c>=n.from.column;case"right":return u.col+u.colspan-1+c<=n.to.column;default:return null}};let s=0,a=null,l=1;do for(let u=0;u<r.length;u+=1){if(a=r[u],s=l*this.currentFillData.cycleLength,o(a,s))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-s,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+s,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-s,colspan:a.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+s,colspan:a.colspan});break}u===r.length-1&&(l+=1)}while(o(a,s));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},r={min:null,max:null};return H(e,i=>{const o=i[0],s=this.plugin.hot.propToCol(i[1]);(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o),(r.min===null||s<r.min)&&(r.min=s),(r.max===null||s>r.max)&&(r.max=s)}),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}dragAreaOverlapsCollections(e,n,r){const i=this.getDragArea(e,n,r),[o,s,a,l]=i,u=this.plugin.hot._createCellCoords(o,s),c=this.plugin.hot._createCellCoords(a,l),d=this.plugin.hot._createCellRange(u,u,c);return!!this.mergedCellsCollection.getWithinRange(d,!0)}}const hie=cie;function Iw(t,e,n){return e=die(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function die(t){var e=fie(t,"string");return typeof e=="symbol"?e:String(e)}function fie(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gie{constructor(e){Iw(this,"plugin",void 0),Iw(this,"hot",void 0),Iw(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}snapDelta(e,n,r){const i=n.to,o=i.row+e.row,s=i.col+e.col;e.row?this.jumpOverMergedCell(e,r,o):e.col&&this.jumpOverMergedCell(e,r,s)}jumpOverMergedCell(e,n,r){let i=e.row||e.col,o=null,s=null,a=null;e.row?(o=n.includesVertically(r),s=n.row,a=n.getLastRow()):e.col&&(o=n.includesHorizontally(r),s=n.col,a=n.getLastColumn()),i!==0&&(i>0?o&&r!==s&&(i+=a-r+1):o&&r!==a&&(i-=r-s+1),e.row?e.row=i:e.col&&(e.col=i))}getUpdatedSelectionRange(e,n){return this.hot._createCellRange(e.highlight,e.from,this.hot._createCellCoords(e.to.row+n.row,e.to.col+n.col))}getSelectedMergedCellClassName(e,n,r,i){const o=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const c=this.plugin.mergedCellsCollection.get(e,n);if(!c)return;const d=c.getLastRow(),g=c.getLastColumn();if(o<=c.row&&s<=c.col&&a>=d&&l>=g)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.plugin.selectionCalculations.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const r=[];if(!n||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let o=0;o<e.colspan;o+=1)r.push(this.hot._createCellCoords(e.row+i,e.col+o));for(let i=0;i<r.length;i+=1){const o=[];for(let s=0;s<n.length;s+=1)o[s]=n[s].includes(r[i]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}const mie=gie;function pie(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(Ry)}return this.getTranslatedPhrase(by)},callback(){t.toggleMergeOnSelection()},disabled(){const e=this.getSelectedLast();return e?Wi.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function en(t,e){KD(t,e),e.add(t)}function wie(t,e,n){KD(t,e),e.set(t,n)}function KD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pw(t,e,n){return e=Cie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cie(t){var e=vie(t,"string");return typeof e=="symbol"?e:String(e)}function vie(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xw(t,e,n){var r=qD(t,e,"set");return Sie(t,r,n),n}function Sie(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function vl(t,e){var n=qD(t,e,"get");return yie(t,n)}function qD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function yie(t,e){return e.get?e.get.call(t):e.value}function Yt(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}_e.getSingleton().register("beforeMergeCells");_e.getSingleton().register("afterMergeCells");_e.getSingleton().register("beforeUnmergeCells");_e.getSingleton().register("afterUnmergeCells");const Rc="mergeCells",bie=150,PO=Rc;var $i=new WeakMap,xO=new WeakSet,HO=new WeakSet,DO=new WeakSet,NO=new WeakSet,LO=new WeakSet,$O=new WeakSet,kO=new WeakSet,Hw=new WeakSet,FO=new WeakSet,WO=new WeakSet,VO=new WeakSet,BO=new WeakSet,UO=new WeakSet,YO=new WeakSet,GO=new WeakSet,zO=new WeakSet,jO=new WeakSet,KO=new WeakSet,qO=new WeakSet,XO=new WeakSet,ZO=new WeakSet,QO=new WeakSet;class Rie extends gt{constructor(){super(...arguments),en(this,QO),en(this,ZO),en(this,XO),en(this,qO),en(this,KO),en(this,jO),en(this,zO),en(this,GO),en(this,YO),en(this,UO),en(this,BO),en(this,VO),en(this,WO),en(this,FO),en(this,Hw),en(this,kO),en(this,$O),en(this,LO),en(this,NO),en(this,DO),en(this,HO),en(this,xO),Pw(this,"mergedCellsCollection",null),Pw(this,"autofillCalculations",null),Pw(this,"selectionCalculations",null),wie(this,$i,{writable:!0,value:null})}static get PLUGIN_KEY(){return Rc}static get PLUGIN_PRIORITY(){return bie}isEnabled(){return!!this.hot.getSettings()[Rc]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new aie(this),this.autofillCalculations=new hie(this),this.selectionCalculations=new mie(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Yt(e,xO,Eie).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Yt(e,DO,_ie).call(e,...r)}),this.addHook("afterModifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Yt(e,XO,Bie).call(e,...r)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Yt(e,NO,Mie).call(e,...r)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Yt(e,LO,Oie).call(e,...r)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Yt(e,Hw,JO).call(e,...r)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Yt(e,Hw,JO).call(e,...r)}),this.addHook("beforeSetRangeEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Yt(e,FO,Pie).call(e,...r)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Yt(e,HO,Tie).call(e,...r)}),this.addHook("afterRenderer",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Yt(e,kO,Iie).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Yt(e,$O,Aie).call(e,...r)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Yt(e,WO,xie).call(e,...r)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Yt(e,VO,Hie).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Yt(e,BO,Die).call(e,...r)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Yt(e,UO,Nie).call(e,...r)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Yt(e,YO,Lie).call(e,...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Yt(e,GO,$ie).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Yt(e,zO,kie).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Yt(e,jO,Fie).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Yt(e,KO,Wie).call(e,...r)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Yt(e,qO,Vie).call(e,...r)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Yt(e,ZO,Uie).call(e,...r)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Yt(e,QO,Yie).call(e,...r)}),this.addHook("beforeUndoStackChange",(n,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){const e=this.hot.getSettings()[Rc];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),super.updatePlugin()}ifChromeForceRepaint(){if(!CS())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(r=>{const{row:i,rowspan:o}=r;for(let s=i+1;s<i+o;s++)n.push(s)}),n=[...new Set(n)],n.forEach(r=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>(o==null?void 0:o.name)==="master"?o:o.clone.wtTable).forEach(o=>{const s=o.getRow(i);s&&(s.style.background=Wl(s,"backgroundColor").replace(")",", 0.99)"),e.push(s))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{r.style.background=Wl(r,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){let n=!0;return e?(Wi.containsNegativeValues(e)?(Pt(Wi.NEGATIVE_VALUES_WARNING(e)),n=!1):Wi.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(Pt(Wi.IS_OUT_OF_BOUNDS_WARNING(e)),n=!1):Wi.isSingleCell(e)?(Pt(Wi.IS_SINGLE_CELL(e)),n=!1):Wi.containsZeroSpan(e)&&(Pt(Wi.ZERO_SPAN_WARNING(e)),n=!1),n):!1}generateFromSettings(e){if(Array.isArray(e)){const n=[];if(H(e,r=>{if(!this.validateSetting(r))return;const i=this.hot._createCellCoords(r.row,r.col),o=this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1),s=this.hot._createCellRange(i,i,o);this.mergeRange(s,!0,!0),xe(r.row,r.row+r.rowspan-1,a=>{xe(r.col,r.col+r.colspan-1,l=>{a===r.row&&l===r.col||n.push([a,l,null])})})}),n.length===0)return;this.hot.setDataAtCell(n)}}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}toggleMergeOnSelection(){const e=this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.toggleMerge(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:n,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),o=e.getBottomEndCorner(),s={row:i.row,col:i.col,rowspan:o.row-i.row+1,colspan:o.col-i.col+1},a=[];let l=null;return this.canMergeRange(s,n)?(this.hot.runHooks("beforeMergeCells",e,n),xe(0,s.rowspan-1,c=>{xe(0,s.colspan-1,d=>{let g=null;a[c]||(a[c]=[]),c===0&&d===0?g=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+c,s.col+d,"hidden",!0),a[c][d]=g})}),this.hot.setCellMeta(s.row,s.col,"spanned",!0),this.mergedCellsCollection.add(s)?(r?l=[s.row,s.col,a]:this.hot.populateFromArray(s.row,s.col,a,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,s,n),l):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCellsCollection.getWithinRange(e);r&&(this.hot.runHooks("beforeUnmergeCells",e,n),H(r,i=>{this.mergedCellsCollection.remove(i.row,i.col),xe(0,i.rowspan-1,o=>{xe(0,i.colspan-1,s=>{this.hot.removeCellMeta(i.row+o,i.col+s,"hidden"),this.hot.removeCellMeta(i.row+o,i.col+s,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const n=this.mergedCellsCollection.get(e.from.row,e.from.col);n.row===e.from.row&&n.col===e.from.col&&n.row+n.rowspan-1===e.to.row&&n.col+n.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.mergeRange(this.hot._createCellRange(o,o,s))}unmerge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.unmergeRange(this.hot._createCellRange(o,o,s))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const r=this.hot.getSelectedRangeLast();r&&!r.isSingleHeader()&&(this.toggleMerge(r),this.hot.render())},runOnlyIf:r=>!r.altKey,group:PO})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(PO)}modifyViewportRowStart(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(qe(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(qe(s)){const a=s.row+s.rowspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(qe(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(qe(s)){const a=s.col+s.colspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,r,i){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot;let a,l;n===0?a=o.getNearestNotHiddenIndex(e,1):a=o.getNearestNotHiddenIndex(e+n-1,-1),i===0?l=s.getNearestNotHiddenIndex(r,1):l=s.getNearestNotHiddenIndex(r+i-1,-1);const u=e>=0?o.getRenderableFromVisualIndex(a):e,c=r>=0?s.getRenderableFromVisualIndex(l):r;return[u,c]}}function Eie(){this.generateFromSettings(this.hot.getSettings()[Rc]),this.hot.render()}function Tie(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast();for(let r=0;r<e.length;r+=1)if(n.from.row===e[r].row&&n.from.col===e[r].col&&n.to.row===e[r].row+e[r].rowspan-1&&n.to.col===e[r].col+e[r].colspan-1)return!1}return t}function _ie(t){const e=this.hot.getSelectedRangeLast();let n={row:t.row,col:t.col},r=null;const i=this.hot._createCellCoords(e.highlight.row,e.highlight.col),o=this.mergedCellsCollection.get(i.row,i.col);if(vl(this,$i)||xw(this,$i,this.hot._createCellCoords(null,null)),o){const a=this.hot._createCellCoords(o.row,o.col),l=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);this.hot._createCellRange(a,a,l).includes(vl(this,$i))||xw(this,$i,this.hot._createCellCoords(null,null)),n.row=vl(this,$i).row?vl(this,$i).row-i.row:n.row,n.col=vl(this,$i).col?vl(this,$i).col-i.col:n.col,t.row>0?n.row=o.row+o.rowspan-1-i.row+t.row:t.row<0&&(n.row=i.row-o.row+t.row),t.col>0?n.col=o.col+o.colspan-1-i.col+t.col:t.col<0&&(n.col=i.col-o.col+t.col)}r=this.hot._createCellCoords(e.highlight.row+n.row,e.highlight.col+n.col);const s=this.mergedCellsCollection.get(r.row,r.col);if(s){const a=this.mergedCellsCollection.getFirstRenderableCoords(s.row,s.col);xw(this,$i,r),n={row:a.row-i.row,col:a.col-i.col}}n.row!==0&&(t.row=n.row),n.col!==0&&(t.col=n.col)}function Mie(t){const e=this.hot.getSelectedRangeLast(),n=tr(t),r=this.selectionCalculations.getUpdatedSelectionRange(e,t);let i=tr(n);const o=this.mergedCellsCollection.getWithinRange(r,!0);do i=tr(n),this.selectionCalculations.getUpdatedSelectionRange(e,n),H(o,s=>{this.selectionCalculations.snapDelta(n,e,s)});while(n.row!==i.row||n.col!==i.col);t.row=n.row,t.col=n.col}function Oie(t,e){if(t<0||e<0)return;const n=this.mergedCellsCollection.get(t,e);if(!n)return;const{row:r,col:i,colspan:o,rowspan:s}=n;return[r,i,r+s-1,i+o-1]}function Aie(t){t.items.push({name:"---------"},pie(this))}function Iie(t,e,n){const r=this.mergedCellsCollection.get(e,n),i=qe(r)?tr(r):void 0;if(qe(i)){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot,{row:a,col:l,colspan:u,rowspan:c}=i,[d,g]=this.translateMergedCellToRenderable(a,c,l,u),p=o.getRenderableFromVisualIndex(e),C=s.getRenderableFromVisualIndex(n),E=d-p+1,I=g-C+1;i.row=o.getNearestNotHiddenIndex(i.row,1),i.col=s.getNearestNotHiddenIndex(i.col,1),i.rowspan=Math.min(i.rowspan,E),i.colspan=Math.min(i.colspan,I)}vv(t,i,e,n)}function JO(t){if(this.mergedCellsCollection.isFirstRenderableMergedCell(t.row,t.col)){const e=this.mergedCellsCollection.get(t.row,t.col);[t.row,t.col]=[e.row,e.col]}}function Pie(t){const e=this.hot.getSelectedRangeLast();e.highlight=this.hot._createCellCoords(e.highlight.row,e.highlight.col),e.to=t;let n=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{n=!1;for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1){const o=this.mergedCellsCollection.mergedCells[r].getRange();e.expandByRange(o)&&(t.row=e.to.row,t.col=e.to.col,n=!0)}}while(n)}function xie(t,e,n){const r=this.mergedCellsCollection.get(t,e);r&&(r.row!==t||r.col!==e?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}function Hie(t){const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function Die(t){const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function Nie(t,e){this.autofillCalculations.correctSelectionAreaSize(e);const n=this.autofillCalculations.getDirection(e,t);let r=t;if(this.autofillCalculations.dragAreaOverlapsCollections(e,r,n))return r=e,r;const i=this.mergedCellsCollection.getWithinRange({from:{row:e[0],col:e[1]},to:{row:e[2],col:e[3]}});return i&&(r=this.autofillCalculations.snapDragArea(e,r,n,i)),r}function Lie(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function $ie(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function kie(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function Fie(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function Wie(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function Vie(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(n);H(r,i=>{n.getBottomEndCorner().row===i.getLastRow()&&n.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function Bie(t,e,n){if(!this.enabled)return;const r=this.mergedCellsCollection.get(t.row,t.col);if(!r)return;const i=e>0,o=e<0,s=n<0,a=n>0,l=r.row+r.rowspan-1===this.hot.countRows()-1,u=r.row===0,c=r.col+r.colspan-1===this.hot.countCols()-1,d=r.col===0;(i&&l||o&&u||a&&c||s&&d)&&(t.row=r.row,t.col=r.col)}function Uie(t,e,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,r)}function Yie(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function Gie(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function s(a){const l=t[a],u=e[a],c=i[a],d=o[a],g=u.multiColumnSorting,C=(g.compareFunctionFactory?g.compareFunctionFactory:bH(u.type))(l,u,g)(c,d);if(C===ji){const E=a+1;if(typeof e[E]<"u")return s(E)}return C}(0)}}function eA(){Pt(bt`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work.`)}const XD="sort";function zie(t,e,n){const r=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push(`${XD}-${t.getIndexOfColumnInSortQueue(e)+1}`),r}function jie(t){const e=t.className.split(" "),n=new RegExp(`^${XD}-[0-9]{1,2}$`);return e.filter(r=>n.test(r))}function Kie(t,e,n){return e=qie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qie(t){var e=Xie(t,"string");return typeof e=="symbol"?e:String(e)}function Xie(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const ag="multiColumnSorting",Zie=170,tA="columnSorting",nA=ag;yH(ag,Gie);class Qie extends RH{constructor(){super(...arguments),Kie(this,"pluginKey",ag)}static get PLUGIN_KEY(){return ag}static get PLUGIN_PRIORITY(){return Zie}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[tA]&&eA(),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,zf))},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()},group:nA})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(nA)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];super.updateHeaderClasses(e,...r),Ye(e,jie(e)),this.enabled!==!1&&ce(e,zie(...r))}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[tA]&&eA(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,n){Yb(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,zf))):this.sort(this.getColumnNextConfig(n.col)))}}function rA(t,e,n){return e=Jie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jie(t){var e=eoe(t,"string");return typeof e=="symbol"?e:String(e)}function eoe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const toe="multipleSelectionHandles",noe=160;class roe extends gt{constructor(){super(...arguments),rA(this,"dragged",[]),rA(this,"lastSetCell",null)}static get PLUGIN_KEY(){return toe}static get PLUGIN_PRIORITY(){return noe}isEnabled(){return Mo()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function r(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(i);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",i=>{let o;if(Ve(i.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1;if(Ve(i.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",i=>{if(Ve(i.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(Ve(i.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",i=>{const{rootDocument:o}=this.hot;let s,a,l,u,c,d;if(e.dragged.length===0)return;const g=o.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!g||g===e.lastSetCell||((g.nodeName==="TD"||g.nodeName==="TH")&&(s=e.hot.getCoords(g),s.col===-1&&(s.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(s),d=e.getCurrentRangeCoords(a,s,e.touchStartRange.direction,c,e.dragged[0]),d.start!==null&&e.hot.selection.setRangeStart(d.start),e.hot.selection.setRangeEnd(d.end),e.lastSetCell=g),i.preventDefault())})}getCurrentRangeCoords(e,n,r,i,o){const s=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(r){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":o==="top"?c={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,s.col)};break;case"SE-NW":o==="bottom"&&(c={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,s.col)});break}break;case"NW-SE":switch(i){case"NE-SW":o==="top"?c={start:n,end:l}:c.end=n;break;case"NW-SE":o==="top"?c={start:n,end:a}:c.end=n;break;case"SE-NW":o==="top"?c={start:n,end:s}:c.end=n;break;case"SW-NE":o==="top"?c={start:n,end:u}:c.end=n;break}break;case"SW-NE":switch(i){case"NW-SE":o==="bottom"?c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(s.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SW-NE":o==="top"?c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)}:c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(s.row,n.col)};break;case"SE-NW":o==="bottom"?c={start:this.hot._createCellCoords(n.row,u.col),end:this.hot._createCellCoords(s.row,n.col)}:o==="top"&&(c={start:l,end:n});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(c.end=n);break;case"SE-NW":o==="top"?c.end=n:c={start:n,end:s};break}break}return c}isDragged(){return this.dragged.length>0}}function Sv(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:r,isCollapsed:o,crossHiddenColumns:i,isHidden:s,isRoot:a,isPlaceholder:l}}function ZD(){return{label:"",isPlaceholder:!0}}function ioe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;H(t,i=>{const o=[];let s=0;n.push(o),H(i,a=>{const l=Sv();if(qe(a)){const{label:c,colspan:d}=a;l.label=Zt(c),typeof d=="number"&&d>1&&(l.colspan=d,l.origColspan=d)}else l.label=Zt(a);s+=l.origColspan;let u=!1;if(s>=e&&(l.colspan=l.origColspan-(s-e),l.origColspan=l.colspan,u=!0),o.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)o.push(ZD());return!u})});const r=Math.max(...Xe(n,i=>i.length));return H(n,i=>{if(i.length<r){const o=Xe(new Array(r-i.length),()=>Sv());i.splice(i.length,0,...o)}}),n}function Dw(t,e,n){ooe(t,e),e.set(t,n)}function ooe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oi(t,e){var n=QD(t,e,"get");return soe(t,n)}function soe(t,e){return e.get?e.get.call(t):e.value}function zu(t,e,n){var r=QD(t,e,"set");return aoe(t,r,n),n}function QD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function aoe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const iA=["label","collapsible"];var po=new WeakMap,sa=new WeakMap,Nw=new WeakMap;class loe{constructor(){Dw(this,po,{writable:!0,value:[]}),Dw(this,sa,{writable:!0,value:0}),Dw(this,Nw,{writable:!0,value:1/0})}setColumnsLimit(e){zu(this,Nw,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];zu(this,po,ioe(e,oi(this,Nw))),zu(this,sa,oi(this,po).length)}getData(){return oi(this,po)}mergeWith(e){H(e,n=>{let{row:r,col:i,...o}=n;const s=this.getHeaderSettings(r,i);s!==null&&un(s,o,iA)})}map(e){H(oi(this,po),n=>{H(n,r=>{const i=e({...r});qe(i)&&un(r,i,iA)})})}getHeaderSettings(e,n){var r;if(e>=oi(this,sa)||e<0)return null;const i=oi(this,po)[e];return n>=i.length?null:(r=i[n])!==null&&r!==void 0?r:null}getHeadersSettings(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=oi(this,sa)||e<0)return i;const o=oi(this,po)[e];let s=0;for(let a=n;a<o.length;a++){const l=o[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),s===r)break;if(s>r)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return oi(this,sa)}getColumnsCount(){return oi(this,sa)>0?oi(this,po)[0].length:0}clear(){zu(this,po,[]),zu(this,sa,0)}}function Lw(t,e,n){return e=uoe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uoe(t){var e=coe(t,"string");return typeof e=="symbol"?e:String(e)}function coe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const JD="DF-pre-order";function eN(t,e){let n=t.call(e,this);for(let r=0;r<this.childs.length;r++){if(n===!1)return!1;n=eN.call(this.childs[r],t,e)}return n}const hoe="DF-post-order";function tN(t,e){for(let n=0;n<this.childs.length;n++)if(tN.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const nN="BF";function doe(t,e){const n=[this];function r(){if(n.length===0)return;const i=n.shift();n.push(...i.childs),t.call(e,i)!==!1&&r()}r()}const foe=nN,oA=new Map([[JD,eN],[hoe,tN],[nN,doe]]);class lg{constructor(e){Lw(this,"data",{}),Lw(this,"parent",null),Lw(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new lg({...e.data});for(let r=0;r<e.childs.length;r++)n.addChild(this.cloneTree(e.childs[r]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:foe;if(!oA.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);oA.get(n).call(this,e,this)}walkUp(e){const n=this,r=i=>{e.call(n,i)!==!1&&i.parent!==null&&r(i.parent)};r(this)}}function $w(t,e,n){goe(t,e),e.set(t,n)}function goe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kn(t,e){var n=rN(t,e,"get");return moe(t,n)}function moe(t,e){return e.get?e.get.call(t):e.value}function poe(t,e,n){var r=rN(t,e,"set");return woe(t,r,n),n}function rN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function woe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Sl=new WeakMap,aa=new WeakMap,yl=new WeakMap;class Coe{constructor(e){$w(this,Sl,{writable:!0,value:new Map}),$w(this,aa,{writable:!0,value:new Map}),$w(this,yl,{writable:!0,value:null}),poe(this,yl,e)}getRoots(){return Array.from(Kn(this,Sl).values())}getRootByColumn(e){let n;return Kn(this,aa).has(e)&&(n=Kn(this,Sl).get(Kn(this,aa).get(e))),n}getNode(e,n){const r=this.getRootByColumn(n);if(!r)return;const i=n-Kn(this,aa).get(n);let o=0,s;return r.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(i>=o&&i<=o+l-1)return s=a,s.data.isRoot=n===s.data.columnIndex,!1;o+=l}}),s}rebuildTreeIndex(){let e=0;Kn(this,aa).clear(),H(Kn(this,Sl),n=>{let[,{data:{colspan:r}}]=n;for(let i=e;i<e+r;i++)Kn(this,aa).set(i,e);e+=r})}buildTree(){this.clear();const e=Kn(this,yl).getColumnsCount();let n=0;for(;n<e;){const r=Kn(this,yl).getHeaderSettings(0,n),i=new lg;Kn(this,Sl).set(n,i),this.buildLeaves(i,n,0,r.origColspan),n+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=Kn(this,yl).getHeadersSettings(r,n,i);r+=1,H(o,s=>{const a={...s,headerLevel:r-1,columnIndex:n};let l;r===1?(e.data=a,l=e):(l=new lg(a),e.addChild(l)),r<Kn(this,yl).getLayersCount()&&this.buildLeaves(l,n,r,s.origColspan),n+=s.origColspan})}clear(){Kn(this,Sl).clear(),Kn(this,aa).clear()}}function iN(t,e){t.walkDown(n=>{let{data:r,childs:i}=n;if(!r.isHidden&&(e(r.columnIndex),i.length===0))for(let o=1;o<r.colspan;o++)e(r.columnIndex+o)})}function ug(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function cg(t){return ug(t,"origColspan")===t.data.origColspan}function iR(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(cg(t))return iR(n[0]);e.isCollapsed=!1;const i=n.slice(1),o=new Set;let s=0;if(i.length>0)H(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;s+=l.colspan,iN(a,u=>{o.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;s=l-a;for(let c=1;c<l;c++)o.add(u+c)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=s,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):cg(a)&&(l.isCollapsed=ug(a,"isCollapsed"))}),{rollbackModification:()=>oR(t),affectedColumns:Array.from(o),colspanCompensation:s}}function oR(t){var e;const{data:n,childs:r}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(cg(t))return oR(r[0]);n.isCollapsed=!0;const o=r.slice(1),s=new Set;if(o.length>0)H(o,l=>{iN(l,u=>{s.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=n;for(let c=1;c<l;c++){const d=u+c;s.add(d)}}const a=n.colspan-((e=ug(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):cg(l)&&(u.isCollapsed=ug(l,"isCollapsed"))}),{rollbackModification:()=>iR(t),affectedColumns:Array.from(s),colspanCompensation:a}}function voe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(bt`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}function Soe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(bt`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}const sA=new Map([["collapse",oR],["expand",iR],["hide-column",voe],["show-column",Soe]]);function yoe(t,e,n){if(!sA.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return sA.get(t)(e,n)}function Dd(t){const e=[];return H(t,n=>{n.walkDown(r=>{const i=r.data,{origColspan:o,columnIndex:s,headerLevel:a,crossHiddenColumns:l}=i,u=Roe(e,a);let c=!1;for(let d=s;d<s+o;d++)if(l.includes(d)||c)u.push(ZD());else{const p=boe(i);p.isRoot=!0,u.push(p),c=!0}})}),e}function boe(t){const{crossHiddenColumns:e,...n}=Sv(t);return n}function Roe(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function kw(t,e,n){Eoe(t,e),e.set(t,n)}function Eoe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ju(t,e,n){var r=oN(t,e,"set");return Toe(t,r,n),n}function Toe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Gt(t,e){var n=oN(t,e,"get");return _oe(t,n)}function oN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function _oe(t,e){return e.get?e.get.call(t):e.value}var Ni=new WeakMap,sr=new WeakMap,la=new WeakMap;class Moe{constructor(){kw(this,Ni,{writable:!0,value:new loe}),kw(this,sr,{writable:!0,value:new Coe(Gt(this,Ni))}),kw(this,la,{writable:!0,value:[[]]})}setState(e){Gt(this,Ni).setData(e);let n=!1;try{Gt(this,sr).buildTree()}catch{Gt(this,sr).clear(),Gt(this,Ni).clear(),n=!0}return ju(this,la,Dd(Gt(this,sr).getRoots())),n}setColumnsLimit(e){Gt(this,Ni).setColumnsLimit(e)}mergeStateWith(e){const n=Xe(e,r=>{let{row:i,...o}=r;return{row:i<0?this.rowCoordsToLevel(i):i,...o}});Gt(this,Ni).mergeWith(n),Gt(this,sr).buildTree(),ju(this,la,Dd(Gt(this,sr).getRoots()))}mapState(e){Gt(this,Ni).map(e),Gt(this,sr).buildTree(),ju(this,la,Dd(Gt(this,sr).getRoots()))}mapNodes(e){return nn(Gt(this,sr).getRoots(),(n,r)=>(r.walkDown(i=>{const o=e(i.data);o!==void 0&&n.push(o)}),n),[])}triggerNodeModification(e,n,r){n<0&&(n=this.rowCoordsToLevel(n));const i=Gt(this,sr).getNode(n,r);let o;return i&&(o=yoe(e,i,r),ju(this,la,Dd(Gt(this,sr).getRoots()))),o}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var r,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(i=Gt(this,la)[e])===null||i===void 0?void 0:i[n])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,n){const r=this.getHeaderTreeNode(e,n);return r?{...r.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const r=Gt(this,sr).getNode(e,n);return r||null}findTopMostEntireHeaderLevel(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const i=r-e+1;let o=!1,s=null;for(let a=e;a<=r;a++){const l=Gt(this,sr).getRootByColumn(a);if(!l)break;o=!0,l.walkDown(u=>{const{columnIndex:c,headerLevel:d,origColspan:g,isHidden:p}=u.data;p||g<=i&&c>=e&&c+g-1<=r&&(s===null||d<s)&&(s=d)},JD)}return o&&s===null?-1:this.levelToRowCoords((n=s)!==null&&n!==void 0?n:0)}findLeftMostColumnIndex(e,n){var r;const{isRoot:i}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0};if(i)return n;let o=n-1;for(;o>=0;){var s;const{isRoot:a}=(s=this.getHeaderSettings(e,o))!==null&&s!==void 0?s:{isRoot:!0};if(a)break;o-=1}return o}findRightMostColumnIndex(e,n){var r;const{isRoot:i,origColspan:o}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0,origColspan:1};if(i)return n+o-1;let s=n+1;for(;s<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,s))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;s+=1}return s-1}getLayersCount(){return Gt(this,Ni).getLayersCount()}getColumnsCount(){return Gt(this,Ni).getColumnsCount()}clear(){ju(this,la,[]),Gt(this,Ni).clear(),Gt(this,sr).clear()}}function Ku(t,e,n){return e=Ooe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ooe(t){var e=Aoe(t,"string");return typeof e=="symbol"?e:String(e)}function Aoe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ioe{constructor(e,n){Ku(this,"hot",void 0),Ku(this,"nestedHeaderSettingsGetter",void 0),Ku(this,"layersCount",0),Ku(this,"container",void 0),Ku(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const e=this.container.querySelectorAll("tr:last-of-type th"),n=e.length;this.widthsMap.clear();for(let r=0;r<n;r++){const i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),o=this.hot.toPhysicalColumn(i);this.widthsMap.setValueAtIndex(o,e[r].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:r}=this.hot,i=n.createDocumentFragment(),o=n.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,a=r.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=n.createElement("tr");for(let c=0;c<a;c++){let d=r.getVisualFromRenderableIndex(c);d===null&&(d=c);const g=n.createElement("th"),p=this.nestedHeaderSettingsGetter(l,d);if(p&&(!p.isPlaceholder||p.isHidden)){let C=p.label;s&&(C+='<button class="changeType"></button>'),Pa(g,C),g.colSpan=p.colspan,u.appendChild(g)}}o.appendChild(u)}i.appendChild(o),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}const Poe=Ioe;function Rn(t,e){sN(t,e),e.add(t)}function aA(t,e,n){return e=xoe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xoe(t){var e=Hoe(t,"string");return typeof e=="symbol"?e:String(e)}function Hoe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Nd(t,e,n){sN(t,e),e.set(t,n)}function sN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wa(t,e,n){var r=aN(t,e,"set");return Doe(t,r,n),n}function Doe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function ct(t,e){var n=aN(t,e,"get");return Noe(t,n)}function aN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Noe(t,e){return e.get?e.get.call(t):e.value}function fn(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const lA="nestedHeaders",Loe=280;var St=new WeakMap,rs=new WeakMap,Ec=new WeakMap,dm=new WeakMap,Ld=new WeakSet,uA=new WeakSet,cA=new WeakSet,hA=new WeakSet,dA=new WeakSet,fA=new WeakSet,gA=new WeakSet,mA=new WeakSet,pA=new WeakSet,wA=new WeakSet,CA=new WeakSet,vA=new WeakSet,SA=new WeakSet,yA=new WeakSet,bA=new WeakSet,RA=new WeakSet,EA=new WeakSet,TA=new WeakSet;class $oe extends gt{constructor(){super(...arguments),Rn(this,TA),Rn(this,EA),Rn(this,RA),Rn(this,bA),Rn(this,yA),Rn(this,SA),Rn(this,vA),Rn(this,CA),Rn(this,wA),Rn(this,pA),Rn(this,mA),Rn(this,gA),Rn(this,fA),Rn(this,dA),Rn(this,hA),Rn(this,cA),Rn(this,uA),Rn(this,Ld),Nd(this,St,{writable:!0,value:new Moe}),Nd(this,rs,{writable:!0,value:null}),Nd(this,Ec,{writable:!0,value:null}),Nd(this,dm,{writable:!0,value:!1}),aA(this,"ghostTable",new Poe(this.hot,(e,n)=>this.getHeaderSettings(e,n))),aA(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return lA}static get PLUGIN_PRIORITY(){return Loe}isEnabled(){return!!this.hot.getSettings()[lA]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&Pt(bt`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>fn(this,EA,Joe).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return fn(e,TA,ese).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return fn(e,dA,Voe).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return fn(e,fA,Boe).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return fn(e,gA,Uoe).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return fn(e,mA,Yoe).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return fn(e,pA,Goe).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return fn(e,wA,zoe).call(e,...i)}),this.addHook("afterSelection",()=>fn(this,Ld,Fw).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return fn(e,uA,koe).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",r=>fn(this,vA,Koe).call(this,r)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return fn(e,yA,Xoe).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return fn(e,bA,Zoe).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return fn(e,cA,Foe).call(e,...i)}),this.addHook("beforeCopy",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return fn(e,hA,Woe).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return fn(e,CA,joe).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return fn(e,SA,qoe).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return fn(e,RA,Qoe).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>fn(this,Ld,Fw).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>fn(this,Ld,Fw).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();ct(this,St).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=ct(this,St).setState(e)),this.detectedOverlappedHeaders&&Pt(bt`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,r)=>{const i=n===!0?"hide-column":"show-column";ct(this,St).triggerColumnModification(i,r)}),!ct(this,rs)&&this.enabled&&wa(this,rs,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(r=>{let{op:i,index:o,newValue:s}=r;if(i==="replace"){const a=s===!0?"hide-column":"show-column";ct(this,St).triggerColumnModification(a,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),ct(this,St).clear(),ct(this,rs).unsubscribe(),wa(this,rs,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return ct(this,St)}getLayersCount(){return ct(this,St).getLayersCount()}getHeaderSettings(e,n){return ct(this,St).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let s=0;s<n;s++){const a=r.childNodes[s];if(!a)break;const l=i.childNodes[s],u=o?o.childNodes[s]:null;for(let c=0,d=a.childNodes.length;c<d;c++)a.childNodes[c].removeAttribute("colspan"),Ye(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),Ye(l.childNodes[c],"hiddenHeader")),o&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),Ye(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const r=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,o)=>{var s;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(i);u===null&&(u=i),o.removeAttribute("colspan"),Ye(o,"hiddenHeader");const{colspan:c,isHidden:d,isPlaceholder:g}=(s=ct(this,St).getHeaderSettings(e,u))!==null&&s!==void 0?s:{label:""};if(g||d)ce(o,"hiddenHeader");else if(c>1){var p,C;const{wtOverlays:E}=l._wt,I=(p=E.topInlineStartCornerOverlay)===null||p===void 0?void 0:p.clone.wtTable.THEAD.contains(o),M=(C=E.inlineStartOverlay)===null||C===void 0?void 0:C.clone.wtTable.THEAD.contains(o),y=I||M?Math.min(c,r-i):c;y>1&&o.setAttribute("colspan",y)}this.hot.view.appendColHeader(u,o,function(){return n.getColumnHeaderValue(...arguments)},e)}}getColumnHeaderValue(e,n){var r;const{isHidden:i,isPlaceholder:o}=(r=ct(this,St).getHeaderSettings(n,e))!==null&&r!==void 0?r:{};return o||i?"":this.hot.getColHeader(e,n)}destroy(){wa(this,St,null),ct(this,rs)!==null&&(ct(this,rs).unsubscribe(),wa(this,rs,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return ct(this,St).getHeaderTreeNodeData(e.row,e.col)}}function Fw(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:n}=e;if(n.isHeader()&&n.col>=0){const i=ct(this,St).findLeftMostColumnIndex(n.row,n.col),o=this.hot.selection.highlight.getFocus();o.visualCellRange.highlight.col=i,o.visualCellRange.from.col=i,o.visualCellRange.to.col=i,o.commit()}}function koe(t){const e=this.hot.getSelectedRangeLast();if(!e)return t;const{highlight:n}=e;if(!(n.isHeader()&&n.col>=0))return t;const i=this.hot.view.getFirstFullyVisibleColumn(),o=this.hot.view.getLastFullyVisibleColumn(),s=ct(this,St).findLeftMostColumnIndex(n.row,n.col),a=ct(this,St).findRightMostColumnIndex(n.row,n.col);return s<i&&a>o?t:s<i?s:a}function Foe(t,e,n){const r=ct(this,St).getHeaderTreeNodeData(e,t);if(!r)return t;const{columnCursor:i,selectionType:o,selectionWidth:s}=n,{isRoot:a,colspan:l}=ct(this,St).getHeaderSettings(e,t);if(o===VS){if(!a)return r.columnIndex}else if(o===tx&&(l>s-i||!a))return null;return t}function Woe(t,e,n){let{columnHeadersCount:r}=n;if(r!==0)for(let o=0;o<e.length;o++){const{startRow:s,startCol:a,endRow:l,endCol:u}=e[o],c=l-s+1,d=a-u+1;if(s>=0||d===1)break;for(let g=a;g<=u;g++)for(let p=s;p<=l;p++){var i;const C=c+p,E=g-a;if(E===0)continue;((i=ct(this,St).getHeaderTreeNodeData(p,g))===null||i===void 0?void 0:i.isRoot)===!1&&(t[C][E]="")}}}function Voe(t,e,n,r){this._getHeaderTreeNodeDataByCoords(e)&&(r.column=!0)}function Boe(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;wa(this,Ec,e.clone()),wa(this,dm,!0);const{selection:r}=this.hot,i=r.isSelected()?r.getSelectedRange().current():null,o=[],{columnIndex:s,origColspan:a}=n,l=!r.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?o.push(i.getTopEndCorner().col,s,e.row):e.col>i.from.col?o.push(i.getTopStartCorner().col,s+a-1,e.row):o.push(s,s+a-1,e.row):(Wg(t)||Ms(t)&&l)&&o.push(s,s+a-1,e.row),r.selectColumns(...o)}function Uoe(t,e,n,r){if(!this.hot.view.isMouseDown())return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:o,origColspan:s}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;r.column=!0,r.cell=!0;const d=[],g=pr(e.row,-1/0,-1);e.col<c.col?d.push(u.col,o,g):e.col>c.col?d.push(l.col,o+s-1,g):d.push(o,o+s-1,g),this.hot.selection.selectColumns(...d)}function Yoe(){wa(this,dm,!1)}function Goe(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!ct(this,dm)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,r=e.getBottomEndCorner().col,{columnIndex:i,origColspan:o}=ct(this,St).getHeaderTreeNodeData(ct(this,Ec).row,ct(this,Ec).col);if(e.setHighlight(ct(this,Ec)),o>e.getWidth()||i<n||i+o-1>r){const s=ct(this,St).findTopMostEntireHeaderLevel(pr(n,i,i+o-1),pr(r,i,i+o-1));e.highlight.row=s,e.highlight.col=e.from.col}}function zoe(t){const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const i=ct(this,St).findLeftMostColumnIndex(n.row,n.col),o=ct(this,St).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const s=e.col>=i&&e.col<=o?i-1:o,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const s=e.col>=i&&e.col<=o?o+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function joe(t,e){const n=t.row,r=this._getHeaderTreeNodeDataByCoords({row:n,col:t.col}),i=this._getHeaderTreeNodeDataByCoords({row:n,col:e.col});e.col<t.col?(r&&(t.col=r.columnIndex+r.origColspan-1),i&&(e.col=i.columnIndex)):e.col>=t.col&&(r&&(t.col=r.columnIndex),i&&(e.col=i.columnIndex+i.origColspan-1))}function Koe(t){t.length=0;for(let e=0;e<ct(this,St).getLayersCount();e++)t.push(this.headerRendererFactory(e))}function qoe(t){const e=ct(this,St).getLayersCount();let n=t.startColumn,r=!!e;for(let i=0;i<e;i++){const o=ct(this,St).findLeftMostColumnIndex(i,t.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(r=!1),er(s)&&s<t.startColumn){n=s;break}}t.startColumn=r?ct(this,St).getHeaderTreeNodeData(0,n).columnIndex:n}function Xoe(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function Zoe(t,e,n){var r;const{label:i}=(r=ct(this,St).getHeaderTreeNodeData(n,e))!==null&&r!==void 0?r:{label:""};return i}function Qoe(t,e){if(t<0)return this.hot.getCell(t,ct(this,St).findLeftMostColumnIndex(t,e),!0)}function Joe(){this.updatePlugin()}function ese(t,e){e||this.updatePlugin()}function qu(t,e,n){return e=tse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tse(t){var e=nse(t,"string");return typeof e=="symbol"?e:String(e)}function nse(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rse{constructor(e,n){qu(this,"hot",void 0),qu(this,"data",null),qu(this,"plugin",void 0),qu(this,"parentReference",new WeakMap),qu(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},xe(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,r){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&H(e.__children,i=>{this.cacheNode(i,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,r,i){let o=!1,s=n;if(isNaN(s)&&s.end)return s;let a=e;return a||(a={__children:this.data},o=!0,s-=1),r!=null&&s===r?{result:a,end:!0}:i!=null&&a===i?{result:s,end:!0}:(s+=1,a.__children&&H(a.__children,l=>{if(this.parentReference.set(l,o?null:a),s=this.readTreeNodes(l,s,r,i),isNaN(s)&&s.end)return!1}),s)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return Ze(this.data[0],(n,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const r=this.getRowParent(e);return r==null?this.data.indexOf(n):r.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:(H(r.__children,i=>{n+=1,i.__children&&(n+=this.countChildren(i))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var r;return((r=e.__children)===null||r===void 0?void 0:r[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((n=r.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let r=n;this.hot.runHooks("beforeAddChild",e,r);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),r||(r=this.mockNode()),o.__children.push(r),this.rewriteCache();const s=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,n,r){let i=r,o;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,n),e){const a=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),o=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[n]);i=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,i,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const r=this.translateTrimmedRow(e),i=this.getRowParent(r),o=this.getRowIndexWithinParent(r);switch(n){case"below":this.addChildAtIndex(i,o+1,null);break;case"above":this.addChildAtIndex(i,o,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null;const i=[];Array.isArray(e)?(xe(e[0],e[2],g=>{const p=this.translateTrimmedRow(g);i.push(this.getDataObject(p))}),xe(0,i.length-2,g=>{this.detachFromParent(i[g],!1)}),r=i[i.length-1]):r=e;const o=this.getRowIndex(r),s=this.countChildren(r),a=this.getRowIndexWithinParent(r),l=this.getRowParent(r),u=this.getRowParent(l),c=this.getRowIndex(u);let d=null;if(this.hot.runHooks("beforeDetachChild",l,r),a!=null){const g=Array.from(new Array(o+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",o,s+1,g,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,s+1,g,this.plugin.pluginName),u){d=c+this.countChildren(u);const p=this.getChild(u,this.countChildren(u)-1),C=this.getRowIndex(p);this.hot.runHooks("beforeCreateRow",C+1,s+1,this.plugin.pluginName),u.__children.push(r)}else d=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",d-2,s+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",d-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,r,this.getRowIndex(r)),n&&this.hot.render()}filterData(e,n,r){const i=[];H(r,o=>{i.push(this.getDataObject(o))}),H(i,o=>{const s=this.getRowIndexWithinParent(o),a=this.getRowParent(o);a===null?this.data.splice(s,1):a.__children.splice(s,1)}),this.rewriteCache()}spliceData(e,n,r){const i=this.getDataObject(e-1);let o=null,s=e;i&&i.__children&&i.__children.length===0?(o=i,s=0):e<this.countAllRows()&&(o=this.getRowParent(e),s=this.getRowIndexWithinParent(e)),o?r?o.__children.splice(s,n,...r):o.__children.splice(s,n):r?this.data.splice(s,n,...r):this.data.splice(s,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,r=null;do r=this.getRowParent(r),r!==null&&(n=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,r,i){const o=n===this.hot.countRows(),s=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=s.__children.slice(a,a+1),u=e>n;let c=o?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);const d=o||r||i?c.__children.length:this.getRowIndexWithinParent(n),g=s===c;c.__children.splice(d,0,l[0]),s.__children.splice(a+(u&&g?1:0),1),this.syncRowWithRawSource(s),g||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}const ise=rse;function _A(t,e,n){return e=ose(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ose(t){var e=sse(t,"string");return typeof e=="symbol"?e:String(e)}function sse(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ase{constructor(e,n){_A(this,"hot",void 0),_A(this,"plugin",void 0),this.hot=n,this.plugin=e}}const sR=ase;class Ro extends sR{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const r=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(r),o=this.dataManager.getDataObject(r),s=n.getElementsByTagName("DIV")[0],a=s.querySelector("span.rowHeader"),l=s.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(H(l,c=>{c&&s.removeChild(c)}),ce(n,Ro.CSS_CLASSES.indicatorContainer),i){const{rootDocument:c}=this.hot,d=a.cloneNode(!0);s.innerHTML="",xe(0,i-1,()=>{const g=c.createElement("SPAN");ce(g,Ro.CSS_CLASSES.emptyIndicator),s.appendChild(g)}),s.appendChild(d)}if(this.dataManager.hasChildren(o)){const c=this.hot.rootDocument.createElement("DIV");u&&Ne(c,[Vo()]),ce(n,Ro.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?(ce(c,`${Ro.CSS_CLASSES.button} ${Ro.CSS_CLASSES.expandButton}`),u&&Ne(n,[Ur(!1)])):(ce(c,`${Ro.CSS_CLASSES.button} ${Ro.CSS_CLASSES.collapseButton}`),u&&Ne(n,[Ur(!0)])),s.appendChild(c)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*n+25),this.hot.render()}}const lN=Ro;class lse extends sR{constructor(e,n){var r;super(e,n),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,i)},shiftStash:function(i,o){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),H(r.lastCollapsedRows,(a,l)=>{a>=i&&a<o&&(r.lastCollapsedRows[l]=a+s)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,i),r.lastCollapsedRows=void 0},trimStash:(i,o)=>{xe(i,i+o-1,s=>{const a=this.lastCollapsedRows.indexOf(s);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),s=e),this.dataManager.hasChildren(o)&&H(o.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),r&&this.trimRows(a),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(s)===-1&&this.collapsedRows.push(s),a}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];H(e,o=>{i.push(...this.collapseChildren(o,!1,!1))}),r&&this.trimRows(i),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return H(e,o=>{i.push(o),n&&this.collapseChildRows(o,i)}),r&&this.trimRows(i),i}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);H(i.__children,o=>{const s=this.dataManager.getRowIndex(o);n.push(s),this.collapseChildRows(s,n)})}r&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return H(e,o=>{i.push(o),n&&this.expandChildRows(o,i)}),r&&this.untrimRows(i),i}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);H(i.__children,o=>{if(!this.isAnyParentCollapsed(o)){const s=this.dataManager.getRowIndex(o);n.push(s),this.expandChildRows(s,n)}})}r&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),s=e),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(o)&&H(o.__children,l=>{const u=this.dataManager.getRowIndex(l);i.push(u)}),a=this.expandRows(i,!0,!1),r&&this.untrimRows(a),n&&this.renderAndAdjust(),a}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];H(e,o=>{i.push(...this.expandChildren(o,!1,!1))}),r&&this.untrimRows(i),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];H(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];H(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{H(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{H(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&H(n.__children,i=>{const o=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return r=!1,!1}),r}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const r=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const r=this.translateTrimmedRow(n.row);Ve(e.target,lN.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),Kr(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}const use=lse;function cse(t,e,n){hse(t,e),e.set(t,n)}function hse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dse(t,e,n){return e=fse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fse(t){var e=gse(t,"string");return typeof e=="symbol"?e:String(e)}function gse(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mse(t,e){var n=pse(t,e,"get");return wse(t,n)}function pse(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function wse(t,e){return e.get?e.get.call(t):e.value}var MA=new WeakMap;class Cse extends sR{constructor(){super(...arguments),dse(this,"dataManager",this.plugin.dataManager),cse(this,MA,{writable:!0,value:{row_above:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"below")}}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase(By)},callback:()=>{const r=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(r);this.dataManager.addChild(i)},disabled:()=>{const r=this.hot.getSelectedLast();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(Uy)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const r=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(i)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return xe(0,e.items.length-1,r=>{if(r===0)return H(n,(i,o)=>{e.items.splice(r+o,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return xe(0,e.items.length-1,n=>{const r=mse(this,MA)[e.items[n].key];r!=null&&(e.items[n].callback=r)}),e}}const vse=Cse;function $d(t,e,n){return e=Sse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sse(t){var e=yse(t,"string");return typeof e=="symbol"?e:String(e)}function yse(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bse{constructor(e){$d(this,"plugin",void 0),$d(this,"hot",void 0),$d(this,"dataManager",void 0),$d(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,r,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:r,movePossible:i}))return!1;this.movedToCollapsed=!1;const s=r===this.hot.countRows(),a=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let l=!0;const u=e.map(C=>{if(!l)return!1;const E=this.dataManager.translateTrimmedRow(C);return l=this.shouldAllowMoving(E,a),E}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const d=this.getBaseParent(u),g=this.getTargetParent(s,a),p=d===g;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(g),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,p),this.moveRows(u,a,g),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,r,i,i&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:r,dropIndex:i,movePossible:o}=e;let s=!1;return It(i)&&(Pt(bt`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,r,i,o,!1),s=!0),s}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let r=this.dataManager.getRowParent(e?n-1:n);return r==null&&(r=this.dataManager.getRowParent(n-1)),r}shiftCollapsibleParentsLocations(e,n,r){r||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,r){const i=n===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,n,this.movedToCollapsed,i)})})}moveCellsMeta(e,n){const r=[],i=Math.max(...e)<n;e.forEach(o=>{r.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(i?r.length:0),0,...r)}selectCells(e,n){const r=e.length;let i=0,o=0,s=null,a=null;if(this.movedToCollapsed){let l=null;e[r-1]<n?l=this.dataManager.translateTrimmedRow(n-r):l=this.dataManager.translateTrimmedRow(n);const u=this.dataManager.getRowParent(l===null?this.hot.countSourceRows()-1:l-1),c=this.dataManager.getRowIndex(u);i=this.dataManager.untranslateTrimmedRow(c),o=i}else e[r-1]<n?(o=n-1,i=o-r+1):(i=n,o=i+r-1);s=this.hot.selection,a=this.hot.countCols()-1,s.setRangeStart(this.hot._createCellCoords(i,0)),s.setRangeEnd(this.hot._createCellCoords(o,a),!0)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}}function Nn(t,e){uN(t,e),e.add(t)}function OA(t,e,n){uN(t,e),e.set(t,n)}function uN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ww(t,e,n){return e=Rse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rse(t){var e=Ese(t,"string");return typeof e=="symbol"?e:String(e)}function Ese(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ff(t,e){var n=cN(t,e,"get");return Tse(t,n)}function Tse(t,e){return e.get?e.get.call(t):e.value}function hg(t,e,n){var r=cN(t,e,"set");return _se(t,r,n),n}function cN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function _se(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function In(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const dg="nestedRows",Mse=300,AA=dg,Ose="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var fm=new WeakMap,bl=new WeakMap,IA=new WeakSet,PA=new WeakSet,xA=new WeakSet,HA=new WeakSet,DA=new WeakSet,NA=new WeakSet,LA=new WeakSet,$A=new WeakSet,kA=new WeakSet,FA=new WeakSet,WA=new WeakSet,VA=new WeakSet,BA=new WeakSet,UA=new WeakSet,YA=new WeakSet,Vw=new WeakSet;class Ase extends gt{constructor(){super(...arguments),Nn(this,Vw),Nn(this,YA),Nn(this,UA),Nn(this,BA),Nn(this,VA),Nn(this,WA),Nn(this,FA),Nn(this,kA),Nn(this,$A),Nn(this,LA),Nn(this,NA),Nn(this,DA),Nn(this,HA),Nn(this,xA),Nn(this,PA),Nn(this,IA),Ww(this,"dataManager",null),Ww(this,"headersUI",null),Ww(this,"collapsedRowsMap",null),OA(this,fm,{writable:!0,value:!1}),OA(this,bl,{writable:!0,value:!1})}static get PLUGIN_KEY(){return dg}static get PLUGIN_PRIORITY(){return Mse}isEnabled(){return!!this.hot.getSettings()[dg]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new oh),this.dataManager=new ise(this,this.hot),this.collapsingUI=new use(this,this.hot),this.headersUI=new lN(this,this.hot),this.contextMenuUI=new vse(this,this.hot),this.rowMoveController=new bse(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return In(e,UA,Use).call(e,...r)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return In(e,YA,Yse).call(e,...r)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return In(e,xA,xse).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return In(e,HA,Hse).call(e,...r)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return In(e,DA,Dse).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return In(e,PA,Pse).call(e,...r)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return In(e,$A,$se).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return In(e,LA,Lse).call(e,...r)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return In(e,kA,kse).call(e,...r)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return In(e,FA,Fse).call(e,...r)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return In(e,WA,Wse).call(e,...r)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return In(e,VA,Vse).call(e,...r)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return In(e,NA,Nse).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return In(e,BA,Bse).call(e,...r)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return In(e,IA,Ise).call(e,...r)}),this.addHook("beforeLoadData",n=>In(this,Vw,GA).call(this,n)),this.addHook("beforeUpdateData",n=>In(this,Vw,GA).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();if(e.col===-1&&e.row>=0){const n=this.collapsingUI.translateTrimmedRow(e.row);this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n)}},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()},group:AA})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(AA)}disableCoreAPIModifiers(){hg(this,bl,!0)}enableCoreAPIModifiers(){hg(this,bl,!1)}onModifyRowData(e){if(!ff(this,bl))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!ff(this,bl))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,r){return ff(this,bl)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,r),!1)}destroy(){super.destroy()}}function Ise(t,e,n,r){return this.rowMoveController.onBeforeRowMove(t,e,n,r)}function Pse(t,e,n){this.collapsingUI.toggleState(t,e,n)}function xse(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),hg(this,fm,!0),this.dataManager.getData().slice()}function Hse(t){return this.contextMenuUI.appendOptions(t)}function Dse(t,e){this.headersUI.appendLevelIndicators(t,e)}function Nse(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function Lse(t,e,n,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{hg(this,fm,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function $se(t,e,n){const r=Array.from(n.reduce((i,o)=>{if(this.dataManager.isParent(o)){const s=this.dataManager.getDataObject(o).__children;return i.add(o),Array.isArray(s)&&s.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(o)},new Set));n.length=0,n.push(...r)}function kse(){this.collapsingUI.collapsedRowsStash.stash()}function Fse(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Wse(){this.collapsingUI.collapsedRowsStash.stash()}function Vse(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Bse(){this.dataManager.rewriteCache()}function Use(){this.headersUI.updateRowHeaderWidth()}function Yse(t,e){ff(this,fm)&&(e.skipRender=!0)}function GA(t){if(!gx(t)){RS(Ose),this.hot.getSettings()[dg]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function Bw(t,e,n){return e=Gse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gse(t){var e=zse(t,"string");return typeof e=="symbol"?e:String(e)}function zse(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jse{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;Bw(this,"rootWindow",void 0),Bw(this,"prefix",void 0),Bw(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const r=typeof e>"u"?n:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){H(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}const Kse=jse;function qse(t,e,n){return e=Xse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xse(t){var e=Zse(t,"string");return typeof e=="symbol"?e:String(e)}function Zse(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}_e.getSingleton().register("persistentStateSave");_e.getSingleton().register("persistentStateLoad");_e.getSingleton().register("persistentStateReset");const zA="persistentState",Qse=0;class Jse extends gt{constructor(){super(...arguments),qse(this,"storage",void 0)}static get PLUGIN_KEY(){return zA}static get PLUGIN_PRIORITY(){return Qse}isEnabled(){return!!this.hot.getSettings()[zA]}enablePlugin(){this.enabled||(this.storage||(this.storage=new Kse(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function eae(t,e){tae(t,e),e.add(t)}function tae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Uw(t,e,n){return e=nae(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nae(t){var e=rae(t,"string");return typeof e=="symbol"?e:String(e)}function rae(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function jA(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Yw="search",iae=190,oae="htSearchResult",sae=function(t,e,n,r,i){t.getCellMeta(e,n).isSearchResult=i},aae=function(t,e,n){return It(t)||t===null||!t.toLocaleLowerCase||t.length===0||It(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var Gw=new WeakSet;class lae extends gt{constructor(){super(...arguments),eae(this,Gw),Uw(this,"callback",sae),Uw(this,"queryMethod",aae),Uw(this,"searchResultClass",oae)}static get PLUGIN_KEY(){return Yw}static get PLUGIN_PRIORITY(){return iae}isEnabled(){return this.hot.getSettings()[Yw]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Yw];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jA(e,Gw,KA).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jA(e,Gw,KA).call(e,...i)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),o=this.hot.countCols(),s=[],a=this.hot;return xe(0,i-1,l=>{xe(0,o-1,u=>{const c=this.hot.getDataAtCell(l,u),d=this.hot.getCellMeta(l,u),g=d.search.callback||n,C=(d.search.queryMethod||r)(e,c,d);if(C){const E={row:l,col:u,data:c};s.push(E)}g&&g(a,l,u,c,C)})}),s}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){qe(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function KA(t,e,n,r,i,o){const s=o.className||[];let a=[];typeof s=="string"?a=s.split(" "):a.push(...s),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}function zw(t,e){uae(t,e),e.add(t)}function uae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kd(t,e,n){return e=cae(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cae(t){var e=hae(t,"string");return typeof e=="symbol"?e:String(e)}function hae(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function jw(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const dae="touchScroll",fae=200;var qA=new WeakSet,XA=new WeakSet,ZA=new WeakSet;class gae extends gt{constructor(){super(...arguments),zw(this,ZA),zw(this,XA),zw(this,qA),kd(this,"scrollbars",[]),kd(this,"clones",[]),kd(this,"lockedCollection",!1),kd(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return dae}static get PLUGIN_PRIORITY(){return fae}static get SETTING_KEYS(){return!0}isEnabled(){return DS()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>jw(this,qA,mae).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>jw(this,XA,pae).call(this)),this.addHook("afterMomentumScroll",()=>jw(this,ZA,wae).call(this))}}function mae(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function pae(){this.freezeOverlays=!0,H(this.clones,t=>{ce(t,"hide-tween")})}function wae(){this.freezeOverlays=!1,H(this.clones,t=>{Ye(t,"hide-tween"),ce(t,"show-tween")}),this.hot._registerTimeout(()=>{H(this.clones,t=>{Ye(t,"show-tween")})},400),H(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function Cae(t,e){vae(t,e),e.add(t)}function vae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sae(t,e,n){return e=yae(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yae(t){var e=bae(t,"string");return typeof e=="symbol"?e:String(e)}function bae(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Rae(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const gf="trimRows",Eae=330;var QA=new WeakSet;class Tae extends gt{constructor(){super(...arguments),Cae(this,QA),Sae(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return gf}static get PLUGIN_PRIORITY(){return Eae}isEnabled(){return!!this.hot.getSettings()[gf]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new oh),this.trimmedRowsMap.addLocalHook("init",()=>Rae(this,QA,_ae).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[gf];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),H(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{H(e,s=>{this.trimmedRowsMap.setValueAtIndex(s,!0)})},!0),this.hot.runHooks("afterTrimRow",n,i,r,r&&i.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;const o=this.trimmedRowsMap.getValues().slice(),s=e.length>0;r&&s&&(H(e,l=>{o[l]=!1}),i=nn(o,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",n,i,r&&s)!==!1&&(r&&s&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",n,i,r&&s,r&&i.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<n)}destroy(){super.destroy()}}function _ae(){const t=this.hot.getSettings()[gf];Array.isArray(t)&&this.hot.batchExecution(()=>{H(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}const hN="undoRedo",Mae="undoRedo";function Te(t){const e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",function(n,r){const i=n&&n.length;if(!i||!n.find(a=>{const[,,l,u]=a;return l!==u}))return;const s=()=>{const a=n.reduce((u,c)=>(u.push([...c]),u),[]);H(a,u=>{u[1]=t.propToCol(u[1])});const l=i>1?this.getSelected():[[a[0][0],a[0][1]]];return new Te.ChangeAction(a,l)};e.done(s,r)}),t.addHook("afterCreateRow",(n,r,i)=>{e.done(()=>new Te.CreateRowAction(n,r),i)}),t.addHook("beforeRemoveRow",(n,r,i,o)=>{const s=()=>{const a=t.toPhysicalRow(n),l=Vn(e.instance.getSourceData(a,0,a+r-1,e.instance.countSourceCols()-1));return new Te.RemoveRowAction(a,l,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop,t.rowIndexMapper.getIndexesSequence())};e.done(s,o)}),t.addHook("afterCreateCol",(n,r,i)=>{e.done(()=>new Te.CreateColumnAction(n,r),i)}),t.addHook("beforeRemoveCol",(n,r,i,o)=>{const s=()=>{const a=e.instance.getSourceDataArray(),l=(e.instance.countCols()+n)%e.instance.countCols(),u=[],c=[],d=[];xe(a.length-1,C=>{const E=[],I=a[C];xe(l,l+(r-1),M=>{E.push(I[t.toPhysicalColumn(M)])}),u.push(E)}),xe(r-1,C=>{d.push(t.toPhysicalColumn(l+C))}),Array.isArray(t.getSettings().colHeaders)&&xe(r-1,C=>{c.push(t.getSettings().colHeaders[t.toPhysicalColumn(l+C)]||null)});const g=t.columnIndexMapper.getIndexesSequence(),p=t.rowIndexMapper.getIndexesSequence();return new Te.RemoveColumnAction(l,d,u,c,g,p,t.getSettings().fixedColumnsStart)};e.done(s,o)}),t.addHook("beforeCellAlignment",(n,r,i,o)=>{e.done(()=>new Te.CellAlignmentAction(n,r,i,o))}),t.addHook("beforeFilter",n=>{e.done(()=>new Te.FiltersAction(n))}),t.addHook("beforeRowMove",(n,r)=>{n!==!1&&e.done(()=>new Te.RowMoveAction(n,r))}),t.addHook("beforeMergeCells",(n,r)=>{r||e.done(()=>new Te.MergeCellsAction(t,n))}),t.addHook("afterUnmergeCells",(n,r)=>{r||e.done(()=>new Te.UnmergeCellsAction(t,n))}),t.addHook("afterInit",()=>{e.init()})}Te.prototype.done=function(t,e){if(this.ignoreNewActions||e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto")return;const r=this.doneActions.slice();if(this.instance.runHooks("beforeUndoStackChange",r,e)===!1)return;const o=t(),s=this.undoneActions.slice();this.doneActions.push(o),this.instance.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",s),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",s,this.undoneActions.slice())};Te.prototype.undo=function(){if(this.isUndoAvailable()){const t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());const n=Vn(e);if(this.instance.runHooks("beforeUndo",n)===!1)return;this.ignoreNewActions=!0;const i=this,o=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",o),e.undo(this.instance,()=>{i.ignoreNewActions=!1,i.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.instance.runHooks("afterUndo",n)}};Te.prototype.redo=function(){if(this.isRedoAvailable()){const t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());const n=Vn(e);if(this.instance.runHooks("beforeRedo",n)===!1)return;this.ignoreNewActions=!0;const i=this,o=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",o),e.redo(this.instance,()=>{i.ignoreNewActions=!1,i.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.instance.runHooks("afterRedo",n)}};Te.prototype.isUndoAvailable=function(){return this.doneActions.length>0};Te.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};Te.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};Te.prototype.isEnabled=function(){return this.enabled};Te.prototype.enable=function(){if(this.isEnabled())return;const t=this.instance;this.enabled=!0,Iae(t),this.registerShortcuts(),t.addHook("afterChange",dN)};Te.prototype.disable=function(){if(!this.isEnabled())return;const t=this.instance;this.enabled=!1,Pae(t),this.unregisterShortcuts(),t.removeHook("afterChange",dN)};Te.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};Te.Action=function(){};Te.Action.prototype.undo=function(){};Te.Action.prototype.redo=function(){};Te.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"};Bo(Te.ChangeAction,Te.Action);Te.ChangeAction.prototype.undo=function(t,e){const n=Vn(this.changes),r=t.countEmptyRows(!0),i=t.countEmptyCols(!0);for(let o=0,s=n.length;o<s;o++)n[o].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.undo");for(let o=0,s=n.length;o<s;o++){const[a,l]=n[o];t.getSettings().minSpareRows&&a+1+t.getSettings().minSpareRows===t.countRows()&&r===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(a+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&l+1+t.getSettings().minSpareCols===t.countCols()&&i===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(l+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}t.selectCells(this.selected,!1,!1)};Te.ChangeAction.prototype.redo=function(t,e){const n=Vn(this.changes);for(let r=0,i=n.length;r<i;r++)n[r].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)};Te.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"};Bo(Te.CreateRowAction,Te.Action);Te.CreateRowAction.prototype.undo=function(t,e){const n=t.countRows(),r=t.getSettings().minSpareRows;this.index>=n&&this.index-r<n&&(this.index-=r),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};Te.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};Te.RemoveRowAction=function(t,e,n,r,i){this.index=t,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=n,this.fixedRowsTop=r,this.rowIndexesSequence=i};Bo(Te.RemoveRowAction,Te.Action);Te.RemoveRowAction.prototype.undo=function(t,e){const n=t.getSettings(),r=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach((i,o)=>{Object.keys(i).forEach(s=>{const a=parseInt(s,10);r.push([this.index+o,isNaN(a)?s:a,i[s]])})}),t.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(r,null,null,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};Te.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};Te.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"};Bo(Te.CreateColumnAction,Te.Action);Te.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};Te.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};Te.RemoveColumnAction=function(t,e,n,r,i,o,s){this.index=t,this.indexes=e,this.data=n,this.amount=this.data[0].length,this.headers=r,this.columnPositions=i.slice(0),this.rowPositions=o.slice(0),this.actionType="remove_col",this.fixedColumnsStart=s};Bo(Te.RemoveColumnAction,Te.Action);Te.RemoveColumnAction.prototype.undo=function(t,e){const n=t.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;const r=this.indexes.slice(0).sort(),i=(u,c,d)=>d[this.indexes.indexOf(r[c])],o=this.data.length,s=[];for(let u=0;u<o;u++)s.push(Xe(this.data[u],i));const a=Xe(this.headers,i),l=[];t.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),H(t.getSourceDataArray(),(u,c)=>{H(r,(d,g)=>{u[d]=s[c][g],l.push([c,d,u[d]])})}),t.setSourceDataAtCell(l,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&H(a,(u,c)=>{t.getSettings().colHeaders[r[c]]=u}),t.batchExecution(()=>{t.rowIndexMapper.setIndexesSequence(this.rowPositions),t.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),t.addHookOnce("afterViewRender",e),t.render()};Te.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};Te.CellAlignmentAction=function(t,e,n,r){this.stateBefore=t,this.range=e,this.type=n,this.alignment=r};Te.CellAlignmentAction.prototype.undo=function(t,e){H(this.range,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&t.setCellMeta(r,i,"className",this.stateBefore[r][i]||" htLeft")})}),t.addHookOnce("afterViewRender",e),t.render()};Te.CellAlignmentAction.prototype.redo=function(t,e){ss(this.range,this.type,this.alignment,(n,r)=>t.getCellMeta(n,r),(n,r,i,o)=>t.setCellMeta(n,r,i,o)),t.addHookOnce("afterViewRender",e),t.render()};Te.FiltersAction=function(t){this.conditionsStack=t,this.actionType="filter"};Bo(Te.FiltersAction,Te.Action);Te.FiltersAction.prototype.undo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),n.filter()};Te.FiltersAction.prototype.redo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack),n.filter()};class Oae extends Te.Action{constructor(e,n){super(),this.cellRange=n;const r=this.cellRange.getTopStartCorner(),i=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(r.row,r.col,i.row,i.col)}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange)}}Te.MergeCellsAction=Oae;class Aae extends Te.Action{constructor(e,n){super(),this.cellRange=n}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange,!0)}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0),e.render()}}Te.UnmergeCellsAction=Aae;Te.RowMoveAction=function(t,e){this.rows=t.slice(),this.finalIndex=e,this.actionType="row_move"};Bo(Te.RowMoveAction,Te.Action);Te.RowMoveAction.prototype.undo=function(t,e){const n=t.getPlugin("manualRowMove"),r=[].concat(this.rows),i=r.filter(a=>a>this.finalIndex),o=r.filter(a=>a<=this.finalIndex),s=i.sort((a,l)=>l-a).concat(o.sort((a,l)=>a-l));t.addHookOnce("afterViewRender",e);for(let a=0;a<s.length;a+=1){const l=t.toVisualRow(s[a]);n.moveRow(l,s[a])}t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};Te.RowMoveAction.prototype.redo=function(t,e){const n=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),n.moveRows(this.rows.slice(),this.finalIndex),t.render(),t.deselectCell(),t.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};Te.prototype.init=function(){const t=this.instance.getSettings().undo,e=typeof t>"u"||t;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};Te.prototype.registerShortcuts=function(){const e=this.instance.getShortcutManager().getContext("grid"),r={runOnlyIf:i=>!i.altKey,group:hN};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],r)};Te.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(hN)};function dN(t,e){const n=this;if(e==="loadData")return n.undoRedo.clear()}function Iae(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}function Pae(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}const fh=_e.getSingleton();fh.add("afterUpdateSettings",function(){var t;(t=this.getPlugin("undoRedo"))===null||t===void 0||t.init()});fh.register("beforeUndo");fh.register("afterUndo");fh.register("beforeRedo");fh.register("afterRedo");Te.PLUGIN_KEY=Mae;Te.SETTING_KEYS=!0;function xae(){dt(hc),dt(d8),dt(dc),dt(U8),dt(Q8),dt(RH),dt(U7),dt(O5),dt(lm),dt(QZ),dt(bQ),dt(IQ),dt(cm),dt(rJ),dt(hte),dt(zte),dt(vne),dt(Pne),dt(Yne),dt(ore),dt(pre),dt(kre),dt(Kre),dt(Rie),dt(Qie),dt(roe),dt($oe),dt(Ase),dt(Jse),dt(lae),dt(gae),dt(Tae),dt(Te)}function Hae(){k6(),J6(),a9(),A9(),xae()}function Dae(t){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(n){const r=this.first();let i=r.data("handsontable");if(typeof n!="string"){const u=n||{};return i?i.updateSettings(u):(i=new t.Core(r[0],u),r.data("handsontable",i),i.init()),r}let o;if(i)if(typeof i[n]<"u"){for(var s=arguments.length,a=new Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];o=i[n].call(i,...a),n==="destroy"&&r.removeData()}else throw new Error(`Handsontable do not provide action: ${n}`);return o})}var Kw,qw,Xw,Zw,Qw;Hae();Dae(Be);Be.__GhostTable=Bb;Be._getListenersCounter=QG;Be._getRegisteredMapsCounter=gq;Be.EventManager=Mr;const Nae=[_Y,HG,eq,t9,Aj,gG,IY,gz,IG,xY,LG,fz],Lae=[cG,$G];Be.helper={};Be.dom={};H(Nae,t=>{H(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Be.helper[e]=t[e])})});H(Lae,t=>{H(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Be.dom[e]=t[e])})});Be.cellTypes=(Kw=Be.cellTypes)!==null&&Kw!==void 0?Kw:{};H(DX(),t=>{Be.cellTypes[t]=Ob(t)});Be.cellTypes.registerCellType=$r;Be.cellTypes.getCellType=Ob;Be.editors=(qw=Be.editors)!==null&&qw!==void 0?qw:{};H(GG(),t=>{Be.editors[`${Wn(t)}Editor`]=xf(t)});Be.editors.registerEditor=dr;Be.editors.getEditor=xf;Be.renderers=(Xw=Be.renderers)!==null&&Xw!==void 0?Xw:{};H(Az(),t=>{const e=Nf(t);t==="base"&&(Be.renderers.cellDecorator=e),Be.renderers[`${Wn(t)}Renderer`]=e});Be.renderers.registerRenderer=ki;Be.renderers.getRenderer=Nf;Be.validators=(Zw=Be.validators)!==null&&Zw!==void 0?Zw:{};H(xz(),t=>{Be.validators[`${Wn(t)}Validator`]=OS(t)});Be.validators.registerValidator=Il;Be.validators.getValidator=OS;Be.plugins=(Qw=Be.plugins)!==null&&Qw!==void 0?Qw:{};H(MS(),t=>{Be.plugins[t]=nh(t)});Be.plugins[`${Wn(gt.PLUGIN_KEY)}Plugin`]=gt;Be.plugins.registerPlugin=dt;Be.plugins.getPlugin=nh;class $ae extends Be.editors.BaseEditor{init(){this.select=this.hot.rootDocument.createElement("div"),this.select.classList.add("htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select)}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.close(),this.row=e,this.col=n,this.originalValue=o,this.renderStyle=this.cellProperties.renderStyle,this.renderNode=this.cellProperties.renderNode,this.renderNode(null)}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){const{top:e,start:n,width:r,height:i}=this.getEditedCellRect(),o=this.select.style;this.cellProperties.afterRenderEdit(this.row,this.col,this.originalValue,this.hot,this),this._opened=!0,this.renderNode(this.cellProperties.editorReactNode,{row:this.row,col:this.col,hot:this.hot,originalValue:this.originalValue}),o.height=`${i}px`,o.minWidth=`${r}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${n}px`,o.margin="0px",o.display="",this.renderStyle(o)}focus(){this.select.focus()}close(){this.isClose&&(this._opened=!1,this.select.style.display="none",this.renderStyle(this.select.style),this.renderNode(null),delete this.isClose),typeof this.isClose>"u"&&(this.select.style.display="none",this.renderStyle&&this.renderStyle(this.select.style))}}const fN=sn.createContext({});var kae=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,Jw=Math.ceil,Nr=Math.floor,cr="[BigNumber Error] ",JA=cr+"Number primitive has more than 15 significant digits: ",si=1e14,Ke=14,eC=9007199254740991,tC=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],is=1e7,En=1e9;function gN(t){var e,n,r,i=y.prototype={constructor:y,toString:null,valueOf:null},o=new y(1),s=20,a=4,l=-7,u=21,c=-1e7,d=1e7,g=!1,p=1,C=0,E={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},I="0123456789abcdefghijklmnopqrstuvwxyz",M=!0;function y(v,S){var b,L,P,x,W,D,B,z,w=this;if(!(w instanceof y))return new y(v,S);if(S==null){if(v&&v._isBigNumber===!0){w.s=v.s,!v.c||v.e>d?w.c=w.e=null:v.e<c?w.c=[w.e=0]:(w.e=v.e,w.c=v.c.slice());return}if((D=typeof v=="number")&&v*0==0){if(w.s=1/v<0?(v=-v,-1):1,v===~~v){for(x=0,W=v;W>=10;W/=10,x++);x>d?w.c=w.e=null:(w.e=x,w.c=[v]);return}z=String(v)}else{if(!kae.test(z=String(v)))return r(w,z,D);w.s=z.charCodeAt(0)==45?(z=z.slice(1),-1):1}(x=z.indexOf("."))>-1&&(z=z.replace(".","")),(W=z.search(/e/i))>0?(x<0&&(x=W),x+=+z.slice(W+1),z=z.substring(0,W)):x<0&&(x=z.length)}else{if(zt(S,2,I.length,"Base"),S==10&&M)return w=new y(v),X(w,s+w.e+1,a);if(z=String(v),D=typeof v=="number"){if(v*0!=0)return r(w,z,D,S);if(w.s=1/v<0?(z=z.slice(1),-1):1,y.DEBUG&&z.replace(/^0\.0*|\./,"").length>15)throw Error(JA+v)}else w.s=z.charCodeAt(0)===45?(z=z.slice(1),-1):1;for(b=I.slice(0,S),x=W=0,B=z.length;W<B;W++)if(b.indexOf(L=z.charAt(W))<0){if(L=="."){if(W>x){x=B;continue}}else if(!P&&(z==z.toUpperCase()&&(z=z.toLowerCase())||z==z.toLowerCase()&&(z=z.toUpperCase()))){P=!0,W=-1,x=0;continue}return r(w,String(v),D,S)}D=!1,z=n(z,S,10,w.s),(x=z.indexOf("."))>-1?z=z.replace(".",""):x=z.length}for(W=0;z.charCodeAt(W)===48;W++);for(B=z.length;z.charCodeAt(--B)===48;);if(z=z.slice(W,++B)){if(B-=W,D&&y.DEBUG&&B>15&&(v>eC||v!==Nr(v)))throw Error(JA+w.s*v);if((x=x-W-1)>d)w.c=w.e=null;else if(x<c)w.c=[w.e=0];else{if(w.e=x,w.c=[],W=(x+1)%Ke,x<0&&(W+=Ke),W<B){for(W&&w.c.push(+z.slice(0,W)),B-=Ke;W<B;)w.c.push(+z.slice(W,W+=Ke));W=Ke-(z=z.slice(W)).length}else W-=B;for(;W--;z+="0");w.c.push(+z)}}else w.c=[w.e=0]}y.clone=gN,y.ROUND_UP=0,y.ROUND_DOWN=1,y.ROUND_CEIL=2,y.ROUND_FLOOR=3,y.ROUND_HALF_UP=4,y.ROUND_HALF_DOWN=5,y.ROUND_HALF_EVEN=6,y.ROUND_HALF_CEIL=7,y.ROUND_HALF_FLOOR=8,y.EUCLID=9,y.config=y.set=function(v){var S,b;if(v!=null)if(typeof v=="object"){if(v.hasOwnProperty(S="DECIMAL_PLACES")&&(b=v[S],zt(b,0,En,S),s=b),v.hasOwnProperty(S="ROUNDING_MODE")&&(b=v[S],zt(b,0,8,S),a=b),v.hasOwnProperty(S="EXPONENTIAL_AT")&&(b=v[S],b&&b.pop?(zt(b[0],-En,0,S),zt(b[1],0,En,S),l=b[0],u=b[1]):(zt(b,-En,En,S),l=-(u=b<0?-b:b))),v.hasOwnProperty(S="RANGE"))if(b=v[S],b&&b.pop)zt(b[0],-En,-1,S),zt(b[1],1,En,S),c=b[0],d=b[1];else if(zt(b,-En,En,S),b)c=-(d=b<0?-b:b);else throw Error(cr+S+" cannot be zero: "+b);if(v.hasOwnProperty(S="CRYPTO"))if(b=v[S],b===!!b)if(b)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))g=b;else throw g=!b,Error(cr+"crypto unavailable");else g=b;else throw Error(cr+S+" not true or false: "+b);if(v.hasOwnProperty(S="MODULO_MODE")&&(b=v[S],zt(b,0,9,S),p=b),v.hasOwnProperty(S="POW_PRECISION")&&(b=v[S],zt(b,0,En,S),C=b),v.hasOwnProperty(S="FORMAT"))if(b=v[S],typeof b=="object")E=b;else throw Error(cr+S+" not an object: "+b);if(v.hasOwnProperty(S="ALPHABET"))if(b=v[S],typeof b=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(b))M=b.slice(0,10)=="0123456789",I=b;else throw Error(cr+S+" invalid: "+b)}else throw Error(cr+"Object expected: "+v);return{DECIMAL_PLACES:s,ROUNDING_MODE:a,EXPONENTIAL_AT:[l,u],RANGE:[c,d],CRYPTO:g,MODULO_MODE:p,POW_PRECISION:C,FORMAT:E,ALPHABET:I}},y.isBigNumber=function(v){if(!v||v._isBigNumber!==!0)return!1;if(!y.DEBUG)return!0;var S,b,L=v.c,P=v.e,x=v.s;e:if({}.toString.call(L)=="[object Array]"){if((x===1||x===-1)&&P>=-En&&P<=En&&P===Nr(P)){if(L[0]===0){if(P===0&&L.length===1)return!0;break e}if(S=(P+1)%Ke,S<1&&(S+=Ke),String(L[0]).length==S){for(S=0;S<L.length;S++)if(b=L[S],b<0||b>=si||b!==Nr(b))break e;if(b!==0)return!0}}}else if(L===null&&P===null&&(x===null||x===1||x===-1))return!0;throw Error(cr+"Invalid BigNumber: "+v)},y.maximum=y.max=function(){return q(arguments,-1)},y.minimum=y.min=function(){return q(arguments,1)},y.random=function(){var v=9007199254740992,S=Math.random()*v&2097151?function(){return Nr(Math.random()*v)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(b){var L,P,x,W,D,B=0,z=[],w=new y(o);if(b==null?b=s:zt(b,0,En),W=Jw(b/Ke),g)if(crypto.getRandomValues){for(L=crypto.getRandomValues(new Uint32Array(W*=2));B<W;)D=L[B]*131072+(L[B+1]>>>11),D>=9e15?(P=crypto.getRandomValues(new Uint32Array(2)),L[B]=P[0],L[B+1]=P[1]):(z.push(D%1e14),B+=2);B=W/2}else if(crypto.randomBytes){for(L=crypto.randomBytes(W*=7);B<W;)D=(L[B]&31)*281474976710656+L[B+1]*1099511627776+L[B+2]*4294967296+L[B+3]*16777216+(L[B+4]<<16)+(L[B+5]<<8)+L[B+6],D>=9e15?crypto.randomBytes(7).copy(L,B):(z.push(D%1e14),B+=7);B=W/7}else throw g=!1,Error(cr+"crypto unavailable");if(!g)for(;B<W;)D=S(),D<9e15&&(z[B++]=D%1e14);for(W=z[--B],b%=Ke,W&&b&&(D=tC[Ke-b],z[B]=Nr(W/D)*D);z[B]===0;z.pop(),B--);if(B<0)z=[x=0];else{for(x=-1;z[0]===0;z.splice(0,1),x-=Ke);for(B=1,D=z[0];D>=10;D/=10,B++);B<Ke&&(x-=Ke-B)}return w.e=x,w.c=z,w}}(),y.sum=function(){for(var v=1,S=arguments,b=new y(S[0]);v<S.length;)b=b.plus(S[v++]);return b},n=function(){var v="0123456789";function S(b,L,P,x){for(var W,D=[0],B,z=0,w=b.length;z<w;){for(B=D.length;B--;D[B]*=L);for(D[0]+=x.indexOf(b.charAt(z++)),W=0;W<D.length;W++)D[W]>P-1&&(D[W+1]==null&&(D[W+1]=0),D[W+1]+=D[W]/P|0,D[W]%=P)}return D.reverse()}return function(b,L,P,x,W){var D,B,z,w,h,f,m,T,O=b.indexOf("."),_=s,Y=a;for(O>=0&&(w=C,C=0,b=b.replace(".",""),T=new y(L),f=T.pow(b.length-O),C=w,T.c=S(wo(Dr(f.c),f.e,"0"),10,P,v),T.e=T.c.length),m=S(b,L,P,W?(D=I,v):(D=v,I)),z=w=m.length;m[--w]==0;m.pop());if(!m[0])return D.charAt(0);if(O<0?--z:(f.c=m,f.e=z,f.s=x,f=e(f,T,_,Y,P),m=f.c,h=f.r,z=f.e),B=z+_+1,O=m[B],w=P/2,h=h||B<0||m[B+1]!=null,h=Y<4?(O!=null||h)&&(Y==0||Y==(f.s<0?3:2)):O>w||O==w&&(Y==4||h||Y==6&&m[B-1]&1||Y==(f.s<0?8:7)),B<1||!m[0])b=h?wo(D.charAt(1),-_,D.charAt(0)):D.charAt(0);else{if(m.length=B,h)for(--P;++m[--B]>P;)m[B]=0,B||(++z,m=[1].concat(m));for(w=m.length;!m[--w];);for(O=0,b="";O<=w;b+=D.charAt(m[O++]));b=wo(b,z,D.charAt(0))}return b}}(),e=function(){function v(L,P,x){var W,D,B,z,w=0,h=L.length,f=P%is,m=P/is|0;for(L=L.slice();h--;)B=L[h]%is,z=L[h]/is|0,W=m*B+z*f,D=f*B+W%is*is+w,w=(D/x|0)+(W/is|0)+m*z,L[h]=D%x;return w&&(L=[w].concat(L)),L}function S(L,P,x,W){var D,B;if(x!=W)B=x>W?1:-1;else for(D=B=0;D<x;D++)if(L[D]!=P[D]){B=L[D]>P[D]?1:-1;break}return B}function b(L,P,x,W){for(var D=0;x--;)L[x]-=D,D=L[x]<P[x]?1:0,L[x]=D*W+L[x]-P[x];for(;!L[0]&&L.length>1;L.splice(0,1));}return function(L,P,x,W,D){var B,z,w,h,f,m,T,O,_,Y,U,ie,se,oe,de,Ce,pe,we=L.s==P.s?1:-1,ee=L.c,ye=P.c;if(!ee||!ee[0]||!ye||!ye[0])return new y(!L.s||!P.s||(ee?ye&&ee[0]==ye[0]:!ye)?NaN:ee&&ee[0]==0||!ye?we*0:we/0);for(O=new y(we),_=O.c=[],z=L.e-P.e,we=x+z+1,D||(D=si,z=Lr(L.e/Ke)-Lr(P.e/Ke),we=we/Ke|0),w=0;ye[w]==(ee[w]||0);w++);if(ye[w]>(ee[w]||0)&&z--,we<0)_.push(1),h=!0;else{for(oe=ee.length,Ce=ye.length,w=0,we+=2,f=Nr(D/(ye[0]+1)),f>1&&(ye=v(ye,f,D),ee=v(ee,f,D),Ce=ye.length,oe=ee.length),se=Ce,Y=ee.slice(0,Ce),U=Y.length;U<Ce;Y[U++]=0);pe=ye.slice(),pe=[0].concat(pe),de=ye[0],ye[1]>=D/2&&de++;do{if(f=0,B=S(ye,Y,Ce,U),B<0){if(ie=Y[0],Ce!=U&&(ie=ie*D+(Y[1]||0)),f=Nr(ie/de),f>1)for(f>=D&&(f=D-1),m=v(ye,f,D),T=m.length,U=Y.length;S(m,Y,T,U)==1;)f--,b(m,Ce<T?pe:ye,T,D),T=m.length,B=1;else f==0&&(B=f=1),m=ye.slice(),T=m.length;if(T<U&&(m=[0].concat(m)),b(Y,m,U,D),U=Y.length,B==-1)for(;S(ye,Y,Ce,U)<1;)f++,b(Y,Ce<U?pe:ye,U,D),U=Y.length}else B===0&&(f++,Y=[0]);_[w++]=f,Y[0]?Y[U++]=ee[se]||0:(Y=[ee[se]],U=1)}while((se++<oe||Y[0]!=null)&&we--);h=Y[0]!=null,_[0]||_.splice(0,1)}if(D==si){for(w=1,we=_[0];we>=10;we/=10,w++);X(O,x+(O.e=w+z*Ke-1)+1,W,h)}else O.e=z,O.r=+h;return O}}();function $(v,S,b,L){var P,x,W,D,B;if(b==null?b=a:zt(b,0,8),!v.c)return v.toString();if(P=v.c[0],W=v.e,S==null)B=Dr(v.c),B=L==1||L==2&&(W<=l||W>=u)?Wd(B,W):wo(B,W,"0");else if(v=X(new y(v),S,b),x=v.e,B=Dr(v.c),D=B.length,L==1||L==2&&(S<=x||x<=l)){for(;D<S;B+="0",D++);B=Wd(B,x)}else if(S-=W,B=wo(B,x,"0"),x+1>D){if(--S>0)for(B+=".";S--;B+="0");}else if(S+=x-D,S>0)for(x+1==D&&(B+=".");S--;B+="0");return v.s<0&&P?"-"+B:B}function q(v,S){for(var b,L,P=1,x=new y(v[0]);P<v.length;P++)L=new y(v[P]),(!L.s||(b=ua(x,L))===S||b===0&&x.s===S)&&(x=L);return x}function G(v,S,b){for(var L=1,P=S.length;!S[--P];S.pop());for(P=S[0];P>=10;P/=10,L++);return(b=L+b*Ke-1)>d?v.c=v.e=null:b<c?v.c=[v.e=0]:(v.e=b,v.c=S),v}r=function(){var v=/^(-?)0([xbo])(?=\w[\w.]*$)/i,S=/^([^.]+)\.$/,b=/^\.([^.]+)$/,L=/^-?(Infinity|NaN)$/,P=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(x,W,D,B){var z,w=D?W:W.replace(P,"");if(L.test(w))x.s=isNaN(w)?null:w<0?-1:1;else{if(!D&&(w=w.replace(v,function(h,f,m){return z=(m=m.toLowerCase())=="x"?16:m=="b"?2:8,!B||B==z?f:h}),B&&(z=B,w=w.replace(S,"$1").replace(b,"0.$1")),W!=w))return new y(w,z);if(y.DEBUG)throw Error(cr+"Not a"+(B?" base "+B:"")+" number: "+W);x.s=null}x.c=x.e=null}}();function X(v,S,b,L){var P,x,W,D,B,z,w,h=v.c,f=tC;if(h){e:{for(P=1,D=h[0];D>=10;D/=10,P++);if(x=S-P,x<0)x+=Ke,W=S,B=h[z=0],w=Nr(B/f[P-W-1]%10);else if(z=Jw((x+1)/Ke),z>=h.length)if(L){for(;h.length<=z;h.push(0));B=w=0,P=1,x%=Ke,W=x-Ke+1}else break e;else{for(B=D=h[z],P=1;D>=10;D/=10,P++);x%=Ke,W=x-Ke+P,w=W<0?0:Nr(B/f[P-W-1]%10)}if(L=L||S<0||h[z+1]!=null||(W<0?B:B%f[P-W-1]),L=b<4?(w||L)&&(b==0||b==(v.s<0?3:2)):w>5||w==5&&(b==4||L||b==6&&(x>0?W>0?B/f[P-W]:0:h[z-1])%10&1||b==(v.s<0?8:7)),S<1||!h[0])return h.length=0,L?(S-=v.e+1,h[0]=f[(Ke-S%Ke)%Ke],v.e=-S||0):h[0]=v.e=0,v;if(x==0?(h.length=z,D=1,z--):(h.length=z+1,D=f[Ke-x],h[z]=W>0?Nr(B/f[P-W]%f[W])*D:0),L)for(;;)if(z==0){for(x=1,W=h[0];W>=10;W/=10,x++);for(W=h[0]+=D,D=1;W>=10;W/=10,D++);x!=D&&(v.e++,h[0]==si&&(h[0]=1));break}else{if(h[z]+=D,h[z]!=si)break;h[z--]=0,D=1}for(x=h.length;h[--x]===0;h.pop());}v.e>d?v.c=v.e=null:v.e<c&&(v.c=[v.e=0])}return v}function re(v){var S,b=v.e;return b===null?v.toString():(S=Dr(v.c),S=b<=l||b>=u?Wd(S,b):wo(S,b,"0"),v.s<0?"-"+S:S)}return i.absoluteValue=i.abs=function(){var v=new y(this);return v.s<0&&(v.s=1),v},i.comparedTo=function(v,S){return ua(this,new y(v,S))},i.decimalPlaces=i.dp=function(v,S){var b,L,P,x=this;if(v!=null)return zt(v,0,En),S==null?S=a:zt(S,0,8),X(new y(x),v+x.e+1,S);if(!(b=x.c))return null;if(L=((P=b.length-1)-Lr(this.e/Ke))*Ke,P=b[P])for(;P%10==0;P/=10,L--);return L<0&&(L=0),L},i.dividedBy=i.div=function(v,S){return e(this,new y(v,S),s,a)},i.dividedToIntegerBy=i.idiv=function(v,S){return e(this,new y(v,S),0,1)},i.exponentiatedBy=i.pow=function(v,S){var b,L,P,x,W,D,B,z,w,h=this;if(v=new y(v),v.c&&!v.isInteger())throw Error(cr+"Exponent not an integer: "+re(v));if(S!=null&&(S=new y(S)),D=v.e>14,!h.c||!h.c[0]||h.c[0]==1&&!h.e&&h.c.length==1||!v.c||!v.c[0])return w=new y(Math.pow(+re(h),D?v.s*(2-Fd(v)):+re(v))),S?w.mod(S):w;if(B=v.s<0,S){if(S.c?!S.c[0]:!S.s)return new y(NaN);L=!B&&h.isInteger()&&S.isInteger(),L&&(h=h.mod(S))}else{if(v.e>9&&(h.e>0||h.e<-1||(h.e==0?h.c[0]>1||D&&h.c[1]>=24e7:h.c[0]<8e13||D&&h.c[0]<=9999975e7)))return x=h.s<0&&Fd(v)?-0:0,h.e>-1&&(x=1/x),new y(B?1/x:x);C&&(x=Jw(C/Ke+2))}for(D?(b=new y(.5),B&&(v.s=1),z=Fd(v)):(P=Math.abs(+re(v)),z=P%2),w=new y(o);;){if(z){if(w=w.times(h),!w.c)break;x?w.c.length>x&&(w.c.length=x):L&&(w=w.mod(S))}if(P){if(P=Nr(P/2),P===0)break;z=P%2}else if(v=v.times(b),X(v,v.e+1,1),v.e>14)z=Fd(v);else{if(P=+re(v),P===0)break;z=P%2}h=h.times(h),x?h.c&&h.c.length>x&&(h.c.length=x):L&&(h=h.mod(S))}return L?w:(B&&(w=o.div(w)),S?w.mod(S):x?X(w,C,a,W):w)},i.integerValue=function(v){var S=new y(this);return v==null?v=a:zt(v,0,8),X(S,S.e+1,v)},i.isEqualTo=i.eq=function(v,S){return ua(this,new y(v,S))===0},i.isFinite=function(){return!!this.c},i.isGreaterThan=i.gt=function(v,S){return ua(this,new y(v,S))>0},i.isGreaterThanOrEqualTo=i.gte=function(v,S){return(S=ua(this,new y(v,S)))===1||S===0},i.isInteger=function(){return!!this.c&&Lr(this.e/Ke)>this.c.length-2},i.isLessThan=i.lt=function(v,S){return ua(this,new y(v,S))<0},i.isLessThanOrEqualTo=i.lte=function(v,S){return(S=ua(this,new y(v,S)))===-1||S===0},i.isNaN=function(){return!this.s},i.isNegative=function(){return this.s<0},i.isPositive=function(){return this.s>0},i.isZero=function(){return!!this.c&&this.c[0]==0},i.minus=function(v,S){var b,L,P,x,W=this,D=W.s;if(v=new y(v,S),S=v.s,!D||!S)return new y(NaN);if(D!=S)return v.s=-S,W.plus(v);var B=W.e/Ke,z=v.e/Ke,w=W.c,h=v.c;if(!B||!z){if(!w||!h)return w?(v.s=-S,v):new y(h?W:NaN);if(!w[0]||!h[0])return h[0]?(v.s=-S,v):new y(w[0]?W:a==3?-0:0)}if(B=Lr(B),z=Lr(z),w=w.slice(),D=B-z){for((x=D<0)?(D=-D,P=w):(z=B,P=h),P.reverse(),S=D;S--;P.push(0));P.reverse()}else for(L=(x=(D=w.length)<(S=h.length))?D:S,D=S=0;S<L;S++)if(w[S]!=h[S]){x=w[S]<h[S];break}if(x&&(P=w,w=h,h=P,v.s=-v.s),S=(L=h.length)-(b=w.length),S>0)for(;S--;w[b++]=0);for(S=si-1;L>D;){if(w[--L]<h[L]){for(b=L;b&&!w[--b];w[b]=S);--w[b],w[L]+=si}w[L]-=h[L]}for(;w[0]==0;w.splice(0,1),--z);return w[0]?G(v,w,z):(v.s=a==3?-1:1,v.c=[v.e=0],v)},i.modulo=i.mod=function(v,S){var b,L,P=this;return v=new y(v,S),!P.c||!v.s||v.c&&!v.c[0]?new y(NaN):!v.c||P.c&&!P.c[0]?new y(P):(p==9?(L=v.s,v.s=1,b=e(P,v,0,3),v.s=L,b.s*=L):b=e(P,v,0,p),v=P.minus(b.times(v)),!v.c[0]&&p==1&&(v.s=P.s),v)},i.multipliedBy=i.times=function(v,S){var b,L,P,x,W,D,B,z,w,h,f,m,T,O,_,Y=this,U=Y.c,ie=(v=new y(v,S)).c;if(!U||!ie||!U[0]||!ie[0])return!Y.s||!v.s||U&&!U[0]&&!ie||ie&&!ie[0]&&!U?v.c=v.e=v.s=null:(v.s*=Y.s,!U||!ie?v.c=v.e=null:(v.c=[0],v.e=0)),v;for(L=Lr(Y.e/Ke)+Lr(v.e/Ke),v.s*=Y.s,B=U.length,h=ie.length,B<h&&(T=U,U=ie,ie=T,P=B,B=h,h=P),P=B+h,T=[];P--;T.push(0));for(O=si,_=is,P=h;--P>=0;){for(b=0,f=ie[P]%_,m=ie[P]/_|0,W=B,x=P+W;x>P;)z=U[--W]%_,w=U[W]/_|0,D=m*z+w*f,z=f*z+D%_*_+T[x]+b,b=(z/O|0)+(D/_|0)+m*w,T[x--]=z%O;T[x]=b}return b?++L:T.splice(0,1),G(v,T,L)},i.negated=function(){var v=new y(this);return v.s=-v.s||null,v},i.plus=function(v,S){var b,L=this,P=L.s;if(v=new y(v,S),S=v.s,!P||!S)return new y(NaN);if(P!=S)return v.s=-S,L.minus(v);var x=L.e/Ke,W=v.e/Ke,D=L.c,B=v.c;if(!x||!W){if(!D||!B)return new y(P/0);if(!D[0]||!B[0])return B[0]?v:new y(D[0]?L:P*0)}if(x=Lr(x),W=Lr(W),D=D.slice(),P=x-W){for(P>0?(W=x,b=B):(P=-P,b=D),b.reverse();P--;b.push(0));b.reverse()}for(P=D.length,S=B.length,P-S<0&&(b=B,B=D,D=b,S=P),P=0;S;)P=(D[--S]=D[S]+B[S]+P)/si|0,D[S]=si===D[S]?0:D[S]%si;return P&&(D=[P].concat(D),++W),G(v,D,W)},i.precision=i.sd=function(v,S){var b,L,P,x=this;if(v!=null&&v!==!!v)return zt(v,1,En),S==null?S=a:zt(S,0,8),X(new y(x),v,S);if(!(b=x.c))return null;if(P=b.length-1,L=P*Ke+1,P=b[P]){for(;P%10==0;P/=10,L--);for(P=b[0];P>=10;P/=10,L++);}return v&&x.e+1>L&&(L=x.e+1),L},i.shiftedBy=function(v){return zt(v,-eC,eC),this.times("1e"+v)},i.squareRoot=i.sqrt=function(){var v,S,b,L,P,x=this,W=x.c,D=x.s,B=x.e,z=s+4,w=new y("0.5");if(D!==1||!W||!W[0])return new y(!D||D<0&&(!W||W[0])?NaN:W?x:1/0);if(D=Math.sqrt(+re(x)),D==0||D==1/0?(S=Dr(W),(S.length+B)%2==0&&(S+="0"),D=Math.sqrt(+S),B=Lr((B+1)/2)-(B<0||B%2),D==1/0?S="5e"+B:(S=D.toExponential(),S=S.slice(0,S.indexOf("e")+1)+B),b=new y(S)):b=new y(D+""),b.c[0]){for(B=b.e,D=B+z,D<3&&(D=0);;)if(P=b,b=w.times(P.plus(e(x,P,z,1))),Dr(P.c).slice(0,D)===(S=Dr(b.c)).slice(0,D))if(b.e<B&&--D,S=S.slice(D-3,D+1),S=="9999"||!L&&S=="4999"){if(!L&&(X(P,P.e+s+2,0),P.times(P).eq(x))){b=P;break}z+=4,D+=4,L=1}else{(!+S||!+S.slice(1)&&S.charAt(0)=="5")&&(X(b,b.e+s+2,1),v=!b.times(b).eq(x));break}}return X(b,b.e+s+1,a,v)},i.toExponential=function(v,S){return v!=null&&(zt(v,0,En),v++),$(this,v,S,1)},i.toFixed=function(v,S){return v!=null&&(zt(v,0,En),v=v+this.e+1),$(this,v,S)},i.toFormat=function(v,S,b){var L,P=this;if(b==null)v!=null&&S&&typeof S=="object"?(b=S,S=null):v&&typeof v=="object"?(b=v,v=S=null):b=E;else if(typeof b!="object")throw Error(cr+"Argument not an object: "+b);if(L=P.toFixed(v,S),P.c){var x,W=L.split("."),D=+b.groupSize,B=+b.secondaryGroupSize,z=b.groupSeparator||"",w=W[0],h=W[1],f=P.s<0,m=f?w.slice(1):w,T=m.length;if(B&&(x=D,D=B,B=x,T-=x),D>0&&T>0){for(x=T%D||D,w=m.substr(0,x);x<T;x+=D)w+=z+m.substr(x,D);B>0&&(w+=z+m.slice(x)),f&&(w="-"+w)}L=h?w+(b.decimalSeparator||"")+((B=+b.fractionGroupSize)?h.replace(new RegExp("\\d{"+B+"}\\B","g"),"$&"+(b.fractionGroupSeparator||"")):h):w}return(b.prefix||"")+L+(b.suffix||"")},i.toFraction=function(v){var S,b,L,P,x,W,D,B,z,w,h,f,m=this,T=m.c;if(v!=null&&(D=new y(v),!D.isInteger()&&(D.c||D.s!==1)||D.lt(o)))throw Error(cr+"Argument "+(D.isInteger()?"out of range: ":"not an integer: ")+re(D));if(!T)return new y(m);for(S=new y(o),z=b=new y(o),L=B=new y(o),f=Dr(T),x=S.e=f.length-m.e-1,S.c[0]=tC[(W=x%Ke)<0?Ke+W:W],v=!v||D.comparedTo(S)>0?x>0?S:z:D,W=d,d=1/0,D=new y(f),B.c[0]=0;w=e(D,S,0,1),P=b.plus(w.times(L)),P.comparedTo(v)!=1;)b=L,L=P,z=B.plus(w.times(P=z)),B=P,S=D.minus(w.times(P=S)),D=P;return P=e(v.minus(b),L,0,1),B=B.plus(P.times(z)),b=b.plus(P.times(L)),B.s=z.s=m.s,x=x*2,h=e(z,L,x,a).minus(m).abs().comparedTo(e(B,b,x,a).minus(m).abs())<1?[z,L]:[B,b],d=W,h},i.toNumber=function(){return+re(this)},i.toPrecision=function(v,S){return v!=null&&zt(v,1,En),$(this,v,S,2)},i.toString=function(v){var S,b=this,L=b.s,P=b.e;return P===null?L?(S="Infinity",L<0&&(S="-"+S)):S="NaN":(v==null?S=P<=l||P>=u?Wd(Dr(b.c),P):wo(Dr(b.c),P,"0"):v===10&&M?(b=X(new y(b),s+P+1,a),S=wo(Dr(b.c),b.e,"0")):(zt(v,2,I.length,"Base"),S=n(wo(Dr(b.c),P,"0"),10,v,L,!0)),L<0&&b.c[0]&&(S="-"+S)),S},i.valueOf=i.toJSON=function(){return re(this)},i._isBigNumber=!0,i[Symbol.toStringTag]="BigNumber",i[Symbol.for("nodejs.util.inspect.custom")]=i.valueOf,t!=null&&y.set(t),y}function Lr(t){var e=t|0;return t>0||t===e?e:e-1}function Dr(t){for(var e,n,r=1,i=t.length,o=t[0]+"";r<i;){for(e=t[r++]+"",n=Ke-e.length;n--;e="0"+e);o+=e}for(i=o.length;o.charCodeAt(--i)===48;);return o.slice(0,i+1||1)}function ua(t,e){var n,r,i=t.c,o=e.c,s=t.s,a=e.s,l=t.e,u=e.e;if(!s||!a)return null;if(n=i&&!i[0],r=o&&!o[0],n||r)return n?r?0:-a:s;if(s!=a)return s;if(n=s<0,r=l==u,!i||!o)return r?0:!i^n?1:-1;if(!r)return l>u^n?1:-1;for(a=(l=i.length)<(u=o.length)?l:u,s=0;s<a;s++)if(i[s]!=o[s])return i[s]>o[s]^n?1:-1;return l==u?0:l>u^n?1:-1}function zt(t,e,n,r){if(t<e||t>n||t!==Nr(t))throw Error(cr+(r||"Argument")+(typeof t=="number"?t<e||t>n?" out of range: ":" not an integer: ":" not a primitive number: ")+String(t))}function Fd(t){var e=t.c.length-1;return Lr(t.e/Ke)==e&&t.c[e]%2!=0}function Wd(t,e){return(t.length>1?t.charAt(0)+"."+t.slice(1):t)+(e<0?"e":"e+")+e}function wo(t,e,n){var r,i;if(e<0){for(i=n+".";++e;i+=n);t=i+t}else if(r=t.length,++e>r){for(i=n,e-=r;--e;i+=n);t+=i}else e<r&&(t=t.slice(0,e)+"."+t.slice(e));return t}var Vd=gN();const Fae=t=>{const e=sn.useRef([]),n=sn.useRef(null),r=sn.useRef(),[i,o]=sn.useState(),[s,a]=sn.useState(),[l,u]=sn.useState(),c=sn.useRef();let d={};const[g,p]=sn.useState([]),[C,E]=sn.useState(),[I,M]=sn.useState(!1),[y,$]=sn.useState(0),[q,G]=sn.useState(0),[X,re]=sn.useState(0),[v,S]=sn.useState(0),[b,L]=sn.useState(0),[P,x]=sn.useState(0);sn.useEffect(()=>{z()},[t.data]);const W=(T,O,_,Y,U)=>{u({row:T,col:O,hot:Y,originalValue:_}),c.current=U},D=(T,O)=>{let _=T;T!=null&&(_=sn.cloneElement(T,O)),o(_)},B=T=>{const O={};for(let _ in T)parseInt(_).toString()=="NaN"&&T.hasOwnProperty(_)&&T[_]!=""&&(O[_.replace(/-([a-z])/gi,Y=>Y[1].toUpperCase())]=T[_]);a(O)},z=()=>{e.current=[];let T=[...t.columns];if(t.selected){let _={title:"",width:60,className:"center",editor:!1,copyable:!1,rendereCell:(Y,U)=>au(uR.Checkbox,{disabled:U.readOnly,defaultChecked:Y,onChange:ie=>m(ie,U)})};t.isData&&(_={..._,data:"selected"}),T.unshift(_)}const O={wordWrap:!1};T.forEach(_=>{let Y={...O,..._};_.editorReactNode&&(Y.editor=$ae,Y.renderNode=D,Y.renderStyle=B,Y.afterRenderEdit=W),_.rendereCell&&(Y.renderer=(U,ie,se,oe,de,Ce,pe)=>{let we=ie.firstChild,ee=document.createElement("div");return ee.setAttribute("last-data",Ce),we?we.getAttribute("last-data")!=Ce.toString()&&(d[`index-${se}${oe}`]={td:ee,node:_.rendereCell(Ce,pe)},ie.replaceChild(ee,we)):(d[`index-${se}${oe}`]={td:ee,node:_.rendereCell(Ce,pe)},ie.appendChild(ee)),pe.className&&ie.classList.add(pe.className),pe.required&&ie.classList.add("is-required"),ie}),_.required&&(_.className=_.className?`${_.className} is-required`:"is-required",_.title=`<span class="is-required">${_.title}</span>`),e.current.push(Y)}),!(!t.data||t.data.length==0)&&(t.selected&&t.data.forEach(_=>{t.isData?_.selected=!1:_.unshift(!1)}),r.current=new Be(n.current,{data:!t.data||t.data.length==0?[]:t.data,columns:e.current,rowHeaders:!0,columnHeaderHeight:40,rowHeights:40,licenseKey:"non-commercial-and-evaluation",afterRender:_=>{let Y=[];Object.keys(d).map(U=>{Y.push(d[U])}),setTimeout(()=>{p(Y)},0)},afterGetColHeader:(_,Y,U)=>{if(t.selected&&_==0){let ie=document.createElement("div");Y.firstChild.firstChild.innerHTML="",Y.firstChild.firstChild.appendChild(ie),E(ie)}},afterSelection:(_,Y,U,ie,se,oe)=>{let de=r.current.getSelected();if((de==null?void 0:de.length)>0){$(de[0][2]-de[0][0]+1),G(de[0][3]-de[0][1]+1);let Ce=r.current.getSourceDataArray(de[0][0],de[0][1],de[0][2],de[0][3]),pe=[],we=0;for(let ee=0;ee<Ce.length;ee++){let ye=Ce[ee];pe=[...pe,...ye];for(let $e=0;$e<ye.length;$e++)we=new Vd(we).plus(ye[$e]).toNumber()}re(we),S(new Vd(we).div(pe.length).toNumber()),x(Vd.min(...pe).toNumber()),L(Vd.max(...pe).toNumber())}}}))},w=(T,O=!0)=>{var _;c.current&&(c.current.isClose=O),l&&((_=l==null?void 0:l.hot)==null||_.setDataAtCell(l.row,l.col,T),c.current.isClose=!0)},h=()=>l?l.originalValue:null,f=T=>{var O;M(T.target.checked);for(let _=0;_<t.data.length;_++)(O=r.current)==null||O.setDataAtCell([[_,0,T.target.checked]])},m=(T,O)=>{var U,ie;T.target.checked||M(T.target.checked),(U=r.current)==null||U.setDataAtCell([[O.row,O.col,T.target.checked]]);let _=(ie=r.current)==null?void 0:ie.getData(),Y=!0;_==null||_.forEach(se=>{se[0]||(Y=!1)}),M(Y)};return mm(fN.Provider,{value:{handsontableInfo:l,setValue:w,getValue:h},children:[mm("div",{className:"react-handsontable",children:[au("div",{className:"main",children:au("div",{ref:n,children:au("div",{className:"react-node",style:s,children:i&&i})})}),mm("div",{className:"foot-tool",children:["éä¸­[è¡æ°:",y," åæ°:",q," æ±å:",X," å¹³å:",v," æå¤§:",b," æå°:",P,"]"]})]}),g.map(T=>lR.createPortal(T.node,T.td)),C&&lR.createPortal(au(uR.Checkbox,{defaultChecked:I,onChange:f}),C)]})};exports.ReactHandsontable=Fae;exports.ReactHandsontableContext=fN;exports.tuple=mN;
