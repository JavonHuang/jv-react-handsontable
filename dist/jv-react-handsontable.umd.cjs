(function(Xr,Dt){typeof exports=="object"&&typeof module<"u"?Dt(exports,require("react"),require("react-dom"),require("antd")):typeof define=="function"&&define.amd?define(["exports","react","react-dom","antd"],Dt):(Xr=typeof globalThis<"u"?globalThis:Xr||self,Dt(Xr["jv-react-handsontable"]={},Xr.require$$0$1,Xr.reactDom,Xr.antd))})(this,function(Xr,Dt,lR,uR){"use strict";const pN=(...t)=>t;var ru=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function wN(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){if(this instanceof r){var i=[null];i.push.apply(i,arguments);var o=Function.bind.apply(e,i);return new o}return e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var mh={},CN={get exports(){return mh},set exports(t){mh=t}},iu={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cR;function vN(){if(cR)return iu;cR=1;var t=Dt,e=Symbol.for("react.element"),n=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function s(a,l,u){var c,d={},g=null,p=null;u!==void 0&&(g=""+u),l.key!==void 0&&(g=""+l.key),l.ref!==void 0&&(p=l.ref);for(c in l)r.call(l,c)&&!o.hasOwnProperty(c)&&(d[c]=l[c]);if(a&&a.defaultProps)for(c in l=a.defaultProps,l)d[c]===void 0&&(d[c]=l[c]);return{$$typeof:e,type:a,key:g,ref:p,props:d,_owner:i.current}}return iu.Fragment=n,iu.jsx=s,iu.jsxs=s,iu}var ou={};/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hR;function SN(){return hR||(hR=1,process.env.NODE_ENV!=="production"&&function(){var t=Dt,e=Symbol.for("react.element"),n=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),a=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),c=Symbol.for("react.suspense_list"),d=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),p=Symbol.for("react.offscreen"),C=Symbol.iterator,E="@@iterator";function I(k){if(k===null||typeof k!="object")return null;var ue=C&&k[C]||k[E];return typeof ue=="function"?ue:null}var M=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function y(k){{for(var ue=arguments.length,me=new Array(ue>1?ue-1:0),Ve=1;Ve<ue;Ve++)me[Ve-1]=arguments[Ve];$("error",k,me)}}function $(k,ue,me){{var Ve=M.ReactDebugCurrentFrame,ft=Ve.getStackAddendum();ft!==""&&(ue+="%s",me=me.concat([ft]));var vt=me.map(function(ut){return String(ut)});vt.unshift("Warning: "+ue),Function.prototype.apply.call(console[k],console,vt)}}var X=!1,G=!1,q=!1,re=!1,v=!1,S;S=Symbol.for("react.module.reference");function b(k){return!!(typeof k=="string"||typeof k=="function"||k===r||k===o||v||k===i||k===u||k===c||re||k===p||X||G||q||typeof k=="object"&&k!==null&&(k.$$typeof===g||k.$$typeof===d||k.$$typeof===s||k.$$typeof===a||k.$$typeof===l||k.$$typeof===S||k.getModuleId!==void 0))}function L(k,ue,me){var Ve=k.displayName;if(Ve)return Ve;var ft=ue.displayName||ue.name||"";return ft!==""?me+"("+ft+")":me}function P(k){return k.displayName||"Context"}function x(k){if(k==null)return null;if(typeof k.tag=="number"&&y("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),typeof k=="function")return k.displayName||k.name||null;if(typeof k=="string")return k;switch(k){case r:return"Fragment";case n:return"Portal";case o:return"Profiler";case i:return"StrictMode";case u:return"Suspense";case c:return"SuspenseList"}if(typeof k=="object")switch(k.$$typeof){case a:var ue=k;return P(ue)+".Consumer";case s:var me=k;return P(me._context)+".Provider";case l:return L(k,k.render,"ForwardRef");case d:var Ve=k.displayName||null;return Ve!==null?Ve:x(k.type)||"Memo";case g:{var ft=k,vt=ft._payload,ut=ft._init;try{return x(ut(vt))}catch{return null}}}return null}var W=Object.assign,D=0,B,z,w,h,f,m,T;function O(){}O.__reactDisabledLog=!0;function _(){{if(D===0){B=console.log,z=console.info,w=console.warn,h=console.error,f=console.group,m=console.groupCollapsed,T=console.groupEnd;var k={configurable:!0,enumerable:!0,value:O,writable:!0};Object.defineProperties(console,{info:k,log:k,warn:k,error:k,group:k,groupCollapsed:k,groupEnd:k})}D++}}function Y(){{if(D--,D===0){var k={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:W({},k,{value:B}),info:W({},k,{value:z}),warn:W({},k,{value:w}),error:W({},k,{value:h}),group:W({},k,{value:f}),groupCollapsed:W({},k,{value:m}),groupEnd:W({},k,{value:T})})}D<0&&y("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}}var U=M.ReactCurrentDispatcher,ie;function se(k,ue,me){{if(ie===void 0)try{throw Error()}catch(ft){var Ve=ft.stack.trim().match(/\n( *(at )?)/);ie=Ve&&Ve[1]||""}return`
`+ie+k}}var oe=!1,de;{var Se=typeof WeakMap=="function"?WeakMap:Map;de=new Se}function pe(k,ue){if(!k||oe)return"";{var me=de.get(k);if(me!==void 0)return me}var Ve;oe=!0;var ft=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var vt;vt=U.current,U.current=null,_();try{if(ue){var ut=function(){throw Error()};if(Object.defineProperty(ut.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ut,[])}catch(Ht){Ve=Ht}Reflect.construct(k,[],ut)}else{try{ut.call()}catch(Ht){Ve=Ht}k.call(ut.prototype)}}else{try{throw Error()}catch(Ht){Ve=Ht}k()}}catch(Ht){if(Ht&&Ve&&typeof Ht.stack=="string"){for(var at=Ht.stack.split(`
`),Re=Ve.stack.split(`
`),V=at.length-1,ae=Re.length-1;V>=1&&ae>=0&&at[V]!==Re[ae];)ae--;for(;V>=1&&ae>=0;V--,ae--)if(at[V]!==Re[ae]){if(V!==1||ae!==1)do if(V--,ae--,ae<0||at[V]!==Re[ae]){var ge=`
`+at[V].replace(" at new "," at ");return k.displayName&&ge.includes("<anonymous>")&&(ge=ge.replace("<anonymous>",k.displayName)),typeof k=="function"&&de.set(k,ge),ge}while(V>=1&&ae>=0);break}}}finally{oe=!1,U.current=vt,Y(),Error.prepareStackTrace=ft}var lt=k?k.displayName||k.name:"",Pn=lt?se(lt):"";return typeof k=="function"&&de.set(k,Pn),Pn}function we(k,ue,me){return pe(k,!1)}function ee(k){var ue=k.prototype;return!!(ue&&ue.isReactComponent)}function ye(k,ue,me){if(k==null)return"";if(typeof k=="function")return pe(k,ee(k));if(typeof k=="string")return se(k);switch(k){case u:return se("Suspense");case c:return se("SuspenseList")}if(typeof k=="object")switch(k.$$typeof){case l:return we(k.render);case d:return ye(k.type,ue,me);case g:{var Ve=k,ft=Ve._payload,vt=Ve._init;try{return ye(vt(ft),ue,me)}catch{}}}return""}var $e=Object.prototype.hasOwnProperty,Pe={},Fe=M.ReactDebugCurrentFrame;function xe(k){if(k){var ue=k._owner,me=ye(k.type,k._source,ue?ue.type:null);Fe.setExtraStackFrame(me)}else Fe.setExtraStackFrame(null)}function R(k,ue,me,Ve,ft){{var vt=Function.call.bind($e);for(var ut in k)if(vt(k,ut)){var at=void 0;try{if(typeof k[ut]!="function"){var Re=Error((Ve||"React class")+": "+me+" type `"+ut+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof k[ut]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw Re.name="Invariant Violation",Re}at=k[ut](ue,ut,Ve,me,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(V){at=V}at&&!(at instanceof Error)&&(xe(ft),y("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",Ve||"React class",me,ut,typeof at),xe(null)),at instanceof Error&&!(at.message in Pe)&&(Pe[at.message]=!0,xe(ft),y("Failed %s type: %s",me,at.message),xe(null))}}}var A=Array.isArray;function N(k){return A(k)}function J(k){{var ue=typeof Symbol=="function"&&Symbol.toStringTag,me=ue&&k[Symbol.toStringTag]||k.constructor.name||"Object";return me}}function F(k){try{return Q(k),!1}catch{return!0}}function Q(k){return""+k}function K(k){if(F(k))return y("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",J(k)),Q(k)}var j=M.ReactCurrentOwner,te={key:!0,ref:!0,__self:!0,__source:!0},Z,ne,fe;fe={};function Te(k){if($e.call(k,"ref")){var ue=Object.getOwnPropertyDescriptor(k,"ref").get;if(ue&&ue.isReactWarning)return!1}return k.ref!==void 0}function He(k){if($e.call(k,"key")){var ue=Object.getOwnPropertyDescriptor(k,"key").get;if(ue&&ue.isReactWarning)return!1}return k.key!==void 0}function ke(k,ue){if(typeof k.ref=="string"&&j.current&&ue&&j.current.stateNode!==ue){var me=x(j.current.type);fe[me]||(y('Component "%s" contains the string ref "%s". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',x(j.current.type),k.ref),fe[me]=!0)}}function ze(k,ue){{var me=function(){Z||(Z=!0,y("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",ue))};me.isReactWarning=!0,Object.defineProperty(k,"key",{get:me,configurable:!0})}}function Tt(k,ue){{var me=function(){ne||(ne=!0,y("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",ue))};me.isReactWarning=!0,Object.defineProperty(k,"ref",{get:me,configurable:!0})}}var et=function(k,ue,me,Ve,ft,vt,ut){var at={$$typeof:e,type:k,key:ue,ref:me,props:ut,_owner:vt};return at._store={},Object.defineProperty(at._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(at,"_self",{configurable:!1,enumerable:!1,writable:!1,value:Ve}),Object.defineProperty(at,"_source",{configurable:!1,enumerable:!1,writable:!1,value:ft}),Object.freeze&&(Object.freeze(at.props),Object.freeze(at)),at};function Ct(k,ue,me,Ve,ft){{var vt,ut={},at=null,Re=null;me!==void 0&&(K(me),at=""+me),He(ue)&&(K(ue.key),at=""+ue.key),Te(ue)&&(Re=ue.ref,ke(ue,ft));for(vt in ue)$e.call(ue,vt)&&!te.hasOwnProperty(vt)&&(ut[vt]=ue[vt]);if(k&&k.defaultProps){var V=k.defaultProps;for(vt in V)ut[vt]===void 0&&(ut[vt]=V[vt])}if(at||Re){var ae=typeof k=="function"?k.displayName||k.name||"Unknown":k;at&&ze(ut,ae),Re&&Tt(ut,ae)}return et(k,at,Re,ft,Ve,j.current,ut)}}var _t=M.ReactCurrentOwner,zo=M.ReactDebugCurrentFrame;function Kr(k){if(k){var ue=k._owner,me=ye(k.type,k._source,ue?ue.type:null);zo.setExtraStackFrame(me)}else zo.setExtraStackFrame(null)}var xt;xt=!1;function cn(k){return typeof k=="object"&&k!==null&&k.$$typeof===e}function eo(){{if(_t.current){var k=x(_t.current.type);if(k)return`

Check the render method of \``+k+"`."}return""}}function In(k){{if(k!==void 0){var ue=k.fileName.replace(/^.*[\\\/]/,""),me=k.lineNumber;return`

Check your code at `+ue+":"+me+"."}return""}}var rn={};function Pt(k){{var ue=eo();if(!ue){var me=typeof k=="string"?k:k.displayName||k.name;me&&(ue=`

Check the top-level render call using <`+me+">.")}return ue}}function dh(k,ue){{if(!k._store||k._store.validated||k.key!=null)return;k._store.validated=!0;var me=Pt(ue);if(rn[me])return;rn[me]=!0;var Ve="";k&&k._owner&&k._owner!==_t.current&&(Ve=" It was passed a child from "+x(k._owner.type)+"."),Kr(k),y('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',me,Ve),Kr(null)}}function cm(k,ue){{if(typeof k!="object")return;if(N(k))for(var me=0;me<k.length;me++){var Ve=k[me];cn(Ve)&&dh(Ve,ue)}else if(cn(k))k._store&&(k._store.validated=!0);else if(k){var ft=I(k);if(typeof ft=="function"&&ft!==k.entries)for(var vt=ft.call(k),ut;!(ut=vt.next()).done;)cn(ut.value)&&dh(ut.value,ue)}}}function nu(k){{var ue=k.type;if(ue==null||typeof ue=="string")return;var me;if(typeof ue=="function")me=ue.propTypes;else if(typeof ue=="object"&&(ue.$$typeof===l||ue.$$typeof===d))me=ue.propTypes;else return;if(me){var Ve=x(ue);R(me,k.props,"prop",Ve,k)}else if(ue.PropTypes!==void 0&&!xt){xt=!0;var ft=x(ue);y("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",ft||"Unknown")}typeof ue.getDefaultProps=="function"&&!ue.getDefaultProps.isReactClassApproved&&y("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}function fh(k){{for(var ue=Object.keys(k.props),me=0;me<ue.length;me++){var Ve=ue[me];if(Ve!=="children"&&Ve!=="key"){Kr(k),y("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",Ve),Kr(null);break}}k.ref!==null&&(Kr(k),y("Invalid attribute `ref` supplied to `React.Fragment`."),Kr(null))}}function hm(k,ue,me,Ve,ft,vt){{var ut=b(k);if(!ut){var at="";(k===void 0||typeof k=="object"&&k!==null&&Object.keys(k).length===0)&&(at+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var Re=In(ft);Re?at+=Re:at+=eo();var V;k===null?V="null":N(k)?V="array":k!==void 0&&k.$$typeof===e?(V="<"+(x(k.type)||"Unknown")+" />",at=" Did you accidentally export a JSX literal instead of a component?"):V=typeof k,y("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",V,at)}var ae=Ct(k,ue,me,ft,vt);if(ae==null)return ae;if(ut){var ge=ue.children;if(ge!==void 0)if(Ve)if(N(ge)){for(var lt=0;lt<ge.length;lt++)cm(ge[lt],k);Object.freeze&&Object.freeze(ge)}else y("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else cm(ge,k)}return k===r?fh(ae):nu(ae),ae}}function bi(k,ue,me){return hm(k,ue,me,!0)}function gh(k,ue,me){return hm(k,ue,me,!1)}var dm=gh,fm=bi;ou.Fragment=r,ou.jsx=dm,ou.jsxs=fm}()),ou}(function(t){process.env.NODE_ENV==="production"?t.exports=vN():t.exports=SN()})(CN);const su=mh.jsx,mm=mh.jsxs,yae="",bae="";var au=function(t){return t&&t.Math===Math&&t},Hn=au(typeof globalThis=="object"&&globalThis)||au(typeof window=="object"&&window)||au(typeof self=="object"&&self)||au(typeof ru=="object"&&ru)||au(typeof ru=="object"&&ru)||function(){return this}()||Function("return this")(),pm={},Ar=function(t){try{return!!t()}catch{return!0}},yN=Ar,Ri=!yN(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),bN=Ar,ph=!bN(function(){var t=function(){}.bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),RN=ph,wh=Function.prototype.call,Ch=RN?wh.bind(wh):function(){return wh.apply(wh,arguments)},dR={},fR={}.propertyIsEnumerable,gR=Object.getOwnPropertyDescriptor,EN=gR&&!fR.call({1:2},1);dR.f=EN?function(e){var n=gR(this,e);return!!n&&n.enumerable}:fR;var wm=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},mR=ph,pR=Function.prototype,Cm=pR.call,TN=mR&&pR.bind.bind(Cm,Cm),Gn=mR?TN:function(t){return function(){return Cm.apply(t,arguments)}},wR=Gn,_N=wR({}.toString),MN=wR("".slice),Na=function(t){return MN(_N(t),8,-1)},ON=Gn,AN=Ar,IN=Na,vm=Object,PN=ON("".split),xN=AN(function(){return!vm("z").propertyIsEnumerable(0)})?function(t){return IN(t)==="String"?PN(t,""):vm(t)}:vm,CR=function(t){return t==null},HN=CR,DN=TypeError,vR=function(t){if(HN(t))throw new DN("Can't call method on "+t);return t},NN=xN,LN=vR,vh=function(t){return NN(LN(t))},Sm=typeof document=="object"&&document.all,$N=typeof Sm>"u"&&Sm!==void 0,SR={all:Sm,IS_HTMLDDA:$N},yR=SR,kN=yR.all,_n=yR.IS_HTMLDDA?function(t){return typeof t=="function"||t===kN}:function(t){return typeof t=="function"},bR=_n,RR=SR,FN=RR.all,Hs=RR.IS_HTMLDDA?function(t){return typeof t=="object"?t!==null:bR(t)||t===FN}:function(t){return typeof t=="object"?t!==null:bR(t)},ym=Hn,WN=_n,VN=function(t){return WN(t)?t:void 0},lu=function(t,e){return arguments.length<2?VN(ym[t]):ym[t]&&ym[t][e]},BN=Gn,ER=BN({}.isPrototypeOf),bm=typeof navigator<"u"&&String(navigator.userAgent)||"",TR=Hn,Rm=bm,_R=TR.process,MR=TR.Deno,OR=_R&&_R.versions||MR&&MR.version,AR=OR&&OR.v8,qr,Sh;AR&&(qr=AR.split("."),Sh=qr[0]>0&&qr[0]<4?1:+(qr[0]+qr[1])),!Sh&&Rm&&(qr=Rm.match(/Edge\/(\d+)/),(!qr||qr[1]>=74)&&(qr=Rm.match(/Chrome\/(\d+)/),qr&&(Sh=+qr[1])));var UN=Sh,IR=UN,YN=Ar,GN=Hn,zN=GN.String,Em=!!Object.getOwnPropertySymbols&&!YN(function(){var t=Symbol("symbol detection");return!zN(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&IR&&IR<41}),jN=Em,PR=jN&&!Symbol.sham&&typeof Symbol.iterator=="symbol",KN=lu,XN=_n,qN=ER,ZN=PR,QN=Object,Tm=ZN?function(t){return typeof t=="symbol"}:function(t){var e=KN("Symbol");return XN(e)&&qN(e.prototype,QN(t))},JN=String,xR=function(t){try{return JN(t)}catch{return"Object"}},eL=_n,tL=xR,nL=TypeError,_m=function(t){if(eL(t))return t;throw new nL(tL(t)+" is not a function")},rL=_m,iL=CR,oL=function(t,e){var n=t[e];return iL(n)?void 0:rL(n)},Mm=Ch,Om=_n,Am=Hs,sL=TypeError,aL=function(t,e){var n,r;if(e==="string"&&Om(n=t.toString)&&!Am(r=Mm(n,t))||Om(n=t.valueOf)&&!Am(r=Mm(n,t))||e!=="string"&&Om(n=t.toString)&&!Am(r=Mm(n,t)))return r;throw new sL("Can't convert object to primitive value")},yh={},lL={get exports(){return yh},set exports(t){yh=t}},HR=Hn,uL=Object.defineProperty,Im=function(t,e){try{uL(HR,t,{value:e,configurable:!0,writable:!0})}catch{HR[t]=e}return e},cL=Hn,hL=Im,DR="__core-js_shared__",dL=cL[DR]||hL(DR,{}),Pm=dL,NR=Pm;(lL.exports=function(t,e){return NR[t]||(NR[t]=e!==void 0?e:{})})("versions",[]).push({version:"3.34.0",mode:"global",copyright:"Â© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.34.0/LICENSE",source:"https://github.com/zloirock/core-js"});var fL=vR,gL=Object,bh=function(t){return gL(fL(t))},mL=Gn,pL=bh,wL=mL({}.hasOwnProperty),to=Object.hasOwn||function(e,n){return wL(pL(e),n)},CL=Gn,vL=0,SL=Math.random(),yL=CL(1 .toString),LR=function(t){return"Symbol("+(t===void 0?"":t)+")_"+yL(++vL+SL,36)},bL=Hn,RL=yh,$R=to,EL=LR,TL=Em,_L=PR,La=bL.Symbol,xm=RL("wks"),ML=_L?La.for||La:La&&La.withoutSetter||EL,Rh=function(t){return $R(xm,t)||(xm[t]=TL&&$R(La,t)?La[t]:ML("Symbol."+t)),xm[t]},OL=Ch,kR=Hs,FR=Tm,AL=oL,IL=aL,PL=Rh,xL=TypeError,HL=PL("toPrimitive"),DL=function(t,e){if(!kR(t)||FR(t))return t;var n=AL(t,HL),r;if(n){if(e===void 0&&(e="default"),r=OL(n,t,e),!kR(r)||FR(r))return r;throw new xL("Can't convert object to primitive value")}return e===void 0&&(e="number"),IL(t,e)},NL=DL,LL=Tm,WR=function(t){var e=NL(t,"string");return LL(e)?e:e+""},$L=Hn,VR=Hs,Hm=$L.document,kL=VR(Hm)&&VR(Hm.createElement),Dm=function(t){return kL?Hm.createElement(t):{}},FL=Ri,WL=Ar,VL=Dm,BR=!FL&&!WL(function(){return Object.defineProperty(VL("div"),"a",{get:function(){return 7}}).a!==7}),BL=Ri,UL=Ch,YL=dR,GL=wm,zL=vh,jL=WR,KL=to,XL=BR,UR=Object.getOwnPropertyDescriptor;pm.f=BL?UR:function(e,n){if(e=zL(e),n=jL(n),XL)try{return UR(e,n)}catch{}if(KL(e,n))return GL(!UL(YL.f,e,n),e[n])};var Ds={},qL=Ri,ZL=Ar,YR=qL&&ZL(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),QL=Hs,JL=String,e$=TypeError,uu=function(t){if(QL(t))return t;throw new e$(JL(t)+" is not an object")},t$=Ri,n$=BR,r$=YR,Eh=uu,GR=WR,i$=TypeError,Nm=Object.defineProperty,o$=Object.getOwnPropertyDescriptor,Lm="enumerable",$m="configurable",km="writable";Ds.f=t$?r$?function(e,n,r){if(Eh(e),n=GR(n),Eh(r),typeof e=="function"&&n==="prototype"&&"value"in r&&km in r&&!r[km]){var i=o$(e,n);i&&i[km]&&(e[n]=r.value,r={configurable:$m in r?r[$m]:i[$m],enumerable:Lm in r?r[Lm]:i[Lm],writable:!1})}return Nm(e,n,r)}:Nm:function(e,n,r){if(Eh(e),n=GR(n),Eh(r),n$)try{return Nm(e,n,r)}catch{}if("get"in r||"set"in r)throw new i$("Accessors not supported");return"value"in r&&(e[n]=r.value),e};var s$=Ri,a$=Ds,l$=wm,cu=s$?function(t,e,n){return a$.f(t,e,l$(1,n))}:function(t,e,n){return t[e]=n,t},Fm={},u$={get exports(){return Fm},set exports(t){Fm=t}},Wm=Ri,c$=to,zR=Function.prototype,h$=Wm&&Object.getOwnPropertyDescriptor,Vm=c$(zR,"name"),d$=Vm&&function(){}.name==="something",f$=Vm&&(!Wm||Wm&&h$(zR,"name").configurable),g$={EXISTS:Vm,PROPER:d$,CONFIGURABLE:f$},m$=Gn,p$=_n,Bm=Pm,w$=m$(Function.toString);p$(Bm.inspectSource)||(Bm.inspectSource=function(t){return w$(t)});var C$=Bm.inspectSource,v$=Hn,S$=_n,jR=v$.WeakMap,y$=S$(jR)&&/native code/.test(String(jR)),b$=yh,R$=LR,KR=b$("keys"),XR=function(t){return KR[t]||(KR[t]=R$(t))},Um={},E$=y$,qR=Hn,T$=Hs,_$=cu,Ym=to,Gm=Pm,M$=XR,O$=Um,ZR="Object already initialized",zm=qR.TypeError,A$=qR.WeakMap,Th,hu,_h,I$=function(t){return _h(t)?hu(t):Th(t,{})},P$=function(t){return function(e){var n;if(!T$(e)||(n=hu(e)).type!==t)throw new zm("Incompatible receiver, "+t+" required");return n}};if(E$||Gm.state){var Ei=Gm.state||(Gm.state=new A$);Ei.get=Ei.get,Ei.has=Ei.has,Ei.set=Ei.set,Th=function(t,e){if(Ei.has(t))throw new zm(ZR);return e.facade=t,Ei.set(t,e),e},hu=function(t){return Ei.get(t)||{}},_h=function(t){return Ei.has(t)}}else{var $a=M$("state");O$[$a]=!0,Th=function(t,e){if(Ym(t,$a))throw new zm(ZR);return e.facade=t,_$(t,$a,e),e},hu=function(t){return Ym(t,$a)?t[$a]:{}},_h=function(t){return Ym(t,$a)}}var x$={set:Th,get:hu,has:_h,enforce:I$,getterFor:P$},jm=Gn,H$=Ar,D$=_n,Mh=to,Km=Ri,N$=g$.CONFIGURABLE,L$=C$,QR=x$,$$=QR.enforce,k$=QR.get,JR=String,Oh=Object.defineProperty,F$=jm("".slice),W$=jm("".replace),V$=jm([].join),B$=Km&&!H$(function(){return Oh(function(){},"length",{value:8}).length!==8}),U$=String(String).split("String"),Y$=u$.exports=function(t,e,n){F$(JR(e),0,7)==="Symbol("&&(e="["+W$(JR(e),/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!Mh(t,"name")||N$&&t.name!==e)&&(Km?Oh(t,"name",{value:e,configurable:!0}):t.name=e),B$&&n&&Mh(n,"arity")&&t.length!==n.arity&&Oh(t,"length",{value:n.arity});try{n&&Mh(n,"constructor")&&n.constructor?Km&&Oh(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var r=$$(t);return Mh(r,"source")||(r.source=V$(U$,typeof e=="string"?e:"")),t};Function.prototype.toString=Y$(function(){return D$(this)&&k$(this).source||L$(this)},"toString");var G$=_n,z$=Ds,j$=Fm,K$=Im,X$=function(t,e,n,r){r||(r={});var i=r.enumerable,o=r.name!==void 0?r.name:e;if(G$(n)&&j$(n,o,r),r.global)i?t[e]=n:K$(e,n);else{try{r.unsafe?t[e]&&(i=!0):delete t[e]}catch{}i?t[e]=n:z$.f(t,e,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return t},eE={},q$=Math.ceil,Z$=Math.floor,Q$=Math.trunc||function(e){var n=+e;return(n>0?Z$:q$)(n)},J$=Q$,Xm=function(t){var e=+t;return e!==e||e===0?0:J$(e)},ek=Xm,tk=Math.max,nk=Math.min,rk=function(t,e){var n=ek(t);return n<0?tk(n+e,0):nk(n,e)},ik=Xm,ok=Math.min,sk=function(t){return t>0?ok(ik(t),9007199254740991):0},ak=sk,Ah=function(t){return ak(t.length)},lk=vh,uk=rk,ck=Ah,tE=function(t){return function(e,n,r){var i=lk(e),o=ck(i),s=uk(r,o),a;if(t&&n!==n){for(;o>s;)if(a=i[s++],a!==a)return!0}else for(;o>s;s++)if((t||s in i)&&i[s]===n)return t||s||0;return!t&&-1}},hk={includes:tE(!0),indexOf:tE(!1)},dk=Gn,qm=to,fk=vh,gk=hk.indexOf,mk=Um,nE=dk([].push),rE=function(t,e){var n=fk(t),r=0,i=[],o;for(o in n)!qm(mk,o)&&qm(n,o)&&nE(i,o);for(;e.length>r;)qm(n,o=e[r++])&&(~gk(i,o)||nE(i,o));return i},Zm=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],pk=rE,wk=Zm,Ck=wk.concat("length","prototype");eE.f=Object.getOwnPropertyNames||function(e){return pk(e,Ck)};var iE={};iE.f=Object.getOwnPropertySymbols;var vk=lu,Sk=Gn,yk=eE,bk=iE,Rk=uu,Ek=Sk([].concat),Tk=vk("Reflect","ownKeys")||function(e){var n=yk.f(Rk(e)),r=bk.f;return r?Ek(n,r(e)):n},oE=to,_k=Tk,Mk=pm,Ok=Ds,sE=function(t,e,n){for(var r=_k(e),i=Ok.f,o=Mk.f,s=0;s<r.length;s++){var a=r[s];!oE(t,a)&&!(n&&oE(n,a))&&i(t,a,o(e,a))}},Ak=Ar,Ik=_n,Pk=/#|\.prototype\./,du=function(t,e){var n=Hk[xk(t)];return n===Nk?!0:n===Dk?!1:Ik(e)?Ak(e):!!e},xk=du.normalize=function(t){return String(t).replace(Pk,".").toLowerCase()},Hk=du.data={},Dk=du.NATIVE="N",Nk=du.POLYFILL="P",Lk=du,Qm=Hn,$k=pm.f,kk=cu,Fk=X$,Wk=Im,Vk=sE,Bk=Lk,Ns=function(t,e){var n=t.target,r=t.global,i=t.stat,o,s,a,l,u,c;if(r?s=Qm:i?s=Qm[n]||Wk(n,{}):s=(Qm[n]||{}).prototype,s)for(a in e){if(u=e[a],t.dontCallGetSet?(c=$k(s,a),l=c&&c.value):l=s[a],o=Bk(r?a:n+(i?".":"#")+a,t.forced),!o&&l!==void 0){if(typeof u==typeof l)continue;Vk(u,l)}(t.sham||l&&l.sham)&&kk(u,"sham",!0),Fk(s,a,u,t)}},Uk=Na,aE=Array.isArray||function(e){return Uk(e)==="Array"},Yk=Ri,Gk=aE,zk=TypeError,jk=Object.getOwnPropertyDescriptor,Kk=Yk&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}(),lE=Kk?function(t,e){if(Gk(t)&&!jk(t,"length").writable)throw new zk("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},Xk=TypeError,qk=9007199254740991,uE=function(t){if(t>qk)throw Xk("Maximum allowed index exceeded");return t},Zk=Ns,Qk=bh,Jk=Ah,eF=lE,tF=uE,nF=Ar,rF=nF(function(){return[].push.call({length:4294967296},1)!==4294967297}),iF=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},oF=rF||!iF();Zk({target:"Array",proto:!0,arity:1,forced:oF},{push:function(e){var n=Qk(this),r=Jk(n),i=arguments.length;tF(r+i);for(var o=0;o<i;o++)n[r]=arguments[o],r++;return eF(n,r),r}});var sF=ph,cE=Function.prototype,hE=cE.apply,dE=cE.call,Ih=typeof Reflect=="object"&&Reflect.apply||(sF?dE.bind(hE):function(){return dE.apply(hE,arguments)}),aF=Gn,lF=_m,uF=function(t,e,n){try{return aF(lF(Object.getOwnPropertyDescriptor(t,e)[n]))}catch{}},cF=_n,hF=String,dF=TypeError,fF=function(t){if(typeof t=="object"||cF(t))return t;throw new dF("Can't set "+hF(t)+" as a prototype")},gF=uF,mF=uu,pF=fF,fE=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},n;try{n=gF(Object.prototype,"__proto__","set"),n(e,[]),t=e instanceof Array}catch{}return function(i,o){return mF(i),pF(o),t?n(i,o):i.__proto__=o,i}}():void 0),wF=Ds.f,CF=function(t,e,n){n in t||wF(t,n,{configurable:!0,get:function(){return e[n]},set:function(r){e[n]=r}})},vF=_n,SF=Hs,gE=fE,yF=function(t,e,n){var r,i;return gE&&vF(r=e.constructor)&&r!==n&&SF(i=r.prototype)&&i!==n.prototype&&gE(t,i),t},bF=Rh,RF=bF("toStringTag"),mE={};mE[RF]="z";var EF=String(mE)==="[object z]",TF=EF,_F=_n,Ph=Na,MF=Rh,OF=MF("toStringTag"),AF=Object,IF=Ph(function(){return arguments}())==="Arguments",PF=function(t,e){try{return t[e]}catch{}},xF=TF?Ph:function(t){var e,n,r;return t===void 0?"Undefined":t===null?"Null":typeof(n=PF(e=AF(t),OF))=="string"?n:IF?Ph(e):(r=Ph(e))==="Object"&&_F(e.callee)?"Arguments":r},HF=xF,DF=String,pE=function(t){if(HF(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return DF(t)},NF=pE,LF=function(t,e){return t===void 0?arguments.length<2?"":e:NF(t)},$F=Hs,kF=cu,FF=function(t,e){$F(e)&&"cause"in e&&kF(t,"cause",e.cause)},WF=Gn,wE=Error,VF=WF("".replace),BF=function(t){return String(new wE(t).stack)}("zxcasd"),CE=/\n\s*at [^:]*:[^\n]*/,UF=CE.test(BF),YF=function(t,e){if(UF&&typeof t=="string"&&!wE.prepareStackTrace)for(;e--;)t=VF(t,CE,"");return t},GF=Ar,zF=wm,jF=!GF(function(){var t=new Error("a");return"stack"in t?(Object.defineProperty(t,"stack",zF(1,7)),t.stack!==7):!0}),KF=cu,XF=YF,qF=jF,vE=Error.captureStackTrace,ZF=function(t,e,n,r){qF&&(vE?vE(t,e):KF(t,"stack",XF(n,r)))},SE=lu,QF=to,yE=cu,JF=ER,bE=fE,RE=sE,EE=CF,eW=yF,tW=LF,nW=FF,rW=ZF,iW=Ri,oW=function(t,e,n,r){var i="stackTraceLimit",o=r?2:1,s=t.split("."),a=s[s.length-1],l=SE.apply(null,s);if(l){var u=l.prototype;if(QF(u,"cause")&&delete u.cause,!n)return l;var c=SE("Error"),d=e(function(g,p){var C=tW(r?p:g,void 0),E=r?new l(g):new l;return C!==void 0&&yE(E,"message",C),rW(E,d,E.stack,2),this&&JF(u,this)&&eW(E,this,d),arguments.length>o&&nW(E,arguments[o]),E});d.prototype=u,a!=="Error"?bE?bE(d,c):RE(d,c,{name:!0}):iW&&i in l&&(EE(d,l,i),EE(d,l,"prepareStackTrace")),RE(d,l);try{u.name!==a&&yE(u,"name",a),u.constructor=d}catch{}return d}},TE=Ns,sW=Hn,Ti=Ih,_E=oW,Jm="WebAssembly",ME=sW[Jm],xh=new Error("e",{cause:7}).cause!==7,Ls=function(t,e){var n={};n[t]=_E(t,e,xh),TE({global:!0,constructor:!0,arity:1,forced:xh},n)},ep=function(t,e){if(ME&&ME[t]){var n={};n[t]=_E(Jm+"."+t,e,xh),TE({target:Jm,stat:!0,constructor:!0,arity:1,forced:xh},n)}};Ls("Error",function(t){return function(n){return Ti(t,this,arguments)}}),Ls("EvalError",function(t){return function(n){return Ti(t,this,arguments)}}),Ls("RangeError",function(t){return function(n){return Ti(t,this,arguments)}}),Ls("ReferenceError",function(t){return function(n){return Ti(t,this,arguments)}}),Ls("SyntaxError",function(t){return function(n){return Ti(t,this,arguments)}}),Ls("TypeError",function(t){return function(n){return Ti(t,this,arguments)}}),Ls("URIError",function(t){return function(n){return Ti(t,this,arguments)}}),ep("CompileError",function(t){return function(n){return Ti(t,this,arguments)}}),ep("LinkError",function(t){return function(n){return Ti(t,this,arguments)}}),ep("RuntimeError",function(t){return function(n){return Ti(t,this,arguments)}});var aW=Na,lW=Gn,uW=function(t){if(aW(t)==="Function")return lW(t)},OE=uW,cW=_m,hW=ph,dW=OE(OE.bind),fW=function(t,e){return cW(t),e===void 0?t:hW?dW(t,e):function(){return t.apply(e,arguments)}},gW=lu,AE=gW("document","documentElement"),mW=Gn,tp=mW([].slice),pW=TypeError,IE=function(t,e){if(t<e)throw new pW("Not enough arguments");return t},wW=bm,CW=/(?:ipad|iphone|ipod).*applewebkit/i.test(wW),vW=Hn,SW=Na,yW=SW(vW.process)==="process",Cr=Hn,bW=Ih,RW=fW,PE=_n,EW=to,xE=Ar,HE=AE,TW=tp,DE=Dm,_W=IE,MW=CW,OW=yW,np=Cr.setImmediate,rp=Cr.clearImmediate,AW=Cr.process,ip=Cr.Dispatch,IW=Cr.Function,NE=Cr.MessageChannel,PW=Cr.String,op=0,fu={},LE="onreadystatechange",gu,$s,sp,ap;xE(function(){gu=Cr.location});var lp=function(t){if(EW(fu,t)){var e=fu[t];delete fu[t],e()}},up=function(t){return function(){lp(t)}},$E=function(t){lp(t.data)},kE=function(t){Cr.postMessage(PW(t),gu.protocol+"//"+gu.host)};(!np||!rp)&&(np=function(e){_W(arguments.length,1);var n=PE(e)?e:IW(e),r=TW(arguments,1);return fu[++op]=function(){bW(n,void 0,r)},$s(op),op},rp=function(e){delete fu[e]},OW?$s=function(t){AW.nextTick(up(t))}:ip&&ip.now?$s=function(t){ip.now(up(t))}:NE&&!MW?(sp=new NE,ap=sp.port2,sp.port1.onmessage=$E,$s=RW(ap.postMessage,ap)):Cr.addEventListener&&PE(Cr.postMessage)&&!Cr.importScripts&&gu&&gu.protocol!=="file:"&&!xE(kE)?($s=kE,Cr.addEventListener("message",$E,!1)):LE in DE("script")?$s=function(t){HE.appendChild(DE("script"))[LE]=function(){HE.removeChild(this),lp(t)}}:$s=function(t){setTimeout(up(t),0)});var FE={set:np,clear:rp},xW=Ns,HW=Hn,WE=FE.clear;xW({global:!0,bind:!0,enumerable:!0,forced:HW.clearImmediate!==WE},{clearImmediate:WE});var DW=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",VE=Hn,NW=Ih,LW=_n,$W=DW,kW=bm,FW=tp,WW=IE,VW=VE.Function,BW=/MSIE .\./.test(kW)||$W&&function(){var t=VE.Bun.version.split(".");return t.length<3||t[0]==="0"&&(t[1]<3||t[1]==="3"&&t[2]==="0")}(),UW=function(t,e){var n=e?2:1;return BW?function(r,i){var o=WW(arguments.length,1)>n,s=LW(r)?r:VW(r),a=o?FW(arguments,n):[],l=o?function(){NW(s,this,a)}:s;return e?t(l,i):t(l)}:t},YW=Ns,BE=Hn,UE=FE.set,GW=UW,YE=BE.setImmediate?GW(UE,!1):UE;YW({global:!0,bind:!0,enumerable:!0,forced:BE.setImmediate!==YE},{setImmediate:YE});/*! @license DOMPurify 2.4.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.7/LICENSE */function jo(t){return jo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jo(t)}function cp(t,e){return cp=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},cp(t,e)}function zW(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Hh(t,e,n){return zW()?Hh=Reflect.construct:Hh=function(i,o,s){var a=[null];a.push.apply(a,o);var l=Function.bind.apply(i,a),u=new l;return s&&cp(u,s.prototype),u},Hh.apply(null,arguments)}function Zr(t){return jW(t)||KW(t)||XW(t)||qW()}function jW(t){if(Array.isArray(t))return hp(t)}function KW(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function XW(t,e){if(t){if(typeof t=="string")return hp(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return hp(t,e)}}function hp(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function qW(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ZW=Object.hasOwnProperty,GE=Object.setPrototypeOf,QW=Object.isFrozen,JW=Object.getPrototypeOf,eV=Object.getOwnPropertyDescriptor,zn=Object.freeze,Qr=Object.seal,tV=Object.create,zE=typeof Reflect<"u"&&Reflect,Dh=zE.apply,dp=zE.construct;Dh||(Dh=function(e,n,r){return e.apply(n,r)}),zn||(zn=function(e){return e}),Qr||(Qr=function(e){return e}),dp||(dp=function(e,n){return Hh(e,Zr(n))});var nV=Ir(Array.prototype.forEach),jE=Ir(Array.prototype.pop),mu=Ir(Array.prototype.push),Nh=Ir(String.prototype.toLowerCase),fp=Ir(String.prototype.toString),rV=Ir(String.prototype.match),Jr=Ir(String.prototype.replace),iV=Ir(String.prototype.indexOf),oV=Ir(String.prototype.trim),jn=Ir(RegExp.prototype.test),gp=sV(TypeError);function Ir(t){return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return Dh(t,e,r)}}function sV(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return dp(t,n)}}function tt(t,e,n){var r;n=(r=n)!==null&&r!==void 0?r:Nh,GE&&GE(t,null);for(var i=e.length;i--;){var o=e[i];if(typeof o=="string"){var s=n(o);s!==o&&(QW(e)||(e[i]=s),o=s)}t[o]=!0}return t}function ks(t){var e=tV(null),n;for(n in t)Dh(ZW,t,[n])===!0&&(e[n]=t[n]);return e}function Lh(t,e){for(;t!==null;){var n=eV(t,e);if(n){if(n.get)return Ir(n.get);if(typeof n.value=="function")return Ir(n.value)}t=JW(t)}function r(i){return console.warn("fallback value for",i),null}return r}var KE=zn(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),mp=zn(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),pp=zn(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),aV=zn(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),wp=zn(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),lV=zn(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),XE=zn(["#text"]),qE=zn(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Cp=zn(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),ZE=zn(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),$h=zn(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),uV=Qr(/\{\{[\w\W]*|[\w\W]*\}\}/gm),cV=Qr(/<%[\w\W]*|[\w\W]*%>/gm),hV=Qr(/\${[\w\W]*}/gm),dV=Qr(/^data-[\-\w.\u00B7-\uFFFF]/),fV=Qr(/^aria-[\-\w]+$/),gV=Qr(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),mV=Qr(/^(?:\w+script|data):/i),pV=Qr(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),wV=Qr(/^html$/i),CV=function(){return typeof window>"u"?null:window},vV=function(e,n){if(jo(e)!=="object"||typeof e.createPolicy!="function")return null;var r=null,i="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(i)&&(r=n.currentScript.getAttribute(i));var o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML:function(a){return a},createScriptURL:function(a){return a}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function QE(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:CV(),e=function(V){return QE(V)};if(e.version="2.4.7",e.removed=[],!t||!t.document||t.document.nodeType!==9)return e.isSupported=!1,e;var n=t.document,r=t.document,i=t.DocumentFragment,o=t.HTMLTemplateElement,s=t.Node,a=t.Element,l=t.NodeFilter,u=t.NamedNodeMap,c=u===void 0?t.NamedNodeMap||t.MozNamedAttrMap:u,d=t.HTMLFormElement,g=t.DOMParser,p=t.trustedTypes,C=a.prototype,E=Lh(C,"cloneNode"),I=Lh(C,"nextSibling"),M=Lh(C,"childNodes"),y=Lh(C,"parentNode");if(typeof o=="function"){var $=r.createElement("template");$.content&&$.content.ownerDocument&&(r=$.content.ownerDocument)}var X=vV(p,n),G=X?X.createHTML(""):"",q=r,re=q.implementation,v=q.createNodeIterator,S=q.createDocumentFragment,b=q.getElementsByTagName,L=n.importNode,P={};try{P=ks(r).documentMode?r.documentMode:{}}catch{}var x={};e.isSupported=typeof y=="function"&&re&&re.createHTMLDocument!==void 0&&P!==9;var W=uV,D=cV,B=hV,z=dV,w=fV,h=mV,f=pV,m=gV,T=null,O=tt({},[].concat(Zr(KE),Zr(mp),Zr(pp),Zr(wp),Zr(XE))),_=null,Y=tt({},[].concat(Zr(qE),Zr(Cp),Zr(ZE),Zr($h))),U=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ie=null,se=null,oe=!0,de=!0,Se=!1,pe=!0,we=!1,ee=!1,ye=!1,$e=!1,Pe=!1,Fe=!1,xe=!1,R=!0,A=!1,N="user-content-",J=!0,F=!1,Q={},K=null,j=tt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),te=null,Z=tt({},["audio","video","img","source","image","track"]),ne=null,fe=tt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Te="http://www.w3.org/1998/Math/MathML",He="http://www.w3.org/2000/svg",ke="http://www.w3.org/1999/xhtml",ze=ke,Tt=!1,et=null,Ct=tt({},[Te,He,ke],fp),_t,zo=["application/xhtml+xml","text/html"],Kr="text/html",xt,cn=null,eo=r.createElement("form"),In=function(V){return V instanceof RegExp||V instanceof Function},rn=function(V){cn&&cn===V||((!V||jo(V)!=="object")&&(V={}),V=ks(V),_t=zo.indexOf(V.PARSER_MEDIA_TYPE)===-1?_t=Kr:_t=V.PARSER_MEDIA_TYPE,xt=_t==="application/xhtml+xml"?fp:Nh,T="ALLOWED_TAGS"in V?tt({},V.ALLOWED_TAGS,xt):O,_="ALLOWED_ATTR"in V?tt({},V.ALLOWED_ATTR,xt):Y,et="ALLOWED_NAMESPACES"in V?tt({},V.ALLOWED_NAMESPACES,fp):Ct,ne="ADD_URI_SAFE_ATTR"in V?tt(ks(fe),V.ADD_URI_SAFE_ATTR,xt):fe,te="ADD_DATA_URI_TAGS"in V?tt(ks(Z),V.ADD_DATA_URI_TAGS,xt):Z,K="FORBID_CONTENTS"in V?tt({},V.FORBID_CONTENTS,xt):j,ie="FORBID_TAGS"in V?tt({},V.FORBID_TAGS,xt):{},se="FORBID_ATTR"in V?tt({},V.FORBID_ATTR,xt):{},Q="USE_PROFILES"in V?V.USE_PROFILES:!1,oe=V.ALLOW_ARIA_ATTR!==!1,de=V.ALLOW_DATA_ATTR!==!1,Se=V.ALLOW_UNKNOWN_PROTOCOLS||!1,pe=V.ALLOW_SELF_CLOSE_IN_ATTR!==!1,we=V.SAFE_FOR_TEMPLATES||!1,ee=V.WHOLE_DOCUMENT||!1,Pe=V.RETURN_DOM||!1,Fe=V.RETURN_DOM_FRAGMENT||!1,xe=V.RETURN_TRUSTED_TYPE||!1,$e=V.FORCE_BODY||!1,R=V.SANITIZE_DOM!==!1,A=V.SANITIZE_NAMED_PROPS||!1,J=V.KEEP_CONTENT!==!1,F=V.IN_PLACE||!1,m=V.ALLOWED_URI_REGEXP||m,ze=V.NAMESPACE||ke,U=V.CUSTOM_ELEMENT_HANDLING||{},V.CUSTOM_ELEMENT_HANDLING&&In(V.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(U.tagNameCheck=V.CUSTOM_ELEMENT_HANDLING.tagNameCheck),V.CUSTOM_ELEMENT_HANDLING&&In(V.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(U.attributeNameCheck=V.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),V.CUSTOM_ELEMENT_HANDLING&&typeof V.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(U.allowCustomizedBuiltInElements=V.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),we&&(de=!1),Fe&&(Pe=!0),Q&&(T=tt({},Zr(XE)),_=[],Q.html===!0&&(tt(T,KE),tt(_,qE)),Q.svg===!0&&(tt(T,mp),tt(_,Cp),tt(_,$h)),Q.svgFilters===!0&&(tt(T,pp),tt(_,Cp),tt(_,$h)),Q.mathMl===!0&&(tt(T,wp),tt(_,ZE),tt(_,$h))),V.ADD_TAGS&&(T===O&&(T=ks(T)),tt(T,V.ADD_TAGS,xt)),V.ADD_ATTR&&(_===Y&&(_=ks(_)),tt(_,V.ADD_ATTR,xt)),V.ADD_URI_SAFE_ATTR&&tt(ne,V.ADD_URI_SAFE_ATTR,xt),V.FORBID_CONTENTS&&(K===j&&(K=ks(K)),tt(K,V.FORBID_CONTENTS,xt)),J&&(T["#text"]=!0),ee&&tt(T,["html","head","body"]),T.table&&(tt(T,["tbody"]),delete ie.tbody),zn&&zn(V),cn=V)},Pt=tt({},["mi","mo","mn","ms","mtext"]),dh=tt({},["foreignobject","desc","title","annotation-xml"]),cm=tt({},["title","style","font","a","script"]),nu=tt({},mp);tt(nu,pp),tt(nu,aV);var fh=tt({},wp);tt(fh,lV);var hm=function(V){var ae=y(V);(!ae||!ae.tagName)&&(ae={namespaceURI:ze,tagName:"template"});var ge=Nh(V.tagName),lt=Nh(ae.tagName);return et[V.namespaceURI]?V.namespaceURI===He?ae.namespaceURI===ke?ge==="svg":ae.namespaceURI===Te?ge==="svg"&&(lt==="annotation-xml"||Pt[lt]):Boolean(nu[ge]):V.namespaceURI===Te?ae.namespaceURI===ke?ge==="math":ae.namespaceURI===He?ge==="math"&&dh[lt]:Boolean(fh[ge]):V.namespaceURI===ke?ae.namespaceURI===He&&!dh[lt]||ae.namespaceURI===Te&&!Pt[lt]?!1:!fh[ge]&&(cm[ge]||!nu[ge]):!!(_t==="application/xhtml+xml"&&et[V.namespaceURI]):!1},bi=function(V){mu(e.removed,{element:V});try{V.parentNode.removeChild(V)}catch{try{V.outerHTML=G}catch{V.remove()}}},gh=function(V,ae){try{mu(e.removed,{attribute:ae.getAttributeNode(V),from:ae})}catch{mu(e.removed,{attribute:null,from:ae})}if(ae.removeAttribute(V),V==="is"&&!_[V])if(Pe||Fe)try{bi(ae)}catch{}else try{ae.setAttribute(V,"")}catch{}},dm=function(V){var ae,ge;if($e)V="<remove></remove>"+V;else{var lt=rV(V,/^[\r\n\t ]+/);ge=lt&&lt[0]}_t==="application/xhtml+xml"&&ze===ke&&(V='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+V+"</body></html>");var Pn=X?X.createHTML(V):V;if(ze===ke)try{ae=new g().parseFromString(Pn,_t)}catch{}if(!ae||!ae.documentElement){ae=re.createDocument(ze,"template",null);try{ae.documentElement.innerHTML=Tt?G:Pn}catch{}}var Ht=ae.body||ae.documentElement;return V&&ge&&Ht.insertBefore(r.createTextNode(ge),Ht.childNodes[0]||null),ze===ke?b.call(ae,ee?"html":"body")[0]:ee?ae.documentElement:Ht},fm=function(V){return v.call(V.ownerDocument||V,V,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT,null,!1)},k=function(V){return V instanceof d&&(typeof V.nodeName!="string"||typeof V.textContent!="string"||typeof V.removeChild!="function"||!(V.attributes instanceof c)||typeof V.removeAttribute!="function"||typeof V.setAttribute!="function"||typeof V.namespaceURI!="string"||typeof V.insertBefore!="function"||typeof V.hasChildNodes!="function")},ue=function(V){return jo(s)==="object"?V instanceof s:V&&jo(V)==="object"&&typeof V.nodeType=="number"&&typeof V.nodeName=="string"},me=function(V,ae,ge){x[V]&&nV(x[V],function(lt){lt.call(e,ae,ge,cn)})},Ve=function(V){var ae;if(me("beforeSanitizeElements",V,null),k(V)||jn(/[\u0080-\uFFFF]/,V.nodeName))return bi(V),!0;var ge=xt(V.nodeName);if(me("uponSanitizeElement",V,{tagName:ge,allowedTags:T}),V.hasChildNodes()&&!ue(V.firstElementChild)&&(!ue(V.content)||!ue(V.content.firstElementChild))&&jn(/<[/\w]/g,V.innerHTML)&&jn(/<[/\w]/g,V.textContent)||ge==="select"&&jn(/<template/i,V.innerHTML))return bi(V),!0;if(!T[ge]||ie[ge]){if(!ie[ge]&&vt(ge)&&(U.tagNameCheck instanceof RegExp&&jn(U.tagNameCheck,ge)||U.tagNameCheck instanceof Function&&U.tagNameCheck(ge)))return!1;if(J&&!K[ge]){var lt=y(V)||V.parentNode,Pn=M(V)||V.childNodes;if(Pn&&lt)for(var Ht=Pn.length,xn=Ht-1;xn>=0;--xn)lt.insertBefore(E(Pn[xn],!0),I(V))}return bi(V),!0}return V instanceof a&&!hm(V)||(ge==="noscript"||ge==="noembed"||ge==="noframes")&&jn(/<\/no(script|embed|frames)/i,V.innerHTML)?(bi(V),!0):(we&&V.nodeType===3&&(ae=V.textContent,ae=Jr(ae,W," "),ae=Jr(ae,D," "),ae=Jr(ae,B," "),V.textContent!==ae&&(mu(e.removed,{element:V.cloneNode()}),V.textContent=ae)),me("afterSanitizeElements",V,null),!1)},ft=function(V,ae,ge){if(R&&(ae==="id"||ae==="name")&&(ge in r||ge in eo))return!1;if(!(de&&!se[ae]&&jn(z,ae))){if(!(oe&&jn(w,ae))){if(!_[ae]||se[ae]){if(!(vt(V)&&(U.tagNameCheck instanceof RegExp&&jn(U.tagNameCheck,V)||U.tagNameCheck instanceof Function&&U.tagNameCheck(V))&&(U.attributeNameCheck instanceof RegExp&&jn(U.attributeNameCheck,ae)||U.attributeNameCheck instanceof Function&&U.attributeNameCheck(ae))||ae==="is"&&U.allowCustomizedBuiltInElements&&(U.tagNameCheck instanceof RegExp&&jn(U.tagNameCheck,ge)||U.tagNameCheck instanceof Function&&U.tagNameCheck(ge))))return!1}else if(!ne[ae]){if(!jn(m,Jr(ge,f,""))){if(!((ae==="src"||ae==="xlink:href"||ae==="href")&&V!=="script"&&iV(ge,"data:")===0&&te[V])){if(!(Se&&!jn(h,Jr(ge,f,"")))){if(ge)return!1}}}}}}return!0},vt=function(V){return V.indexOf("-")>0},ut=function(V){var ae,ge,lt,Pn;me("beforeSanitizeAttributes",V,null);var Ht=V.attributes;if(Ht){var xn={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:_};for(Pn=Ht.length;Pn--;){ae=Ht[Pn];var gm=ae,Tn=gm.name,aR=gm.namespaceURI;if(ge=Tn==="value"?ae.value:oV(ae.value),lt=xt(Tn),xn.attrName=lt,xn.attrValue=ge,xn.keepAttr=!0,xn.forceKeepAttr=void 0,me("uponSanitizeAttribute",V,xn),ge=xn.attrValue,!xn.forceKeepAttr&&(gh(Tn,V),!!xn.keepAttr)){if(!pe&&jn(/\/>/i,ge)){gh(Tn,V);continue}we&&(ge=Jr(ge,W," "),ge=Jr(ge,D," "),ge=Jr(ge,B," "));var gN=xt(V.nodeName);if(ft(gN,lt,ge)){if(A&&(lt==="id"||lt==="name")&&(gh(Tn,V),ge=N+ge),X&&jo(p)==="object"&&typeof p.getAttributeType=="function"&&!aR)switch(p.getAttributeType(gN,lt)){case"TrustedHTML":{ge=X.createHTML(ge);break}case"TrustedScriptURL":{ge=X.createScriptURL(ge);break}}try{aR?V.setAttributeNS(aR,Tn,ge):V.setAttribute(Tn,ge),jE(e.removed)}catch{}}}}me("afterSanitizeAttributes",V,null)}},at=function Re(V){var ae,ge=fm(V);for(me("beforeSanitizeShadowDOM",V,null);ae=ge.nextNode();)me("uponSanitizeShadowNode",ae,null),!Ve(ae)&&(ae.content instanceof i&&Re(ae.content),ut(ae));me("afterSanitizeShadowDOM",V,null)};return e.sanitize=function(Re){var V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ae,ge,lt,Pn,Ht;if(Tt=!Re,Tt&&(Re="<!-->"),typeof Re!="string"&&!ue(Re))if(typeof Re.toString=="function"){if(Re=Re.toString(),typeof Re!="string")throw gp("dirty is not a string, aborting")}else throw gp("toString is not a function");if(!e.isSupported){if(jo(t.toStaticHTML)==="object"||typeof t.toStaticHTML=="function"){if(typeof Re=="string")return t.toStaticHTML(Re);if(ue(Re))return t.toStaticHTML(Re.outerHTML)}return Re}if(ye||rn(V),e.removed=[],typeof Re=="string"&&(F=!1),F){if(Re.nodeName){var xn=xt(Re.nodeName);if(!T[xn]||ie[xn])throw gp("root node is forbidden and cannot be sanitized in-place")}}else if(Re instanceof s)ae=dm("<!---->"),ge=ae.ownerDocument.importNode(Re,!0),ge.nodeType===1&&ge.nodeName==="BODY"||ge.nodeName==="HTML"?ae=ge:ae.appendChild(ge);else{if(!Pe&&!we&&!ee&&Re.indexOf("<")===-1)return X&&xe?X.createHTML(Re):Re;if(ae=dm(Re),!ae)return Pe?null:xe?G:""}ae&&$e&&bi(ae.firstChild);for(var gm=fm(F?Re:ae);lt=gm.nextNode();)lt.nodeType===3&&lt===Pn||Ve(lt)||(lt.content instanceof i&&at(lt.content),ut(lt),Pn=lt);if(Pn=null,F)return Re;if(Pe){if(Fe)for(Ht=S.call(ae.ownerDocument);ae.firstChild;)Ht.appendChild(ae.firstChild);else Ht=ae;return(_.shadowroot||_.shadowrootmod)&&(Ht=L.call(n,Ht,!0)),Ht}var Tn=ee?ae.outerHTML:ae.innerHTML;return ee&&T["!doctype"]&&ae.ownerDocument&&ae.ownerDocument.doctype&&ae.ownerDocument.doctype.name&&jn(wV,ae.ownerDocument.doctype.name)&&(Tn="<!DOCTYPE "+ae.ownerDocument.doctype.name+`>
`+Tn),we&&(Tn=Jr(Tn,W," "),Tn=Jr(Tn,D," "),Tn=Jr(Tn,B," ")),X&&xe?X.createHTML(Tn):Tn},e.setConfig=function(Re){rn(Re),ye=!0},e.clearConfig=function(){cn=null,ye=!1},e.isValidAttribute=function(Re,V,ae){cn||rn({});var ge=xt(Re),lt=xt(V);return ft(ge,lt,ae)},e.addHook=function(Re,V){typeof V=="function"&&(x[Re]=x[Re]||[],mu(x[Re],V))},e.removeHook=function(Re){if(x[Re])return jE(x[Re])},e.removeHooks=function(Re){x[Re]&&(x[Re]=[])},e.removeAllHooks=function(){x={}},e}var SV=QE();//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var JE;function le(){return JE.apply(null,arguments)}function yV(t){JE=t}function ei(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function Fs(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function mt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function vp(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(mt(t,e))return!1;return!0}function or(t){return t===void 0}function no(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function pu(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function e0(t,e){var n=[],r,i=t.length;for(r=0;r<i;++r)n.push(e(t[r],r));return n}function Ko(t,e){for(var n in e)mt(e,n)&&(t[n]=e[n]);return mt(e,"toString")&&(t.toString=e.toString),mt(e,"valueOf")&&(t.valueOf=e.valueOf),t}function _i(t,e,n,r){return M0(t,e,n,r,!0).utc()}function bV(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Qe(t){return t._pf==null&&(t._pf=bV()),t._pf}var Sp;Array.prototype.some?Sp=Array.prototype.some:Sp=function(t){var e=Object(this),n=e.length>>>0,r;for(r=0;r<n;r++)if(r in e&&t.call(this,e[r],r,e))return!0;return!1};function yp(t){if(t._isValid==null){var e=Qe(t),n=Sp.call(e.parsedDateParts,function(i){return i!=null}),r=!isNaN(t._d.getTime())&&e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n);if(t._strict&&(r=r&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=r;else return r}return t._isValid}function kh(t){var e=_i(NaN);return t!=null?Ko(Qe(e),t):Qe(e).userInvalidated=!0,e}var t0=le.momentProperties=[],bp=!1;function Rp(t,e){var n,r,i,o=t0.length;if(or(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),or(e._i)||(t._i=e._i),or(e._f)||(t._f=e._f),or(e._l)||(t._l=e._l),or(e._strict)||(t._strict=e._strict),or(e._tzm)||(t._tzm=e._tzm),or(e._isUTC)||(t._isUTC=e._isUTC),or(e._offset)||(t._offset=e._offset),or(e._pf)||(t._pf=Qe(e)),or(e._locale)||(t._locale=e._locale),o>0)for(n=0;n<o;n++)r=t0[n],i=e[r],or(i)||(t[r]=i);return t}function wu(t){Rp(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),bp===!1&&(bp=!0,le.updateOffset(this),bp=!1)}function ti(t){return t instanceof wu||t!=null&&t._isAMomentObject!=null}function n0(t){le.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function Pr(t,e){var n=!0;return Ko(function(){if(le.deprecationHandler!=null&&le.deprecationHandler(null,t),n){var r=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])mt(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];r.push(i)}n0(t+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var r0={};function i0(t,e){le.deprecationHandler!=null&&le.deprecationHandler(t,e),r0[t]||(n0(e),r0[t]=!0)}le.suppressDeprecationWarnings=!1,le.deprecationHandler=null;function Mi(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function RV(t){var e,n;for(n in t)mt(t,n)&&(e=t[n],Mi(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function Ep(t,e){var n=Ko({},t),r;for(r in e)mt(e,r)&&(Fs(t[r])&&Fs(e[r])?(n[r]={},Ko(n[r],t[r]),Ko(n[r],e[r])):e[r]!=null?n[r]=e[r]:delete n[r]);for(r in t)mt(t,r)&&!mt(e,r)&&Fs(t[r])&&(n[r]=Ko({},n[r]));return n}function Tp(t){t!=null&&this.set(t)}var _p;Object.keys?_p=Object.keys:_p=function(t){var e,n=[];for(e in t)mt(t,e)&&n.push(e);return n};var EV={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function TV(t,e,n){var r=this._calendar[t]||this._calendar.sameElse;return Mi(r)?r.call(e,n):r}function Oi(t,e,n){var r=""+Math.abs(t),i=e-r.length,o=t>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var Mp=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Fh=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Op={},ka={};function Ne(t,e,n,r){var i=r;typeof r=="string"&&(i=function(){return this[r]()}),t&&(ka[t]=i),e&&(ka[e[0]]=function(){return Oi(i.apply(this,arguments),e[1],e[2])}),n&&(ka[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function _V(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function MV(t){var e=t.match(Mp),n,r;for(n=0,r=e.length;n<r;n++)ka[e[n]]?e[n]=ka[e[n]]:e[n]=_V(e[n]);return function(i){var o="",s;for(s=0;s<r;s++)o+=Mi(e[s])?e[s].call(i,t):e[s];return o}}function Wh(t,e){return t.isValid()?(e=o0(e,t.localeData()),Op[e]=Op[e]||MV(e),Op[e](t)):t.localeData().invalidDate()}function o0(t,e){var n=5;function r(i){return e.longDateFormat(i)||i}for(Fh.lastIndex=0;n>=0&&Fh.test(t);)t=t.replace(Fh,r),Fh.lastIndex=0,n-=1;return t}var OV={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function AV(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(Mp).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[t])}var IV="Invalid date";function PV(){return this._invalidDate}var xV="%d",HV=/\d{1,2}/;function DV(t){return this._ordinal.replace("%d",t)}var NV={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function LV(t,e,n,r){var i=this._relativeTime[n];return Mi(i)?i(t,e,n,r):i.replace(/%d/i,t)}function $V(t,e){var n=this._relativeTime[t>0?"future":"past"];return Mi(n)?n(e):n.replace(/%s/i,e)}var Cu={};function Dn(t,e){var n=t.toLowerCase();Cu[n]=Cu[n+"s"]=Cu[e]=t}function xr(t){return typeof t=="string"?Cu[t]||Cu[t.toLowerCase()]:void 0}function Ap(t){var e={},n,r;for(r in t)mt(t,r)&&(n=xr(r),n&&(e[n]=t[r]));return e}var s0={};function Nn(t,e){s0[t]=e}function kV(t){var e=[],n;for(n in t)mt(t,n)&&e.push({unit:n,priority:s0[n]});return e.sort(function(r,i){return r.priority-i.priority}),e}function Vh(t){return t%4===0&&t%100!==0||t%400===0}function Hr(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function ot(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=Hr(e)),n}function Fa(t,e){return function(n){return n!=null?(a0(this,t,n),le.updateOffset(this,e),this):Bh(this,t)}}function Bh(t,e){return t.isValid()?t._d["get"+(t._isUTC?"UTC":"")+e]():NaN}function a0(t,e,n){t.isValid()&&!isNaN(n)&&(e==="FullYear"&&Vh(t.year())&&t.month()===1&&t.date()===29?(n=ot(n),t._d["set"+(t._isUTC?"UTC":"")+e](n,t.month(),Xh(n,t.month()))):t._d["set"+(t._isUTC?"UTC":"")+e](n))}function FV(t){return t=xr(t),Mi(this[t])?this[t]():this}function WV(t,e){if(typeof t=="object"){t=Ap(t);var n=kV(t),r,i=n.length;for(r=0;r<i;r++)this[n[r].unit](t[n[r].unit])}else if(t=xr(t),Mi(this[t]))return this[t](e);return this}var l0=/\d/,vr=/\d\d/,u0=/\d{3}/,Ip=/\d{4}/,Uh=/[+-]?\d{6}/,Nt=/\d\d?/,c0=/\d\d\d\d?/,h0=/\d\d\d\d\d\d?/,Yh=/\d{1,3}/,Pp=/\d{1,4}/,Gh=/[+-]?\d{1,6}/,Wa=/\d+/,zh=/[+-]?\d+/,VV=/Z|[+-]\d\d:?\d\d/gi,jh=/Z|[+-]\d\d(?::?\d\d)?/gi,BV=/[+-]?\d+(\.\d{1,3})?/,vu=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Kh;Kh={};function Me(t,e,n){Kh[t]=Mi(e)?e:function(r,i){return r&&n?n:e}}function UV(t,e){return mt(Kh,t)?Kh[t](e._strict,e._locale):new RegExp(YV(t))}function YV(t){return Sr(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,r,i,o){return n||r||i||o}))}function Sr(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var xp={};function Rt(t,e){var n,r=e,i;for(typeof t=="string"&&(t=[t]),no(e)&&(r=function(o,s){s[e]=ot(o)}),i=t.length,n=0;n<i;n++)xp[t[n]]=r}function Su(t,e){Rt(t,function(n,r,i,o){i._w=i._w||{},e(n,i._w,i,o)})}function GV(t,e,n){e!=null&&mt(xp,t)&&xp[t](e,n._a,n,t)}var Ln=0,ro=1,Ai=2,pn=3,ni=4,io=5,Ws=6,zV=7,jV=8;function KV(t,e){return(t%e+e)%e}var on;Array.prototype.indexOf?on=Array.prototype.indexOf:on=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function Xh(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=KV(e,12);return t+=(e-n)/12,n===1?Vh(t)?29:28:31-n%7%2}Ne("M",["MM",2],"Mo",function(){return this.month()+1}),Ne("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)}),Ne("MMMM",0,0,function(t){return this.localeData().months(this,t)}),Dn("month","M"),Nn("month",8),Me("M",Nt),Me("MM",Nt,vr),Me("MMM",function(t,e){return e.monthsShortRegex(t)}),Me("MMMM",function(t,e){return e.monthsRegex(t)}),Rt(["M","MM"],function(t,e){e[ro]=ot(t)-1}),Rt(["MMM","MMMM"],function(t,e,n,r){var i=n._locale.monthsParse(t,r,n._strict);i!=null?e[ro]=i:Qe(n).invalidMonth=t});var XV="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),d0="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),f0=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,qV=vu,ZV=vu;function QV(t,e){return t?ei(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||f0).test(e)?"format":"standalone"][t.month()]:ei(this._months)?this._months:this._months.standalone}function JV(t,e){return t?ei(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[f0.test(e)?"format":"standalone"][t.month()]:ei(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function eB(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)o=_i([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return n?e==="MMM"?(i=on.call(this._shortMonthsParse,s),i!==-1?i:null):(i=on.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=on.call(this._shortMonthsParse,s),i!==-1?i:(i=on.call(this._longMonthsParse,s),i!==-1?i:null)):(i=on.call(this._longMonthsParse,s),i!==-1?i:(i=on.call(this._shortMonthsParse,s),i!==-1?i:null))}function tB(t,e,n){var r,i,o;if(this._monthsParseExact)return eB.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=_i([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!n&&!this._monthsParse[r]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[r].test(t))return r;if(n&&e==="MMM"&&this._shortMonthsParse[r].test(t))return r;if(!n&&this._monthsParse[r].test(t))return r}}function g0(t,e){var n;if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=ot(e);else if(e=t.localeData().monthsParse(e),!no(e))return t}return n=Math.min(t.date(),Xh(t.year(),e)),t._d["set"+(t._isUTC?"UTC":"")+"Month"](e,n),t}function m0(t){return t!=null?(g0(this,t),le.updateOffset(this,!0),this):Bh(this,"Month")}function nB(){return Xh(this.year(),this.month())}function rB(t){return this._monthsParseExact?(mt(this,"_monthsRegex")||p0.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(mt(this,"_monthsShortRegex")||(this._monthsShortRegex=qV),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function iB(t){return this._monthsParseExact?(mt(this,"_monthsRegex")||p0.call(this),t?this._monthsStrictRegex:this._monthsRegex):(mt(this,"_monthsRegex")||(this._monthsRegex=ZV),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function p0(){function t(s,a){return a.length-s.length}var e=[],n=[],r=[],i,o;for(i=0;i<12;i++)o=_i([2e3,i]),e.push(this.monthsShort(o,"")),n.push(this.months(o,"")),r.push(this.months(o,"")),r.push(this.monthsShort(o,""));for(e.sort(t),n.sort(t),r.sort(t),i=0;i<12;i++)e[i]=Sr(e[i]),n[i]=Sr(n[i]);for(i=0;i<24;i++)r[i]=Sr(r[i]);this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}Ne("Y",0,0,function(){var t=this.year();return t<=9999?Oi(t,4):"+"+t}),Ne(0,["YY",2],0,function(){return this.year()%100}),Ne(0,["YYYY",4],0,"year"),Ne(0,["YYYYY",5],0,"year"),Ne(0,["YYYYYY",6,!0],0,"year"),Dn("year","y"),Nn("year",1),Me("Y",zh),Me("YY",Nt,vr),Me("YYYY",Pp,Ip),Me("YYYYY",Gh,Uh),Me("YYYYYY",Gh,Uh),Rt(["YYYYY","YYYYYY"],Ln),Rt("YYYY",function(t,e){e[Ln]=t.length===2?le.parseTwoDigitYear(t):ot(t)}),Rt("YY",function(t,e){e[Ln]=le.parseTwoDigitYear(t)}),Rt("Y",function(t,e){e[Ln]=parseInt(t,10)});function yu(t){return Vh(t)?366:365}le.parseTwoDigitYear=function(t){return ot(t)+(ot(t)>68?1900:2e3)};var w0=Fa("FullYear",!0);function oB(){return Vh(this.year())}function sB(t,e,n,r,i,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,r,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,r,i,o,s),a}function bu(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function qh(t,e,n){var r=7+e-n,i=(7+bu(t,0,r).getUTCDay()-e)%7;return-i+r-1}function C0(t,e,n,r,i){var o=(7+n-r)%7,s=qh(t,r,i),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=yu(l)+a):a>yu(t)?(l=t+1,u=a-yu(t)):(l=t,u=a),{year:l,dayOfYear:u}}function Ru(t,e,n){var r=qh(t.year(),e,n),i=Math.floor((t.dayOfYear()-r-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+oo(s,e,n)):i>oo(t.year(),e,n)?(o=i-oo(t.year(),e,n),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function oo(t,e,n){var r=qh(t,e,n),i=qh(t+1,e,n);return(yu(t)-r+i)/7}Ne("w",["ww",2],"wo","week"),Ne("W",["WW",2],"Wo","isoWeek"),Dn("week","w"),Dn("isoWeek","W"),Nn("week",5),Nn("isoWeek",5),Me("w",Nt),Me("ww",Nt,vr),Me("W",Nt),Me("WW",Nt,vr),Su(["w","ww","W","WW"],function(t,e,n,r){e[r.substr(0,1)]=ot(t)});function aB(t){return Ru(t,this._week.dow,this._week.doy).week}var lB={dow:0,doy:6};function uB(){return this._week.dow}function cB(){return this._week.doy}function hB(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function dB(t){var e=Ru(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Ne("d",0,"do","day"),Ne("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)}),Ne("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)}),Ne("dddd",0,0,function(t){return this.localeData().weekdays(this,t)}),Ne("e",0,0,"weekday"),Ne("E",0,0,"isoWeekday"),Dn("day","d"),Dn("weekday","e"),Dn("isoWeekday","E"),Nn("day",11),Nn("weekday",11),Nn("isoWeekday",11),Me("d",Nt),Me("e",Nt),Me("E",Nt),Me("dd",function(t,e){return e.weekdaysMinRegex(t)}),Me("ddd",function(t,e){return e.weekdaysShortRegex(t)}),Me("dddd",function(t,e){return e.weekdaysRegex(t)}),Su(["dd","ddd","dddd"],function(t,e,n,r){var i=n._locale.weekdaysParse(t,r,n._strict);i!=null?e.d=i:Qe(n).invalidWeekday=t}),Su(["d","e","E"],function(t,e,n,r){e[r]=ot(t)});function fB(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function gB(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function Hp(t,e){return t.slice(e,7).concat(t.slice(0,e))}var mB="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),v0="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),pB="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),wB=vu,CB=vu,vB=vu;function SB(t,e){var n=ei(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?Hp(n,this._week.dow):t?n[t.day()]:n}function yB(t){return t===!0?Hp(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function bB(t){return t===!0?Hp(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function RB(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)o=_i([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return n?e==="dddd"?(i=on.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=on.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=on.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=on.call(this._weekdaysParse,s),i!==-1||(i=on.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=on.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=on.call(this._shortWeekdaysParse,s),i!==-1||(i=on.call(this._weekdaysParse,s),i!==-1)?i:(i=on.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=on.call(this._minWeekdaysParse,s),i!==-1||(i=on.call(this._weekdaysParse,s),i!==-1)?i:(i=on.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function EB(t,e,n){var r,i,o;if(this._weekdaysParseExact)return RB.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=_i([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[r].test(t))return r;if(n&&e==="ddd"&&this._shortWeekdaysParse[r].test(t))return r;if(n&&e==="dd"&&this._minWeekdaysParse[r].test(t))return r;if(!n&&this._weekdaysParse[r].test(t))return r}}function TB(t){if(!this.isValid())return t!=null?this:NaN;var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return t!=null?(t=fB(t,this.localeData()),this.add(t-e,"d")):e}function _B(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function MB(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=gB(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function OB(t){return this._weekdaysParseExact?(mt(this,"_weekdaysRegex")||Dp.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(mt(this,"_weekdaysRegex")||(this._weekdaysRegex=wB),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function AB(t){return this._weekdaysParseExact?(mt(this,"_weekdaysRegex")||Dp.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(mt(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=CB),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function IB(t){return this._weekdaysParseExact?(mt(this,"_weekdaysRegex")||Dp.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(mt(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=vB),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Dp(){function t(c,d){return d.length-c.length}var e=[],n=[],r=[],i=[],o,s,a,l,u;for(o=0;o<7;o++)s=_i([2e3,1]).day(o),a=Sr(this.weekdaysMin(s,"")),l=Sr(this.weekdaysShort(s,"")),u=Sr(this.weekdays(s,"")),e.push(a),n.push(l),r.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),n.sort(t),r.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function Np(){return this.hours()%12||12}function PB(){return this.hours()||24}Ne("H",["HH",2],0,"hour"),Ne("h",["hh",2],0,Np),Ne("k",["kk",2],0,PB),Ne("hmm",0,0,function(){return""+Np.apply(this)+Oi(this.minutes(),2)}),Ne("hmmss",0,0,function(){return""+Np.apply(this)+Oi(this.minutes(),2)+Oi(this.seconds(),2)}),Ne("Hmm",0,0,function(){return""+this.hours()+Oi(this.minutes(),2)}),Ne("Hmmss",0,0,function(){return""+this.hours()+Oi(this.minutes(),2)+Oi(this.seconds(),2)});function S0(t,e){Ne(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}S0("a",!0),S0("A",!1),Dn("hour","h"),Nn("hour",13);function y0(t,e){return e._meridiemParse}Me("a",y0),Me("A",y0),Me("H",Nt),Me("h",Nt),Me("k",Nt),Me("HH",Nt,vr),Me("hh",Nt,vr),Me("kk",Nt,vr),Me("hmm",c0),Me("hmmss",h0),Me("Hmm",c0),Me("Hmmss",h0),Rt(["H","HH"],pn),Rt(["k","kk"],function(t,e,n){var r=ot(t);e[pn]=r===24?0:r}),Rt(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t}),Rt(["h","hh"],function(t,e,n){e[pn]=ot(t),Qe(n).bigHour=!0}),Rt("hmm",function(t,e,n){var r=t.length-2;e[pn]=ot(t.substr(0,r)),e[ni]=ot(t.substr(r)),Qe(n).bigHour=!0}),Rt("hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[pn]=ot(t.substr(0,r)),e[ni]=ot(t.substr(r,2)),e[io]=ot(t.substr(i)),Qe(n).bigHour=!0}),Rt("Hmm",function(t,e,n){var r=t.length-2;e[pn]=ot(t.substr(0,r)),e[ni]=ot(t.substr(r))}),Rt("Hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[pn]=ot(t.substr(0,r)),e[ni]=ot(t.substr(r,2)),e[io]=ot(t.substr(i))});function xB(t){return(t+"").toLowerCase().charAt(0)==="p"}var HB=/[ap]\.?m?\.?/i,DB=Fa("Hours",!0);function NB(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var b0={calendar:EV,longDateFormat:OV,invalidDate:IV,ordinal:xV,dayOfMonthOrdinalParse:HV,relativeTime:NV,months:XV,monthsShort:d0,week:lB,weekdays:mB,weekdaysMin:pB,weekdaysShort:v0,meridiemParse:HB},Ft={},Eu={},Tu;function LB(t,e){var n,r=Math.min(t.length,e.length);for(n=0;n<r;n+=1)if(t[n]!==e[n])return n;return r}function R0(t){return t&&t.toLowerCase().replace("_","-")}function $B(t){for(var e=0,n,r,i,o;e<t.length;){for(o=R0(t[e]).split("-"),n=o.length,r=R0(t[e+1]),r=r?r.split("-"):null;n>0;){if(i=Zh(o.slice(0,n).join("-")),i)return i;if(r&&r.length>=n&&LB(o,r)>=n-1)break;n--}e++}return Tu}function kB(t){return t.match("^[^/\\\\]*$")!=null}function Zh(t){var e=null,n;if(Ft[t]===void 0&&typeof module<"u"&&module&&module.exports&&kB(t))try{e=Tu._abbr,n=require,n("./locale/"+t),Xo(e)}catch{Ft[t]=null}return Ft[t]}function Xo(t,e){var n;return t&&(or(e)?n=so(t):n=Lp(t,e),n?Tu=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),Tu._abbr}function Lp(t,e){if(e!==null){var n,r=b0;if(e.abbr=t,Ft[t]!=null)i0("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=Ft[t]._config;else if(e.parentLocale!=null)if(Ft[e.parentLocale]!=null)r=Ft[e.parentLocale]._config;else if(n=Zh(e.parentLocale),n!=null)r=n._config;else return Eu[e.parentLocale]||(Eu[e.parentLocale]=[]),Eu[e.parentLocale].push({name:t,config:e}),null;return Ft[t]=new Tp(Ep(r,e)),Eu[t]&&Eu[t].forEach(function(i){Lp(i.name,i.config)}),Xo(t),Ft[t]}else return delete Ft[t],null}function FB(t,e){if(e!=null){var n,r,i=b0;Ft[t]!=null&&Ft[t].parentLocale!=null?Ft[t].set(Ep(Ft[t]._config,e)):(r=Zh(t),r!=null&&(i=r._config),e=Ep(i,e),r==null&&(e.abbr=t),n=new Tp(e),n.parentLocale=Ft[t],Ft[t]=n),Xo(t)}else Ft[t]!=null&&(Ft[t].parentLocale!=null?(Ft[t]=Ft[t].parentLocale,t===Xo()&&Xo(t)):Ft[t]!=null&&delete Ft[t]);return Ft[t]}function so(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Tu;if(!ei(t)){if(e=Zh(t),e)return e;t=[t]}return $B(t)}function WB(){return _p(Ft)}function $p(t){var e,n=t._a;return n&&Qe(t).overflow===-2&&(e=n[ro]<0||n[ro]>11?ro:n[Ai]<1||n[Ai]>Xh(n[Ln],n[ro])?Ai:n[pn]<0||n[pn]>24||n[pn]===24&&(n[ni]!==0||n[io]!==0||n[Ws]!==0)?pn:n[ni]<0||n[ni]>59?ni:n[io]<0||n[io]>59?io:n[Ws]<0||n[Ws]>999?Ws:-1,Qe(t)._overflowDayOfYear&&(e<Ln||e>Ai)&&(e=Ai),Qe(t)._overflowWeeks&&e===-1&&(e=zV),Qe(t)._overflowWeekday&&e===-1&&(e=jV),Qe(t).overflow=e),t}var VB=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,BB=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,UB=/Z|[+-]\d\d(?::?\d\d)?/,Qh=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],kp=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],YB=/^\/?Date\((-?\d+)/i,GB=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,zB={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function E0(t){var e,n,r=t._i,i=VB.exec(r)||BB.exec(r),o,s,a,l,u=Qh.length,c=kp.length;if(i){for(Qe(t).iso=!0,e=0,n=u;e<n;e++)if(Qh[e][1].exec(i[1])){s=Qh[e][0],o=Qh[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,n=c;e<n;e++)if(kp[e][1].exec(i[3])){a=(i[2]||" ")+kp[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(i[4])if(UB.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),Wp(t)}else t._isValid=!1}function jB(t,e,n,r,i,o){var s=[KB(t),d0.indexOf(e),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function KB(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function XB(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function qB(t,e,n){if(t){var r=v0.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(r!==i)return Qe(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function ZB(t,e,n){if(t)return zB[t];if(e)return 0;var r=parseInt(n,10),i=r%100,o=(r-i)/100;return o*60+i}function T0(t){var e=GB.exec(XB(t._i)),n;if(e){if(n=jB(e[4],e[3],e[2],e[5],e[6],e[7]),!qB(e[1],n,t))return;t._a=n,t._tzm=ZB(e[8],e[9],e[10]),t._d=bu.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),Qe(t).rfc2822=!0}else t._isValid=!1}function QB(t){var e=YB.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(E0(t),t._isValid===!1)delete t._isValid;else return;if(T0(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:le.createFromInputFallback(t)}le.createFromInputFallback=Pr("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function Va(t,e,n){return t??e??n}function JB(t){var e=new Date(le.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function Fp(t){var e,n,r=[],i,o,s;if(!t._d){for(i=JB(t),t._w&&t._a[Ai]==null&&t._a[ro]==null&&eU(t),t._dayOfYear!=null&&(s=Va(t._a[Ln],i[Ln]),(t._dayOfYear>yu(s)||t._dayOfYear===0)&&(Qe(t)._overflowDayOfYear=!0),n=bu(s,0,t._dayOfYear),t._a[ro]=n.getUTCMonth(),t._a[Ai]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=r[e]=i[e];for(;e<7;e++)t._a[e]=r[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[pn]===24&&t._a[ni]===0&&t._a[io]===0&&t._a[Ws]===0&&(t._nextDay=!0,t._a[pn]=0),t._d=(t._useUTC?bu:sB).apply(null,r),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[pn]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(Qe(t).weekdayMismatch=!0)}}function eU(t){var e,n,r,i,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,n=Va(e.GG,t._a[Ln],Ru(Lt(),1,4).year),r=Va(e.W,1),i=Va(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=Ru(Lt(),o,s),n=Va(e.gg,t._a[Ln],u.year),r=Va(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),r<1||r>oo(n,o,s)?Qe(t)._overflowWeeks=!0:l!=null?Qe(t)._overflowWeekday=!0:(a=C0(n,r,i,o,s),t._a[Ln]=a.year,t._dayOfYear=a.dayOfYear)}le.ISO_8601=function(){},le.RFC_2822=function(){};function Wp(t){if(t._f===le.ISO_8601){E0(t);return}if(t._f===le.RFC_2822){T0(t);return}t._a=[],Qe(t).empty=!0;var e=""+t._i,n,r,i,o,s,a=e.length,l=0,u,c;for(i=o0(t._f,t._locale).match(Mp)||[],c=i.length,n=0;n<c;n++)o=i[n],r=(e.match(UV(o,t))||[])[0],r&&(s=e.substr(0,e.indexOf(r)),s.length>0&&Qe(t).unusedInput.push(s),e=e.slice(e.indexOf(r)+r.length),l+=r.length),ka[o]?(r?Qe(t).empty=!1:Qe(t).unusedTokens.push(o),GV(o,r,t)):t._strict&&!r&&Qe(t).unusedTokens.push(o);Qe(t).charsLeftOver=a-l,e.length>0&&Qe(t).unusedInput.push(e),t._a[pn]<=12&&Qe(t).bigHour===!0&&t._a[pn]>0&&(Qe(t).bigHour=void 0),Qe(t).parsedDateParts=t._a.slice(0),Qe(t).meridiem=t._meridiem,t._a[pn]=tU(t._locale,t._a[pn],t._meridiem),u=Qe(t).era,u!==null&&(t._a[Ln]=t._locale.erasConvertYear(u,t._a[Ln])),Fp(t),$p(t)}function tU(t,e,n){var r;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(r=t.isPM(n),r&&e<12&&(e+=12),!r&&e===12&&(e=0)),e)}function nU(t){var e,n,r,i,o,s,a=!1,l=t._f.length;if(l===0){Qe(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,s=!1,e=Rp({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],Wp(e),yp(e)&&(s=!0),o+=Qe(e).charsLeftOver,o+=Qe(e).unusedTokens.length*10,Qe(e).score=o,a?o<r&&(r=o,n=e):(r==null||o<r||s)&&(r=o,n=e,s&&(a=!0));Ko(t,n||e)}function rU(t){if(!t._d){var e=Ap(t._i),n=e.day===void 0?e.date:e.day;t._a=e0([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(r){return r&&parseInt(r,10)}),Fp(t)}}function iU(t){var e=new wu($p(_0(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function _0(t){var e=t._i,n=t._f;return t._locale=t._locale||so(t._l),e===null||n===void 0&&e===""?kh({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),ti(e)?new wu($p(e)):(pu(e)?t._d=e:ei(n)?nU(t):n?Wp(t):oU(t),yp(t)||(t._d=null),t))}function oU(t){var e=t._i;or(e)?t._d=new Date(le.now()):pu(e)?t._d=new Date(e.valueOf()):typeof e=="string"?QB(t):ei(e)?(t._a=e0(e.slice(0),function(n){return parseInt(n,10)}),Fp(t)):Fs(e)?rU(t):no(e)?t._d=new Date(e):le.createFromInputFallback(t)}function M0(t,e,n,r,i){var o={};return(e===!0||e===!1)&&(r=e,e=void 0),(n===!0||n===!1)&&(r=n,n=void 0),(Fs(t)&&vp(t)||ei(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=n,o._i=t,o._f=e,o._strict=r,iU(o)}function Lt(t,e,n,r){return M0(t,e,n,r,!1)}var sU=Pr("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Lt.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:kh()}),aU=Pr("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Lt.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:kh()});function O0(t,e){var n,r;if(e.length===1&&ei(e[0])&&(e=e[0]),!e.length)return Lt();for(n=e[0],r=1;r<e.length;++r)(!e[r].isValid()||e[r][t](n))&&(n=e[r]);return n}function lU(){var t=[].slice.call(arguments,0);return O0("isBefore",t)}function uU(){var t=[].slice.call(arguments,0);return O0("isAfter",t)}var cU=function(){return Date.now?Date.now():+new Date},_u=["year","quarter","month","week","day","hour","minute","second","millisecond"];function hU(t){var e,n=!1,r,i=_u.length;for(e in t)if(mt(t,e)&&!(on.call(_u,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(r=0;r<i;++r)if(t[_u[r]]){if(n)return!1;parseFloat(t[_u[r]])!==ot(t[_u[r]])&&(n=!0)}return!0}function dU(){return this._isValid}function fU(){return ri(NaN)}function Jh(t){var e=Ap(t),n=e.year||0,r=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=hU(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+r*3+n*12,this._data={},this._locale=so(),this._bubble()}function ed(t){return t instanceof Jh}function Vp(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function gU(t,e,n){var r=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<r;s++)(n&&t[s]!==e[s]||!n&&ot(t[s])!==ot(e[s]))&&o++;return o+i}function A0(t,e){Ne(t,0,0,function(){var n=this.utcOffset(),r="+";return n<0&&(n=-n,r="-"),r+Oi(~~(n/60),2)+e+Oi(~~n%60,2)})}A0("Z",":"),A0("ZZ",""),Me("Z",jh),Me("ZZ",jh),Rt(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=Bp(jh,t)});var mU=/([\+\-]|\d\d)/gi;function Bp(t,e){var n=(e||"").match(t),r,i,o;return n===null?null:(r=n[n.length-1]||[],i=(r+"").match(mU)||["-",0,0],o=+(i[1]*60)+ot(i[2]),o===0?0:i[0]==="+"?o:-o)}function Up(t,e){var n,r;return e._isUTC?(n=e.clone(),r=(ti(t)||pu(t)?t.valueOf():Lt(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+r),le.updateOffset(n,!1),n):Lt(t).local()}function Yp(t){return-Math.round(t._d.getTimezoneOffset())}le.updateOffset=function(){};function pU(t,e,n){var r=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=Bp(jh,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(i=Yp(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),r!==t&&(!e||this._changeInProgress?H0(this,ri(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,le.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:Yp(this)}function wU(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function CU(t){return this.utcOffset(0,t)}function vU(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(Yp(this),"m")),this}function SU(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=Bp(VV,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function yU(t){return this.isValid()?(t=t?Lt(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function bU(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function RU(){if(!or(this._isDSTShifted))return this._isDSTShifted;var t={},e;return Rp(t,this),t=_0(t),t._a?(e=t._isUTC?_i(t._a):Lt(t._a),this._isDSTShifted=this.isValid()&&gU(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function EU(){return this.isValid()?!this._isUTC:!1}function TU(){return this.isValid()?this._isUTC:!1}function I0(){return this.isValid()?this._isUTC&&this._offset===0:!1}var _U=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,MU=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function ri(t,e){var n=t,r=null,i,o,s;return ed(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:no(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(r=_U.exec(t))?(i=r[1]==="-"?-1:1,n={y:0,d:ot(r[Ai])*i,h:ot(r[pn])*i,m:ot(r[ni])*i,s:ot(r[io])*i,ms:ot(Vp(r[Ws]*1e3))*i}):(r=MU.exec(t))?(i=r[1]==="-"?-1:1,n={y:Vs(r[2],i),M:Vs(r[3],i),w:Vs(r[4],i),d:Vs(r[5],i),h:Vs(r[6],i),m:Vs(r[7],i),s:Vs(r[8],i)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(s=OU(Lt(n.from),Lt(n.to)),n={},n.ms=s.milliseconds,n.M=s.months),o=new Jh(n),ed(t)&&mt(t,"_locale")&&(o._locale=t._locale),ed(t)&&mt(t,"_isValid")&&(o._isValid=t._isValid),o}ri.fn=Jh.prototype,ri.invalid=fU;function Vs(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function P0(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function OU(t,e){var n;return t.isValid()&&e.isValid()?(e=Up(e,t),t.isBefore(e)?n=P0(t,e):(n=P0(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function x0(t,e){return function(n,r){var i,o;return r!==null&&!isNaN(+r)&&(i0(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=r,r=o),i=ri(n,r),H0(this,i,t),this}}function H0(t,e,n,r){var i=e._milliseconds,o=Vp(e._days),s=Vp(e._months);t.isValid()&&(r=r??!0,s&&g0(t,Bh(t,"Month")+s*n),o&&a0(t,"Date",Bh(t,"Date")+o*n),i&&t._d.setTime(t._d.valueOf()+i*n),r&&le.updateOffset(t,o||s))}var AU=x0(1,"add"),IU=x0(-1,"subtract");function D0(t){return typeof t=="string"||t instanceof String}function PU(t){return ti(t)||pu(t)||D0(t)||no(t)||HU(t)||xU(t)||t===null||t===void 0}function xU(t){var e=Fs(t)&&!vp(t),n=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=r.length;for(i=0;i<s;i+=1)o=r[i],n=n||mt(t,o);return e&&n}function HU(t){var e=ei(t),n=!1;return e&&(n=t.filter(function(r){return!no(r)&&D0(t)}).length===0),e&&n}function DU(t){var e=Fs(t)&&!vp(t),n=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<r.length;i+=1)o=r[i],n=n||mt(t,o);return e&&n}function NU(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function LU(t,e){arguments.length===1&&(arguments[0]?PU(arguments[0])?(t=arguments[0],e=void 0):DU(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||Lt(),r=Up(n,this).startOf("day"),i=le.calendarFormat(this,r)||"sameElse",o=e&&(Mi(e[i])?e[i].call(this,n):e[i]);return this.format(o||this.localeData().calendar(i,this,Lt(n)))}function $U(){return new wu(this)}function kU(t,e){var n=ti(t)?t:Lt(t);return this.isValid()&&n.isValid()?(e=xr(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function FU(t,e){var n=ti(t)?t:Lt(t);return this.isValid()&&n.isValid()?(e=xr(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function WU(t,e,n,r){var i=ti(t)?t:Lt(t),o=ti(e)?e:Lt(e);return this.isValid()&&i.isValid()&&o.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(i,n):!this.isBefore(i,n))&&(r[1]===")"?this.isBefore(o,n):!this.isAfter(o,n))):!1}function VU(t,e){var n=ti(t)?t:Lt(t),r;return this.isValid()&&n.isValid()?(e=xr(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(r=n.valueOf(),this.clone().startOf(e).valueOf()<=r&&r<=this.clone().endOf(e).valueOf())):!1}function BU(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function UU(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function YU(t,e,n){var r,i,o;if(!this.isValid())return NaN;if(r=Up(t,this),!r.isValid())return NaN;switch(i=(r.utcOffset()-this.utcOffset())*6e4,e=xr(e),e){case"year":o=td(this,r)/12;break;case"month":o=td(this,r);break;case"quarter":o=td(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-i)/864e5;break;case"week":o=(this-r-i)/6048e5;break;default:o=this-r}return n?o:Hr(o)}function td(t,e){if(t.date()<e.date())return-td(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),r=t.clone().add(n,"months"),i,o;return e-r<0?(i=t.clone().add(n-1,"months"),o=(e-r)/(r-i)):(i=t.clone().add(n+1,"months"),o=(e-r)/(i-r)),-(n+o)||0}le.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",le.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function GU(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function zU(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?Wh(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Mi(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Wh(n,"Z")):Wh(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function jU(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,r,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(n+r+i+o)}function KU(t){t||(t=this.isUtc()?le.defaultFormatUtc:le.defaultFormat);var e=Wh(this,t);return this.localeData().postformat(e)}function XU(t,e){return this.isValid()&&(ti(t)&&t.isValid()||Lt(t).isValid())?ri({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function qU(t){return this.from(Lt(),t)}function ZU(t,e){return this.isValid()&&(ti(t)&&t.isValid()||Lt(t).isValid())?ri({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function QU(t){return this.to(Lt(),t)}function N0(t){var e;return t===void 0?this._locale._abbr:(e=so(t),e!=null&&(this._locale=e),this)}var L0=Pr("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function $0(){return this._locale}var nd=1e3,Ba=60*nd,rd=60*Ba,k0=(365*400+97)*24*rd;function Ua(t,e){return(t%e+e)%e}function F0(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-k0:new Date(t,e,n).valueOf()}function W0(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-k0:Date.UTC(t,e,n)}function JU(t){var e,n;if(t=xr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?W0:F0,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Ua(e+(this._isUTC?0:this.utcOffset()*Ba),rd);break;case"minute":e=this._d.valueOf(),e-=Ua(e,Ba);break;case"second":e=this._d.valueOf(),e-=Ua(e,nd);break}return this._d.setTime(e),le.updateOffset(this,!0),this}function e2(t){var e,n;if(t=xr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?W0:F0,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=rd-Ua(e+(this._isUTC?0:this.utcOffset()*Ba),rd)-1;break;case"minute":e=this._d.valueOf(),e+=Ba-Ua(e,Ba)-1;break;case"second":e=this._d.valueOf(),e+=nd-Ua(e,nd)-1;break}return this._d.setTime(e),le.updateOffset(this,!0),this}function t2(){return this._d.valueOf()-(this._offset||0)*6e4}function n2(){return Math.floor(this.valueOf()/1e3)}function r2(){return new Date(this.valueOf())}function i2(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function o2(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function s2(){return this.isValid()?this.toISOString():null}function a2(){return yp(this)}function l2(){return Ko({},Qe(this))}function u2(){return Qe(this).overflow}function c2(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Ne("N",0,0,"eraAbbr"),Ne("NN",0,0,"eraAbbr"),Ne("NNN",0,0,"eraAbbr"),Ne("NNNN",0,0,"eraName"),Ne("NNNNN",0,0,"eraNarrow"),Ne("y",["y",1],"yo","eraYear"),Ne("y",["yy",2],0,"eraYear"),Ne("y",["yyy",3],0,"eraYear"),Ne("y",["yyyy",4],0,"eraYear"),Me("N",Gp),Me("NN",Gp),Me("NNN",Gp),Me("NNNN",y2),Me("NNNNN",b2),Rt(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,r){var i=n._locale.erasParse(t,r,n._strict);i?Qe(n).era=i:Qe(n).invalidEra=t}),Me("y",Wa),Me("yy",Wa),Me("yyy",Wa),Me("yyyy",Wa),Me("yo",R2),Rt(["y","yy","yyy","yyyy"],Ln),Rt(["yo"],function(t,e,n,r){var i;n._locale._eraYearOrdinalRegex&&(i=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[Ln]=n._locale.eraYearOrdinalParse(t,i):e[Ln]=parseInt(t,10)});function h2(t,e){var n,r,i,o=this._eras||so("en")._eras;for(n=0,r=o.length;n<r;++n){switch(typeof o[n].since){case"string":i=le(o[n].since).startOf("day"),o[n].since=i.valueOf();break}switch(typeof o[n].until){case"undefined":o[n].until=1/0;break;case"string":i=le(o[n].until).startOf("day").valueOf(),o[n].until=i.valueOf();break}}return o}function d2(t,e,n){var r,i,o=this.eras(),s,a,l;for(t=t.toUpperCase(),r=0,i=o.length;r<i;++r)if(s=o[r].name.toUpperCase(),a=o[r].abbr.toUpperCase(),l=o[r].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[r];break;case"NNNN":if(s===t)return o[r];break;case"NNNNN":if(l===t)return o[r];break}else if([s,a,l].indexOf(t)>=0)return o[r]}function f2(t,e){var n=t.since<=t.until?1:-1;return e===void 0?le(t.since).year():le(t.since).year()+(e-t.offset)*n}function g2(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].name;return""}function m2(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].narrow;return""}function p2(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].abbr;return""}function w2(){var t,e,n,r,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=i[t].since<=i[t].until?1:-1,r=this.clone().startOf("day").valueOf(),i[t].since<=r&&r<=i[t].until||i[t].until<=r&&r<=i[t].since)return(this.year()-le(i[t].since).year())*n+i[t].offset;return this.year()}function C2(t){return mt(this,"_erasNameRegex")||zp.call(this),t?this._erasNameRegex:this._erasRegex}function v2(t){return mt(this,"_erasAbbrRegex")||zp.call(this),t?this._erasAbbrRegex:this._erasRegex}function S2(t){return mt(this,"_erasNarrowRegex")||zp.call(this),t?this._erasNarrowRegex:this._erasRegex}function Gp(t,e){return e.erasAbbrRegex(t)}function y2(t,e){return e.erasNameRegex(t)}function b2(t,e){return e.erasNarrowRegex(t)}function R2(t,e){return e._eraYearOrdinalRegex||Wa}function zp(){var t=[],e=[],n=[],r=[],i,o,s=this.eras();for(i=0,o=s.length;i<o;++i)e.push(Sr(s[i].name)),t.push(Sr(s[i].abbr)),n.push(Sr(s[i].narrow)),r.push(Sr(s[i].name)),r.push(Sr(s[i].abbr)),r.push(Sr(s[i].narrow));this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}Ne(0,["gg",2],0,function(){return this.weekYear()%100}),Ne(0,["GG",2],0,function(){return this.isoWeekYear()%100});function id(t,e){Ne(0,[t,t.length],0,e)}id("gggg","weekYear"),id("ggggg","weekYear"),id("GGGG","isoWeekYear"),id("GGGGG","isoWeekYear"),Dn("weekYear","gg"),Dn("isoWeekYear","GG"),Nn("weekYear",1),Nn("isoWeekYear",1),Me("G",zh),Me("g",zh),Me("GG",Nt,vr),Me("gg",Nt,vr),Me("GGGG",Pp,Ip),Me("gggg",Pp,Ip),Me("GGGGG",Gh,Uh),Me("ggggg",Gh,Uh),Su(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,r){e[r.substr(0,2)]=ot(t)}),Su(["gg","GG"],function(t,e,n,r){e[r]=le.parseTwoDigitYear(t)});function E2(t){return V0.call(this,t,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function T2(t){return V0.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function _2(){return oo(this.year(),1,4)}function M2(){return oo(this.isoWeekYear(),1,4)}function O2(){var t=this.localeData()._week;return oo(this.year(),t.dow,t.doy)}function A2(){var t=this.localeData()._week;return oo(this.weekYear(),t.dow,t.doy)}function V0(t,e,n,r,i){var o;return t==null?Ru(this,r,i).year:(o=oo(t,r,i),e>o&&(e=o),I2.call(this,t,e,n,r,i))}function I2(t,e,n,r,i){var o=C0(t,e,n,r,i),s=bu(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}Ne("Q",0,"Qo","quarter"),Dn("quarter","Q"),Nn("quarter",7),Me("Q",l0),Rt("Q",function(t,e){e[ro]=(ot(t)-1)*3});function P2(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Ne("D",["DD",2],"Do","date"),Dn("date","D"),Nn("date",9),Me("D",Nt),Me("DD",Nt,vr),Me("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient}),Rt(["D","DD"],Ai),Rt("Do",function(t,e){e[Ai]=ot(t.match(Nt)[0])});var B0=Fa("Date",!0);Ne("DDD",["DDDD",3],"DDDo","dayOfYear"),Dn("dayOfYear","DDD"),Nn("dayOfYear",4),Me("DDD",Yh),Me("DDDD",u0),Rt(["DDD","DDDD"],function(t,e,n){n._dayOfYear=ot(t)});function x2(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Ne("m",["mm",2],0,"minute"),Dn("minute","m"),Nn("minute",14),Me("m",Nt),Me("mm",Nt,vr),Rt(["m","mm"],ni);var H2=Fa("Minutes",!1);Ne("s",["ss",2],0,"second"),Dn("second","s"),Nn("second",15),Me("s",Nt),Me("ss",Nt,vr),Rt(["s","ss"],io);var D2=Fa("Seconds",!1);Ne("S",0,0,function(){return~~(this.millisecond()/100)}),Ne(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),Ne(0,["SSS",3],0,"millisecond"),Ne(0,["SSSS",4],0,function(){return this.millisecond()*10}),Ne(0,["SSSSS",5],0,function(){return this.millisecond()*100}),Ne(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3}),Ne(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4}),Ne(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5}),Ne(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6}),Dn("millisecond","ms"),Nn("millisecond",16),Me("S",Yh,l0),Me("SS",Yh,vr),Me("SSS",Yh,u0);var qo,U0;for(qo="SSSS";qo.length<=9;qo+="S")Me(qo,Wa);function N2(t,e){e[Ws]=ot(("0."+t)*1e3)}for(qo="S";qo.length<=9;qo+="S")Rt(qo,N2);U0=Fa("Milliseconds",!1),Ne("z",0,0,"zoneAbbr"),Ne("zz",0,0,"zoneName");function L2(){return this._isUTC?"UTC":""}function $2(){return this._isUTC?"Coordinated Universal Time":""}var he=wu.prototype;he.add=AU,he.calendar=LU,he.clone=$U,he.diff=YU,he.endOf=e2,he.format=KU,he.from=XU,he.fromNow=qU,he.to=ZU,he.toNow=QU,he.get=FV,he.invalidAt=u2,he.isAfter=kU,he.isBefore=FU,he.isBetween=WU,he.isSame=VU,he.isSameOrAfter=BU,he.isSameOrBefore=UU,he.isValid=a2,he.lang=L0,he.locale=N0,he.localeData=$0,he.max=aU,he.min=sU,he.parsingFlags=l2,he.set=WV,he.startOf=JU,he.subtract=IU,he.toArray=i2,he.toObject=o2,he.toDate=r2,he.toISOString=zU,he.inspect=jU,typeof Symbol<"u"&&Symbol.for!=null&&(he[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),he.toJSON=s2,he.toString=GU,he.unix=n2,he.valueOf=t2,he.creationData=c2,he.eraName=g2,he.eraNarrow=m2,he.eraAbbr=p2,he.eraYear=w2,he.year=w0,he.isLeapYear=oB,he.weekYear=E2,he.isoWeekYear=T2,he.quarter=he.quarters=P2,he.month=m0,he.daysInMonth=nB,he.week=he.weeks=hB,he.isoWeek=he.isoWeeks=dB,he.weeksInYear=O2,he.weeksInWeekYear=A2,he.isoWeeksInYear=_2,he.isoWeeksInISOWeekYear=M2,he.date=B0,he.day=he.days=TB,he.weekday=_B,he.isoWeekday=MB,he.dayOfYear=x2,he.hour=he.hours=DB,he.minute=he.minutes=H2,he.second=he.seconds=D2,he.millisecond=he.milliseconds=U0,he.utcOffset=pU,he.utc=CU,he.local=vU,he.parseZone=SU,he.hasAlignedHourOffset=yU,he.isDST=bU,he.isLocal=EU,he.isUtcOffset=TU,he.isUtc=I0,he.isUTC=I0,he.zoneAbbr=L2,he.zoneName=$2,he.dates=Pr("dates accessor is deprecated. Use date instead.",B0),he.months=Pr("months accessor is deprecated. Use month instead",m0),he.years=Pr("years accessor is deprecated. Use year instead",w0),he.zone=Pr("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",wU),he.isDSTShifted=Pr("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",RU);function k2(t){return Lt(t*1e3)}function F2(){return Lt.apply(null,arguments).parseZone()}function Y0(t){return t}var pt=Tp.prototype;pt.calendar=TV,pt.longDateFormat=AV,pt.invalidDate=PV,pt.ordinal=DV,pt.preparse=Y0,pt.postformat=Y0,pt.relativeTime=LV,pt.pastFuture=$V,pt.set=RV,pt.eras=h2,pt.erasParse=d2,pt.erasConvertYear=f2,pt.erasAbbrRegex=v2,pt.erasNameRegex=C2,pt.erasNarrowRegex=S2,pt.months=QV,pt.monthsShort=JV,pt.monthsParse=tB,pt.monthsRegex=iB,pt.monthsShortRegex=rB,pt.week=aB,pt.firstDayOfYear=cB,pt.firstDayOfWeek=uB,pt.weekdays=SB,pt.weekdaysMin=bB,pt.weekdaysShort=yB,pt.weekdaysParse=EB,pt.weekdaysRegex=OB,pt.weekdaysShortRegex=AB,pt.weekdaysMinRegex=IB,pt.isPM=xB,pt.meridiem=NB;function od(t,e,n,r){var i=so(),o=_i().set(r,e);return i[n](o,t)}function G0(t,e,n){if(no(t)&&(e=t,t=void 0),t=t||"",e!=null)return od(t,e,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=od(t,r,n,"month");return i}function jp(t,e,n,r){typeof t=="boolean"?(no(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,no(e)&&(n=e,e=void 0),e=e||"");var i=so(),o=t?i._week.dow:0,s,a=[];if(n!=null)return od(e,(n+o)%7,r,"day");for(s=0;s<7;s++)a[s]=od(e,(s+o)%7,r,"day");return a}function W2(t,e){return G0(t,e,"months")}function V2(t,e){return G0(t,e,"monthsShort")}function B2(t,e,n){return jp(t,e,n,"weekdays")}function U2(t,e,n){return jp(t,e,n,"weekdaysShort")}function Y2(t,e,n){return jp(t,e,n,"weekdaysMin")}Xo("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=ot(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}}),le.lang=Pr("moment.lang is deprecated. Use moment.locale instead.",Xo),le.langData=Pr("moment.langData is deprecated. Use moment.localeData instead.",so);var ao=Math.abs;function G2(){var t=this._data;return this._milliseconds=ao(this._milliseconds),this._days=ao(this._days),this._months=ao(this._months),t.milliseconds=ao(t.milliseconds),t.seconds=ao(t.seconds),t.minutes=ao(t.minutes),t.hours=ao(t.hours),t.months=ao(t.months),t.years=ao(t.years),this}function z0(t,e,n,r){var i=ri(e,n);return t._milliseconds+=r*i._milliseconds,t._days+=r*i._days,t._months+=r*i._months,t._bubble()}function z2(t,e){return z0(this,t,e,1)}function j2(t,e){return z0(this,t,e,-1)}function j0(t){return t<0?Math.floor(t):Math.ceil(t)}function K2(){var t=this._milliseconds,e=this._days,n=this._months,r=this._data,i,o,s,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=j0(Kp(n)+e)*864e5,e=0,n=0),r.milliseconds=t%1e3,i=Hr(t/1e3),r.seconds=i%60,o=Hr(i/60),r.minutes=o%60,s=Hr(o/60),r.hours=s%24,e+=Hr(s/24),l=Hr(K0(e)),n+=l,e-=j0(Kp(l)),a=Hr(n/12),n%=12,r.days=e,r.months=n,r.years=a,this}function K0(t){return t*4800/146097}function Kp(t){return t*146097/4800}function X2(t){if(!this.isValid())return NaN;var e,n,r=this._milliseconds;if(t=xr(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+r/864e5,n=this._months+K0(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(Kp(this._months)),t){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return e*24+r/36e5;case"minute":return e*1440+r/6e4;case"second":return e*86400+r/1e3;case"millisecond":return Math.floor(e*864e5)+r;default:throw new Error("Unknown unit "+t)}}function q2(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+ot(this._months/12)*31536e6:NaN}function lo(t){return function(){return this.as(t)}}var Z2=lo("ms"),Q2=lo("s"),J2=lo("m"),eY=lo("h"),tY=lo("d"),nY=lo("w"),rY=lo("M"),iY=lo("Q"),oY=lo("y");function sY(){return ri(this)}function aY(t){return t=xr(t),this.isValid()?this[t+"s"]():NaN}function Bs(t){return function(){return this.isValid()?this._data[t]:NaN}}var lY=Bs("milliseconds"),uY=Bs("seconds"),cY=Bs("minutes"),hY=Bs("hours"),dY=Bs("days"),fY=Bs("months"),gY=Bs("years");function mY(){return Hr(this.days()/7)}var uo=Math.round,Ya={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function pY(t,e,n,r,i){return i.relativeTime(e||1,!!n,t,r)}function wY(t,e,n,r){var i=ri(t).abs(),o=uo(i.as("s")),s=uo(i.as("m")),a=uo(i.as("h")),l=uo(i.as("d")),u=uo(i.as("M")),c=uo(i.as("w")),d=uo(i.as("y")),g=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||s<=1&&["m"]||s<n.m&&["mm",s]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(g=g||c<=1&&["w"]||c<n.w&&["ww",c]),g=g||u<=1&&["M"]||u<n.M&&["MM",u]||d<=1&&["y"]||["yy",d],g[2]=e,g[3]=+t>0,g[4]=r,pY.apply(null,g)}function CY(t){return t===void 0?uo:typeof t=="function"?(uo=t,!0):!1}function vY(t,e){return Ya[t]===void 0?!1:e===void 0?Ya[t]:(Ya[t]=e,t==="s"&&(Ya.ss=e-1),!0)}function SY(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,r=Ya,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(r=Object.assign({},Ya,e),e.s!=null&&e.ss==null&&(r.ss=e.s-1)),i=this.localeData(),o=wY(this,!n,r,i),n&&(o=i.pastFuture(+this,o)),i.postformat(o)}var Xp=Math.abs;function Ga(t){return(t>0)-(t<0)||+t}function sd(){if(!this.isValid())return this.localeData().invalidDate();var t=Xp(this._milliseconds)/1e3,e=Xp(this._days),n=Xp(this._months),r,i,o,s,a=this.asSeconds(),l,u,c,d;return a?(r=Hr(t/60),i=Hr(r/60),t%=60,r%=60,o=Hr(n/12),n%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=Ga(this._months)!==Ga(a)?"-":"",c=Ga(this._days)!==Ga(a)?"-":"",d=Ga(this._milliseconds)!==Ga(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(n?u+n+"M":"")+(e?c+e+"D":"")+(i||r||t?"T":"")+(i?d+i+"H":"")+(r?d+r+"M":"")+(t?d+s+"S":"")):"P0D"}var ht=Jh.prototype;ht.isValid=dU,ht.abs=G2,ht.add=z2,ht.subtract=j2,ht.as=X2,ht.asMilliseconds=Z2,ht.asSeconds=Q2,ht.asMinutes=J2,ht.asHours=eY,ht.asDays=tY,ht.asWeeks=nY,ht.asMonths=rY,ht.asQuarters=iY,ht.asYears=oY,ht.valueOf=q2,ht._bubble=K2,ht.clone=sY,ht.get=aY,ht.milliseconds=lY,ht.seconds=uY,ht.minutes=cY,ht.hours=hY,ht.days=dY,ht.weeks=mY,ht.months=fY,ht.years=gY,ht.humanize=SY,ht.toISOString=sd,ht.toString=sd,ht.toJSON=sd,ht.locale=N0,ht.localeData=$0,ht.toIsoString=Pr("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",sd),ht.lang=L0,Ne("X",0,0,"unix"),Ne("x",0,0,"valueOf"),Me("x",zh),Me("X",BV),Rt("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)}),Rt("x",function(t,e,n){n._d=new Date(ot(t))});//! moment.js
le.version="2.29.4",yV(Lt),le.fn=he,le.min=lU,le.max=uU,le.now=cU,le.utc=_i,le.unix=k2,le.months=W2,le.isDate=pu,le.locale=Xo,le.invalid=kh,le.duration=ri,le.isMoment=ti,le.weekdays=B2,le.parseZone=F2,le.localeData=so,le.isDuration=ed,le.monthsShort=V2,le.weekdaysMin=Y2,le.defineLocale=Lp,le.updateLocale=FB,le.locales=WB,le.weekdaysShort=U2,le.normalizeUnits=xr,le.relativeTimeRounding=CY,le.relativeTimeThreshold=vY,le.calendarFormat=NU,le.prototype=he,le.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const yY=Object.freeze(Object.defineProperty({__proto__:null,default:le},Symbol.toStringTag,{value:"Module"}));function X0(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function qp(t,e){const n=e.length;let r=0;for(;r<n;)t.push(e[r]),r+=1}function Mu(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,r=t[0].length;for(let i=0;i<n;i++)for(let o=0;o<r;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function en(t,e,n,r){let i=-1,o=t,s=n;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(r&&a&&(i+=1,s=o[i]),i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function yr(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];e(a,n,r)&&(s+=1,o[s]=a),n+=1}return o}function qe(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];s+=1,o[s]=e(a,n,r),n+=1}return o}function H(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length;for(;n<i&&e(r[n],n,r)!==!1;)n+=1;return t}function q0(t){return en(t,(e,n)=>e+n,0)}function bY(t){return en(t,(e,n)=>e>n?e:n,Array.isArray(t)?t[0]:void 0)}function RY(t){return en(t,(e,n)=>e<n?e:n,Array.isArray(t)?t[0]:void 0)}function EY(t){return t.length?q0(t)/t.length:0}function Z0(t){return en(t,(e,n)=>e.concat(Array.isArray(n)?Z0(n):n),[])}function Zp(t){const e=[];return H(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function Qp(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return H(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function TY(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return H(i,s=>{o=o.filter(a=>s.includes(a))}),o}function _Y(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e],o=new Set(r);return H(i,s=>{H(s,a=>{o.has(a)||o.add(a)})}),Array.from(o)}function Jp(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}const MY=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:EY,arrayEach:H,arrayFilter:yr,arrayFlatten:Z0,arrayMap:qe,arrayMax:bY,arrayMin:RY,arrayReduce:en,arraySum:q0,arrayUnique:Zp,extendArray:qp,getDifferenceOfArrays:Qp,getIntersectionOfArrays:TY,getUnionOfArrays:_Y,pivot:Mu,stringToArray:Jp,to2dArray:X0},Symbol.toStringTag,{value:"Module"}));function St(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return en(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=n[a]?n[a]:"";return o+l+u},"").trim()}function Yt(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function be(t){return typeof t<"u"}function Mt(t){return typeof t>"u"}function hn(t){return t===null||t===""||Mt(t)}function Q0(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const Ou="length",Au=t=>parseInt(t,16),J0=t=>parseInt(t,10),ad=(t,e,n)=>t.substr(e,n),Iu=t=>t.codePointAt(0)-65,ew=t=>`${t}`.replace(/\-/g,""),OY=t=>Au(ad(ew(t),Au("12"),Iu("F")))/(Au(ad(ew(t),Iu("B"),~~![][Ou]))||9),AY=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let eT=!1;const tT={invalid:()=>St`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return St`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>St`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},nT={invalid:()=>St`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return St`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>St`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function rT(t,e){const n=!hn(t),r=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="14.0.0";let o,s="invalid",a="invalid";t=ew(t||"");const l=IY(t);if(n||r||l)if(l){const u=le("30/11/2023","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),d=OY(t);o=le((d+1)*864e5,"x").format("MMMM DD, YYYY"),c>d?(s="expired",a="expired"):(s="valid",a="valid")}else r?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(AY()&&(s="valid",a="valid"),!eT&&s!=="valid"&&(tT[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"](tT[s]({keyValidityDate:o,hotVersion:i})),eT=!0),a!=="valid"&&e.parentNode&&nT[a]({keyValidityDate:o,hotVersion:i})){const c=document.createElement("div");c.className="hot-display-license-info",c.innerHTML=nT[a]({keyValidityDate:o,hotVersion:i}),e.parentNode.insertBefore(c,e.nextSibling)}}function IY(t){let e=[][Ou],n=e;if(t[Ou]!==Iu("Z"))return!1;for(let r="",i="B<H4P+".split(""),o=Iu(i.shift());o;o=Iu(i.shift()||"A"))--o<""[Ou]?n=n|(J0(`${J0(Au(r)+(Au(ad(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=ad(t,o,o?i[Ou]===1?9:8:6);return n===e}const PY=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:rT,isDefined:be,isEmpty:hn,isRegExp:Q0,isUndefined:Mt,stringify:Yt},Symbol.toStringTag,{value:"Module"}));function $n(t){return t[0].toUpperCase()+t.substr(1)}function xY(){const t=[];for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];let i=n.length;for(;i;){i-=1;const o=Yt(n[i]).toLowerCase();t.indexOf(o)===-1&&t.push(o)}return t.length===1}function tw(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function nw(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function rw(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,r)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[r]===void 0?"":e[r])}function iw(t){return ld(`${t}`,{ALLOWED_TAGS:[]})}function ld(t,e){return SV.sanitize(t,e)}const HY=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:xY,isPercentValue:nw,randomString:tw,sanitize:ld,stripTags:iw,substitute:rw,toUpperCaseFirst:$n},Symbol.toStringTag,{value:"Module"})),za=t=>["tabindex",t],DY=()=>["role","treegrid"],Ii=()=>["role","presentation"],NY=()=>["role","gridcell"],LY=()=>["role","rowheader"],iT=()=>["role","rowgroup"],$Y=()=>["role","columnheader"],ow=()=>["role","row"],kY=()=>["role","menu"],FY=()=>["role","menuitem"],WY=()=>["role","combobox"],oT=()=>["role","listbox"],VY=()=>["role","option"],BY=()=>["role","checkbox"],UY=()=>["scope","col"],YY=()=>["scope","row"],GY=()=>["type","text"],sw=t=>["aria-label",t],co=()=>["aria-hidden","true"],zY=()=>["aria-disabled","true"],jY=()=>["aria-multiselectable","true"],sT=t=>["aria-haspopup",t],aT=t=>["aria-rowcount",t],ud=t=>["aria-colcount",t],lT=t=>["aria-rowindex",t],aw=t=>["aria-colindex",t],Dr=t=>["aria-expanded",t],KY=t=>["aria-sort",t],uT=()=>["aria-readonly","true"],cT=()=>["aria-invalid","true"],XY=t=>["aria-checked",t],lw=()=>["aria-selected","true"],qY=()=>["aria-autocomplete","list"],ZY=t=>["aria-controls",t],QY=t=>["aria-activedescendant",t],JY=t=>["aria-live",t],eG=t=>["aria-relevant",t],tG=t=>["aria-setsize",t],nG=t=>["aria-posinset",t];function hT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=null,i=t;for(;i!==null;){if(n===e){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return r}function dT(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function fT(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function Pu(t){return fT(t)&&t.parent}function rG(t){return!!Object.getPrototypeOf(t.parent)}function Zo(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==n;){const{nodeType:s,nodeName:a}=o;if(s===r&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function xu(t,e,n){const r=[];let i=t;for(;i&&(i=Zo(i,e,n),!(!i||n&&!n.contains(i)));)r.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=r.length;return o?r[o-1]:null}function Qo(t,e){let n=t.parentNode,r=[];for(typeof e=="string"?t.defaultView?r=Array.prototype.slice.call(t.querySelectorAll(e),0):r=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);n!==null;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function gT(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function Jo(t,e,n){const r=n.parentElement.querySelector(`.ht_clone_${t}`);return r?r.contains(e):null}function mT(t){return!t||!t.length?[]:t.filter(e=>!!e)}function pT(t,e){if(!t||!t.length)return e?{regexFree:[],regexes:[]}:[];const n=[],r=[];return r.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&n.push(i),!o})),e?{regexFree:r,regexes:n}:r}function We(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function ce(t,e){typeof e=="string"&&(e=e.split(" ")),e=mT(e),e.length>0&&t.classList.add(...e)}function Ue(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:r}=pT(e,!0);n=mT(n),n.length>0&&t.classList.remove(...n),r.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function Le(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(r=>{Array.isArray(r)&&r[0]!==""&&t.setAttribute(...r)})}function Us(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:r}=pT(e,!0);n.forEach(i=>{i!==""&&t.removeAttribute(i)}),r.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function uw(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)uw(e[n])}}function ii(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const wT=/(<(.*)>|&(.*);)/;function Ys(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;wT.test(e)?t.innerHTML=n?ld(e):e:es(t,e)}function es(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(ii(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function ts(t){const e=t.ownerDocument.documentElement;let n=t;for(;n!==e;){if(n===null)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(n.host){if(n.host.impl)return ts(n.host.impl);if(n.host)return ts(n.host);throw new Error("Lost in Web Components world")}else return!1;else if(ho(n).display==="none")return!1;n=n.parentNode}return!0}function sn(t){const e=t.ownerDocument,n=e.defaultView,r=e.documentElement;let i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=n.pageXOffset||r.scrollLeft,s+=n.pageYOffset||r.scrollTop),{left:o,top:s}}function cw(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function cd(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function Hu(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?cw(e):t.scrollTop}function hd(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?cd(e):t.scrollLeft}function Du(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const r=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=n.getComputedStyle(i),r.includes(o)||r.includes(s)||r.includes(a)||i.clientHeight<=i.scrollHeight+1&&(r.includes(a)||r.includes(o))||i.clientWidth<=i.scrollWidth+1&&(r.includes(s)||r.includes(o)))return i;i=i.parentNode}return n}function Gs(t){const e=t.ownerDocument,n=e.defaultView;let r=t.parentNode;for(;r&&r.style&&e.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;const i=ho(r,n),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return r;r=r.parentNode}return n}function ja(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const r=t.style[e];if(r!==""&&r!==void 0)return r;const i=ho(t,n);if(i[e]!==""&&i[e]!==void 0)return i[e]}function iG(t,e){const{selectorText:n}=e;let r=!1;return e.type===CSSRule.STYLE_RULE&&n&&(t.msMatchesSelector?r=t.msMatchesSelector(n):t.matches&&(r=t.matches(n))),r}function ho(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t.currentStyle||e.getComputedStyle(t)}function yt(t){return t.offsetWidth}function Wt(t){return t.offsetHeight}function fo(t){return t.clientHeight||t.innerHeight}function Nu(t){return t.clientWidth||t.innerWidth}function oG(t,e,n){t.addEventListener(e,n,!1)}function sG(t,e,n){t.removeEventListener(e,n,!1)}function hw(t){return t.selectionStart?t.selectionStart:0}function CT(t){return t.selectionEnd?t.selectionEnd:0}function aG(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=t.document;let n="";return t.getSelection?n=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(n=e.selection.createRange().text),n}function dw(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function Lu(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,n),i.style.display=o}}}let fw;function lG(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const r=e.offsetWidth;n.style.overflow="scroll";let i=e.offsetWidth;return r===i&&(i=n.clientWidth),(t.body||t.documentElement).removeChild(n),r-i}function wn(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return fw===void 0&&(fw=lG(t)),fw}function vT(t){return t.offsetWidth!==t.clientWidth}function ST(t){return t.offsetHeight!==t.clientHeight}function dd(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function uG(t){let e;return t.style.transform&&(e=t.style.transform)!==""?["transform",e]:-1}function $u(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function fd(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function gd(t){return fd(t)&&t.hasAttribute("data-hot-input")===!1}function cG(t){const e=t.ownerDocument.activeElement;gd(e)||t.select()}function gw(t){return!t.parentNode}function yT(t,e){new IntersectionObserver((r,i)=>{r.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function mw(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=t.ownerDocument,i=r.createRange(),o=r.defaultView.getSelection();Le(t,"contenteditable",!0),n&&Le(t,...co()),e&&ce(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function pw(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&Ue(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function bT(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;mw(t,n),e(),pw(t,n)}const hG=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:wT,addClass:ce,addEvent:oG,clearTextSelection:dw,closest:Zo,closestDown:xu,empty:ii,fastInnerHTML:Ys,fastInnerText:es,getCaretPosition:hw,getComputedStyle:ho,getCssTransform:uG,getFrameElement:fT,getParent:hT,getParentWindow:Pu,getScrollLeft:hd,getScrollTop:Hu,getScrollableElement:Du,getScrollbarWidth:wn,getSelectionEndPosition:CT,getSelectionText:aG,getStyle:ja,getTrimmingContainer:Gs,getWindowScrollLeft:cd,getWindowScrollTop:cw,hasAccessToParentWindow:rG,hasClass:We,hasHorizontalScrollbar:ST,hasVerticalScrollbar:vT,index:gT,innerHeight:fo,innerWidth:Nu,isChildOf:Qo,isDetached:gw,isInput:fd,isOutsideInput:gd,isThisHotChild:dT,isVisible:ts,makeElementContentEditableAndSelectItsContent:mw,matchesCSSRules:iG,observeVisibilityChangeOnce:yT,offset:sn,outerHeight:Wt,outerWidth:yt,overlayContainsElement:Jo,removeAttribute:Us,removeClass:Ue,removeContentEditableFromElementAndDeselect:pw,removeEvent:sG,removeTextNodes:uw,resetCssTransform:$u,runWithSelectedContendEditableElement:bT,selectElementIfAllowed:cG,setAttribute:Le,setCaretPosition:Lu,setOverlayPosition:dd},Symbol.toStringTag,{value:"Module"}));function Ot(t){return typeof t=="function"}function RT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=0;const r={lastCallThrottled:!0};let i=null;function o(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];const u=Date.now();let c=!1;r.lastCallThrottled=!0,n||(n=u,c=!0);const d=e-(u-n);return c?(r.lastCallThrottled=!1,t.apply(this,a)):(i&&clearTimeout(i),i=setTimeout(()=>{r.lastCallThrottled=!1,t.apply(this,a),n=0,i=void 0},d)),r}return o}function dG(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const r=RT(t,e);let i=n;function o(){i=n}function s(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return i?(i-=1,t.apply(this,l)):r.apply(this,l)}return s.clearHits=o,s}function md(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,r;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout(()=>{r=t.apply(this,s)},e),r}return i}function fG(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=e;return function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return en(i,(u,c)=>c(u),r.apply(this,a))}}function ww(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,n.concat(s))}}function ET(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s);let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function gG(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s.reverse());let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function pd(t,e,n,r,i,o,s,a){return be(a)?t.call(e,n,r,i,o,s,a):be(s)?t.call(e,n,r,i,o,s):be(o)?t.call(e,n,r,i,o):be(i)?t.call(e,n,r,i):be(r)?t.call(e,n,r):be(n)?t.call(e,n):t.call(e)}const mG=Object.freeze(Object.defineProperty({__proto__:null,curry:ET,curryRight:gG,debounce:md,fastCall:pd,isFunction:Ot,partial:ww,pipe:fG,throttle:RT,throttleAfterHits:dG},Symbol.toStringTag,{value:"Module"}));var pG=Gn,TT=aE,wG=_n,_T=Na,CG=pE,MT=pG([].push),vG=function(t){if(wG(t))return t;if(TT(t)){for(var e=t.length,n=[],r=0;r<e;r++){var i=t[r];typeof i=="string"?MT(n,i):(typeof i=="number"||_T(i)==="Number"||_T(i)==="String")&&MT(n,CG(i))}var o=n.length,s=!0;return function(a,l){if(s)return s=!1,l;if(TT(this))return l;for(var u=0;u<o;u++)if(n[u]===a)return l}}},SG=Ns,OT=lu,AT=Ih,yG=Ch,ku=Gn,IT=Ar,PT=_n,xT=Tm,HT=tp,bG=vG,RG=Em,EG=String,ns=OT("JSON","stringify"),wd=ku(/./.exec),DT=ku("".charAt),TG=ku("".charCodeAt),_G=ku("".replace),MG=ku(1 .toString),OG=/[\uD800-\uDFFF]/g,NT=/^[\uD800-\uDBFF]$/,LT=/^[\uDC00-\uDFFF]$/,$T=!RG||IT(function(){var t=OT("Symbol")("stringify detection");return ns([t])!=="[null]"||ns({a:t})!=="{}"||ns(Object(t))!=="{}"}),kT=IT(function(){return ns("\uDF06\uD834")!=='"\\udf06\\ud834"'||ns("\uDEAD")!=='"\\udead"'}),AG=function(t,e){var n=HT(arguments),r=bG(e);if(!(!PT(r)&&(t===void 0||xT(t))))return n[1]=function(i,o){if(PT(r)&&(o=yG(r,this,EG(i),o)),!xT(o))return o},AT(ns,null,n)},IG=function(t,e,n){var r=DT(n,e-1),i=DT(n,e+1);return wd(NT,t)&&!wd(LT,i)||wd(LT,t)&&!wd(NT,r)?"\\u"+MG(TG(t,0),16):t};ns&&SG({target:"JSON",stat:!0,arity:3,forced:$T||kT},{stringify:function(e,n,r){var i=HT(arguments),o=AT($T?AG:ns,null,i);return kT&&typeof o=="string"?_G(o,OG,IG):o}});function Ka(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Ze(t,(n,r)=>{r!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[r]=Ka(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[r]=[Ka(n[0])]:e[r]=[]:e[r]=null)})),e}function go(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function an(t,e,n){const r=Array.isArray(n);return Ze(e,(i,o)=>{(r===!1||n.includes(o))&&(t[o]=i)}),t}function Fu(t,e){Ze(e,(n,r)=>{e[r]&&typeof e[r]=="object"?(t[r]||(Array.isArray(e[r])?t[r]=[]:Object.prototype.toString.call(e[r])==="[object Date]"?t[r]=e[r]:t[r]={}),Fu(t[r],e[r])):t[r]=e[r]})}function kn(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function Kn(t){const e={};return Ze(t,(n,r)=>{e[r]=n}),e}function Et(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return H(n,i=>{t.MIXINS.push(i.MIXIN_NAME),Ze(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,d){const g=`_${c}`,p=C=>{let E=C;return(Array.isArray(E)||Ke(E))&&(E=kn(E)),E};return function(){return this[g]===void 0&&(this[g]=p(d)),this[g]}},l=function(c){const d=`_${c}`;return function(g){this[d]=g}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function Cd(t,e){return JSON.stringify(t)===JSON.stringify(e)}function Ke(t){return Object.prototype.toString.call(t)==="[object Object]"}function Pi(t,e,n,r){r.value=n,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(t,e,r)}function Ze(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function FT(t,e){const n=e.split(".");let r=t;return Ze(n,i=>{if(r=r[i],r===void 0)return r=void 0,!1}),r}function vd(t,e,n){const r=e.split(".");let i=t;r.forEach((o,s)=>{s!==r.length-1?(Vt(i,o)||(i[o]={}),i=i[o]):i[o]=n})}function Sd(t){if(!Ke(t))return 0;const e=function(n){let r=0;return Ke(n)?Ze(n,(i,o)=>{o!=="__children"&&(r+=e(i))}):r+=1,r};return e(t)}function oi(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,r={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[n]},set(i){this._touched=!0,this[n]=i},enumerable:!0,configurable:!0}),r}function Vt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const PG=Object.freeze(Object.defineProperty({__proto__:null,clone:Kn,createObjectPropListener:oi,deepClone:kn,deepExtend:Fu,deepObjectSize:Sd,defineGetter:Pi,duckSchema:Ka,extend:an,getProperty:FT,hasOwnProperty:Vt,inherit:go,isObject:Ke,isObjectEqual:Cd,mixin:Et,objectEach:Ze,setProperty:vd},Symbol.toStringTag,{value:"Module"})),Nr=t=>{const e={value:!1};return e.test=(n,r)=>{e.value=t(n,r)},e},mo={chrome:Nr((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:Nr(t=>/CriOS/.test(t)),edge:Nr(t=>/Edge/.test(t)),edgeWebKit:Nr(t=>/EdgiOS/.test(t)),firefox:Nr(t=>/Firefox/.test(t)),firefoxWebKit:Nr(t=>/FxiOS/.test(t)),mobile:Nr(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:Nr((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},Xa={mac:Nr(t=>/^Mac/.test(t)),win:Nr(t=>/^Win/.test(t)),linux:Nr(t=>/^Linux/.test(t)),ios:Nr(t=>/iPhone|iPad|iPod/i.test(t))};function WT(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ze(mo,n=>{let{test:r}=n;return void r(t,e)})}function VT(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ze(Xa,e=>{let{test:n}=e;return void n(t)})}WT(),VT();function Cw(){return mo.chrome.value}function BT(){return mo.chromeWebKit.value}function yd(){return mo.firefox.value}function UT(){return mo.firefoxWebKit.value}function vw(){return mo.safari.value}function YT(){return mo.edge.value}function xG(){return mo.edgeWebKit.value}function po(){return mo.mobile.value}function Sw(){return Xa.ios.value}function yw(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&Xa.mac.value}function bw(){return Xa.win.value}function Wu(){return Xa.mac.value}function HG(){return Xa.linux.value}const DG=Object.freeze(Object.defineProperty({__proto__:null,isChrome:Cw,isChromeWebKit:BT,isEdge:YT,isEdgeWebKit:xG,isFirefox:yd,isFirefoxWebKit:UT,isIOS:Sw,isIpadOS:yw,isLinuxOS:HG,isMacOS:Wu,isMobileBrowser:po,isSafari:vw,isWindowsOS:bw,setBrowserMeta:WT,setPlatformMeta:VT},Symbol.toStringTag,{value:"Module"})),Ae={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:yd()?182:174,AUDIO_MUTE:yd()?181:173,AUDIO_UP:yd()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},NG=[Ae.ALT,Ae.ARROW_DOWN,Ae.ARROW_LEFT,Ae.ARROW_RIGHT,Ae.ARROW_UP,Ae.AUDIO_DOWN,Ae.AUDIO_MUTE,Ae.AUDIO_UP,Ae.BACKSPACE,Ae.CAPS_LOCK,Ae.DELETE,Ae.END,Ae.ENTER,Ae.ESCAPE,Ae.F1,Ae.F2,Ae.F3,Ae.F4,Ae.F5,Ae.F6,Ae.F7,Ae.F8,Ae.F9,Ae.F10,Ae.F11,Ae.F12,Ae.F13,Ae.F14,Ae.F15,Ae.F16,Ae.F17,Ae.F18,Ae.F19,Ae.HOME,Ae.INSERT,Ae.MEDIA_NEXT,Ae.MEDIA_PLAY_PAUSE,Ae.MEDIA_PREV,Ae.MEDIA_STOP,Ae.NULL,Ae.NUM_LOCK,Ae.PAGE_DOWN,Ae.PAGE_UP,Ae.PAUSE,Ae.SCROLL_LOCK,Ae.SHIFT,Ae.TAB];function GT(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function Rw(t){return NG.includes(t)}function LG(t){const e=[];return Wu()?e.push(Ae.COMMAND_LEFT,Ae.COMMAND_RIGHT,Ae.COMMAND_FIREFOX):e.push(Ae.CONTROL),e.includes(t)}function zT(t){return[Ae.CONTROL,Ae.COMMAND_LEFT,Ae.COMMAND_RIGHT,Ae.COMMAND_FIREFOX].includes(t)}function qa(t,e){const n=e.split("|");let r=!1;return H(n,i=>{if(t===Ae[i])return r=!0,!1}),r}const $G=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:Ae,isCtrlKey:LG,isCtrlMetaKey:zT,isFunctionKey:Rw,isKey:qa,isPrintableChar:GT},Symbol.toStringTag,{value:"Module"}));function Lr(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function rs(t){return t.isImmediatePropagationEnabled===!1}function is(t){return t.button===2}function bd(t){return t.button===0}function jT(t,e){const n={x:t.offsetX,y:t.offsetY};let r=t.target;if(!(e instanceof HTMLElement)||r!==e&&r.contains(e))return n;for(;r!==e;)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;return n}const kG=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:rs,isLeftClick:bd,isRightClick:is,offsetRelativeTo:jT,stopImmediatePropagation:Lr},Symbol.toStringTag,{value:"Module"}));function At(){be(console)&&console.warn(...arguments)}function Ew(){be(console)&&console.error(...arguments)}function FG(t,e,n){return e=WG(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function WG(t){var e=VG(t,"string");return typeof e=="symbol"?e:String(e)}function VG(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Za=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],BG=St`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,Tw=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),_w=new Map([[]]);class KT{static getSingleton(){return YG()}constructor(){FG(this,"globalBucket",void 0),this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const e=Object.create(null);return H(Za,n=>e[n]=[]),e}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(n))H(n,i=>this.add(e,i,r));else{Tw.has(e)&&At(rw(BG,{hookName:e,removedInVersion:Tw.get(e)})),_w.has(e)&&At(_w.get(e));const i=this.getBucket(r);if(typeof i[e]>"u"&&(this.register(e),i[e]=[]),n.skip=!1,i[e].indexOf(n)===-1){let o=!1;n.initialHook&&H(i[e],(s,a)=>{if(s.initialHook)return i[e][a]=n,o=!0,!1}),o||i[e].push(n)}}return this}once(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(n)?H(n,i=>this.once(e,i,r)):(n.runOnce=!0,this.add(e,n,r))}remove(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const i=this.getBucket(r);return typeof i[e]<"u"&&i[e].indexOf(n)>=0?(n.skip=!0,!0):!1}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const r=this.getBucket(n);return!!(r[e]!==void 0&&r[e].length)}run(e,n,r,i,o,s,a,l){{const u=this.globalBucket[n],c=u?u.length:0;let d=0;if(c)for(;d<c;){if(!u[d]||u[d].skip){d+=1;continue}const g=pd(u[d],e,r,i,o,s,a,l);g!==void 0&&(r=g),u[d]&&u[d].runOnce&&this.remove(n,u[d]),d+=1}}{const u=this.getBucket(e)[n],c=u?u.length:0;let d=0;if(c)for(;d<c;){if(!u[d]||u[d].skip){d+=1;continue}const g=pd(u[d],e,r,i,o,s,a,l);g!==void 0&&(r=g),u[d]&&u[d].runOnce&&this.remove(n,u[d],e),d+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Ze(this.getBucket(e),(n,r,i)=>i[r].length=0)}register(e){this.isRegistered(e)||Za.push(e)}deregister(e){this.isRegistered(e)&&Za.splice(Za.indexOf(e),1)}isDeprecated(e){return _w.has(e)||Tw.has(e)}isRegistered(e){return Za.indexOf(e)>=0}getRegistered(){return Za}}const UG=new KT;function YG(){return UG}const _e=KT,Mw=new Map;function si(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";Mw.has(t)||Mw.set(t,new Map);const e=Mw.get(t);function n(a,l){e.set(a,l)}function r(a){return e.get(a)}function i(a){return e.has(a)}function o(){return[...e.keys()]}function s(){return[...e.values()]}return{register:n,getItem:r,hasItem:i,getNames:o,getValues:s}}const Ow=new WeakMap,{register:GG,getItem:XT,hasItem:qT,getNames:zG,getValues:Rae}=si("editors");function jG(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new n(r)),e[r.guid]},_e.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function ZT(t,e){let n;if(typeof t=="function")Ow.get(t)||sr(null,t),n=Ow.get(t);else if(typeof t=="string")n=XT(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function Rd(t){if(typeof t=="function")return t;if(!qT(t))throw Error(`No registered editor found under "${t}" name`);return XT(t).getConstructor()}function sr(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new jG(e);typeof t=="string"&&GG(t,n),Ow.set(e,n)}function KG(t,e,n){return e=XG(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function XG(t){var e=qG(t,"string");return typeof e=="symbol"?e:String(e)}function qG(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let Ed=0;class ZG{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;KG(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){r.call(this,QG(s))}return this.context.eventListeners.push({element:e,event:n,callback:r,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(n,o,i),Ed+=1,()=>{this.removeEventListener(e,n,r)}}removeEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===n&&s.element===e){if(r&&r!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options),Ed-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const r=this.context.eventListeners[n];e&&r.eventManager!==this||(this.context.eventListeners.splice(n,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),Ed-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let r=e.document,i=e;r||(r=e.ownerDocument?e.ownerDocument:e,i=r.defaultView);const o={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let s;r.createEvent?(s=r.createEvent("MouseEvents"),s.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,r.body.parentNode)):s=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${n}`,s)}}function QG(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),Lr(this)},t}const br=ZG;function JG(){return Ed}function QT(t,e){ez(t,e),e.add(t)}function ez(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function os(t,e,n){return e=tz(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tz(t){var e=nz(t,"string");return typeof e=="symbol"?e:String(e)}function nz(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function JT(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Td="editorManager.navigation";var e_=new WeakSet,t_=new WeakSet;class Aw{constructor(e,n,r){QT(this,t_),QT(this,e_),os(this,"hot",void 0),os(this,"tableMeta",void 0),os(this,"selection",void 0),os(this,"eventManager",void 0),os(this,"destroyed",!1),os(this,"lock",!1),os(this,"activeEditor",void 0),os(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=r,this.eventManager=new br(e),this.hot.addHook("afterDocumentKeyDown",i=>JT(this,e_,rz).call(this,i)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",i=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",i)}),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>JT(this,t_,iz).call(this,i,o,s))}lockEditor(){this.lock=!0}unlockEditor(){this.lock=!1}destroyEditor(e){this.lock||this.closeEditor(e)}getActiveEditor(){return this.activeEditor}prepareEditor(){if(this.lock)return;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,l=>{l&&this.prepareEditor()});return}const{highlight:e}=this.hot.getSelectedRangeLast();if(e.isHeader())return;const{row:n,col:r}=e,i=this.hot.runHooks("modifyGetCellCoords",n,r);let o=n,s=r;if(Array.isArray(i)&&([o,s]=i),this.cellProperties=this.hot.getCellMeta(o,s),!this.isCellEditable()){this.clearActiveEditor();return}const a=this.hot.getCell(n,r,!0);if(a){const l=this.hot.getCellEditor(this.cellProperties),u=this.hot.colToProp(s),c=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o),s);this.activeEditor=ZT(l,this.hot),this.activeEditor.prepare(n,r,u,a,c,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,r){this.activeEditor?this.activeEditor.finishEditing(e,n,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:r,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(r))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!n||a)}moveSelectionAfterEnter(e){const n=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;e?this.selection.transformStart(-n.row,-n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function rz(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||rs(t))return;const{keyCode:n}=t,r=(t.ctrlKey||t.metaKey)&&!t.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!Rw(n)&&!zT(n)&&!r&&!this.isEditorOpened()){const o=this.hot.getShortcutManager().getContext("editor"),s={runOnlyIf:()=>be(this.hot.getSelected()),group:Td};o.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],s),this.openEditor("",t)}}function iz(t,e,n){n.nodeName==="TD"&&this.openEditor(null,t,!0)}const n_=new WeakMap;Aw.getInstance=function(t,e,n){let r=n_.get(t);return r||(r=new Aw(t,e,n),n_.set(t,r)),r};const oz=Aw;function _d(t,e){r_(t,e),e.add(t)}function Vu(t,e,n){r_(t,e),e.set(t,n)}function r_(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qa(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Gt(t,e){var n=i_(t,e,"get");return sz(t,n)}function sz(t,e){return e.get?e.get.call(t):e.value}function Bu(t,e,n){var r=i_(t,e,"set");return az(t,r,n),n}function i_(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function az(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const ss=Object.freeze({CELL:"cell",MIXED:"mixed"});var Mn=new WeakMap,Md=new WeakMap,Od=new WeakMap,Ad=new WeakMap,Id=new WeakMap,Pd=new WeakSet,o_=new WeakSet,s_=new WeakSet,a_=new WeakSet;class lz{constructor(e){var n=this;_d(this,a_),_d(this,s_),_d(this,o_),_d(this,Pd),Vu(this,Mn,{writable:!0,value:void 0}),Vu(this,Md,{writable:!0,value:void 0}),Vu(this,Od,{writable:!0,value:50}),Vu(this,Ad,{writable:!0,value:null}),Vu(this,Id,{writable:!0,value:new Map});const r=e.getSettings();Bu(this,Mn,e),Bu(this,Md,r.imeFastEdit?ss.MIXED:ss.CELL),Gt(this,Mn).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Qa(n,a_,hz).call(n,...o)}),Gt(this,Mn).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Qa(n,o_,uz).call(n,...o)}),Gt(this,Mn).addHook("afterSelectionEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Qa(n,s_,cz).call(n,...o)})}getFocusMode(){return Gt(this,Md)}setFocusMode(e){Object.values(ss).includes(e)?Bu(this,Md,e):At(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return Gt(this,Od)}setRefocusDelay(e){Bu(this,Od,e)}setRefocusElementGetter(e){Bu(this,Ad,e)}getRefocusElement(){if(typeof Gt(this,Ad)=="function")return Gt(this,Ad).call(this);var e;return(e=Gt(this,Mn).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const n=r=>{var i,o;const s=(i=Gt(this,Mn).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!s)return;let a=Gt(this,Mn).runHooks("modifyFocusedElement",s.row,s.col,r);a instanceof HTMLElement||(a=r),a&&!((o=Gt(this,Mn).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?n(e):Qa(this,Pd,Iw).call(this,r=>n(r))}refocusToEditorTextarea(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Gt(this,Od);const r=this.getRefocusElement();Gt(this,Mn).getSettings().imeFastEdit&&!((e=Gt(this,Mn).getActiveEditor())!==null&&e!==void 0&&e.isOpened())&&r&&(Gt(this,Id).has(n)||Gt(this,Id).set(n,md(()=>{r.select()},n)),Gt(this,Id).get(n)())}}function Iw(t){var e;const n=(e=Gt(this,Mn).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||!Gt(this,Mn).selection.isCellVisible(n)){t(null);return}const r=Gt(this,Mn).getCell(n.row,n.col,!0);r===null?Gt(this,Mn).addHookOnce("afterScroll",()=>{t(Gt(this,Mn).getCell(n.row,n.col,!0))}):t(r)}function uz(){Qa(this,Pd,Iw).call(this,t=>{const{activeElement:e}=Gt(this,Mn).rootDocument;e&&gd(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function cz(){Qa(this,Pd,Iw).call(this,t=>{this.getFocusMode()===ss.MIXED&&t.nodeName==="TD"&&this.refocusToEditorTextarea()})}function hz(t){t.imeFastEdit&&this.getFocusMode()!==ss.MIXED?this.setFocusMode(ss.MIXED):!t.imeFastEdit&&this.getFocusMode()!==ss.CELL&&this.setFocusMode(ss.CELL)}const l_={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},dz=new RegExp(Object.keys(l_).map(t=>`(${t})`).join("|"),"gi");function fz(t){return(t&&t.nodeName||"")==="TABLE"}function Pw(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),r=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...r),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,d=e?1:0;for(let g=0;g<o;g+=1){const p=e&&g===0,C=[];for(let I=0;I<s;I+=1){const M=!p&&n&&I===0;let y="";if(p)y=`<th>${t.getColHeader(I-c)}</th>`;else if(M)y=`<th>${t.getRowHeader(g-d)}</th>`;else{const $=i[g][I],{hidden:X,rowspan:G,colspan:q}=t.getCellMeta(g-d,I-c);if(!X){const re=[];if(G&&re.push(`rowspan="${G}"`),q&&re.push(`colspan="${q}"`),hn($))y=`<td ${re.join(" ")}></td>`;else{const v=$.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");y=`<td ${re.join(" ")}>${v}</td>`}}}C.push(y)}const E=["<tr>",...C,"</tr>"].join("");p?l.splice(1,0,E):u.splice(-1,0,E)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function xw(t){const e=t.length,n=["<table>"];for(let r=0;r<e;r+=1){const i=t[r],o=i.length,s=[];r===0&&n.push("<tbody>");for(let a=0;a<o;a+=1){const l=i[a],u=hn(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}n.push("<tr>",...s,"</tr>"),r+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function u_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},r=e.createDocumentFragment(),i=e.createElement("div");r.appendChild(i);let o=t;if(typeof o=="string"){const $=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,X=>{const G=X.match(/<td\b[^>]*?>/g)[0],q=X.substring(G.length,X.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,"");return`${G}${q}</td>`});i.insertAdjacentHTML("afterbegin",`${$}`),o=i.querySelector("table")}if(!o||!fz(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce(($,X)=>$+X.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],d=[];let g=!1,p=0,C=0;if(o.tHead){const $=Array.from(o.tHead.rows).filter(X=>{const G=X.querySelector("td")!==null;return G&&d.push(X),!G});p=$.length,g=p>0,p>1?n.nestedHeaders=Array.from($).reduce((X,G)=>{const q=Array.from(G.cells).reduce((re,v,S)=>{if(a&&S===0)return re;const{colSpan:b,innerHTML:L}=v,P=b>1?{label:L,colspan:b}:L;return re.push(P),re},[]);return X.push(q),X},[]):g&&(n.colHeaders=Array.from($[0].children).reduce((X,G,q)=>(a&&q===0||X.push(G.innerHTML),X),[]))}d.length&&(n.fixedRowsTop=d.length),c.length&&(n.fixedRowsBottom=c.length);const E=[...d,...Array.from(o.tBodies).reduce(($,X)=>($.push(...Array.from(X.rows)),$),[]),...c];C=E.length;const I=new Array(C);for(let $=0;$<C;$++)I[$]=new Array(u);const M=[],y=[];for(let $=0;$<C;$++){const X=E[$],G=Array.from(X.cells),q=G.length;for(let re=0;re<q;re++){const v=G[re],{nodeName:S,innerHTML:b,rowSpan:L,colSpan:P}=v,x=I[$].findIndex(W=>W===void 0);if(S==="TD"){if(L>1||P>1){for(let z=$;z<$+L;z++)if(z<C)for(let w=x;w<x+P;w++)I[z][w]=null;const D=v.getAttribute("style");D&&D.includes("mso-ignore:colspan")||M.push({col:x,row:$,rowspan:L,colspan:P})}let W="";s&&/excel/gi.test(s.content)?W=b.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):W=b.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),I[$][x]=W.replace(dz,D=>l_[D])}else y.push(b)}}return M.length&&(n.mergeCells=M),y.length&&(n.rowHeaders=y),I.length&&(n.data=I),n}const gz=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:xw,htmlToGridSettings:u_,instanceToHTML:Pw},Symbol.toStringTag,{value:"Module"}));function Xn(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const r=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?\\s*(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function c_(t){return Xn(t,[","])}function Ie(t,e,n){let r=-1;for(typeof e=="function"?(n=e,e=t):r=t-1;++r<=e&&n(r)!==!1;);}function xd(t,e,n){let r=t+1;for(typeof e=="function"&&(n=e,e=0);--r>=e&&n(r)!==!1;);}function Hw(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function ar(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}const mz=Object.freeze(Object.defineProperty({__proto__:null,clamp:ar,isNumeric:Xn,isNumericLike:c_,rangeEach:Ie,rangeEachReverse:xd,valueAccordingPercent:Hw},Symbol.toStringTag,{value:"Module"})),Dw="asc",pz="desc",h_=new Map([[Dw,[-1,1]],[pz,[1,-1]]]),wz=t=>`The priority '${t}' is already declared in a map.`,Cz=t=>`The priority '${t}' is not a number.`;function vz(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=Ot(t)?t:wz,e=Ot(e)?e:Cz;function r(o,s){if(!Xn(o))throw new Error(e(o));if(n.has(o))throw new Error(t(o));n.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Dw;const[s,a]=h_.get(o)||h_.get(Dw);return[...n].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:r,getItems:i}}const Sz=t=>`The id '${t}' is already declared in a map.`;function Hd(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=Ot(t)?t:Sz;function n(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function r(u){return e.delete(u)}function i(){e.clear()}function o(u){const[c]=a().find(d=>{let[g,p]=d;return u===p?g:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:n,clear:i,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:r}}const yz=t=>`'${t}' value is already declared in a unique set.`;function bz(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=Ot(t)?t:yz;function n(o){if(e.has(o))throw new Error(t(o));e.add(o)}function r(){return[...e]}function i(){e.clear()}return{addItem:n,clear:i,getItems:r}}const Nw=t=>`There is already registered "${t}" plugin.`,d_=vz({errorPriorityExists:t=>`There is already registered plugin on priority "${t}".`,errorPriorityNaN:t=>`The priority "${t}" is not a number.`}),f_=bz({errorItemExists:Nw}),Lw=Hd({errorIdExists:Nw});function $w(){return[...d_.getItems(),...f_.getItems()]}function Uu(t){const e=$n(t);return Lw.getItem(e)}function Rz(t){return!!Uu(t)}function dt(t,e,n){[t,e,n]=Tz(t,e,n),Uu(t)===void 0&&Ez(t,e,n)}function Ez(t,e,n){const r=$n(t);if(Lw.hasItem(r))throw new Error(Nw(r));n===void 0?f_.addItem(r):d_.addItem(n,r),Lw.addItem(r,e)}function Tz(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:_z,getItem:Mz,hasItem:g_,getNames:Oz,getValues:_ae}=si("renderers");function Dd(t){if(typeof t=="function")return t;if(!g_(t))throw Error(`No registered renderer found under "${t}" name`);return Mz(t)}function xi(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),_z(t,e)}const{register:Az,getItem:Iz,hasItem:m_,getNames:Pz,getValues:Mae}=si("validators");function kw(t){if(typeof t=="function")return t;if(!m_(t))throw Error(`No registered validator found under "${t}" name`);return Iz(t)}function Ja(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),Az(t,e)}var p_={},xz=rE,Hz=Zm,Dz=Object.keys||function(e){return xz(e,Hz)},Nz=Ri,Lz=YR,$z=Ds,kz=uu,Fz=vh,Wz=Dz;p_.f=Nz&&!Lz?Object.defineProperties:function(e,n){kz(e);for(var r=Fz(n),i=Wz(n),o=i.length,s=0,a;o>s;)$z.f(e,a=i[s++],r[a]);return e};var Vz=uu,Bz=p_,w_=Zm,Uz=Um,Yz=AE,Gz=Dm,zz=XR,C_=">",v_="<",Fw="prototype",Ww="script",S_=zz("IE_PROTO"),Vw=function(){},y_=function(t){return v_+Ww+C_+t+v_+"/"+Ww+C_},b_=function(t){t.write(y_("")),t.close();var e=t.parentWindow.Object;return t=null,e},jz=function(){var t=Gz("iframe"),e="java"+Ww+":",n;return t.style.display="none",Yz.appendChild(t),t.src=String(e),n=t.contentWindow.document,n.open(),n.write(y_("document.F=Object")),n.close(),n.F},Nd,Ld=function(){try{Nd=new ActiveXObject("htmlfile")}catch{}Ld=typeof document<"u"?document.domain&&Nd?b_(Nd):jz():b_(Nd);for(var t=w_.length;t--;)delete Ld[Fw][w_[t]];return Ld()};Uz[S_]=!0;var Kz=Object.create||function(e,n){var r;return e!==null?(Vw[Fw]=Vz(e),r=new Vw,Vw[Fw]=null,r[S_]=e):r=Ld(),n===void 0?r:Bz.f(r,n)},Xz=Rh,qz=Kz,Zz=Ds.f,Bw=Xz("unscopables"),Uw=Array.prototype;Uw[Bw]===void 0&&Zz(Uw,Bw,{configurable:!0,value:qz(null)});var R_=function(t){Uw[Bw][t]=!0},Qz=Ns,Jz=bh,ej=Ah,tj=Xm,nj=R_;Qz({target:"Array",proto:!0},{at:function(e){var n=Jz(this),r=ej(n),i=tj(e),o=i>=0?i:r+i;return o<0||o>=r?void 0:n[o]}}),nj("at");const zs=1,Fn=2;function E_(t,e,n){rj(t,e),e.set(t,n)}function rj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wo(t,e,n){return e=ij(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ij(t){var e=oj(t,"string");return typeof e=="symbol"?e:String(e)}function oj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dn(t,e){var n=__(t,e,"get");return sj(t,n)}function sj(t,e){return e.get?e.get.call(t):e.value}function T_(t,e,n){var r=__(t,e,"set");return aj(t,r,n),n}function __(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function aj(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var $d=new WeakMap,fn=new WeakMap;class Yw{static get DEFAULT_WIDTH(){return 50}constructor(e){wo(this,"count",0),wo(this,"startColumn",null),wo(this,"endColumn",null),wo(this,"startPosition",null),wo(this,"isVisibleInTrimmingContainer",!1),wo(this,"stretchAllRatio",0),wo(this,"stretchLastWidth",0),E_(this,$d,{writable:!0,value:0}),wo(this,"needVerifyLastColumnWidth",!0),wo(this,"stretchAllColumnsWidth",[]),E_(this,fn,{writable:!0,value:void 0}),T_(this,fn,e),typeof dn(this,fn).stretchingColumnWidthFn!="function"&&(dn(this,fn).stretchingColumnWidthFn=n=>n),this.calculate()}calculate(){const{calculationType:e,overrideFn:n,scrollOffset:r,totalColumns:i,viewportWidth:o}=dn(this,fn),s=Math.max(dn(this,fn).scrollOffset,0),a=s>0?o+1:o;let l=0,u=!0;const c=[];let d,g=0,p=0;for(let M=0;M<i;M++)if(d=this._getColumnWidth(M),l<=s&&e!==Fn&&(this.startColumn=M,g=d),l>=s&&l+(e===Fn?d:0)<=s+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=M,g=d),this.endColumn=M),c.push(l),l+=d,p=d,e!==Fn&&(this.endColumn=M),l>=s+o){u=!1;break}const C=r+o-a,E=e===Fn?0:p,I=e===Fn?g:0;if(C<-1*dn(this,fn).inlineStartOffset||r>c.at(-1)+E||-1*dn(this,fn).scrollOffset-dn(this,fn).viewportWidth>-1*I?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===i-1&&u)for(this.startColumn=this.endColumn;this.startColumn>0;){const M=c[this.endColumn]+d-c[this.startColumn-1];if((M<=o||e!==Fn)&&(this.startColumn-=1),M>o)break}e===zs&&this.startColumn!==null&&n&&n(this),this.startPosition=c[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}refreshStretching(e){if(dn(this,fn).stretchMode==="none")return;let n=e;T_(this,$d,n);const r=dn(this,fn).totalColumns;let i=0;for(let s=0;s<r;s++){const a=this._getColumnWidth(s),l=dn(this,fn).stretchingColumnWidthFn(void 0,s);typeof l=="number"?n-=l:i+=a}const o=n-i;if(dn(this,fn).stretchMode==="all"&&o>0)this.stretchAllRatio=n/i,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(dn(this,fn).stretchMode==="last"&&n!==1/0){const s=this._getColumnWidth(r-1),a=o+s;this.stretchLastWidth=a>=0?a:s}}getStretchedColumnWidth(e,n){let r=null;return dn(this,fn).stretchMode==="all"&&this.stretchAllRatio!==0?r=this._getStretchedAllColumnWidth(e,n):dn(this,fn).stretchMode==="last"&&this.stretchLastWidth!==0&&(r=this._getStretchedLastColumnWidth(e)),r}_getStretchedAllColumnWidth(e,n){let r=0;const i=dn(this,fn).totalColumns;if(!this.stretchAllColumnsWidth[e]){const o=Math.round(n*this.stretchAllRatio),s=dn(this,fn).stretchingColumnWidthFn(o,e);s===void 0?this.stretchAllColumnsWidth[e]=o:this.stretchAllColumnsWidth[e]=isNaN(s)?this._getColumnWidth(e):s}if(this.stretchAllColumnsWidth.length===i&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let o=0;o<this.stretchAllColumnsWidth.length;o++)r+=this.stretchAllColumnsWidth[o];r!==dn(this,$d)&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=dn(this,$d)-r)}return this.stretchAllColumnsWidth[e]}_getStretchedLastColumnWidth(e){const n=dn(this,fn).totalColumns;return e===n-1?this.stretchLastWidth:null}_getColumnWidth(e){let n=dn(this,fn).columnWidthFn(e);return isNaN(n)&&(n=Yw.DEFAULT_WIDTH),n}}const Gw=Yw;function lj(t,e,n){uj(t,e),e.set(t,n)}function uj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yu(t,e,n){return e=cj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cj(t){var e=hj(t,"string");return typeof e=="symbol"?e:String(e)}function hj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zw(t,e){var n=M_(t,e,"get");return dj(t,n)}function dj(t,e){return e.get?e.get.call(t):e.value}function fj(t,e,n){var r=M_(t,e,"set");return gj(t,r,n),n}function M_(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function gj(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Gu=new WeakMap;class jw{static get DEFAULT_HEIGHT(){return 23}constructor(e){Yu(this,"count",0),Yu(this,"startRow",null),Yu(this,"endRow",null),Yu(this,"startPosition",null),Yu(this,"isVisibleInTrimmingContainer",!1),lj(this,Gu,{writable:!0,value:void 0}),fj(this,Gu,e),this.calculate()}calculate(){const{calculationType:e,overrideFn:n,rowHeightFn:r,scrollOffset:i,totalRows:o,viewportHeight:s}=zw(this,Gu),a=Math.max(zw(this,Gu).scrollOffset,0),l=zw(this,Gu).horizontalScrollbarHeight||0;let u=0,c=!0;const d=[];let g,p=0,C=0;for(let y=0;y<o;y++)if(g=r(y),isNaN(g)&&(g=jw.DEFAULT_HEIGHT),u<=a&&e!==Fn&&(this.startRow=y,p=g),u>=a&&u+(e===Fn?g:0)<=a+s-l&&(this.startRow===null&&(this.startRow=y,p=g),this.endRow=y),d.push(u),u+=g,C=g,e!==Fn&&(this.endRow=y),u>=a+s-l){c=!1;break}const E=i+s-l,I=e===Fn?p:0,M=e===Fn?0:C;if(E<I||i>d.at(-1)+M?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===o-1&&c)for(this.startRow=this.endRow;this.startRow>0;){const y=d[this.endRow]+g-d[this.startRow-1];if((y<=s-l||e!==Fn)&&(this.startRow-=1),y>=s-l)break}e===zs&&this.startRow!==null&&n&&n(this),this.startPosition=d[this.startRow],this.startPosition===void 0&&(this.startPosition=null),o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}const O_=jw;function mj(t,e,n){pj(t,e),e.set(t,n)}function pj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function A_(t,e,n){return e=wj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wj(t){var e=Cj(t,"string");return typeof e=="symbol"?e:String(e)}function Cj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function el(t,e){var n=P_(t,e,"get");return vj(t,n)}function vj(t,e){return e.get?e.get.call(t):e.value}function I_(t,e,n){var r=P_(t,e,"set");return Sj(t,r,n),n}function P_(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Sj(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Co=new WeakMap;class kd{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;A_(this,"row",null),A_(this,"col",null),mj(this,Co,{writable:!0,value:!1}),I_(this,Co,r),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:r,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=n||this.col>=r)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return el(this,Co)}isSouthEastOf(e){return this.row>=e.row&&(el(this,Co)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(el(this,Co)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(el(this,Co)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(el(this,Co)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof kd&&I_(this,Co,e.isRtl()),this}clone(){return new kd(this.row,this.col,el(this,Co))}toObject(){return{row:this.row,col:this.col}}}const Fd=kd;function yj(t,e,n){bj(t,e),e.set(t,n)}function bj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kw(t,e,n){return e=Rj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rj(t){var e=Ej(t,"string");return typeof e=="symbol"?e:String(e)}function Ej(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Hi(t,e){var n=x_(t,e,"get");return Tj(t,n)}function Tj(t,e){return e.get?e.get.call(t):e.value}function _j(t,e,n){var r=x_(t,e,"set");return Mj(t,r,n),n}function x_(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Mj(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var $r=new WeakMap;class Xw{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;Kw(this,"highlight",null),Kw(this,"from",null),Kw(this,"to",null),yj(this,$r,{writable:!0,value:!1}),this.highlight=e.clone(),this.from=n.clone(),this.to=r.clone(),_j(this,$r,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:r}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=n&&o.row>=n&&i.col<=r&&o.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopRightCorner().col>=e.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=e.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=e.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=e.getOuterTopLeftCorner().col}isOverlappingVertically(e){return this.getOuterBottomRightCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=e.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=e.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>r.row||e.col>r.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0):!1}expandByRange(e){if(this.includesRange(e)||!this.overlaps(e))return!1;const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),i=this.getDirection(),o=e.getOuterTopStartCorner(),s=e.getOuterBottomEndCorner(),a=Math.min(n.row,o.row),l=Math.min(n.col,o.col),u=Math.max(r.row,s.row),c=Math.max(r.col,s.col),d=this._createCellCoords(a,l),g=this._createCellCoords(u,c);return this.from=d,this.to=g,this.setDirection(i),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return Hi(this,$r)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return Hi(this,$r)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return Hi(this,$r)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return Hi(this,$r)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return Hi(this,$r)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return Hi(this,$r)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return Hi(this,$r)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return Hi(this,$r)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e,n){return n&&n.includes(e)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(n.from.row,n.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(n.from.row,n.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(n.to.row,n.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(n.to.row,n.to.col)))?!0:e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e,n){if(!(e instanceof Fd))return!1;if(n){const{from:r,to:i}=n;if(n.includes(e)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(r.row,r.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(r.row,i.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(i.row,r.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(i.row,i.col)))return this.getOuterTopStartCorner()}}if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return n.top===r.top&&i.push("top"),n.right===r.right&&i.push("right"),n.bottom===r.bottom&&i.push("bottom"),n.left===r.left&&i.push("left"),i}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&r.push(this._createCellCoords(i,o));return r}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)e.row===i&&e.col===o?r.push(e):n.row===i&&n.col===o?r.push(n):r.push(this._createCellCoords(i,o));return r}forAll(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let i=n.row;i<=r.row;i++)for(let o=n.col;o<=r.col;o++)if(e(i,o)===!1)return}clone(){return new Xw(this.highlight,this.from,this.to,Hi(this,$r))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new Fd(e,n,Hi(this,$r))}}const qw=Xw;function Wd(t){return window.requestAnimationFrame(t)}function zu(t){window.cancelAnimationFrame(t)}function Zw(){return"ontouchstart"in window}let tl;function H_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return tl||(typeof Intl=="object"?tl=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?tl=(n,r)=>`${n}`.localeCompare(r):tl=(n,r)=>n===r?0:n>r?-1:1,tl)}const Oj=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:zu,getComparisonFunction:H_,isTouchSupported:Zw,requestAnimationFrame:Wd},Symbol.toStringTag,{value:"Module"}));function Di(t,e,n){Aj(t,e),e.set(t,n)}function Aj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function De(t,e){var n=D_(t,e,"get");return Ij(t,n)}function Ij(t,e){return e.get?e.get.call(t):e.value}function as(t,e,n){var r=D_(t,e,"set");return Pj(t,r,n),n}function D_(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Pj(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var kr=new WeakMap,Qw=new WeakMap,vn=new WeakMap,nl=new WeakMap,Vd=new WeakMap,ai=new WeakMap,Jw=new WeakMap,ju=new WeakMap,js=new WeakMap,Ni=new WeakMap;const N_=class{constructor(e,n,r,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Di(this,kr,{writable:!0,value:void 0}),Di(this,Qw,{writable:!0,value:void 0}),Di(this,vn,{writable:!0,value:void 0}),Di(this,nl,{writable:!0,value:void 0}),Di(this,Vd,{writable:!0,value:void 0}),Di(this,ai,{writable:!0,value:void 0}),Di(this,Jw,{writable:!0,value:void 0}),Di(this,ju,{writable:!0,value:void 0}),Di(this,js,{writable:!0,value:[null,null]}),Di(this,Ni,{writable:!0,value:[null,null]}),as(this,kr,r),as(this,Qw,n),as(this,vn,o),as(this,nl,s),as(this,Vd,a),as(this,ai,i),as(this,Jw,e),this.registerEvents()}registerEvents(){De(this,ai).addEventListener(De(this,vn).holder,"contextmenu",r=>this.onContextMenu(r)),De(this,ai).addEventListener(De(this,vn).TABLE,"mouseover",r=>this.onMouseOver(r)),De(this,ai).addEventListener(De(this,vn).TABLE,"mouseout",r=>this.onMouseOut(r));const e=()=>{De(this,ai).addEventListener(De(this,vn).holder,"touchstart",r=>this.onTouchStart(r)),De(this,ai).addEventListener(De(this,vn).holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),De(this,ai).addEventListener(De(this,vn).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||De(this,kr).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,De(this,kr).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{De(this,ai).addEventListener(De(this,vn).holder,"mouseup",r=>this.onMouseUp(r)),De(this,ai).addEventListener(De(this,vn).holder,"mousedown",r=>this.onMouseDown(r))};po()?e():(Zw()&&e(),n())}selectedCellWasTouched(e){const r=this.parentCell(e).coords;if(De(this,ju)&&r){const[i,o]=[r.row,De(this,ju).from.row],[s,a]=[r.col,De(this,ju).from.col];return i===o&&s===a}return!1}parentCell(e){const n={},r=De(this,vn).TABLE,i=xu(e,["TD","TH"],r);return i?(n.coords=De(this,vn).getCoords(i),n.TD=i):We(e,"wtBorder")&&We(e,"current")?(n.coords=De(this,nl).getFocusSelection().cellRange.highlight,n.TD=De(this,vn).getCell(n.coords)):We(e,"wtBorder")&&We(e,"area")&&De(this,nl).getAreaSelection().cellRange&&(n.coords=De(this,nl).getAreaSelection().cellRange.to,n.TD=De(this,vn).getCell(n.coords)),n}onMouseDown(e){const n=De(this,Qw).rootDocument.activeElement,r=ww(hT,e.target),i=e.target;if(!["TD","TH"].includes(n.nodeName)&&(i===n||r(0)===n||r(1)===n))return;const o=this.parentCell(i);We(i,"corner")?De(this,kr).getSetting("onCellCornerMouseDown",e,i):o.TD&&De(this,kr).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(De(this,Ni)[0]=o.TD,clearTimeout(De(this,js)[0]),De(this,js)[0]=setTimeout(()=>{De(this,Ni)[0]=null},1e3))}onContextMenu(e){if(De(this,kr).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!De(this,kr).has("onCellMouseOver"))return;const n=De(this,vn).TABLE,r=xu(e.target,["TD","TH"],n),i=De(this,Vd)||this;r&&r!==i.lastMouseOver&&Qo(r,n)&&(i.lastMouseOver=r,this.callListener("onCellMouseOver",e,De(this,vn).getCoords(r),r))}onMouseOut(e){if(!De(this,kr).has("onCellMouseOut"))return;const n=De(this,vn).TABLE,r=xu(e.target,["TD","TH"],n),i=xu(e.relatedTarget,["TD","TH"],n),o=De(this,Vd)||this;r&&r!==i&&Qo(r,n)&&(this.callListener("onCellMouseOut",e,De(this,vn).getCoords(r),r),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&De(this,kr).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===De(this,Ni)[0]&&n.TD===De(this,Ni)[1]?(We(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),De(this,Ni)[0]=null,De(this,Ni)[1]=null):n.TD===De(this,Ni)[0]&&(De(this,Ni)[1]=n.TD,clearTimeout(De(this,js)[1]),De(this,js)[1]=setTimeout(()=>{De(this,Ni)[1]=null},500)))}onTouchStart(e){as(this,ju,De(this,nl).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const r=e.target,i=(n=this.parentCell(r))===null||n===void 0?void 0:n.coords,o=be(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&De(this,kr).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];Sw()&&(BT()||UT())&&this.selectedCellWasTouched(r)&&!a.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,r,i){const o=De(this,kr).getSettingPure(e);o&&o(n,r,i,De(this,Jw).call(this))}destroy(){clearTimeout(De(this,js)[0]),clearTimeout(De(this,js)[1]),De(this,ai).destroy()}};function eC(t,e,n){return e=xj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xj(t){var e=Hj(t,"string");return typeof e=="symbol"?e:String(e)}function Hj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Dj{constructor(e,n,r){eC(this,"offset",void 0),eC(this,"total",void 0),eC(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const Nj=Dj;function tC(t,e,n){return e=Lj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lj(t){var e=$j(t,"string");return typeof e=="symbol"?e:String(e)}function $j(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kj{constructor(e,n,r){tC(this,"offset",void 0),tC(this,"total",void 0),tC(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const Fj=kj,Wj=0,Bd=1,Ud=2;function Yd(t,e,n){return e=Vj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vj(t){var e=Bj(t,"string");return typeof e=="symbol"?e:String(e)}function Bj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class L_{constructor(){Yd(this,"currentSize",0),Yd(this,"nextSize",0),Yd(this,"currentOffset",0),Yd(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}function nC(t,e,n){return e=Uj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Uj(t){var e=Yj(t,"string");return typeof e=="symbol"?e:String(e)}function Yj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Gj{constructor(){nC(this,"size",new L_),nC(this,"workingSpace",Wj),nC(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof L_}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=Bd,e.workingSpace=Ud,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=Ud,e.workingSpace=Bd,this.sharedSize=e.getViewSize()}}function rl(t,e,n){return e=zj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zj(t){var e=jj(t,"string");return typeof e=="symbol"?e:String(e)}function jj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $_{constructor(e,n,r){rl(this,"rootNode",void 0),rl(this,"nodesPool",void 0),rl(this,"sizeSet",new Gj),rl(this,"childNodeType",void 0),rl(this,"visualIndex",0),rl(this,"collectedNodes",[]),this.rootNode=e,this.nodesPool=n,this.childNodeType=r.toUpperCase()}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:n}=this;let r=0;if(this.isSharedViewSet()){let i=e.firstElementChild;for(;i;){if(i.tagName===this.childNodeType)r+=1;else if(n.isPlaceOn(Bd))break;i=i.nextElementSibling}}else r=e.childElementCount;return r}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:n}=this,r=this.isSharedViewSet(),{nextSize:i}=n.getViewSize();let o=this.getRenderedChildCount();for(;o<i;){const a=this.nodesPool();!r||r&&n.isPlaceOn(Ud)?e.appendChild(a):e.insertBefore(a,e.firstChild),o+=1}const s=r&&n.isPlaceOn(Bd);for(;o>i;)e.removeChild(s?e.firstChild:e.lastChild),o-=1}render(){const{rootNode:e,sizeSet:n}=this;let r=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(Ud)&&(r+=n.sharedSize.nextSize);let i=e.childNodes[r];if(i.tagName!==this.childNodeType){const o=this.nodesPool();e.replaceChild(o,i),i=o}this.collectedNodes.push(i),this.visualIndex+=1}end(){}}class k_ extends $_{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function Kj(t,e,n){return e=Xj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xj(t){var e=qj(t,"string");return typeof e=="symbol"?e:String(e)}function qj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Zj{constructor(e){Kj(this,"nodeType",void 0),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}function Ku(t,e,n){return e=Qj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qj(t){var e=Jj(t,"string");return typeof e=="symbol"?e:String(e)}function Jj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Xu{constructor(e,n){Ku(this,"nodesPool",null),Ku(this,"nodeType",void 0),Ku(this,"rootNode",void 0),Ku(this,"table",null),Ku(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new Zj(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function F_(t,e,n){return e=eK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eK(t){var e=tK(t,"string");return typeof e=="symbol"?e:String(e)}function tK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nK extends Xu{constructor(){super("TH"),F_(this,"orderViews",new WeakMap),F_(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new k_(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:r,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(let d=0;d<r;d++){u.render();const g=u.getCurrentNode();g.className="",g.removeAttribute("style"),Us(g,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Le(g,[LY(),YY(),aw(d+1),za(-1)]),n[d](a,g,d)}u.end()}}}class rK extends Xu{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+n;for(let a=0,l=e;a<l;a++){for(r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<o;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)r.removeChild(r.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&ii(r)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Le(this.rootNode,[iT()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:r,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&Le(s,[ow(),lT(n+1)]);for(let a=-1*o;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),Us(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Le(u,[aw(a+1+this.table.rowHeadersCount),za(-1),$Y(),...a>=0?[UY()]:[ow()]]),r[n](l,u,n)}}}}class iK extends Xu{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,r=e+n;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;for(let i=0;i<n;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getStretchedColumnWidth(o);this.rootNode.childNodes[i+n].style.width=`${s}px`}const r=this.rootNode.firstChild;r&&ce(r,"rowHeader")}}function oK(t,e,n){return e=sK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sK(t){var e=aK(t,"string");return typeof e=="symbol"?e:String(e)}function aK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let W_=!1;class lK extends Xu{constructor(e){super("TR",e),oK(this,"orderView",void 0),this.orderView=new $_(e,n=>this.nodesPool.obtain(n),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!W_&&e>1e3&&(W_=!0,At(St`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Le(this.rootNode,[iT()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var n,r;Le(o,[ow(),lT(s+((n=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}}this.orderView.end()}}function V_(t,e,n){return e=uK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uK(t){var e=cK(t,"string");return typeof e=="symbol"?e:String(e)}function cK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hK extends Xu{constructor(){super("TD"),V_(this,"orderViews",new WeakMap),V_(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new k_(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:r,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=r.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),d=i.obtainOrderView(u);c.prependView(d).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(let g=0;g<n;g++){c.render();const p=c.getCurrentNode(),C=this.table.renderedColumnToSource(g);if(We(p,"hide")||(p.className=""),p.removeAttribute("style"),p.removeAttribute("dir"),Us(p,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,C,p),this.table.isAriaEnabled()){var o,s;Le(p,[...p.hasAttribute("role")?[]:[NY()],za(-1),aw(C+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function Sn(t,e,n){return e=dK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dK(t){var e=fK(t,"string");return typeof e=="symbol"?e:String(e)}function fK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gK{constructor(e){let{cellRenderer:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Sn(this,"rootNode",void 0),Sn(this,"rootDocument",void 0),Sn(this,"rowHeaders",null),Sn(this,"columnHeaders",null),Sn(this,"colGroup",null),Sn(this,"rows",null),Sn(this,"cells",null),Sn(this,"rowFilter",null),Sn(this,"columnFilter",null),Sn(this,"rowUtils",null),Sn(this,"columnUtils",null),Sn(this,"rowsToRender",0),Sn(this,"columnsToRender",0),Sn(this,"rowHeaderFunctions",[]),Sn(this,"rowHeadersCount",0),Sn(this,"columnHeaderFunctions",[]),Sn(this,"columnHeadersCount",0),Sn(this,"cellRenderer",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:r,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),r.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=r,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let r=0;r<e;r++){const i=n.getRenderedNode(r);if(i.firstChild){const o=this.renderedRowToSource(r),s=this.rowUtils.getHeight(o);s?i.firstChild.style.height=`${s-1}px`:i.firstChild.style.height=""}}}}class mK{constructor(){let{TABLE:e,THEAD:n,COLGROUP:r,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new gK(e,{cellRenderer:a}),this.renderer.setRenderers({rowHeaders:new nK,columnHeaders:new rK(n),colGroup:new iK(r),rows:new lK(i),cells:new hK}),this.renderer.setAxisUtils(o,s)}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function rC(t,e,n){return e=pK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pK(t){var e=wK(t,"string");return typeof e=="symbol"?e:String(e)}function wK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class CK{constructor(e,n){rC(this,"dataAccessObject",void 0),rC(this,"wtSettings",void 0),rC(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=n}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(e){const n=this.dataAccessObject.wtViewport.columnsRenderCalculator;let r=this.getWidth(e);if(n){const i=n.getStretchedColumnWidth(e,r);i&&(r=i)}return r}getHeaderHeight(e){let n=this.wtSettings.getSetting("defaultRowHeight");const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(n=n?Math.max(n,r):r),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this,{wtTable:n,wtViewport:r,cloneSource:i}=this.dataAccessObject,o=i?i.wtTable.holder:n.holder,s=o.offsetHeight<o.scrollHeight?wn():0;let a=e.getSetting("rowHeaderWidth");if(r.columnsRenderCalculator.refreshStretching(r.getViewportWidth()-s),a=e.getSetting("onModifyRowHeaderWidth",a),a!=null){const l=e.getSetting("rowHeaders").length,u=e.getSetting("defaultColumnWidth");for(let c=0;c<l;c++){let d=Array.isArray(a)?a[c]:a;d=d??u,this.headerWidths.set(c,d)}}}}function B_(t,e,n){return e=vK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vK(t){var e=SK(t,"string");return typeof e=="symbol"?e:String(e)}function SK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yK{constructor(e,n){B_(this,"dataAccessObject",void 0),B_(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(n=n===void 0?r:Math.max(n,r)),n}}function Li(t,e,n){return e=bK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bK(t){var e=RK(t,"string");return typeof e=="symbol"?e:String(e)}function RK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class EK{constructor(e,n,r,i,o){Li(this,"wtSettings",null),Li(this,"domBindings",void 0),Li(this,"TBODY",null),Li(this,"THEAD",null),Li(this,"COLGROUP",null),Li(this,"hasTableHeight",!0),Li(this,"hasTableWidth",!0),Li(this,"isTableVisible",!1),Li(this,"tableOffset",0),Li(this,"holderOffset",0),this.domBindings=r,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,uw(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new yK(this.dataAccessObject,this.wtSettings),this.columnUtils=new CK(this.dataAccessObject,this.wtSettings),this.tableRenderer=new mK({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!We(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",n&&n.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Le(r,[Ii()]),r}createHider(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!We(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",n&&n.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Le(r,[Ii()]),r}createHolder(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!We(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",n&&n.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Le(r.parentNode,[Ii()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Le(r,[Ii()]),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:r,wtViewport:i}=this.dataAccessObject,o=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),a=n.getSetting("rowHeaders"),l=a.length,u=n.getSetting("columnHeaders"),c=u.length;let d=!1,g=e;if(this.isMaster&&(this.holderOffset=sn(this.holder),g=i.createRenderCalculators(g),l&&!n.getSetting("fixedColumnsStart"))){const C=r.inlineStartOverlay.getScrollPosition(),E=this.correctHeaderWidth;this.correctHeaderWidth=C!==0,E!==this.correctHeaderWidth&&(g=!1)}if(this.isMaster&&(d=r.updateStateOfRendering()),g)this.isMaster&&i.createVisibleCalculators(),r&&r.refresh(!0);else{this.isMaster?this.tableOffset=sn(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const C=o>0?this.getFirstRenderedRow():0,E=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new Fj(C,o,c),this.columnFilter=new Nj(E,s,l);let I=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const M={};this.wtSettings.getSetting("beforeDraw",!0,M),I=M.skipRender!==!0}if(I){this.tableRenderer.setHeaderContentRenderers(a,u),(this.is($i)||this.is(ls))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();let M;if(this.isMaster&&(M=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is($i))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();const y=yt(this.hider),$=yt(this.TABLE);y!==0&&$!==y&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),M!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is($i)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let p=!1;return this.isMaster&&(p=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(p=r.bottomOverlay.resetFixedPosition()||p),p=r.inlineStartOverlay.resetFixedPosition()||p,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),p?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(g),d&&r.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("defaultRowHeight");let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,o=this.getColumnHeaderHeight(r),s=this.getColumnHeader(n,r),s&&(a=fo(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),Array.isArray(l)?l[r]!==null&&l[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(l[r]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(r[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height=`${r[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is($i))&&!e.getSetting("externalRowCalculator")){const r=this.getRenderedRowsCount();for(let i=0;i<r;i++){const o=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}}getCell(e){let n=e.row,r=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",n,r);if(i&&Array.isArray(i)&&([n,r]=i),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const o=this.getRow(n);if(!o&&n>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!s&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let n=null,r=null;if(e<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),r=this.TBODY}return n!==void 0&&r!==void 0?r.childNodes.length<n+1?!1:r.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.THEAD.childNodes[n];return r==null?void 0:r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[r];o&&n.push(o)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.wtSettings.getSetting("rowHeaders").length;if(n>=r)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a==null?void 0:a.childNodes[n]}getRowHeaders(e){const n=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<r;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o==null?void 0:o.childNodes[i];s&&n.push(s)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=Zo(n,["TD","TH"])),n===null)return null;const r=n.parentNode,i=r.parentNode;let o=gT(r),s=n.cellIndex;return Jo(qs,n,this.wtRootElement)||Jo(Ks,n,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):Jo(ls,n,this.wtRootElement)||Jo($i,n,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):o=this.rowFilter.renderedToSource(o),Jo(qs,n,this.wtRootElement)||Jo(Xs,n,this.wtRootElement)||Jo(ls,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=e*this.wtSettings.getSetting("defaultRowHeight"),r=fo(this.TBODY)-1;let i,o,s,a,l;if(!(n===r&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;)e-=1,s=this.rowFilter.renderedToSource(e),i=this.getRowHeight(s),a=this.getTrForRow(s),l=a.querySelector("th"),l?o=fo(l):o=fo(a)-1,(!i&&this.wtSettings.getSetting("defaultRowHeight")<o||i<o)&&(o+=1,this.dataAccessObject.wtViewport.oversizedRows[s]=o)}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}getStretchedColumnWidth(e){return this.columnUtils.getStretchedColumnWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return yt(this.TABLE)}getHeight(){return Wt(this.TABLE)}getTotalWidth(){const e=yt(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=Wt(this.hider);return e!==0?e:this.getHeight()}isVisible(){return ts(this.TABLE)}_modifyRowHeaderWidth(e){let n=Ot(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const il=EK,TK="stickyRowsBottom",U_={getFirstRenderedRow(){const t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),n=t-e;return t===0||e===0?-1:n<0?0:n},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};Pi(U_,"MIXIN_NAME",TK,{writable:!1,enumerable:!1});const Y_=U_,_K="stickyColumnsStart",G_={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Pi(G_,"MIXIN_NAME",_K,{writable:!1,enumerable:!1});const iC=G_;class oC extends il{constructor(e,n,r,i){super(e,n,r,i,ls)}}Et(oC,Y_),Et(oC,iC);const MK=oC,Ks="top",$i="bottom",Xs="inline_start",qs="top_inline_start_corner",ls="bottom_inline_start_corner",OK=[Ks,$i,Xs,qs,ls],AK=new Map([[Ks,`ht_clone_${Ks}`],[$i,`ht_clone_${$i}`],[Xs,`ht_clone_${Xs} ht_clone_left`],[qs,`ht_clone_${qs} ht_clone_top_left_corner`],[ls,`ht_clone_${ls} ht_clone_bottom_left_corner`]]);function sC(t,e,n){return e=IK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function IK(t){var e=PK(t,"string");return typeof e=="symbol"?e:String(e)}function PK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xK{constructor(e){sC(this,"dataAccessObject",void 0),sC(this,"lastScrolledColumnPos",-1),sC(this,"lastScrolledRowPos",-1),this.dataAccessObject=e}scrollViewport(e,n,r,i,o){const s=this.scrollViewportHorizontally(e.col,r,o),a=this.scrollViewportVertically(e.row,n,i);return s||a}scrollViewportHorizontally(e,n,r){const{drawn:i,totalColumns:o}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>o)return!1;const s=this.getFirstVisibleColumn(),a=this.getLastVisibleColumn(),l=n===void 0&&r===void 0,{fixedColumnsStart:u,inlineStartOverlay:c}=this.dataAccessObject;if(l&&e<u)return!1;let d=!1;return e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e),s===-1?d=c.scrollTo(e,l?e>this.lastScrolledColumnPos:n):(l&&(e<s||e>a)||!l)&&(d=c.scrollTo(e,l?e>a:n)),d&&(this.lastScrolledColumnPos=e),d}scrollViewportVertically(e,n,r){const{drawn:i,totalRows:o}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>o)return!1;const s=this.getFirstVisibleRow(),a=this.getLastVisibleRow(),l=n===void 0&&r===void 0,{fixedRowsBottom:u,fixedRowsTop:c,topOverlay:d}=this.dataAccessObject;if(l&&(e<c||e>o-u-1))return!1;let g=!1;return e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e),s===-1?g=d.scrollTo(e,l?e>this.lastScrolledRowPos:r):(l&&(e<s||e>a)||!l)&&(g=d.scrollTo(e,l?e>a:r)),g&&(this.lastScrolledRowPos=e),g}getFirstVisibleRow(){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,fixedRowsTop:o,rootWindow:s}=this.dataAccessObject;let a=n.getFirstVisibleRow();if(e.mainTableScrollableElement===s){const l=sn(n.wtRootElement),u=fo(n.hider),c=fo(s),d=Hu(s,s);if(l.top+u-c<=d){let g=r.getColumnHeaderHeight();g+=e.sumCellSizes(0,o);for(let p=i;p>0;p--)if(g+=e.sumCellSizes(p-1,p),l.top+u-g<=d){a=p;break}}}return a}getLastVisibleRow(){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,rootWindow:o}=this.dataAccessObject;let s=n.getLastVisibleRow();if(e.mainTableScrollableElement===o){const a=sn(n.wtRootElement),l=Hu(o,o);if(a.top>l){const u=fo(o);let c=r.getColumnHeaderHeight();for(let d=1;d<=i;d++)if(c+=e.sumCellSizes(d-1,d),a.top+c-l>=u){s=d-2;break}}}return s}getFirstVisibleColumn(){const{inlineStartOverlay:e,wtTable:n,wtViewport:r,totalColumns:i,rootWindow:o}=this.dataAccessObject;let s=n.getFirstVisibleColumn();if(e.mainTableScrollableElement===o){const a=sn(n.wtRootElement),l=Nu(n.hider),u=Nu(o),c=Math.abs(hd(o,o));if(a.left+l-u<=c){let d=r.getRowHeaderWidth();for(let g=i;g>0;g--)if(d+=e.sumCellSizes(g-1,g),a.left+l-d<=c){s=g;break}}}return s}getLastVisibleColumn(){const{wtSettings:e,inlineStartOverlay:n,wtTable:r,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;let a=r.getLastVisibleColumn();if(n.mainTableScrollableElement===s){const l=e.getSetting("rtlMode");let u=null;if(l){const d=r.TABLE.getBoundingClientRect(),p=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;u=Math.abs(d.right-p)}else u=sn(r.wtRootElement).left;const c=Math.abs(hd(s,s));if(u>c){const d=Nu(s);let g=i.getRowHeaderWidth();for(let p=1;p<=o;p++)if(g+=n.sumCellSizes(p-1,p),u+g-c>=d){a=p-2;break}}}return a}}const HK=xK;function li(t,e,n){return e=DK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function DK(t){var e=NK(t,"string");return typeof e=="symbol"?e:String(e)}function NK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aC{get eventManager(){return new br(this)}constructor(e,n){li(this,"wtTable",void 0),li(this,"wtScroll",void 0),li(this,"wtViewport",void 0),li(this,"wtOverlays",void 0),li(this,"selectionManager",void 0),li(this,"wtEvent",void 0),li(this,"guid",`wt_${tw()}`),li(this,"drawInterrupted",!1),li(this,"drawn",!1),li(this,"domBindings",void 0),li(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new HK(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;n<r;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,r){es(r,e[n])}])}}createCellCoords(e,n){return new Fd(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,r){return new qw(e,n,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!e&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const r=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=r-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,r,i,o){return e.col<0||e.row<0?!1:this.wtScroll.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return e<0?!1:this.wtScroll.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return e<0?!1:this.wtScroll.scrollViewportVertically(e,n,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function z_(t,e,n){return e=LK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function LK(t){var e=$K(t,"string");return typeof e=="symbol"?e:String(e)}function $K(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kK extends aC{constructor(e,n,r){super(e,n),z_(this,"cloneSource",void 0),z_(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new N_(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}function FK(t,e,n){return e=WK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function WK(t){var e=VK(t,"string");return typeof e=="symbol"?e:String(e)}function VK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qu{constructor(e,n,r,i,o){FK(this,"wtSettings",null),Pi(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=n,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=Gs(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}updateStateOfRendering(){const e=this.needFullRender;this.needFullRender=this.shouldBeRendered();const n=e!==this.needFullRender;return n&&!this.needFullRender&&this.reset(),n}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Gs(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Du(e.TABLE)}getRelativeCellPosition(e,n,r){if(this.clone.wtTable.holder.contains(e)===!1){At(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=r<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),a=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let d=null;return i?d=this.getRelativeCellPositionWithinWindow(s,o,c,u):d=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),d}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,r,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!n)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+wn())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:r.start+s,top:r.top+a}}getRelativeCellPositionWithinHolder(e,n,r,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(r||(a=s.horizontal-o.start),n){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(OK.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=r.createElement("div"),s=r.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${AK.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,n.getSetting("ariaTags")&&Le(o,[Ii()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===Ks||u==="vertical"&&this.type===Xs?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=Du(e.TABLE),new kK(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(e),this.needFullRender=n}reset(){if(!this.clone)return;const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,r=e.style,i=n.style,o=e.parentNode.style;H([r,i,o],s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class BK extends qu{constructor(e,n,r,i,o,s){super(e,n,ls,r,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new MK(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${o}px`,n.style.bottom=`${s}px`}else $u(n),this.repositionOverlay();let r=Wt(this.clone.wtTable.TABLE);const i=yt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),n.style.height=`${r}px`,n.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=wn(r)),i.style.bottom=`${o}px`}}const UK="calculatedColumns",j_={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Pi(j_,"MIXIN_NAME",UK,{writable:!1,enumerable:!1});const lC=j_;class uC extends il{constructor(e,n,r,i){super(e,n,r,i,$i)}}Et(uC,Y_),Et(uC,lC);const YK=uC;function GK(t,e,n){return e=zK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zK(t){var e=jK(t,"string");return typeof e=="symbol"?e:String(e)}function jK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class KK extends qu{constructor(e,n,r,i){super(e,n,$i,r,i),GK(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new YK(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let r=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(r=this.getOverlayOffset(),n.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=wn(r)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;return this.mainTableScrollableElement===n?(n.scrollTo(cd(n),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:r,wtSettings:i}=this.wot,o=i.getSetting("defaultRowHeight");let s=e,a=0;for(;s<n;){const l=r.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=wn(r),a=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||l==="horizontal"){let c=n.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(c-=o),c=Math.min(c,e.wtRootElement.scrollWidth),a.width=`${c}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let u=Wt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(u=0),a.height=`${u}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;n&&o.offsetHeight!==o.clientHeight&&(s=wn(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Hu(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==n,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((r||n===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=We(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(ce(s,"innerBorderBottom"),o=!a):(Ue(s,"innerBorderBottom"),o=a)}return o}}const XK="calculatedRows",K_={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Pi(K_,"MIXIN_NAME",XK,{writable:!1,enumerable:!1});const X_=K_;class cC extends il{constructor(e,n,r,i){super(e,n,r,i,Xs)}}Et(cC,X_),Et(cC,iC);const qK=cC,ZK="localHooks",q_={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,r,i,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)pd(this._localHooks[t][l],this,e,n,r,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};Pi(q_,"MIXIN_NAME",ZK,{writable:!1,enumerable:!1});const lr=q_;let Z_=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};Et(Z_,lr);const QK=Z_,Q_="active-header",hC="header",dC="area",fC="focus",JK="fill",e3="row",t3="column",n3="custom-selection",gC=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});var r3=R_;r3("flat");function i3(t,e){eM(t,e),e.add(t)}function J_(t,e,n){eM(t,e),e.set(t,n)}function eM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mC(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function ln(t,e){var n=nM(t,e,"get");return o3(t,n)}function o3(t,e){return e.get?e.get.call(t):e.value}function tM(t,e,n){var r=nM(t,e,"set");return s3(t,r,n),n}function nM(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function s3(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var ui=new WeakMap,ur=new WeakMap,Gd=new WeakSet;class a3{constructor(){i3(this,Gd),J_(this,ui,{writable:!0,value:void 0}),J_(this,ur,{writable:!0,value:void 0})}setActiveOverlay(e){return tM(this,ur,e),this}setActiveSelection(e){return tM(this,ui,e),this}scan(){const e=ln(this,ui).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="area"?this.scanCellsRange(r=>n.add(r)):e==="focus"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r)),this.scanCellsRange(r=>n.add(r))):e==="fill"?this.scanCellsRange(r=>n.add(r)):e==="header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="row"?(this.scanRowsInHeadersRange(r=>n.add(r)),this.scanRowsInCellsRange(r=>n.add(r))):e==="column"&&(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanColumnsInCellsRange(r=>n.add(r))),n}scanColumnsInHeadersRange(e){const[n,r,i,o]=ln(this,ui).getCorners(),{wtTable:s}=ln(this,ur),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const d=s.columnFilter.renderedToSource(c);if(!(d<r||d>o)){for(let g=-l;g<0;g++){if(g<n||g>i)continue;const p=g+l;let C=s.getColumnHeader(d,p);const E=ln(this,ur).getSetting("onBeforeHighlightingColumnHeader",d,p,{selectionType:ln(this,ui).settings.selectionType,columnCursor:u,selectionWidth:o-r+1});E!==null&&(E!==d&&(C=s.getColumnHeader(E,p)),e(C))}u+=1}}}scanRowsInHeadersRange(e){const[n,r,i,o]=ln(this,ui).getCorners(),{wtTable:s}=ln(this,ur),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const d=s.rowFilter.renderedToSource(c);if(!(d<n||d>i)){for(let g=-l;g<0;g++){if(g<r||g>o)continue;const p=g+l;let C=s.getRowHeader(d,p);const E=ln(this,ur).getSetting("onBeforeHighlightingRowHeader",d,p,{selectionType:ln(this,ui).settings.selectionType,rowCursor:u,selectionHeight:i-n+1});E!==null&&(E!==d&&(C=s.getRowHeader(E,p)),e(C))}u+=1}}}scanCellsRange(e){const[n,r,i,o]=ln(this,ui).getCorners(),{wtTable:s}=ln(this,ur);mC(this,Gd,pC).call(this,(a,l)=>{if(a>=n&&a<=i&&l>=r&&l<=o){const u=s.getCell(ln(this,ur).createCellCoords(a,l)),c=ln(this,ur).getSetting("onAfterDrawSelection",a,l,ln(this,ui).settings.layerLevel);typeof c=="string"&&ce(u,c),e(u)}})}scanRowsInCellsRange(e){const[n,,r]=ln(this,ui).getCorners(),{wtTable:i}=ln(this,ur);mC(this,Gd,pC).call(this,(o,s)=>{if(o>=n&&o<=r){const a=i.getCell(ln(this,ur).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,n,,r]=ln(this,ui).getCorners(),{wtTable:i}=ln(this,ur);mC(this,Gd,pC).call(this,(o,s)=>{if(s>=n&&s<=r){const a=i.getCell(ln(this,ur).createCellCoords(o,s));e(a)}})}}function pC(t){const{wtTable:e}=ln(this,ur),n=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let i=0;i<n;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<r;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class l3{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=gC,this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,r=this.main.childNodes.length;n<r;n++){const i=this.main.childNodes[n];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Lr(e);const r=this,i=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(r.eventManager.removeEventListener(i,"mousemove",a),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const r=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=r[a],u=n.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),po()&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=n.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const n=10,r=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const i={position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${parseInt(r/1.5,10)}px`};Ze(i,(s,a)=>{this.selectionHandles.styles.bottomHitArea[a]=s,this.selectionHandles.styles.topHitArea[a]=s});const o={position:"absolute",height:`${n}px`,width:`${n}px`,"border-radius":`${parseInt(n/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};Ze(o,(s,a)=>{this.selectionHandles.styles.bottom[a]=s,this.selectionHandles.styles.top[a]=s}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const r=this.wot.selectionManager.getAreaSelection();return!!(r.cellRange&&(e!==r.cellRange.to.row||n!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,r,i,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:d,bottomHitArea:g}=this.selectionHandles.styles,p=parseInt(u.borderWidth,10),C=parseInt(u.width,10),E=parseInt(c.width,10),I=this.wot.wtTable.getWidth(),M=this.wot.wtTable.getHeight();u.top=`${parseInt(r-C-1,10)}px`,u[l]=`${parseInt(i-C-1,10)}px`,c.top=`${parseInt(r-E/4*3,10)}px`,c[l]=`${parseInt(i-E/4*3,10)}px`;const y=Math.min(parseInt(i+o,10),I-C-p*2),$=Math.min(parseInt(i+o-E/4,10),I-E-p*2);d[l]=`${y}px`,g[l]=`${$}px`;const X=Math.min(parseInt(r+s,10),M-C-p*2),G=Math.min(parseInt(r+s-E/4,10),M-E-p*2);d.top=`${X}px`,g.top=`${G}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,n)?(d.display="none",g.display="none"):(d.display="block",g.display="block")):(u.display="none",d.display="none",c.display="none",g.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;const{wtTable:n,rootDocument:r,rootWindow:i}=this.wot;let o,s,a,l,u,c;const d=n.getRenderedRowsCount();for(let w=0;w<d;w+=1){const h=n.rowFilter.renderedToSource(w);if(h>=e[0]&&h<=e[2]){o=h,u=e[0];break}}for(let w=d-1;w>=0;w-=1){const h=n.rowFilter.renderedToSource(w);if(h>=e[0]&&h<=e[2]){s=h;break}}const g=n.getRenderedColumnsCount();for(let w=0;w<g;w+=1){const h=n.columnFilter.renderedToSource(w);if(h>=e[1]&&h<=e[3]){a=h,c=e[1];break}}for(let w=g-1;w>=0;w-=1){const h=n.columnFilter.renderedToSource(w);if(h>=e[1]&&h<=e[3]){l=h;break}}if(o===void 0||a===void 0){this.disappear();return}let p=n.getCell(this.wot.createCellCoords(o,a));const C=o!==s||a!==l,E=C?n.getCell(this.wot.createCellCoords(s,l)):p,I=sn(p),M=C?sn(E):I,y=sn(n.TABLE),$=yt(n.TABLE),X=I.top,G=I.left,q=this.wot.wtSettings.getSetting("rtlMode");let re=0,v=0;if(q){const w=yt(p),h=i.innerWidth-y.left-$;v=G+w-M.left,re=i.innerWidth-G-w-h-1}else v=M.left+yt(E)-G,re=G-y.left-1;if(this.isEntireColumnSelected(o,s)){const w=this.getDimensionsFromHeader("columns",a,l,u,y);let h=null;w&&([h,re,v]=w),h&&(p=h)}let S=X-y.top-1,b=M.top+Wt(E)-X;if(this.isEntireRowSelected(a,l)){const w=this.getDimensionsFromHeader("rows",o,s,c,y);let h=null;w&&([h,S,b]=w),h&&(p=h)}const L=ho(p,i);parseInt(L.borderTopWidth,10)>0&&(S+=1,b=b>0?b-1:0),parseInt(L[q?"borderRightWidth":"borderLeftWidth"],10)>0&&(re+=1,v=v>0?v-1:0);const P=q?"right":"left";this.topStyle.top=`${S}px`,this.topStyle[P]=`${re}px`,this.topStyle.width=`${v}px`,this.topStyle.display="block",this.startStyle.top=`${S}px`,this.startStyle[P]=`${re}px`,this.startStyle.height=`${b}px`,this.startStyle.display="block";const x=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${S+b-x}px`,this.bottomStyle[P]=`${re}px`,this.bottomStyle.width=`${v}px`,this.bottomStyle.display="block",this.endStyle.top=`${S}px`,this.endStyle[P]=`${re+v-x}px`,this.endStyle.height=`${b+1}px`,this.endStyle.display="block";let W=this.settings.border.cornerVisible;W=typeof W=="function"?W(this.settings.layerLevel):W;const D=this.wot.getSetting("onModifyGetCellCoords",s,l);let[B,z]=[s,l];if(D&&Array.isArray(D)&&([,,B,z]=D),po()||!W||this.isPartRange(B,z))this.cornerStyle.display="none";else{this.cornerStyle.top=`${S+b+this.cornerCenterPointOffset-1}px`,this.cornerStyle[P]=`${re+v+this.cornerCenterPointOffset-1}px`,this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let w=Gs(n.TABLE);const h=w===i;h&&(w=r.documentElement);const f=parseInt(this.cornerDefaultStyle.width,10)/2,m=parseInt(this.cornerDefaultStyle.height,10)/2;if(l===this.wot.getSetting("totalColumns")-1){const T=h?E.getBoundingClientRect().left:E.offsetLeft;let O=!1,_=0;q?(_=T-parseInt(this.cornerDefaultStyle.width,10)/2,O=_<0):(_=T+yt(E)+parseInt(this.cornerDefaultStyle.width,10)/2,O=_>=Nu(w)),O&&(this.cornerStyle[P]=`${Math.floor(re+v+this.cornerCenterPointOffset-f)}px`,this.cornerStyle[q?"borderLeftWidth":"borderRightWidth"]=0)}s===this.wot.getSetting("totalRows")-1&&(h?E.getBoundingClientRect().top:E.offsetTop)+Wt(E)+parseInt(this.cornerDefaultStyle.height,10)/2>=fo(w)&&(this.cornerStyle.top=`${Math.floor(S+b+this.cornerCenterPointOffset-m)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}po()&&this.updateMultipleSelectionHandlesPosition(s,l,S,re,v,b)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,r,i,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,d=null,g=null,p=null,C=null,E=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return Wt(...arguments)},c="ht__selection--rows",p="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return yt(...arguments)},c="ht__selection--columns",p="left";break}if(a.classList.contains(c)){const I=this.wot.getSetting("columnHeaders").length;if(C=l(n,I-i),E=l(r,I-i),!C||!E)return!1;const M=sn(C),y=sn(E);return C&&E&&(d=M[p]-o[p]-1,g=y[p]+u(E)-M[p]),[C,d,g]}return!1}changeBorderStyle(e,n){const r=this[e].style,i=n[e];!i||i.hide?ce(this[e],"hidden"):(We(this[e],"hidden")&&Ue(this[e],"hidden"),r.backgroundColor=i.color,(e==="top"||e==="bottom")&&(r.height=`${i.width}px`),(e==="start"||e==="end")&&(r.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},r=this[e].style;r.backgroundColor=n.color,r.width=`${n.width}px`,r.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?ce(this[e],"hidden"):Ue(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",po()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}const rM=l3;function u3(t,e){iM(t,e),e.add(t)}function ol(t,e,n){iM(t,e),e.set(t,n)}function iM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function c3(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function nt(t,e){var n=sM(t,e,"get");return h3(t,n)}function h3(t,e){return e.get?e.get.call(t):e.value}function oM(t,e,n){var r=sM(t,e,"set");return d3(t,r,n),n}function sM(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function d3(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Wn=new WeakMap,cr=new WeakMap,wC=new WeakMap,Zu=new WeakMap,CC=new WeakMap,Zs=new WeakMap,aM=new WeakSet;class f3{constructor(e){u3(this,aM),ol(this,Wn,{writable:!0,value:void 0}),ol(this,cr,{writable:!0,value:void 0}),ol(this,wC,{writable:!0,value:new a3}),ol(this,Zu,{writable:!0,value:new WeakMap}),ol(this,CC,{writable:!0,value:new WeakSet}),ol(this,Zs,{writable:!0,value:new Map}),oM(this,cr,e)}setActiveOverlay(e){return oM(this,Wn,e),nt(this,wC).setActiveOverlay(nt(this,Wn)),nt(this,Zu).has(nt(this,Wn))||nt(this,Zu).set(nt(this,Wn),new Set),this}getFocusSelection(){return nt(this,cr)!==null?nt(this,cr).getFocus():null}getAreaSelection(){return nt(this,cr)!==null?nt(this,cr).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(nt(this,Zs).has(e)){const r=nt(this,Zs).get(e);if(r.has(nt(this,Wn)))return r.get(nt(this,Wn));const i=new rM(nt(this,Wn),e.settings);return r.set(nt(this,Wn),i),i}const n=new rM(nt(this,Wn),e.settings);return nt(this,Zs).set(e,new Map([[nt(this,Wn),n]])),n}getBorderInstances(e){var n,r;return Array.from((n=(r=nt(this,Zs).get(e))===null||r===void 0?void 0:r.values())!==null&&n!==void 0?n:[])}destroyBorders(e){nt(this,Zs).get(e).forEach(n=>n.destroy()),nt(this,Zs).delete(e)}render(e){if(nt(this,cr)===null)return;e&&c3(this,aM,g3).call(this);const n=Array.from(nt(this,cr)),r=new Map,i=new Map;for(let o=0;o<n.length;o++){const s=n[o],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;nt(this,CC).has(s)||(nt(this,CC).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const d=this.getBorderInstance(s);if(s.isEmpty()){d==null||d.disappear();continue}a&&nt(this,wC).setActiveSelection(s).scan().forEach(C=>{if(r.has(C)){const E=r.get(C);E.has(a)&&u===!0?E.set(a,E.get(a)+1):E.set(a,1)}else r.set(C,new Map([[a,1]]));l&&(i.has(C)||i.set(C,[]),C.nodeName==="TH"&&i.get(C).push(...l))});const g=s.getCorners();nt(this,Wn).getSetting("onBeforeDrawBorders",g,c),d==null||d.appear(g)}r.forEach((o,s)=>{var a;const l=Array.from(o).map(u=>{let[c,d]=u;return d===1?c:[c,...Array.from({length:d-1},(g,p)=>`${c}-${p+1}`)]}).flat();l.forEach(u=>nt(this,Zu).get(nt(this,Wn)).add(u)),ce(s,l),s.nodeName==="TD"&&Array.isArray((a=nt(this,cr).options)===null||a===void 0?void 0:a.cellAttributes)&&Le(s,nt(this,cr).options.cellAttributes)}),Array.from(i.keys()).forEach(o=>{Le(o,[...i.get(o)])})}}function g3(){const t=nt(this,Zu).get(nt(this,Wn)),e=nt(this,Wn).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var r,i;const o=nt(this,Wn).wtTable.TABLE.querySelectorAll(`.${n}`);let s=[];Array.isArray((r=nt(this,cr).options)===null||r===void 0?void 0:r.cellAttributes)&&(s=nt(this,cr).options.cellAttributes.map(a=>a[0])),Array.isArray((i=nt(this,cr).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...nt(this,cr).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)Ue(o[a],n),Us(o[a],s)}),t.clear()}class m3 extends qu{constructor(e,n,r,i){super(e,n,Xs,r,i)}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new qK(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===n&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),dd(r,`${o}px`,"0px")):(o=this.getScrollPosition(),$u(r));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===n&&n.scrollX!==e?(n.scrollTo(e,cw(n)),r=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<n;)o+=this.wot.wtTable.getStretchedColumnWidth(i)||r,i+=1;return o}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=wn(n),s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="vertical"){let u=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(u-=i),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=yt(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=this.wot.selectionManager.getFocusSelection()?parseInt(gC.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;if(n){const a=this.wot.wtTable.getColumnWidth(e),l=this.wot.wtViewport.getViewportWidth();a>l&&(n=!1)}return n&&o.offsetWidth!==o.clientWidth&&(s=wn(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportWidth()):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(hd(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wot.wtTable.holder.parentNode,r=this.wtSettings.getSetting("rowHeaders"),i=this.wtSettings.getSetting("fixedColumnsStart");this.wtSettings.getSetting("totalRows")?Ue(n,"emptyRows"):ce(n,"emptyRows");let s=!1;if(i&&!r.length)ce(n,"innerBorderLeft innerBorderInlineStart");else if(!i&&r.length){const a=We(n,"innerBorderInlineStart");e?(ce(n,"innerBorderLeft innerBorderInlineStart"),s=!a):(Ue(n,"innerBorderLeft innerBorderInlineStart"),s=a)}return s}}const p3="stickyRowsTop",lM={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Pi(lM,"MIXIN_NAME",p3,{writable:!1,enumerable:!1});const uM=lM;class vC extends il{constructor(e,n,r,i){super(e,n,r,i,qs)}}Et(vC,uM),Et(vC,iC);const w3=vC;function cM(t,e,n){return e=C3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function C3(t){var e=v3(t,"string");return typeof e=="symbol"?e:String(e)}function v3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class S3 extends qu{constructor(e,n,r,i,o,s){super(e,n,qs,r,i),cM(this,"topOverlay",void 0),cM(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new w3(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();dd(e,`${i}px`,`${o}px`)}else $u(e);let n=Wt(this.clone.wtTable.TABLE);const r=yt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${r}px`,!1}}class SC extends il{constructor(e,n,r,i){super(e,n,r,i,Ks)}}Et(SC,uM),Et(SC,lC);const y3=SC;function b3(t,e,n){return e=R3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function R3(t){var e=E3(t,"string");return typeof e=="symbol"?e:String(e)}function E3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class T3 extends qu{constructor(e,n,r,i){super(e,n,Ks,r,i),b3(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new y3(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===n&&(!r||r!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,i=this.getOverlayOffset(),dd(e,"0px",`${i}px`)}else i=this.getScrollPosition(),$u(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const n=this.domBindings.rootWindow;let r=!1;return this.mainTableScrollableElement===n&&n.scrollY!==e?(n.scrollTo(cd(n),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultRowHeight");let i=e,o=0;for(;i<n;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?r:s,i+=1}return o}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=wn(n),s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="horizontal"){let u=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(u-=i),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=Wt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=this.wot.selectionManager.getFocusSelection()?parseInt(gC.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:r,wtSettings:i}=this,s=(r.cloneSource?r.cloneSource:r).wtTable.holder;let a=this.getTableParentOffset(),l=0;if(n){const u=this.wot.wtTable.getRowHeight(e),c=this.wot.wtViewport.getViewportHeight();u>c&&(n=!1)}if(n&&s.offsetHeight!==s.clientHeight&&(l=wn(this.domBindings.rootDocument)),n){const u=i.getSetting("fixedRowsBottom"),c=i.getSetting("totalRows");a+=this.sumCellSizes(0,e+1),a-=r.wtViewport.getViewportHeight()-this.sumCellSizes(c-u,c),a+=1}else a+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return a+=l,this.setScrollPosition(a)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Hu(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.wot.wtTable.holder.parentNode;this.wtSettings.getSetting("totalColumns")?Ue(r,"emptyColumns"):ce(r,"emptyColumns");let o=!1;if(!n){const s=this.wtSettings.getSetting("fixedRowsTop"),a=this.cachedFixedRowsTop!==s,l=this.wtSettings.getSetting("columnHeaders");if((a||s===0)&&l.length>0){const u=We(r,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),e||this.wtSettings.getSetting("totalRows")===0?(ce(r,"innerBorderTop"),o=!u):(Ue(r,"innerBorderTop"),o=u)}}return o}}function vo(t,e,n){return e=_3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _3(t){var e=M3(t,"string");return typeof e=="symbol"?e:String(e)}function M3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class O3{constructor(e,n,r,i,o,s){vo(this,"wot",null),vo(this,"topOverlay",null),vo(this,"bottomOverlay",null),vo(this,"inlineStartOverlay",null),vo(this,"topInlineStartCornerOverlay",null),vo(this,"bottomInlineStartCornerOverlay",null),vo(this,"browserLineHeight",void 0),vo(this,"wtSettings",null),vo(this,"resizeObserver",new ResizeObserver(c=>{Wd(()=>{!Array.isArray(c)||!c.length||this.wtSettings.getSetting("onContainerElementResize")})})),this.wot=e,this.wtSettings=i,this.domBindings=r,this.facadeGetter=n,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=wn(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:Du(s.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,r=e.getComputedStyle(n.body),i=parseInt(r.lineHeight,10),o=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new T3(...e),this.bottomOverlay=new KK(...e),this.inlineStartOverlay=new m3(...e),this.topInlineStartCornerOverlay=new S3(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new BK(...e,this.bottomOverlay,this.inlineStartOverlay)}updateStateOfRendering(){let e=this.topOverlay.updateStateOfRendering();return e=this.bottomOverlay.updateStateOfRendering()||e,e=this.inlineStartOverlay.updateStateOfRendering()||e,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(e=this.topInlineStartCornerOverlay.updateStateOfRendering()||e),this.bottomOverlay.needFullRender&&(e=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||e)),e}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",d=>this.onKeyDown(d)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",d=>this.onTableScroll(d),{passive:!0}),r!==i&&this.eventManager.addEventListener(i,"scroll",d=>this.onTableScroll(d),{passive:!0});const o=n.devicePixelRatio&&n.devicePixelRatio>1,s=this.scrollableElement===n,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!Cw())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",d=>this.onCloneWheel(d,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(d=>{if(d&&d.needFullRender){const{holder:g}=d.clone.wtTable;this.eventManager.addEventListener(g,"wheel",p=>this.onCloneWheel(p,a),l)}});let c;this.eventManager.addEventListener(n,"resize",()=>{clearTimeout(c),c=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize")},200)}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==n&&o!==n&&!e.target.contains(i)||r!==n&&o!==n&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,n){const{rootWindow:r}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==r&&s!==r&&!s.contains(o),l=i!==r&&s!==r&&!s.contains(i);if(this.keyPressed&&(a||l))return;const u=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==r&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=qa(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,n+=n*this.browserLineHeight);const i=this.scrollVertically(n),o=this.scrollHorizontally(r);return i||o}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,n=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder,[i,o]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=n.scrollLeft!==i||this.lastScrollX!==e.scrollX,this.verticalScrolling=r.scrollTop!==o||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){n.scrollLeft=i;const s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=i)}this.verticalScrolling&&(r.scrollTop=o),this.refreshAll()}syncScrollWithMaster(){const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=Du(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,r=e.clientHeight,i=n!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r),i}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtViewport:n}=this.wot,{wtTable:r}=this,i=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),s=n.getRowHeaderWidth(),a=n.getColumnHeaderHeight(),l=r.hider.style;if(l.width=`${s+this.inlineStartOverlay.sumCellSizes(0,i)}px`,l.height=`${a+this.topOverlay.sumCellSizes(0,o)+1}px`,this.scrollbarSize>0){const{scrollHeight:u,scrollWidth:c}=r.wtRootElement,{scrollHeight:d,scrollWidth:g}=r.holder;this.hasScrollbarRight=u<d,this.hasScrollbarBottom=c<g,this.hasScrollbarRight&&r.hider.scrollWidth+this.scrollbarSize>c?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&r.hider.scrollHeight+this.scrollbarSize>u&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(e),this.inlineStartOverlay.adjustElementsSize(e),this.bottomOverlay.adjustElementsSize(e)}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return H(n,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(r=i.clone)}),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];H(n,r=>{r&&(r.clone.wtTable.TABLE.className=e.className)})}}const A3=O3;function hM(t,e,n){return e=I3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function I3(t){var e=P3(t,"string");return typeof e=="symbol"?e:String(e)}function P3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class x3{constructor(e){hM(this,"settings",{}),hM(this,"defaults",Object.freeze(this.getDefaults())),Ze(this.defaults,(n,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(n===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,r)=>{const i=this.getSetting("data",e,n);es(r,i??"")},columnWidth(){},rowHeight(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:e=>e,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,n){return n===void 0?Ze(e,(r,i)=>{this.settings[i]=r}):this.settings[e]=n,this}getSetting(e,n,r,i,o){return typeof this.settings[e]=="function"?this.settings[e](n,r,i,o):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class yC extends il{constructor(e,n,r,i){super(e,n,r,i,"master")}alignOverlaysWithTrimmingContainer(){const e=Gs(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const r=e.parentElement,i=ja(e,"height",n),o=ja(e,"overflow",n),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(o)){const g=e.cloneNode(!1);g.style.overflow="auto",g.style.position="absolute",e.nextElementSibling?r.insertBefore(g,e.nextElementSibling):r.appendChild(g);const p=parseInt(ho(g,n).height,10);r.removeChild(g),p===0&&(c=0)}c=Math.min(c,l),s.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=ts(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,r="master",o=e.getSetting("columnHeaders").length;if(o&&!n.hasOversizedColumnHeadersMarked[r]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);n.hasOversizedColumnHeadersMarked[r]=!0}}}Et(yC,X_),Et(yC,lC);const H3=yC;class D3{constructor(e,n,r,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;return n===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=Wt(n)>0&&n.clientHeight>0?n.clientHeight:1/0,r}getWorkspaceWidth(){const{wtSettings:e}=this,{rootDocument:n,rootWindow:r}=this.domBindings,i=this.dataAccessObject.inlineStartOverlayTrimmingContainer,o=n.documentElement.offsetWidth,s=e.getSetting("totalColumns"),a=e.getSetting("preventOverflow"),l=e.getSetting("rtlMode"),u=this.wtTable.TABLE.getBoundingClientRect(),c=l?u.right-o:u.left,d=o-c;let g,p;if(a)return yt(this.wtTable.wtRootElement);if(e.getSetting("freezeOverlays")?g=Math.min(d,o):g=Math.min(this.getContainerFillWidth(),d,o),i===r&&s>0&&this.sumColumnWidths(0,s-1)>g)return n.documentElement.clientWidth;if(i!==r&&(p=ja(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",r),p==="scroll"||p==="hidden"||p==="auto"))return Math.max(g,i.clientWidth);const C=e.getSetting("stretchH");return C==="none"||!C?Math.max(g,yt(this.wtTable.TABLE)):g}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(e,n){let r=0,i=e;for(;i<n;)r+=this.wtTable.getColumnWidth(i),i+=1;return r}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const e=this.wtTable.holder,n=this.domBindings.rootDocument.createElement("div");n.style.width="100%",n.style.height="1px",e.appendChild(n);const r=n.offsetWidth;return this.containerWidth=r,e.removeChild(n),r}getWorkspaceOffset(){return sn(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Wt(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,i=n.length;r<i;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=n.length;i<o;i++)r?(this.rowHeaderWidth+=yt(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:zs;const{wtSettings:n,wtTable:r}=this;let i,o,s;this.rowHeaderWidth=NaN,n.getSetting("renderAllRows")&&e===zs?i=1/0:i=this.getViewportHeight();let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=n.getSetting("fixedRowsTop"),u=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=s),r.holder.clientHeight===r.holder.offsetHeight?o=0:o=wn(this.domBindings.rootDocument),new O_({viewportHeight:i,scrollOffset:a,totalRows:n.getSetting("totalRows"),rowHeightFn:d=>r.getRowHeight(d),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),calculationType:e,horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:zs;const{wtSettings:n,wtTable:r}=this;let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=n.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return r.holder.clientWidth!==r.holder.offsetWidth&&(i-=wn(this.domBindings.rootDocument)),new Gw({viewportWidth:i,scrollOffset:o,totalColumns:n.getSetting("totalColumns"),columnWidthFn:a=>r.getColumnWidth(a),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),calculationType:e,stretchMode:n.getSetting("stretchH"),stretchingColumnWidthFn:(a,l)=>n.getSetting("onBeforeStretchingColumnWidth",a,l),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createRenderCalculators(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(n){const r=this.createRowsCalculator(Fn),i=this.createColumnsCalculator(Fn);this.areAllProposedVisibleRowsAlreadyRendered(r)&&this.areAllProposedVisibleColumnsAlreadyRendered(i)||(n=!1)}return n||(this.rowsRenderCalculator=this.createRowsCalculator(zs),this.columnsRenderCalculator=this.createColumnsCalculator(zs)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,n}createVisibleCalculators(){this.rowsVisibleCalculator=this.createRowsCalculator(Fn),this.columnsVisibleCalculator=this.createColumnsCalculator(Fn)}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;const{startRow:n,endRow:r,isVisibleInTrimmingContainer:i}=e;if(n===null&&r===null)return!i;const{startRow:o,endRow:s}=this.rowsRenderCalculator;return n<o||n===o&&n>0?!1:!(r>s||r===s&&r<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;const{startColumn:n,endColumn:r,isVisibleInTrimmingContainer:i}=e;if(n===null&&r===null)return!i;const{startColumn:o,endColumn:s}=this.columnsRenderCalculator;return n<o||n===o&&n>0?!1:!(r>s||r===s&&r<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){Ze(this.hasOversizedColumnHeadersMarked,(e,n,r)=>{r[n]=void 0})}}const N3=D3;class L3 extends aC{constructor(e,n){super(e,new x3(n));const r=this.wtSettings.getSetting("facade",this);this.wtTable=new H3(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new N3(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new f3(this.wtSettings.getSetting("selections")),this.wtEvent=new N_(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new A3(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],r=[];Ze(e,(i,o)=>{this.wtSettings.getSetting(o).length&&r.push(i),n.push(i)}),Ue(this.wtTable.wtRootElement.parentNode,n),ce(this.wtTable.wtRootElement.parentNode,r)}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class bC{constructor(e){e instanceof aC?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const r=new bC(n);return()=>r},this._wot=new L3(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,r){return this._wot.createCellRange(e,n,r)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,r,i,o){return this._wot.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return this._wot.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return this._wot.scrollViewportVertically(e,n,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,r,i,o){return this._wot.wtSettings.getSetting(e,n,r,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function dM(t){let{isShiftKey:e,isLeftClick:n,isRightClick:r,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const d=!o.inInSelection(i),g=n||r&&d;i.row<0&&i.col>=0&&!s.column?g&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?g&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?g&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}}function $3(t){let{isLeftClick:e,coords:n,selection:r,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),u=r.tableProps.countRows();a&&!i.column?r.setRangeEnd(o(u-1,n.col)):s&&!i.row?r.setRangeEnd(o(n.row,l-1)):i.cell||r.setRangeEnd(n)}const k3=new Map([["mousedown",dM],["mouseover",$3],["touchstart",dM]]);function fM(t,e){let{coords:n,selection:r,controller:i,cellCoordsFactory:o}=e;k3.get(t.type)({coords:n,selection:r,controller:i,cellCoordsFactory:o,isShiftKey:t.shiftKey,isLeftClick:bd(t)||t.type==="touchstart",isRightClick:is(t)})}const gM=new WeakMap,RC=Symbol("rootInstance");function F3(t){gM.set(t,!0)}function W3(t){return t===RC}function zd(t){return gM.has(t)}function mM(t,e){pM(t,e),e.add(t)}function Qs(t,e,n){pM(t,e),e.set(t,n)}function pM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function us(t,e,n){return e=V3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function V3(t){var e=B3(t,"string");return typeof e=="symbol"?e:String(e)}function B3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function EC(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function yn(t,e){var n=wM(t,e,"get");return U3(t,n)}function U3(t,e){return e.get?e.get.call(t):e.value}function Fr(t,e,n){var r=wM(t,e,"set");return Y3(t,r,n),n}function wM(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Y3(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var TC=new WeakMap,jd=new WeakMap,Kd=new WeakMap,So=new WeakMap,ci=new WeakMap,_C=new WeakMap,MC=new WeakMap,OC=new WeakSet,CM=new WeakSet;class G3{constructor(e){mM(this,CM),mM(this,OC),us(this,"hot",void 0),us(this,"eventManager",void 0),us(this,"settings",void 0),us(this,"THEAD",void 0),us(this,"TBODY",void 0),us(this,"_wt",void 0),us(this,"activeWt",void 0),Qs(this,TC,{writable:!0,value:0}),Qs(this,jd,{writable:!0,value:0}),us(this,"postponedAdjustElementsSize",!1),Qs(this,Kd,{writable:!0,value:!1}),Qs(this,So,{writable:!0,value:void 0}),Qs(this,ci,{writable:!0,value:void 0}),Qs(this,_C,{writable:!0,value:0}),Qs(this,MC,{writable:!0,value:0}),this.hot=e,this.eventManager=new br(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(e)}getCellAtCoords(e,n){const r=this._wt.getCell(e,n);return r<0?null:r}scrollViewport(e,n,r,i,o){return this._wt.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return this._wt.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return this._wt.scrollViewportVertically(e,n,r)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),ce(e,"handsontable"),Fr(this,ci,n.createElement("TABLE")),ce(yn(this,ci),"htCore"),this.hot.getSettings().tableClassName&&ce(yn(this,ci),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Le(yn(this,ci),[Ii()]),Le(e,[DY(),aT(-1),ud(this.hot.countCols()),jY()])),this.THEAD=n.createElement("THEAD"),yn(this,ci).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),yn(this,ci).appendChild(this.TBODY),this.hot.table=yn(this,ci),this.hot.container.insertBefore(yn(this,ci),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:n,selection:r}=this.hot,i=n.documentElement;this.eventManager.addEventListener(e,"mousedown",o=>{if(Fr(this,Kd,!0),!this.isTextSelectionAllowed(o.target)){const{rootWindow:s}=this.hot;dw(s),o.preventDefault(),s.focus()}}),this.eventManager.addEventListener(e,"mouseup",()=>{Fr(this,Kd,!1)}),this.eventManager.addEventListener(e,"mousemove",o=>{yn(this,Kd)&&!this.isTextSelectionAllowed(o.target)&&(this.settings.fragmentSelection&&dw(this.hot.rootWindow),o.preventDefault())}),this.eventManager.addEventListener(i,"keyup",o=>{r.isInProgress()&&!o.shiftKey&&r.finish()}),this.eventManager.addEventListener(i,"mouseup",o=>{r.isInProgress()&&bd(o)&&r.finish(),Fr(this,So,!1);const s=gd(n.activeElement);s&&(s||!r.isSelected()&&!r.isSelectedByAnyHeader()&&!e.contains(o.target)&&!is(o))&&this.hot.unlisten()}),this.eventManager.addEventListener(i,"contextmenu",o=>{r.isInProgress()&&is(o)&&(r.finish(),Fr(this,So,!1))}),this.eventManager.addEventListener(i,"touchend",()=>{r.isInProgress()&&r.finish(),Fr(this,So,!1)}),this.eventManager.addEventListener(i,"mousedown",o=>{const s=o.target,a=o.x||o.clientX,l=o.y||o.clientY;let u=o.target;if(yn(this,So)||!e||!this.hot.view)return;const{holder:c}=this.hot.view._wt.wtTable;if(u===c){const g=wn(n);if(n.elementFromPoint(a+g,l)!==c||n.elementFromPoint(a,l+g)!==c)return}else for(;u!==i;){if(u===null){if(o.isTargetWebComponent)break;return}if(u===e)return;u=u.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(s):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)}),this.eventManager.addEventListener(yn(this,ci),"selectstart",o=>{this.settings.fragmentSelection||fd(o.target)||o.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,r))}translateFromRenderableToVisualIndex(e,n){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return r===null&&(r=e),i===null&&(i=n),[r,i]}countRenderableIndexes(e,n){const r=Math.min(e.getNotTrimmedIndexesLength(),n),i=e.getNearestNotHiddenIndex(r-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,r,i){if(isNaN(e)||e<0)return 0;const o=r.getNearestNotHiddenIndex(e,n),s=r.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return n<0?a=s+1:n>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}countRenderableRowsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:yn(this,ci),isDataViewInstance:()=>zd(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),Fr(this,jd,o.length),this.hot.getSettings().ariaTags&&EC(this,OC,vM).call(this)===this.hot.countCols()&&EC(this,CM,z3).call(this,yn(this,jd)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),Fr(this,TC,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u);let d=l,g=u;Array.isArray(c)&&([d,g]=c);const p=this.hot.getCellMeta(d,g),C=this.hot.colToProp(g);let E=this.hot.getDataAtRowProp(d,C);this.hot.hasHook("beforeValueRender")&&(E=this.hot.runHooks("beforeValueRender",E,p)),this.hot.runHooks("beforeRenderer",a,l,u,C,E,p),this.hot.getCellRenderer(p)(this.hot,a,l,u,C,E,p),this.hot.runHooks("afterRenderer",a,l,u,C,E,p)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&ts(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,Fr(this,So,!0),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!rs(o)&&(fM(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(d,g)=>this.hot._createCellCoords(d,g)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,Fr(this,So,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!rs(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!rs(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!rs(o)&&(yn(this,So)&&fM(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(d,g)=>this.hot._createCellCoords(d,g)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt)},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(rs(o)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:o=>{const s=this.hot.rowIndexMapper,a=o<0;let l=o;return!a&&(l=s.getVisualFromRenderableIndex(o),l===null)?o:(l=this.hot.runHooks("beforeViewportScrollVertically",l),this.hot.runHooks("beforeViewportScroll"),a?l:s.getRenderableFromVisualIndex(l))},onBeforeViewportScrollHorizontally:o=>{const s=this.hot.columnIndexMapper,a=o<0;let l=o;return!a&&(l=s.getVisualFromRenderableIndex(o),l===null)?o:(l=this.hot.runHooks("beforeViewportScrollHorizontally",l),this.hot.runHooks("beforeViewportScroll"),a?l:s.getRenderableFromVisualIndex(l))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const d=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?d:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(d,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const d=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?d:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(d,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),d=this.hot.selection.getSelectedRange();if(d.size()>0){const p=d.peekByIndex(a??0);l=[p.from.row,p.from.col,p.to.row,p.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,d=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",d,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(o,s)=>{const a=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s);return this.hot.runHooks("beforeStretchingColumnWidth",o,a)},onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=this.hot.columnIndexMapper,c=s>=0?u.getVisualFromRenderableIndex(s):s,d=o>=0?l.getVisualFromRenderableIndex(o):o,g=this.hot.runHooks("modifyGetCellCoords",d,c,a);if(Array.isArray(g)){const[p,C,E,I]=g;return[p>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(p,1)):p,C>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(C,1)):C,E>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(E,-1)):E,I>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(I,-1)):I]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.ceil(u/a*12);o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.ceil(u/a*6);o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new bC(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:r,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,i),this.eventManager.addEventListener(n,"mousedown",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(fd(e))return!0;const n=Qo(e,this.hot.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return yn(this,So)}isSelectedOnlyCell(){var e,n;return(e=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const r=n.firstChild;if(!We(r,"relative")){ii(n),this.appendRowHeader(e,n);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:r,getRowHeader:i}=this.hot,o=r.createElement("div"),s=r.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),n.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(n.firstChild){const o=n.firstChild;We(o,"relative")?this.updateCellHeader(o.querySelector(".colHeader"),e,r,i):(ii(n),this.appendColHeader(e,n,r,i))}else{const{rootDocument:o}=this.hot,s=o.createElement("div"),a=o.createElement("span");s.className="relative",a.className="colHeader",this.settings.ariaTags&&(Le(s,...Ii()),Le(a,...Ii())),this.updateCellHeader(a,e,r,i),s.appendChild(a),n.appendChild(s)}this.hot.runHooks("afterGetColHeader",e,n,i)}updateCellHeader(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(We(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(n):We(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(n))),o>-1?Ys(e,r(n,i)):(es(e,String.fromCharCode(160)),ce(e,"cornerHeader"))}maximumVisibleElementWidth(e){const r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){const r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,n){Fr(this,_C,e),Fr(this,MC,n)}getLastSize(){return{width:yn(this,_C),height:yn(this,MC)}}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleColumn())}getColumnHeadersCount(){return yn(this,TC)}getRowHeadersCount(){return yn(this,jd)}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function vM(){return parseInt(this.hot.rootElement.getAttribute(ud()[0]),10)}function z3(t){const e=EC(this,OC,vM).call(this)+t;Le(this.hot.rootElement,...ud(e))}const j3=G3,SM="ABCDEFGHIJKLMNOPQRSTUVWXYZ",AC=SM.length;function Xd(t){let e=t+1,n="",r;for(;e>0;)r=(e-1)%AC,n=String.fromCharCode(65+r)+n,e=parseInt((e-r)/AC,10);return n}function K3(t){let e=0;if(t)for(let n=0,r=t.length-1;n<t.length;n+=1,r-=1)e+=AC**r*(SM.indexOf(t[n])+1);return e-=1,e}function X3(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o=[];for(i=0;i<e;i++)o.push(Xd(i)+(r+1));n.push(o)}return n}function q3(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o={};for(i=0;i<e;i++)o[`prop${i}`]=Xd(i)+(r+1);n.push(o)}return n}function Z3(t,e){const n=[];let r;for(let i=0;i<t;i++){r=[];for(let o=0;o<e;o++)r.push("");n.push(r)}return n}function IC(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const r=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((i,o)=>{Array.isArray(i)?i.forEach((s,a)=>{r.push([o+e,a,s])}):Object.keys(i).forEach(s=>{r.push([o+e,s,i[s]])})}),r}function PC(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&Ke(t[0])&&(e=Sd(t[0]))),e}function yM(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function bM(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const Q3=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:PC,createEmptySpreadsheetData:Z3,createSpreadsheetData:X3,createSpreadsheetObjectData:q3,dataRowToChangesArray:IC,isArrayOfArrays:yM,isArrayOfObjects:bM,spreadsheetColumnIndex:K3,spreadsheetColumnLabel:Xd},Symbol.toStringTag,{value:"Module"}));function Qu(t,e,n){return e=J3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function J3(t){var e=eX(t,"string");return typeof e=="symbol"?e:String(e)}function eX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tX{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Qu(this,"hot",void 0),Qu(this,"data",void 0),Qu(this,"dataType","array"),Qu(this,"colToProp",()=>{}),Qu(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return H(this.data,(r,i)=>{const o=this.getAtCell(i,e);n.push(o)}),n}getAtRow(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=n===void 0&&r===void 0;let s=null,a=null;if(s=this.modifyRowData(e),Array.isArray(s))a=[],o?s.forEach((l,u)=>{a[u]=this.getAtPhysicalCell(e,u,s)}):Ie(n,r,l=>{a[l-n]=this.getAtPhysicalCell(e,l,s)});else if(Ke(s)||Ot(s))if(i?a=[]:a={},!o||i){const u=this.countFirstRowKeys()-1;Ie(0,u,c=>{const d=this.colToProp(c);if(c>=(n||0)&&c<=(r||u)&&!Number.isInteger(d)){const g=this.getAtPhysicalCell(e,d,s);i?a.push(g):vd(a,d,g)}})}else Ze(s,(l,u)=>{vd(a,u,this.getAtPhysicalCell(e,u,s))});return a}setAtCell(e,n,r){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=oi(r);this.hot.runHooks("modifySourceData",e,n,i,"set"),i.isTouched()&&(r=i.value)}Number.isInteger(n)?this.data[e][n]=r:vd(this.data[e],n,r)}}getAtPhysicalCell(e,n,r){let i=null;if(r&&(typeof n=="string"?i=FT(r,n):typeof n=="function"?i=n(r):i=r[n]),this.hot.hasHook("modifySourceData")){const o=oi(i);this.hot.runHooks("modifySourceData",e,n,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,n){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||n===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,n.row),s=Math.min(e.col,n.col),a=Math.max(e.row,n.row),l=Math.max(e.col,n.col));const u=[];return Ie(o,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,r):this.getAtRow(c,s,l,r))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return PC(this.data)}destroy(){this.data=null,this.hot=null}}const nX=tX;function RM(t,e,n){return e=rX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rX(t){var e=iX(t,"string");return typeof e=="symbol"?e:String(e)}function iX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Js{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;RM(this,"indexedValues",[]),RM(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Ot(this.initValueOrFn)?Ie(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):Ie(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}Et(Js,lr);function xC(t,e,n,r){const i=n.length?n[0]:void 0;return[...t.slice(0,i),...n.map((o,s)=>Ot(r)?r(o,s):r),...i===void 0?[]:t.slice(i)]}function HC(t,e){return yr(t,(n,r)=>e.includes(r)===!1)}class cs extends Js{insert(e,n){this.indexedValues=xC(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=HC(this.indexedValues,e),super.remove(e)}}class qd extends cs{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return en(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}function DC(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function Ju(t,e){return yr(t,n=>e.includes(n)===!1)}function NC(t,e){return qe(t,n=>n-e.filter(r=>r<n).length)}function LC(t,e){const n=e[0],r=e.length;return qe(t,i=>i>=n?i+r:i)}function oX(t,e,n){return e=sX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sX(t){var e=aX(t,"string");return typeof e=="symbol"?e:String(e)}function aX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Zd extends Js{constructor(){super(...arguments),oX(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=Ju(this.orderOfIndexes,[e]),Ot(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=xC(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=LC(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=HC(this.indexedValues,e),this.orderOfIndexes=Ju(this.orderOfIndexes,e),this.orderOfIndexes=NC(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class ec extends cs{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return en(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}const EM=new Map([["indexesSequence",{getListWithInsertedItems:DC,getListWithRemovedItems:Ju}],["physicallyIndexed",{getListWithInsertedItems:xC,getListWithRemovedItems:HC}]]),TM=t=>{if(EM.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return EM.get(t)};class _M extends Js{constructor(){super(e=>e)}insert(e,n){const r=LC(this.indexedValues,n);this.indexedValues=DC(r,e,n),super.insert(e,n)}remove(e){const n=Ju(this.indexedValues,e);this.indexedValues=NC(n,e),super.remove(e)}}const MM=new Map([["hiding",qd],["index",Js],["linkedPhysicalIndexToValue",Zd],["physicalIndexToValue",cs],["trimming",ec]]);function lX(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!MM.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(MM.get(t))(e)}function uX(t,e,n){return e=cX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cX(t){var e=hX(t,"string");return typeof e=="symbol"?e:String(e)}function hX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let $C=0;class kC{constructor(){uX(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)),$C+=1)}unregister(e){const n=this.collection.get(e);be(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n),$C-=1)}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return Mt(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(r=>{r.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}Et(kC,lr);function dX(){return $C}function FC(t,e,n){return e=fX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fX(t){var e=gX(t,"string");return typeof e=="symbol"?e:String(e)}function gX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class OM extends kC{constructor(e,n){super(),FC(this,"mergedValuesCache",[]),FC(this,"aggregationFunction",void 0),FC(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=qe(this.get(),o=>o.getValues()),r=[],i=be(n[0])&&n[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(n[a][o]);r.push(s)}return qe(r,this.aggregationFunction)}getMergedValueAtIndex(e,n){const r=this.getMergedValues(n)[e];return be(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function mX(t,e,n){pX(t,e),e.set(t,n)}function pX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wX(t,e,n){var r=AM(t,e,"set");return CX(t,r,n),n}function CX(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function vX(t,e){var n=AM(t,e,"get");return SX(t,n)}function AM(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function SX(t,e){return e.get?e.get.call(t):e.value}var WC=new WeakMap;class IM{constructor(){mX(this,WC,{writable:!0,value:[]})}subscribe(e){return this.addLocalHook("change",e),this._write(vX(this,WC)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){wX(this,WC,e)}}Et(IM,lr);function PM(t,e){const n=[];let r=0,i=0;for(;r<t.length&&i<e.length;r++,i++)t[r]!==e[i]&&n.push({op:"replace",index:i,oldValue:t[r],newValue:e[i]});for(;r<e.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;i<t.length;i++)n.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return n}function tc(t,e,n){yX(t,e),e.set(t,n)}function yX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wr(t,e){var n=xM(t,e,"get");return bX(t,n)}function bX(t,e){return e.get?e.get.call(t):e.value}function Qd(t,e,n){var r=xM(t,e,"set");return RX(t,r,n),n}function xM(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function RX(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Jd=new WeakMap,nc=new WeakMap,ef=new WeakMap,tf=new WeakMap,nf=new WeakMap;class EX{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};tc(this,Jd,{writable:!0,value:new Set}),tc(this,nc,{writable:!0,value:[]}),tc(this,ef,{writable:!0,value:[]}),tc(this,tf,{writable:!0,value:!1}),tc(this,nf,{writable:!0,value:!1}),Qd(this,nf,e??!1)}createObserver(){const e=new IM;return Wr(this,Jd).add(e),e.addLocalHook("unsubscribe",()=>{Wr(this,Jd).delete(e)}),e._writeInitialChanges(PM(Wr(this,nc),Wr(this,ef))),e}emit(e){let n=Wr(this,ef);(!Wr(this,tf)||Wr(this,nc).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(Wr(this,nf)):Qd(this,nc,new Array(e.length).fill(Wr(this,nf))),Wr(this,tf)||(Qd(this,tf,!0),n=Wr(this,nc)));const r=PM(n,e);Wr(this,Jd).forEach(i=>i._write(r)),Qd(this,ef,e)}}function qn(t,e,n){return e=TX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function TX(t){var e=_X(t,"string");return typeof e=="symbol"?e:String(e)}function _X(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class VC{constructor(){qn(this,"indexesSequence",new _M),qn(this,"trimmingMapsCollection",new OM(e=>e.some(n=>n===!0),!1)),qn(this,"hidingMapsCollection",new OM(e=>e.some(n=>n===!0),!1)),qn(this,"variousMapsCollection",new kC),qn(this,"hidingChangesObservable",new EX({initialIndexValue:!1})),qn(this,"notTrimmedIndexesCache",[]),qn(this,"notHiddenIndexesCache",[]),qn(this,"isBatched",!1),qn(this,"indexesSequenceChanged",!1),qn(this,"indexesChangeSource",void 0),qn(this,"trimmedIndexesChanged",!1),qn(this,"hiddenIndexesChanged",!1),qn(this,"renderablePhysicalIndexesCache",[]),qn(this,"fromPhysicalToVisualIndexesCache",new Map),qn(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,r){return this.registerMap(e,lX(n,r))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof ec?this.trimmingMapsCollection.register(e,n):n instanceof qd?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const r=this.getNumberOfIndexes();return r>0&&n.init(r),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return be(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return be(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return be(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return be(n)?n:null}getNearestNotHiddenIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return n>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?r?this.getNearestNotHiddenIndex(e,-n,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const r=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(r)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const r=qe(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=Ju(this.getIndexesSequence(),r),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(n+o<i){const u=a[n];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(DC(s,l,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){const r=this.getNotTrimmedIndexes()[e],i=be(r)?r:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),s=qe(new Array(n).fill(i),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(r,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(i,n)}}}Et(VC,lr);function MX(t,e){return Ze(e,(n,r)=>{Mt(t[r])&&(t[r]=n)}),t}function HM(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function DM(t){be(t)&&Ew(St`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function OX(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:AX,getValues:IX}=si("phraseFormatters");function PX(t,e){AX(t,e)}function xX(){return IX()}PX("pluralize",OX);const NM="ContextMenu:items",je=NM,BC=`${je}.noItems`,UC=`${je}.insertRowAbove`,YC=`${je}.insertRowBelow`,GC=`${je}.insertColumnOnTheLeft`,zC=`${je}.insertColumnOnTheRight`,jC=`${je}.removeRow`,KC=`${je}.removeColumn`,XC=`${je}.undo`,qC=`${je}.redo`,ZC=`${je}.readOnly`,QC=`${je}.clearColumn`,JC=`${je}.copy`,ev=`${je}.copyWithHeaders`,tv=`${je}.copyWithGroupHeaders`,nv=`${je}.copyHeadersOnly`,rv=`${je}.cut`,iv=`${je}.freezeColumn`,ov=`${je}.unfreezeColumn`,sv=`${je}.mergeCells`,av=`${je}.unmergeCells`,lv=`${je}.addComment`,uv=`${je}.editComment`,cv=`${je}.removeComment`,hv=`${je}.readOnlyComment`,dv=`${je}.align`,fv=`${je}.align.left`,gv=`${je}.align.center`,mv=`${je}.align.right`,pv=`${je}.align.justify`,wv=`${je}.align.top`,Cv=`${je}.align.middle`,vv=`${je}.align.bottom`,Sv=`${je}.borders`,yv=`${je}.borders.top`,bv=`${je}.borders.right`,Rv=`${je}.borders.bottom`,Ev=`${je}.borders.left`,Tv=`${je}.borders.remove`,_v=`${je}.nestedHeaders.insertChildRow`,Mv=`${je}.nestedHeaders.detachFromParent`,Ov=`${je}.hideColumn`,Av=`${je}.showColumn`,Iv=`${je}.hideRow`,Pv=`${je}.showRow`,Zn="Filters:",zt=`${Zn}conditions`,rf=`${zt}.none`,xv=`${zt}.isEmpty`,Hv=`${zt}.isNotEmpty`,Dv=`${zt}.isEqualTo`,Nv=`${zt}.isNotEqualTo`,Lv=`${zt}.beginsWith`,$v=`${zt}.endsWith`,kv=`${zt}.contains`,Fv=`${zt}.doesNotContain`,HX=`${zt}.byValue`,Wv=`${zt}.greaterThan`,Vv=`${zt}.greaterThanOrEqualTo`,Bv=`${zt}.lessThan`,Uv=`${zt}.lessThanOrEqualTo`,Yv=`${zt}.isBetween`,Gv=`${zt}.isNotBetween`,zv=`${zt}.after`,jv=`${zt}.before`,Kv=`${zt}.today`,Xv=`${zt}.tomorrow`,qv=`${zt}.yesterday`,Zv=`${Zn}labels.filterByCondition`,Qv=`${Zn}labels.filterByValue`,Jv=`${Zn}labels.conjunction`,of=`${Zn}labels.disjunction`,sf=`${Zn}values.blankCells`,eS=`${Zn}buttons.selectAll`,tS=`${Zn}buttons.clear`,nS=`${Zn}buttons.ok`,rS=`${Zn}buttons.cancel`,iS=`${Zn}buttons.placeholder.search`,oS=`${Zn}buttons.placeholder.value`,sS=`${Zn}buttons.placeholder.secondValue`,aS="CheckboxRenderer:",lS=`${aS}checked`,uS=`${aS}unchecked`,DX=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:lS,CHECKBOX_RENDERER_NAMESPACE:aS,CHECKBOX_UNCHECKED:uS,CONTEXTMENU_ITEMS_ADD_COMMENT:lv,CONTEXTMENU_ITEMS_ALIGNMENT:dv,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:vv,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:gv,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:pv,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:fv,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:Cv,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:mv,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:wv,CONTEXTMENU_ITEMS_BORDERS:Sv,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:Rv,CONTEXTMENU_ITEMS_BORDERS_LEFT:Ev,CONTEXTMENU_ITEMS_BORDERS_RIGHT:bv,CONTEXTMENU_ITEMS_BORDERS_TOP:yv,CONTEXTMENU_ITEMS_CLEAR_COLUMN:QC,CONTEXTMENU_ITEMS_COPY:JC,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:nv,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:tv,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:ev,CONTEXTMENU_ITEMS_CUT:rv,CONTEXTMENU_ITEMS_EDIT_COMMENT:uv,CONTEXTMENU_ITEMS_FREEZE_COLUMN:iv,CONTEXTMENU_ITEMS_HIDE_COLUMN:Ov,CONTEXTMENU_ITEMS_HIDE_ROW:Iv,CONTEXTMENU_ITEMS_INSERT_LEFT:GC,CONTEXTMENU_ITEMS_INSERT_RIGHT:zC,CONTEXTMENU_ITEMS_MERGE_CELLS:sv,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:Mv,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:_v,CONTEXTMENU_ITEMS_NO_ITEMS:BC,CONTEXTMENU_ITEMS_READ_ONLY:ZC,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:hv,CONTEXTMENU_ITEMS_REDO:qC,CONTEXTMENU_ITEMS_REMOVE_BORDERS:Tv,CONTEXTMENU_ITEMS_REMOVE_COLUMN:KC,CONTEXTMENU_ITEMS_REMOVE_COMMENT:cv,CONTEXTMENU_ITEMS_REMOVE_ROW:jC,CONTEXTMENU_ITEMS_ROW_ABOVE:UC,CONTEXTMENU_ITEMS_ROW_BELOW:YC,CONTEXTMENU_ITEMS_SHOW_COLUMN:Av,CONTEXTMENU_ITEMS_SHOW_ROW:Pv,CONTEXTMENU_ITEMS_UNDO:XC,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:ov,CONTEXTMENU_ITEMS_UNMERGE_CELLS:av,CONTEXT_MENU_ITEMS_NAMESPACE:NM,FILTERS_BUTTONS_CANCEL:rS,FILTERS_BUTTONS_CLEAR:tS,FILTERS_BUTTONS_OK:nS,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:iS,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:sS,FILTERS_BUTTONS_PLACEHOLDER_VALUE:oS,FILTERS_BUTTONS_SELECT_ALL:eS,FILTERS_CONDITIONS_AFTER:zv,FILTERS_CONDITIONS_BEFORE:jv,FILTERS_CONDITIONS_BEGINS_WITH:Lv,FILTERS_CONDITIONS_BETWEEN:Yv,FILTERS_CONDITIONS_BY_VALUE:HX,FILTERS_CONDITIONS_CONTAINS:kv,FILTERS_CONDITIONS_EMPTY:xv,FILTERS_CONDITIONS_ENDS_WITH:$v,FILTERS_CONDITIONS_EQUAL:Dv,FILTERS_CONDITIONS_GREATER_THAN:Wv,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:Vv,FILTERS_CONDITIONS_LESS_THAN:Bv,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:Uv,FILTERS_CONDITIONS_NAMESPACE:zt,FILTERS_CONDITIONS_NONE:rf,FILTERS_CONDITIONS_NOT_BETWEEN:Gv,FILTERS_CONDITIONS_NOT_CONTAIN:Fv,FILTERS_CONDITIONS_NOT_EMPTY:Hv,FILTERS_CONDITIONS_NOT_EQUAL:Nv,FILTERS_CONDITIONS_TODAY:Kv,FILTERS_CONDITIONS_TOMORROW:Xv,FILTERS_CONDITIONS_YESTERDAY:qv,FILTERS_DIVS_FILTER_BY_CONDITION:Zv,FILTERS_DIVS_FILTER_BY_VALUE:Qv,FILTERS_LABELS_CONJUNCTION:Jv,FILTERS_LABELS_DISJUNCTION:of,FILTERS_NAMESPACE:Zn,FILTERS_VALUES_BLANK_CELLS:sf},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const LM={languageCode:"en-US",[BC]:"No available options",[UC]:"Insert row above",[YC]:"Insert row below",[GC]:"Insert column left",[zC]:"Insert column right",[jC]:["Remove row","Remove rows"],[KC]:["Remove column","Remove columns"],[XC]:"Undo",[qC]:"Redo",[ZC]:"Read only",[QC]:"Clear column",[dv]:"Alignment",[fv]:"Left",[gv]:"Center",[mv]:"Right",[pv]:"Justify",[wv]:"Top",[Cv]:"Middle",[vv]:"Bottom",[iv]:"Freeze column",[ov]:"Unfreeze column",[Sv]:"Borders",[yv]:"Top",[bv]:"Right",[Rv]:"Bottom",[Ev]:"Left",[Tv]:"Remove border(s)",[lv]:"Add comment",[uv]:"Edit comment",[cv]:"Delete comment",[hv]:"Read-only comment",[sv]:"Merge cells",[av]:"Unmerge cells",[JC]:"Copy",[ev]:["Copy with header","Copy with headers"],[tv]:["Copy with group header","Copy with group headers"],[nv]:["Copy header only","Copy headers only"],[rv]:"Cut",[_v]:"Insert child row",[Mv]:"Detach from parent",[Ov]:["Hide column","Hide columns"],[Av]:["Show column","Show columns"],[Iv]:["Hide row","Hide rows"],[Pv]:["Show row","Show rows"],[rf]:"None",[xv]:"Is empty",[Hv]:"Is not empty",[Dv]:"Is equal to",[Nv]:"Is not equal to",[Lv]:"Begins with",[$v]:"Ends with",[kv]:"Contains",[Fv]:"Does not contain",[Wv]:"Greater than",[Vv]:"Greater than or equal to",[Bv]:"Less than",[Uv]:"Less than or equal to",[Yv]:"Is between",[Gv]:"Is not between",[zv]:"After",[jv]:"Before",[Kv]:"Today",[Xv]:"Tomorrow",[qv]:"Yesterday",[sf]:"Blank cells",[Zv]:"Filter by condition",[Qv]:"Filter by value",[Jv]:"And",[of]:"Or",[eS]:"Select all",[tS]:"Clear",[nS]:"OK",[rS]:"Cancel",[iS]:"Search",[oS]:"Value",[sS]:"Second value",[lS]:"Checked",[uS]:"Unchecked"},NX=DX,cS=LM.languageCode,{register:LX,getItem:$M,hasItem:$X,getValues:kX}=si("languagesDictionaries");kM(LM);function kM(t,e){let n=t,r=e;return Ke(t)&&(r=t,n=r.languageCode),FX(n,r),LX(n,kn(r)),kn(r)}function FX(t,e){t!==cS&&MX(e,$M(cS))}function FM(t){return hS(t)?kn($M(t)):null}function hS(t){return $X(t)}function WX(){return kX()}function WM(t,e,n){const r=FM(t);if(r===null)return null;const i=r[e];if(Mt(i))return null;const o=VX(i,n);return Array.isArray(o)?o[0]:o}function VX(t,e){let n=t;return H(xX(),r=>{n=r(t,e)}),n}function BX(t){let e=HM(t);return hS(e)||(e=cS,DM(t)),e}function UX(t,e,n){return e=YX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function YX(t){var e=GX(t,"string");return typeof e=="symbol"?e:String(e)}function GX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zX extends QK{constructor(e,n){super(e,null),UX(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:r}=e,i=this.getNearestNotHiddenCoords(n,1),o=this.getNearestNotHiddenCoords(r,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=n,o=r),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,n,r){return n<0?n:e.getNearestNotHiddenIndex(n,r)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),r=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(n,r,i)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const r=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(n);return r.row===null||r.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(r,r,i)}}const yo=zX;function dS(t){let{activeHeaderClassName:e,...n}=t;return new yo({className:e,...n,selectionType:Q_})}function jX(t){let{areaCornerVisible:e,...n}=t;return new yo({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:dC})}function KX(t){let{...e}=t;return new yo({className:"highlight",...e,selectionType:dC})}function XX(t){let{columnClassName:e,...n}=t;return new yo({className:e,...n,selectionType:t3})}function qX(t){let{cellCornerVisible:e,...n}=t;return new yo({className:"current",headerAttributes:[lw()],border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:fC})}function ZX(t){let{border:e,visualCellRange:n,...r}=t;return new yo({...e,...r,selectionType:n3},n)}function QX(t){let{...e}=t;return new yo({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:JK})}function VM(t){let{headerClassName:e,...n}=t;return new yo({className:e,...n,selectionType:hC})}function JX(t){let{rowClassName:e,...n}=t;return new yo({className:e,...n,selectionType:e3})}let BM;function e4(t,e){t4(t,e),e.add(t)}function t4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hr(t,e,n){return e=n4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function n4(t){var e=r4(t,"string");return typeof e=="symbol"?e:String(e)}function r4(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bo(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var ki=new WeakSet;BM=Symbol.iterator;class i4{constructor(e){e4(this,ki),hr(this,"options",void 0),hr(this,"layerLevel",0),hr(this,"focus",void 0),hr(this,"fill",void 0),hr(this,"layeredAreas",new Map),hr(this,"areas",new Map),hr(this,"rowHeaders",new Map),hr(this,"columnHeaders",new Map),hr(this,"activeRowHeaders",new Map),hr(this,"activeColumnHeaders",new Map),hr(this,"activeCornerHeaders",new Map),hr(this,"rowHighlights",new Map),hr(this,"columnHighlights",new Map),hr(this,"customSelections",[]),this.options=e,this.focus=qX(e),this.fill=QX(e)}isEnabledFor(e,n){let r=e;e===fC&&(r="current");let i=this.options.disabledCellSelection(n.row,n.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return bo(this,ki,Ro).call(this,this.layeredAreas,jX)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return bo(this,ki,Ro).call(this,this.areas,KX)}getAreas(){return[...this.areas.values()]}createRowHeader(){return bo(this,ki,Ro).call(this,this.rowHeaders,VM)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return bo(this,ki,Ro).call(this,this.columnHeaders,VM)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return bo(this,ki,Ro).call(this,this.activeRowHeaders,dS)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return bo(this,ki,Ro).call(this,this.activeColumnHeaders,dS)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return bo(this,ki,Ro).call(this,this.activeCornerHeaders,dS)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return bo(this,ki,Ro).call(this,this.rowHighlights,JX)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return bo(this,ki,Ro).call(this,this.columnHighlights,XX)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(ZX({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),H(this.areas.values(),e=>void e.clear()),H(this.layeredAreas.values(),e=>void e.clear()),H(this.rowHeaders.values(),e=>void e.clear()),H(this.columnHeaders.values(),e=>void e.clear()),H(this.activeRowHeaders.values(),e=>void e.clear()),H(this.activeColumnHeaders.values(),e=>void e.clear()),H(this.activeCornerHeaders.values(),e=>void e.clear()),H(this.rowHighlights.values(),e=>void e.clear()),H(this.columnHighlights.values(),e=>void e.clear())}[BM](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function Ro(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const r=e({layerLevel:n,...this.options});return t.set(n,r),r}const o4=i4;let UM;function YM(t,e,n){return e=s4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s4(t){var e=a4(t,"string");return typeof e=="symbol"?e:String(e)}function a4(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}UM=Symbol.iterator;class l4{constructor(e){YM(this,"ranges",[]),YM(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(n=>n.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[UM](){return this.ranges[Symbol.iterator]()}}const u4=l4;function rc(t,e){GM(t,e),e.add(t)}function fS(t,e,n){GM(t,e),e.set(t,n)}function GM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function st(t,e){var n=zM(t,e,"get");return c4(t,n)}function c4(t,e){return e.get?e.get.call(t):e.value}function dr(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function gS(t,e,n){var r=zM(t,e,"set");return h4(t,r,n),n}function zM(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function h4(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var af=new WeakMap,wt=new WeakMap,hs=new WeakMap,mS=new WeakSet,pS=new WeakSet,wS=new WeakSet,CS=new WeakSet,ea=new WeakSet;class jM{constructor(e,n){rc(this,ea),rc(this,CS),rc(this,wS),rc(this,pS),rc(this,mS),fS(this,af,{writable:!0,value:void 0}),fS(this,wt,{writable:!0,value:void 0}),fS(this,hs,{writable:!0,value:{x:0,y:0}}),gS(this,af,e),gS(this,wt,n)}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;dr(this,mS,KM).call(this,{x:st(this,wt).navigableHeaders()?st(this,wt).countRowHeaders():0,y:st(this,wt).navigableHeaders()?st(this,wt).countColHeaders():0});const i=st(this,wt).createCellCoords(e,n);let o=st(this,af).current().highlight;const s=st(this,wt).visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){const{width:u,height:c}=dr(this,wS,qM).call(this),{row:d,col:g}=dr(this,CS,ZM).call(this,o),p=st(this,wt).fixedRowsBottom(),C=st(this,wt).minSpareRows(),E=st(this,wt).minSpareCols(),I=st(this,wt).autoWrapRow(),M=st(this,wt).autoWrapCol(),y=st(this,wt).createCellCoords(d+i.row,g+i.col);if(y.row>=c){const G=oi(r&&C>0&&p===0),q=y.col+1,re=st(this,wt).createCellCoords(y.row-c,q>=u?q-u:q);this.runLocalHooks("beforeColumnWrap",G,dr(this,ea,sl).call(this,re),q>=u),G.value?this.runLocalHooks("insertRowRequire",st(this,wt).countRenderableRows()):M&&y.assign(re)}else if(y.row<0){const G=oi(M),q=y.col-1,re=st(this,wt).createCellCoords(c+y.row,q<0?u+q:q);this.runLocalHooks("beforeColumnWrap",G,dr(this,ea,sl).call(this,re),q<0),M&&y.assign(re)}if(y.col>=u){const G=oi(r&&E>0),q=y.row+1,re=st(this,wt).createCellCoords(q>=c?q-c:q,y.col-u);this.runLocalHooks("beforeRowWrap",G,dr(this,ea,sl).call(this,re),q>=c),G.value?this.runLocalHooks("insertColRequire",st(this,wt).countRenderableColumns()):I&&y.assign(re)}else if(y.col<0){const G=oi(I),q=y.row-1,re=st(this,wt).createCellCoords(q<0?c+q:q,u+y.col);this.runLocalHooks("beforeRowWrap",G,dr(this,ea,sl).call(this,re),q<0),I&&y.assign(re)}const{rowDir:$,colDir:X}=dr(this,pS,XM).call(this,y);a=$,l=X,o=dr(this,ea,sl).call(this,y)}return this.runLocalHooks("afterTransformStart",o,a,l),o}transformEnd(e,n){dr(this,mS,KM).call(this,{x:st(this,wt).navigableHeaders()?st(this,wt).countRowHeaders():0,y:st(this,wt).navigableHeaders()?st(this,wt).countColHeaders():0});const r=st(this,wt).createCellCoords(e,n),i=st(this,af).current(),o=st(this,wt).visualToRenderableCoords(i.highlight),s=i.to.clone();let a=0,l=0;if(this.runLocalHooks("beforeTransformEnd",r),o.row!==null&&o.col!==null){const{row:u,col:c}=dr(this,CS,ZM).call(this,i.to),d=st(this,wt).createCellCoords(u+r.row,c+r.col),{rowDir:g,colDir:p}=dr(this,pS,XM).call(this,d);a=g,l=p;const C=dr(this,ea,sl).call(this,d);r.row===0&&r.col!==0?s.col=C.col:r.row!==0&&r.col===0?s.row=C.row:(s.row=C.row,s.col=C.col)}return this.runLocalHooks("afterTransformEnd",s,a,l),s}}function KM(t){let{x:e,y:n}=t;gS(this,hs,{x:e,y:n})}function XM(t){const{width:e,height:n}=dr(this,wS,qM).call(this);let r=0,i=0;return t.row<0?(r=-1,t.row=0):t.row>0&&t.row>=n&&(r=1,t.row=n-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:r,colDir:i}}function qM(){return{width:st(this,hs).x+st(this,wt).countRenderableColumns(),height:st(this,hs).y+st(this,wt).countRenderableRows()}}function ZM(t){const{row:e,col:n}=st(this,wt).visualToRenderableCoords(t);return st(this,wt).createCellCoords(st(this,hs).y+e,st(this,hs).x+n)}function sl(t){const e=t.clone();return e.col=t.col-st(this,hs).x,e.row=t.row-st(this,hs).y,st(this,wt).renderableToVisualCoords(e)}Et(jM,lr);const d4=jM,lf=0,uf=1,QM=2,vS=3,f4=[vS,QM],g4=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],SS=Symbol("root"),JM=Symbol("child");function al(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:SS;if(e!==SS&&e!==JM)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),r=e===SS;let i=lf;if(n){const o=t[0];t.length===0?i=uf:r&&o instanceof qw?i=vS:r&&Array.isArray(o)?i=al(o,JM):t.length>=2&&t.length<=4&&!t.some((a,l)=>!g4[l].includes(typeof a))&&(i=QM)}return i}function ic(t){let{createCellCoords:e,createCellRange:n,keepDirection:r=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!f4.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===vS;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),Mt(u)&&(u=a),Mt(c)&&(c=l),!r){const p=a,C=l,E=u,I=c;a=Math.min(p,E),l=Math.min(C,I),u=Math.max(p,E),c=Math.max(C,I)}const d=e(a,l),g=e(u,c);return n(d,d,g)}}function m4(t){const e=al(t.getSelected());if(e===lf||e===uf)return[];const n=ic(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;H(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.col,0),c=l.col-u+1;H(Array.from(new Array(c),(d,g)=>u+g),d=>{r.has(d)||r.add(d)})});const i=Array.from(r).sort((s,a)=>s-a);return en(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function p4(t){const e=al(t.getSelected());if(e===lf||e===uf)return[];const n=ic(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;H(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.row,0),c=l.row-u+1;H(Array.from(new Array(c),(d,g)=>u+g),d=>{r.has(d)||r.add(d)})});const i=Array.from(r).sort((s,a)=>s-a);return en(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function w4(t,e,n){C4(t,e),e.set(t,n)}function C4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ds(t,e,n){return e=v4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function v4(t){var e=S4(t,"string");return typeof e=="symbol"?e:String(e)}function S4(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function eO(t,e,n){var r=nO(t,e,"set");return y4(t,r,n),n}function y4(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function tO(t,e){var n=nO(t,e,"get");return b4(t,n)}function nO(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function b4(t,e){return e.get?e.get.call(t):e.value}var oc=new WeakMap;class rO{constructor(e,n){var r=this;ds(this,"settings",void 0),ds(this,"tableProps",void 0),ds(this,"inProgress",!1),ds(this,"selectedRange",new u4((i,o,s)=>this.tableProps.createCellRange(i,o,s))),ds(this,"highlight",void 0),ds(this,"transformation",void 0),ds(this,"selectedByRowHeader",new Set),ds(this,"selectedByColumnHeader",new Set),w4(this,oc,{writable:!0,value:!1}),this.settings=e,this.tableProps=n,this.highlight=new o4({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[lw()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),this.transformation=new d4(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),countRowHeaders:()=>this.tableProps.countRowHeaders(),countColHeaders:()=>this.tableProps.countColHeaders(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformStart",...o)}),this.transformation.addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformStart",...o)}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformEnd",...o)}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformEnd",...o)}),this.transformation.addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertRowRequire",...o)}),this.transformation.addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertColRequire",...o)}),this.transformation.addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeRowWrap",...o)}),this.transformation.addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeColumnWrap",...o)})}getSelectedRange(){return this.selectedRange}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}isInProgress(){return this.inProgress}setRangeStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=Mt(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=e.clone();this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,a),(!o||o&&!s&&Mt(n))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,r)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const n=e.clone(),r=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((r>0||i>0)&&(r===0&&n.col<0&&!o||i===0&&n.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const s=this.selectedRange.current();this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single"?(s.setFrom(s.highlight),s.setTo(s.highlight)):s.setTo(n),r>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet");const a=this.highlight.getFocus();a.clear(),this.highlight.isEnabledFor(fC,s.highlight)&&a.add(this.selectedRange.current().highlight).commit().syncWith(s);const l=this.getLayerLevel();l<this.highlight.layerLevel&&(H(this.highlight.getAreas(),y=>void y.clear()),H(this.highlight.getLayeredAreas(),y=>void y.clear()),H(this.highlight.getRowHeaders(),y=>void y.clear()),H(this.highlight.getColumnHeaders(),y=>void y.clear()),H(this.highlight.getActiveRowHeaders(),y=>void y.clear()),H(this.highlight.getActiveColumnHeaders(),y=>void y.clear()),H(this.highlight.getActiveCornerHeaders(),y=>void y.clear()),H(this.highlight.getRowHighlights(),y=>void y.clear()),H(this.highlight.getColumnHighlights(),y=>void y.clear())),this.highlight.useLayerLevel(l);const u=this.highlight.createArea(),c=this.highlight.createLayeredArea(),d=this.highlight.createRowHeader(),g=this.highlight.createColumnHeader(),p=this.highlight.createActiveRowHeader(),C=this.highlight.createActiveColumnHeader(),E=this.highlight.createActiveCornerHeader(),I=this.highlight.createRowHighlight(),M=this.highlight.createColumnHighlight();if(u.clear(),c.clear(),d.clear(),g.clear(),p.clear(),C.clear(),E.clear(),I.clear(),M.clear(),this.highlight.isEnabledFor(dC,s.highlight)&&(this.isMultiple()||l>=1)&&(u.add(s.from).add(s.to).commit(),c.add(s.from).add(s.to).commit(),l===1)){const y=this.selectedRange.previous();this.highlight.useLayerLevel(l-1),this.highlight.createArea().add(y.from).commit().syncWith(y),this.highlight.createLayeredArea().add(y.from).commit().syncWith(y),this.highlight.useLayerLevel(l)}if(this.highlight.isEnabledFor(hC,s.highlight)){if(!s.isSingleHeader()){const X=this.tableProps.createCellCoords(Math.max(s.from.row,0),-1),G=this.tableProps.createCellCoords(s.to.row,-1),q=this.tableProps.createCellCoords(-1,Math.max(s.from.col,0)),re=this.tableProps.createCellCoords(-1,s.to.col);this.settings.selectionMode==="single"?(d.add(X).commit(),g.add(q).commit(),I.add(X).commit(),M.add(q).commit()):(d.add(X).add(G).commit(),g.add(q).add(re).commit(),I.add(X).add(G).commit(),M.add(q).add(re).commit())}const y=!tO(this,oc)&&this.isEntireRowSelected()&&(i>0&&i===s.getWidth()||i===0&&this.isSelectedByRowHeader()),$=!tO(this,oc)&&this.isEntireColumnSelected()&&(r>0&&r===s.getHeight()||r===0&&this.isSelectedByColumnHeader());y&&p.add(this.tableProps.createCellCoords(Math.max(s.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(s.to.row,0),-1)).commit(),$&&C.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(s.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(s.to.col,0))).commit(),y&&$&&E.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}this.runLocalHooks("afterSetRangeEnd",e)}isMultiple(){const e=oi(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(e,n,r))}transformEnd(e,n){this.setRangeEnd(this.transformation.transformEnd(e,n))}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=r?-l:0,c=n?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let d=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:g,disableHeadersHighlight:p}=i;eO(this,oc,p),g&&Number.isInteger(g==null?void 0:g.row)&&Number.isInteger(g==null?void 0:g.col)&&(d=this.tableProps.createCellCoords(ar(g.row,u,o-1),ar(g.col,c,s-1)));const C=this.tableProps.createCellCoords(u,c),E=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.setRangeStartOnly(C,void 0,d),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(E),this.finish(),eO(this,oc,!1)}selectCells(e){var n=this;const r=al(e);if(r===uf)return!1;if(r===lf)throw new Error(St`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=ic(r,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),H(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone()),this.finish()})),a}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),d=this.tableProps.createCellCoords(s-1,o),g=this.tableProps.createCellRange(c,c,d).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(g){const p=l===0?0:ar(r,u,-1),C=s-1,E=this.tableProps.createCellCoords(p,i),I=this.tableProps.createCellCoords(C,o),M=this.tableProps.createCellCoords(ar(r,u,s-1),i);this.runLocalHooks("beforeSelectColumns",E,I,M),E.row=p,I.row=C,this.setRangeStartOnly(E,void 0,M),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(I),this.runLocalHooks("afterSelectColumns",E,I,M),this.finish()}return g}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(n,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){const d=s===0?0:ar(r,a,-1),g=o-1,p=this.tableProps.createCellCoords(e,d),C=this.tableProps.createCellCoords(n,g),E=this.tableProps.createCellCoords(e,ar(r,a,o-1));this.runLocalHooks("beforeSelectRows",p,C,E),p.col=d,C.col=g,this.setRangeStartOnly(p,void 0,E),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(C),this.runLocalHooks("afterSelectRows",p,C,E),this.finish()}return c}refresh(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const n=this.highlight.getFocus(),r=this.getLayerLevel();n.commit().syncWith(this.selectedRange.current());for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),d=this.highlight.createActiveCornerHeader(),g=this.highlight.createRowHighlight(),p=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),d.commit(),g.commit(),p.commit()}this.highlight.useLayerLevel(r)}}Et(rO,lr);const R4=rO,iO=/^(\r\n|\n\r|\r|\n)/,E4=/^[^\t\r\n]+/,oO=/^\t/;function T4(t){const e=[[""]];if(t.length===0)return e;let n=0,r=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(oO))t=t.replace(oO,""),n+=1,e[r][n]="";else if(t.match(iO))t=t.replace(iO,""),n=0,r+=1,e[r]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(E4);o=s?s[0]:"",t=t.slice(o.length)}e[r][n]=o}return e}function sc(t){let e,n,r,i,o="",s;for(e=0,n=t.length;e<n;e+=1){for(i=t[e].length,r=0;r<i;r+=1)r>0&&(o+="	"),s=t[e][r],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==n-1&&(o+=`
`)}return o}function ta(t,e,n){return e=_4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _4(t){var e=M4(t,"string");return typeof e=="symbol"?e:String(e)}function M4(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ll{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,r){ta(this,"hot",void 0),ta(this,"metaManager",void 0),ta(this,"tableMeta",void 0),ta(this,"dataSource",void 0),ta(this,"duckSchema",void 0),ta(this,"colToPropCache",void 0),ta(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=n,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,n){let i=0,o=0,s=!1;if(typeof n=="function"){const a=Sd(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,n.length)}for(r=0;r<i;r++){const a=s?n(r):n[r];if(Ke(a)){if(typeof a.data<"u"){const l=s?o:r;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return PC(this.dataSource)}recursiveDuckColumns(e,n,r){let i=n,o=r,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&Ze(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&be(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(be(n))return this.hot.toVisualColumn(n);const r=this.hot.toVisualColumn(e);return r===null?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Ka(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,n,r)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,d=this.getSchema().length,g=[];for(;a<n&&o+a<c;){let C=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?C=kn(this.getSchema()):(C=[],Ie(d-1,()=>C.push(null))):this.hot.dataType==="function"?C=this.tableMeta.dataSchema(l+a):(C={},Fu(C,this.getSchema())),g.push(C),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,g);const p=this.hot.toVisualRow(s);return this.hot.countSourceRows()===g.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):r!=="auto"&&this.metaManager.createRow(s,n)),this.hot.runHooks("afterCreateRow",p,a,r),this.hot.forceFullRender=!0,{delta:a,startPhysicalIndex:s}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.hot.runHooks("beforeCreateCol",l,n,r)===!1)return{delta:0};let c=a;l<this.hot.countCols()&&(c=this.hot.toPhysicalColumn(l));const d=this.hot.countSourceRows();let g=this.hot.countCols(),p=0,C=c;i==="end"&&(C=Math.min(C+1,a));const E=C;for(;p<n&&g<s;){if(typeof l!="number"||l>=g)if(d>0)for(let M=0;M<d;M+=1)typeof o[M]>"u"&&(o[M]=[]),o[M].push(null);else o.push([null]);else for(let M=0;M<d;M++)o[M].splice(C,0,null);p+=1,C+=1,g+=1}this.hot.columnIndexMapper.insertIndexes(l,p),p>0&&(e==null?this.metaManager.createColumn(null,p):r!=="auto"&&this.metaManager.createColumn(E,n));const I=this.hot.toVisualColumn(E);return this.hot.runHooks("afterCreateCol",I,p,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:p,startPhysicalIndex:E}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-n;const o=this.visualRowsToPhysical(i,n),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,r)===!1)return!1;const l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=be(this.tableMeta.columns)||be(this.tableMeta.dataSchema);this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&c===!1&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,d)=>d-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,r),this.hot.forceFullRender=!0,!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-n:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,n),s=o.slice(0).sort((d,g)=>g-d);if(this.hot.runHooks("beforeRemoveCol",i,n,o,r)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let d=0;d<u;d++)l&&o[0]!==o[d]-d&&(l=!1);if(l)for(let d=0,g=this.hot.countSourceRows();d<g;d++)c[d].splice(o[0],n),d===0&&this.metaManager.removeColumn(o[0],n);else for(let d=0,g=this.hot.countSourceRows();d<g;d++)for(let p=0;p<u;p++)c[d].splice(s[p],1),d===0&&this.metaManager.removeColumn(s[p],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,n,o,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,n,r){const i=this.hot.getDataAtCol(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];qp(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return X0(l),this.hot.populateFromArray(n,e,l,null,null,"spliceCol"),o}spliceRow(e,n,r){const i=this.hot.getSourceDataAtRow(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];qp(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return this.hot.populateFromArray(e,n,[l],null,null,"spliceRow"),o}spliceData(e,n,r){if(this.hot.runHooks("beforeDataSplice",e,n,r)!==!1){const o=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,n,r){let i=this.hot.runHooks("filterData",e,n,r);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>r.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,n){const r=this.hot.toPhysicalRow(e);let i=this.dataSource[r];const o=this.hot.runHooks("modifyRowData",r);i=isNaN(o)?o:i;let s=null;if(i&&i.hasOwnProperty&&Vt(i,n))s=i[n];else if(typeof n=="string"&&n.indexOf(".")>-1){const a=n.split(".");let l=i;if(!l)return null;for(let u=0,c=a.length;u<c;u++)if(l=l[a[u]],typeof l>"u")return null;s=l}else typeof n=="function"&&(s=n(this.dataSource.slice(r,r+1)[0]));if(this.hot.hasHook("modifyData")){const a=oi(s);this.hot.runHooks("modifyData",r,this.propToCol(n),a,"get"),a.isTouched()&&(s=a.value)}return s}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,r){const i=this.hot.toPhysicalRow(e);let o=r,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const l=oi(o);this.hot.runHooks("modifyData",i,this.propToCol(n),l,"set"),l.isTouched()&&(o=l.value)}if(s&&s.hasOwnProperty&&Vt(s,n))s[n]=o;else if(typeof n=="string"&&n.indexOf(".")>-1){const l=n.split(".");let u=s,c=0,d;for(c=0,d=l.length-1;c<d;c++)typeof u[l[c]]>"u"&&(u[l[c]]={}),u=u[l[c]];u[l[c]]=o}else typeof n=="function"?n(this.dataSource.slice(i,i+1)[0],o):s[n]=o}visualRowsToPhysical(e,n){const r=this.hot.countSourceRows(),i=[];let o=(r+e)%r,s=n,a;for(;o<r&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,n){const r=this.hot.countCols(),i=[];let o=(r+e)%r,s=n;for(;o<r&&s;){const a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,ll.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,r){const i=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=r===ll.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,d=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),g=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=d;o++){a=[];const p=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,n.col);s<=g&&p!==null;s++)a.push(c.call(this,o,this.colToProp(s)));p!==null&&i.push(a)}return i}getText(e,n){return sc(this.getRange(e,n,ll.DESTINATION_RENDERER))}getCopyableText(e,n){return sc(this.getRange(e,n,ll.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const O4=ll,{register:A4,getItem:I4,hasItem:sO,getNames:P4,getValues:Iae}=si("cellTypes");function yS(t){if(!sO(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return I4(t)}function Vr(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:r,validator:i}=e;n&&sr(t,n),r&&xi(t,r),i&&Ja(t,i),A4(t,e)}function x4(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!Vt(e,t)}function cf(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const r=typeof e.type=="string"?yS(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Ze(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!Ke(r))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};Ze(r,(o,s)=>{if(x4(s,n)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),an(t,i)}function H4(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}go(n,t);for(let r=0;r<e.length;r++)n.prototype[e[r]]=void 0;return n}function hf(t){return Number.isInteger(t)&&t>=0}function df(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function ff(t){return t==null}const aO=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,r;for(e=0,n=this.countRows();e<n;e++)if(r=this.getDataAtCell(e,t),hn(r)===!1)return!1;return!0},isEmptyRow(t){let e,n,r,i;for(e=0,n=this.countCols();e<n;e++)if(r=this.getDataAtCell(t,e),hn(r)===!1)return typeof r=="object"?(i=this.getCellMeta(t,e),Cd(this.getSchema()[i.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function lO(t,e,n){return e=D4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function D4(t){var e=N4(t,"string");return typeof e=="symbol"?e:String(e)}function N4(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function L4(){return class{}}class $4{constructor(e){lO(this,"metaCtor",L4()),lO(this,"meta",void 0),this.meta=this.metaCtor.prototype,an(this.meta,aO()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;an(this.meta,e),cf(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function k4(t,e,n){return e=F4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function F4(t){var e=W4(t,"string");return typeof e=="symbol"?e:String(e)}function W4(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class V4{constructor(e){k4(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){an(this.meta,e),cf(this.meta,e,e)}}let uO;function gf(t,e,n){return e=B4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function B4(t){var e=U4(t,"string");return typeof e=="symbol"?e:String(e)}function U4(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}uO=Symbol.iterator;class mf{constructor(e){gf(this,"valueFactory",void 0),gf(this,"data",[]),gf(this,"index",[]),gf(this,"holes",new Set),this.valueFactory=e}obtain(e){df(()=>hf(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let r;if(n>=0)r=this.data[n],r===void 0&&(r=this.valueFactory(e),this.data[n]=r);else if(r=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=r,this.index[e]=i}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;df(()=>hf(e)||ff(e),"Expecting an unsigned number or null/undefined argument.");const r=[],i=this.data.length;for(let s=0;s<n;s++)r.push(i+s),this.data.push(void 0);const o=ff(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...r,...this.index.slice(o)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;df(()=>hf(e)||ff(e),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(ff(e)?this.index.length-n:e,n);for(let i=0;i<r.length;i++){const o=r[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return yr(this.data,(e,n)=>!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const i=this._getKeyByStorageIndex(r);i!==-1&&e.push([i,this.data[r]])}let n=0;return{next:()=>{if(n<e.length){const r=e[n];return n+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[uO](){return this.entries()}}function cO(t,e,n){return e=Y4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Y4(t){var e=G4(t,"string");return typeof e=="symbol"?e:String(e)}function G4(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const z4=["data","width"];class j4{constructor(e){cO(this,"globalMeta",void 0),cO(this,"metas",new mf(()=>this._createMeta())),this.globalMeta=e,this.metas=new mf(()=>this._createMeta())}updateMeta(e,n){const r=this.getMeta(e);an(r,n),cf(r,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return H4(this.globalMeta.getMetaConstructor(),z4).prototype}}function hO(t,e,n){return e=K4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function K4(t){var e=X4(t,"string");return typeof e=="symbol"?e:String(e)}function X4(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class q4{constructor(e){hO(this,"columnMeta",void 0),hO(this,"metas",new mf(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,r){const i=this.getMeta(e,n);an(i,r),cf(i,r)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,n)}getMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);return r===void 0?i:i[r]}setMeta(e,n,r,i){var o;const s=this.metas.obtain(e).obtain(n);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(r),s[r]=i}removeMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);delete i[r]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let r=0;r<n.length;r++)e.push(...n[r].values());return e}getMetasAtRow(e){df(()=>hf(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new mf(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class dO{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new $4(e),this.tableMeta=new V4(this.globalMeta),this.columnMeta=new j4(this.globalMeta),this.cellMeta=new q4(this.columnMeta),r.forEach(i=>new i(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,r){let{visualRow:i,visualColumn:o}=r;const s=this.cellMeta.getMeta(e,n);return s.visualRow=i,s.visualCol=o,s.row=e,s.col=n,this.runLocalHooks("afterGetCellMeta",s),s}getCellMetaKeyValue(e,n,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,r)}setCellMeta(e,n,r,i){this.cellMeta.setMeta(e,n,r,i)}updateCellMeta(e,n,r){this.cellMeta.updateMeta(e,n,r)}removeCellMeta(e,n,r){this.cellMeta.removeMeta(e,n,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}Et(dO,lr);function fO(t,e,n,r){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=r,d=$n(a),g=i.getSettings();Array.isArray(g.dataSchema)?i.dataType="array":Ot(g.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${d}`,t,c,l);const p=new O4(i,t,u);if(e(p),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const C=p.getSchema();t=[];let E,I=0,M=0;for(I=0,M=g.startRows;I<M;I++)if((i.dataType==="object"||i.dataType==="function")&&g.dataSchema)E=kn(C),t.push(E);else if(i.dataType==="array")E=kn(C[0]),t.push(E);else{E=[];for(let y=0,$=g.startCols;y<$;y++)E.push(null);t.push(E)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),g.data=t,p.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=p.colToProp.bind(p),s.propToCol=p.propToCol.bind(p),s.countCachedColumns=p.countCachedColumns.bind(p),n(p),i.runHooks(`after${d}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&Le(i.rootElement,[aT(-1),ud(i.countCols()+(i.view?i.countRowHeaders():0))])}function gO(t,e,n){return e=Z4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Z4(t){var e=Q4(t,"string");return typeof e=="symbol"?e:String(e)}function Q4(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class J4{constructor(e){gO(this,"metaManager",void 0),gO(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",n=>this.extendCellMeta(n)),_e.getSingleton().add("beforeRender",n=>{n&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:r,col:i}=e;if((n=this.metaSyncMemo.get(r))!==null&&n!==void 0&&n.has(i))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=Vt(e,"type")?e.type:null;let c=Ot(e.cells)?e.cells(r,i,l):null;if(u)if(c){var d;c.type=(d=c.type)!==null&&d!==void 0?d:u}else c={type:u};c&&this.metaManager.updateCellMeta(r,i,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(i)}}function bS(t,e,n){return e=eq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eq(t){var e=tq(t,"string");return typeof e=="symbol"?e:String(e)}function tq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nq{constructor(e){bS(this,"metaManager",void 0),bS(this,"usageTracker",new Set),bS(this,"propDescriptors",new Map([["ariaTags",{onChange(n,r,i){if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable instance was initialized.`)}}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange(n,r,i){if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}}]])),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{target:r,onChange:i=()=>{}}=e,o=typeof r=="string",s=o?r:n,a=`_${s}`;this.metaManager.globalMeta.meta[a]=this.metaManager.globalMeta.meta[s],this.installPropWatcher(n,a,i),o&&this.installPropWatcher(r,a,i)})}installPropWatcher(e,n,r){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),r.call(i,e,o,s),this[n]=o},enumerable:!0,configurable:!0})}}const mO="gridDefault",RS="editorManager.handlingEditor",rq={name:"editorCloseAndSave",callback(t,e,n){const r=t._getEditorManager();r.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),r.moveSelectionAfterEnter(n.includes("shift"))}},iq={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},oq={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},sq={name:"editorOpen",callback(t,e,n){const r=t._getEditorManager(),{highlight:i}=t.getSelectedRangeLast();i.isHeader()||(t.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter():r.openEditor(null,e,!0):r.moveSelectionAfterEnter(n.includes("shift")),Lr(e))}};function aq(){return[rq,iq,oq,sq]}const lq={name:"extendCellsSelectionDown",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(1,0)}},uq={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.min(e.row+t.countVisibleRows(),t.countRows()-1),r=t.rowIndexMapper.getNearestNotHiddenIndex(n,-1);if(r!==null){const i=t._createCellCoords(r,e.col),o=e.row-t.view.getFirstFullyVisibleRow(),s=Math.min(i.row-o,t.countRows()-1);t.selection.setRangeEnd(i),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}},cq={name:"extendCellsSelectionLeft",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,-1*t.getDirectionFactor())}},hq={name:"extendCellsSelectionRight",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,t.getDirectionFactor())}},dq={name:"extendCellsSelectionToColumns",callback(t){const{highlight:e,from:n,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()?t.selection.selectAll(!0,!0):t.selectColumns(n.col,r.col,e.row)}},fq={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(t.countRows()-1,-1);e.setRangeStart(i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col))}}},gq={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r}=t.getSelectedRangeLast();r.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},mq={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r}=t.getSelectedRangeLast();r.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,n.getNearestNotHiddenIndex(0,1)))}},pq={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);e.setRangeStart(i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a))}}},wq={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);e.setRangeStart(i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a))}}},Cq={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(0,1);e.setRangeStart(i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col))}}},vq={name:"extendCellsSelectionToRows",callback(t){const{highlight:e,from:n,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()?t.selection.selectAll(!0,!0):t.selectRows(n.row,r.row,e.col)}},Sq={name:"extendCellsSelectionUp",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(-1,0)}},yq={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.max(e.row-t.countVisibleRows(),0),r=t.rowIndexMapper.getNearestNotHiddenIndex(n,1);if(r!==null){const i=t._createCellCoords(r,e.col),o=e.row-t.view.getFirstFullyVisibleRow(),s=Math.max(i.row-o,0);t.selection.setRangeEnd(i),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}};function bq(){return[lq,uq,cq,hq,dq,fq,gq,mq,pq,wq,Cq,vq,Sq,yq]}const Rq={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.transformStart(1,0)}},Eq={name:"moveCellSelectionDownByViewportHeight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight;let i=t.countVisibleRows()+n;r===t.countRows()-1?i=1:r+i>t.countRows()&&(i=t.countRows()-r-1),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},Tq={name:"moveCellSelectionInlineEnd",callback(t,e){const n=t.getSettings(),r=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.transformStart(-r.row,-r.col)}},_q={name:"moveCellSelectionInlineStart",callback(t,e){const n=t.getSettings(),r=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.transformStart(r.row,r.col)}},Mq={name:"moveCellSelectionLeft",callback(t){t.selection.transformStart(0,-1*t.getDirectionFactor())}},Oq={name:"moveCellSelectionRight",callback(t){t.selection.transformStart(0,t.getDirectionFactor())}},Aq={name:"moveCellSelectionToMostBottom",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);n===null&&(n=-1),t.selection.setRangeStart(t._createCellCoords(n,e))}},Iq={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=r.getNearestNotHiddenIndex(t.countCols()-1,-1);e.setRangeStart(t._createCellCoords(o,s))}},Pq={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},xq={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,r=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,o=n.getNearestNotHiddenIndex(r,1);e.setRangeStart(t._createCellCoords(i,o))}},Hq={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,r=t.getSelectedRangeLast().highlight.row;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.setRangeStart(t._createCellCoords(r,i))}},Dq={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:r}=t.getSelectedRangeLast().highlight;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.setRangeStart(t._createCellCoords(r,i))}},Nq={name:"moveCellSelectionToMostTop",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);n===null&&(n=-t.countColHeaders()),t.selection.setRangeStart(t._createCellCoords(n,e))}},Lq={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(i,1),a=r.getNearestNotHiddenIndex(o,1);e.setRangeStart(t._createCellCoords(s,a))}},$q={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.transformStart(-1,0)}},kq={name:"moveCellSelectionUpByViewportHight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight;let i=-(t.countVisibleRows()+n);r===-n?i=-1:r+i<n&&(i=-(r+n)),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function Fq(){return[Rq,Eq,Tq,_q,Mq,Oq,Aq,Iq,Pq,xq,Hq,Dq,Nq,Lq,$q,kq]}const Wq={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},Vq={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.view.getFirstFullyVisibleRow()-1,r=t.view.getFirstFullyVisibleColumn()-1,i=t.view.getLastFullyVisibleRow()+1,o=t.view.getLastFullyVisibleColumn()+1,s=t._createCellCoords(n,r),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},Bq={name:"selectAllCells",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},Uq={name:"selectAllCellsAndHeaders",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},Yq={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:r}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(n,r),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==n||l!==r)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}},Gq=[...aq(),...bq(),...Fq(),Wq,Vq,Bq,Uq,Yq];function pO(t){const e={};return Gq.forEach(n=>{let{name:r,callback:i}=n;e[r]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function zq(t){const e=t.getShortcutManager().addContext("editor"),n=pO(t),r={group:RS};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],r)}function jq(t){const e=t.getShortcutManager().addContext("grid"),n=pO(t),r={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return be(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:mO};e.addShortcuts([{keys:[["F2"]],callback:i=>n.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorOpen(i,o)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:RS,runOnlyIf:()=>be(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells()},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>!t.getSelectedRangeLast().highlight.isHeader()&&t.getSelectedRangeLast().getCellsCount()>1},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:()=>n.moveCellSelectionInlineStart()},{keys:[["Shift","Tab"]],preventDefault:!1,callback:()=>n.moveCellSelectionInlineEnd()},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],r)}function Kq(t){[zq,jq].forEach(e=>e(t))}function Xq(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=t.rootElement,r=wO(t),i=wO(t);return r.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),n.firstChild.before(r),n.lastChild.after(i),{activate(){t._registerTimeout(()=>{r.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{r.tabIndex=-1,i.tabIndex=-1},10)}}}function wO(t){const n=t.rootDocument.createElement("input");return n.type="text",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&Le(n,[Ii(),co()]),n}function qq(t){let e;const{activate:n,deactivate:r}=Xq(t,{onFocusFromTop(){var u;const c=(u=e)!==null&&u!==void 0?u:CO(t);c&&(t.runHooks("modifyFocusOnTabNavigation","from_above",c),t.selectCell(c.row,c.col)),t.listen()},onFocusFromBottom(){var u;const c=(u=e)!==null&&u!==void 0?u:vO(t);c&&(t.runHooks("modifyFocusOnTabNavigation","from_below",c),t.selectCell(c.row,c.col)),t.listen()}}),i={wrapped:!1,flipped:!1};let o=!0,s=!1;t.addHook("afterListen",()=>r()),t.addHook("afterUnlisten",()=>n()),t.addHook("afterSelection",(u,c,d,g,p)=>{if(s&&i.wrapped&&i.flipped&&(p.value=!0),o){var C;e=(C=t.getSelectedRangeLast())===null||C===void 0?void 0:C.highlight}}),t.addHook("beforeRowWrap",(u,c,d)=>{i.wrapped=!0,i.flipped=d});function a(){i.wrapped=!1,i.flipped=!1,t.deselectCell(),t.unlisten()}const l={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:mO,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...l,callback:()=>{s=!0,t.getSelectedRangeLast()&&!t.getSettings().tabNavigation&&(o=!1)},position:"before"},{...l,callback:u=>{const{tabNavigation:c,autoWrapRow:d}=t.getSettings();if(s=!1,o=!0,!c||!t.selection.isSelected()||d&&i.wrapped&&i.flipped||!d&&i.wrapped)return d&&i.wrapped&&i.flipped&&(e=u.shiftKey?CO(t):vO(t)),a(),!1;u.preventDefault()},position:"after"}])}function CO(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:r}=t.getSettings();let i=r&&t.countColHeaders()>0?-t.countColHeaders():0,o=r&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=n.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function vO(t){var e,n;const{rowIndexMapper:r,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=r.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=r.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(n=i.getVisualFromRenderableIndex(a))!==null&&n!==void 0?n:a)}const SO=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),pf=t=>t.map(e=>{const n=e.toLowerCase();return SO.has(n)?SO.get(n):n}).sort().join("+"),Zq=t=>t.split("+"),yO=new RegExp("^(?:Key|Digit)([A-Z0-9])$"),Qq=new Set(["Backquote","Minus","Equal","BracketLeft","BracketRight","Backslash","Semicolon","Quote","Comma","Period","Slash"]),ES=t=>{let{key:e,code:n}=t,r=e;return yO.test(n)?r=n.replace(yO,"$1"):Qq.has(n)&&(r=n),r.toLowerCase()},bO=Symbol("shortcut-context");function RO(t){return Ke(t)&&t.__kindOf===bO}const Jq=t=>{const e=Hd({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:l,callback:u,group:c,runOnlyIf:d=()=>!0,captureCtrl:g=!1,preventDefault:p=!0,stopPropagation:C=!1,relativeToGroup:E,position:I,forwardToContext:M}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Mt(c))throw new Error("You need to define the shortcut's group.");if(Ot(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(St`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const y={callback:u,group:c,runOnlyIf:d,captureCtrl:g,preventDefault:p,stopPropagation:C};be(E)&&([y.relativeToGroup,y.position]=[E,I]),RO(M)&&(y.forwardToContext=M),l.forEach($=>{const X=pf($);if(e.hasItem(X)){const q=e.getItem(X);let re=q.findIndex(v=>v.group===E);re!==-1?I==="before"?re-=1:re+=1:re=q.length,q.splice(re,0,y)}else e.addItem(X,[y])})},r=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{Ze(u,(d,g)=>{Object.prototype.hasOwnProperty.call(c,g)===!1&&(c[g]=u[g])}),n(c)})},i=l=>{const u=pf(l);e.removeItem(u)};return{__kindOf:bO,addShortcut:n,addShortcuts:r,getShortcuts:l=>{const u=pf(l),c=e.getItem(u);return be(c)?c.slice():[]},hasShortcut:l=>{const u=pf(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[d,g]=c;const p=g.filter(C=>C.group!==l);p.length===0?i(Zq(d)):(g.length=0,g.push(...p))})}}};function e6(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const t6=["meta","alt","shift","control"],ac=e6();let wf=0;function n6(t,e,n,r,i){const o=p=>t6.includes(p),s=function(p){let C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const E=[];return p.altKey&&E.push("alt"),C&&(p.ctrlKey||p.metaKey)?E.push("control/meta"):(p.ctrlKey&&E.push("control"),p.metaKey&&E.push("meta")),p.shiftKey&&E.push("shift"),E},a=p=>{if(e(p)===!1)return;const C=n(p);if(p.keyCode===229||C===!1||rs(p))return;const E=ES(p);let I=[];o(E)||(I=s(p));const M=[E].concat(I);!i(p,M)&&(Wu()&&I.includes("meta")||!Wu()&&I.includes("control"))&&i(p,[E].concat(s(p,!0))),r(p)},l=p=>{const C=ES(p);o(C)&&ac.press(C)},u=p=>{const C=ES(p);o(C)&&ac.release(C)},c=()=>{ac.releaseAll()};return{mount:()=>{let p=t;for(wf+=1;p;)wf===1&&(p.document.documentElement.addEventListener("keydown",l),p.document.documentElement.addEventListener("keyup",u)),p.document.documentElement.addEventListener("keydown",a),p.document.documentElement.addEventListener("blur",c),p=Pu(p)},unmount:()=>{let p=t;for(wf-=1;p;)wf===0&&(p.document.documentElement.removeEventListener("keydown",l),p.document.documentElement.removeEventListener("keyup",u)),p.document.documentElement.removeEventListener("keydown",a),p.document.documentElement.removeEventListener("blur",c),p=Pu(p)},isPressed:p=>ac.isPressed(p),releasePressedKeys:()=>ac.releaseAll()}}const r6=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:r,afterKeyDown:i}=t;const o=Hd({errorIdExists:C=>`The "${C}" context name is already registered.`});let s="grid";const a=C=>{const E=Jq(C);return o.addItem(C,E),E},l=()=>s,u=C=>o.getItem(C),c=C=>{if(!o.hasItem(C))throw new Error(St`You've tried to activate the "${C}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=C};let d=!1;const g=function(C,E){let I=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const M=RO(I)?I:u(I);let y=!1;if(!M.hasShortcut(E))return y;const $=M.getShortcuts(E);for(let X=0;X<$.length;X++){const{callback:G,runOnlyIf:q,preventDefault:re,stopPropagation:v,captureCtrl:S,forwardToContext:b}=$[X];if(q(C)===!0){if(d=S,y=G(C,E)===!1,d=!1,re&&C.preventDefault(),v&&(Lr(C),C.stopPropagation()),y)break;b&&g(C,E,b)}}return y},p=n6(e,n,r,i,g);return p.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!d&&(p.isPressed("control")||p.isPressed("meta")),releasePressedKeys:()=>p.releasePressedKeys(),destroy:()=>p.unmount()}};let TS=null;const _S=new Map;function EO(t,e){var n,r=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=!1,s=this;const a=new br(s);let l,u,c,d,g,p=!0;W3(i)&&F3(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const C=(n=e==null?void 0:e.layoutDirection)!==null&&n!==void 0?n:"inherit",E=["rtl","ltr"].includes(C)?C:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",E),this.isRtl=function(){return E==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},e.language=BX(e.language);const I=new dO(s,e,[J4,nq]),M=I.getTableMeta(),y=I.getGlobalMeta(),$=Hd();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),zd(this)&&rT(e.licenseKey,t),this.guid=`ht_${tw()}`,_S.set(this.guid,this),this.columnIndexMapper=new VC,this.rowIndexMapper=new VC,this.columnIndexMapper.addLocalHook("indexesSequenceChange",h=>{s.runHooks("afterColumnSequenceChange",h)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",h=>{s.runHooks("afterRowSequenceChange",h)}),u=new nX(s),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const X=h=>{const{row:f,col:m}=h;return s._createCellCoords(f>=0?s.rowIndexMapper.getRenderableFromVisualIndex(f):f,m>=0?s.columnIndexMapper.getRenderableFromVisualIndex(m):m)},G=h=>{const{row:f,col:m}=h;return s._createCellCoords(f>=0?s.rowIndexMapper.getVisualFromRenderableIndex(f):f,m>=0?s.columnIndexMapper.getVisualFromRenderableIndex(m):m)};let q=new R4(M,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:h=>l.propToCol(h),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(h,f)=>s._createCellCoords(h,f),createCellRange:(h,f,m)=>s._createCellRange(h,f,m),visualToRenderableCoords:X,renderableToVisualCoords:G,isDisabledCellSelection:(h,f)=>h<0||f<0?s.getSettings().disableVisualSelection:s.getCellMeta(h,f).disableVisualSelection});this.selection=q;const re=h=>{let{hiddenIndexesChanged:f}=h;f&&this.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",re),this.rowIndexMapper.addLocalHook("cacheUpdated",re),this.selection.addLocalHook("afterSetRangeEnd",h=>{const f=oi(!1),m=this.selection.getSelectedRange(),{from:T,to:O}=m.current(),_=m.size()-1;this.runHooks("afterSelection",T.row,T.col,O.row,O.col,f,_),this.runHooks("afterSelectionByProp",T.row,s.colToProp(T.col),O.row,s.colToProp(O.col),f,_);let Y=!0;o&&(Y=!1),f.isTouched()&&(Y=!f.value);const U=this.selection.selectedRange.current(),ie=this.selection.isSelectedByAnyHeader(),se=this.selection.isSelectedByRowHeader(),oe=this.selection.isSelectedByColumnHeader();if(Y!==!1)if(ie)se?this.scrollViewportTo({row:h.row}):oe&&this.scrollViewportTo({col:h.col});else if(U&&!this.selection.isMultiple()){const{row:de,col:Se}=U.from;de<0&&Se>=0?this.scrollViewportTo({col:Se}):Se<0&&de>=0?this.scrollViewportTo({row:de}):this.scrollViewportTo({row:de,col:Se})}else this.scrollViewportTo(h.toObject());se&&oe?ce(this.rootElement,["ht__selection--rows","ht__selection--columns"]):se?(Ue(this.rootElement,"ht__selection--columns"),ce(this.rootElement,"ht__selection--rows")):oe?(Ue(this.rootElement,"ht__selection--rows"),ce(this.rootElement,"ht__selection--columns")):Ue(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",h=>{const f=h.length-1,{from:m,to:T}=h[f];this.runHooks("afterSelectionEnd",m.row,m.col,T.row,T.col,f),this.runHooks("afterSelectionEndByProp",m.row,s.colToProp(m.col),T.row,s.colToProp(T.col),f)}),this.selection.addLocalHook("afterIsMultipleSelection",h=>{const f=this.runHooks("afterIsMultipleSelection",h.value);h.value&&(h.value=f)}),this.selection.addLocalHook("afterDeselect",()=>{d.destroyEditor(),this._refreshBorders(),Ue(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var h=arguments.length,f=new Array(h),m=0;m<h;m++)f[m]=arguments[m];return r.runHooks("beforeSetRangeStart",...f)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var h=arguments.length,f=new Array(h),m=0;m<h;m++)f[m]=arguments[m];return r.runHooks("beforeSetRangeStartOnly",...f)}).addLocalHook("beforeSetRangeEnd",function(){for(var h=arguments.length,f=new Array(h),m=0;m<h;m++)f[m]=arguments[m];return r.runHooks("beforeSetRangeEnd",...f)}).addLocalHook("beforeSelectColumns",function(){for(var h=arguments.length,f=new Array(h),m=0;m<h;m++)f[m]=arguments[m];return r.runHooks("beforeSelectColumns",...f)}).addLocalHook("afterSelectColumns",function(){for(var h=arguments.length,f=new Array(h),m=0;m<h;m++)f[m]=arguments[m];return r.runHooks("afterSelectColumns",...f)}).addLocalHook("beforeSelectRows",function(){for(var h=arguments.length,f=new Array(h),m=0;m<h;m++)f[m]=arguments[m];return r.runHooks("beforeSelectRows",...f)}).addLocalHook("afterSelectRows",function(){for(var h=arguments.length,f=new Array(h),m=0;m<h;m++)f[m]=arguments[m];return r.runHooks("afterSelectRows",...f)}).addLocalHook("beforeModifyTransformStart",function(){for(var h=arguments.length,f=new Array(h),m=0;m<h;m++)f[m]=arguments[m];return r.runHooks("modifyTransformStart",...f)}).addLocalHook("afterModifyTransformStart",function(){for(var h=arguments.length,f=new Array(h),m=0;m<h;m++)f[m]=arguments[m];return r.runHooks("afterModifyTransformStart",...f)}).addLocalHook("beforeModifyTransformEnd",function(){for(var h=arguments.length,f=new Array(h),m=0;m<h;m++)f[m]=arguments[m];return r.runHooks("modifyTransformEnd",...f)}).addLocalHook("afterModifyTransformEnd",function(){for(var h=arguments.length,f=new Array(h),m=0;m<h;m++)f[m]=arguments[m];return r.runHooks("afterModifyTransformEnd",...f)}).addLocalHook("beforeRowWrap",function(){for(var h=arguments.length,f=new Array(h),m=0;m<h;m++)f[m]=arguments[m];return r.runHooks("beforeRowWrap",...f)}).addLocalHook("beforeColumnWrap",function(){for(var h=arguments.length,f=new Array(h),m=0;m<h;m++)f[m]=arguments[m];return r.runHooks("beforeColumnWrap",...f)}).addLocalHook("insertRowRequire",h=>this.alter("insert_row_above",h,1,"auto")).addLocalHook("insertColRequire",h=>this.alter("insert_col_start",h,1,"auto")),c={alter(h,f){var m,T;let O=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,_=arguments.length>3?arguments[3]:void 0,Y=arguments.length>4?arguments[4]:void 0;const U=ie=>{if(ie.length===0)return[];const se=[...ie];return se.sort((de,Se)=>{let[pe]=de,[we]=Se;return pe===we?0:pe>we?1:-1}),en(se,(de,Se)=>{let[pe,we]=Se;const ee=de[de.length-1],[ye,$e]=ee,Pe=ye+$e;if(pe<=Pe){const Fe=Math.max(we-(Pe-pe),0);ee[1]+=Fe}else de.push([pe,we]);return de},[se[0]])};switch(h){case"insert_row_below":case"insert_row_above":const ie=s.countSourceRows();if(M.maxRows===ie)return;const se=h==="insert_row_below"?"below":"above";f=(m=f)!==null&&m!==void 0?m:se==="below"?ie:0;const{delta:oe,startPhysicalIndex:de}=l.createRow(f,O,{source:_,mode:se});if(oe){const $e=q.selectedRange.current(),Pe=$e==null?void 0:$e.from,Fe=Pe==null?void 0:Pe.row,xe=s.toVisualRow(de);if(q.isSelectedByCorner())q.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(be(Fe)&&Fe>=xe){const{row:R,col:A}=$e.to;let N=Pe.col;q.isSelectedByRowHeader()&&(N=-1),q.getSelectedRange().pop(),q.setRangeStartOnly(s._createCellCoords(Fe+oe,N),!0),q.setRangeEnd(s._createCellCoords(R+oe,A))}else s._refreshBorders()}break;case"insert_col_start":case"insert_col_end":const Se=h==="insert_col_end"?"end":"start";f=(T=f)!==null&&T!==void 0?T:Se==="end"?s.countSourceCols():0;const{delta:pe,startPhysicalIndex:we}=l.createCol(f,O,{source:_,mode:Se});if(pe){if(Array.isArray(M.colHeaders)){const R=[s.toVisualColumn(we),0];R.length+=pe,Array.prototype.splice.apply(M.colHeaders,R)}const $e=q.selectedRange.current(),Pe=$e==null?void 0:$e.from,Fe=Pe==null?void 0:Pe.col,xe=s.toVisualColumn(we);if(q.isSelectedByCorner())q.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(be(Fe)&&Fe>=xe){const{row:R,col:A}=$e.to;let N=Pe.row;q.isSelectedByColumnHeader()&&(N=-1),q.getSelectedRange().pop(),q.setRangeStartOnly(s._createCellCoords(N,Fe+pe),!0),q.setRangeEnd(s._createCellCoords(R,A+pe))}else s._refreshBorders()}break;case"remove_row":const ee=$e=>{let Pe=0;H($e,Fe=>{let[xe,R]=Fe;const A=hn(xe)?s.countRows()-1:Math.max(xe-Pe,0);if(Number.isInteger(xe)&&(xe=Math.max(xe-Pe,0)),!l.removeRow(xe,R,_))return;const J=s.countRows(),F=M.fixedRowsTop;F>=A+1&&(M.fixedRowsTop-=Math.min(R,F-A));const Q=M.fixedRowsBottom;Q&&A>=J-Q&&(M.fixedRowsBottom-=Math.min(R,Q)),Pe+=R})};Array.isArray(f)?ee(U(f)):ee([[f,O]]),c.adjustRowsAndCols(),s._refreshBorders();break;case"remove_col":const ye=$e=>{let Pe=0;H($e,Fe=>{let[xe,R]=Fe;const A=hn(xe)?s.countCols()-1:Math.max(xe-Pe,0);let N=s.toPhysicalColumn(A);if(Number.isInteger(xe)&&(xe=Math.max(xe-Pe,0)),!l.removeCol(xe,R,_))return;const F=M.fixedColumnsStart;F>=A+1&&(M.fixedColumnsStart-=Math.min(R,F-A)),Array.isArray(M.colHeaders)&&(typeof N>"u"&&(N=-1),M.colHeaders.splice(N,R)),Pe+=R})};Array.isArray(f)?ye(U(f)):ye([[f,O]]),c.adjustRowsAndCols(),s._refreshBorders();break;default:throw new Error(`There is no such action "${h}"`)}Y||c.adjustRowsAndCols()},adjustRowsAndCols(){const h=M.minRows,f=M.minSpareRows,m=M.minCols,T=M.minSpareCols;if(s.countRows()===0&&s.countCols()===0&&q.deselect(),h){const O=s.countRows();O<h&&l.createRow(O,h-O,{source:"auto"})}if(f){const O=s.countEmptyRows(!0);if(O<f){const _=f-O,Y=Math.min(_,M.maxRows-s.countSourceRows());l.createRow(s.countRows(),Y,{source:"auto"})}}{let O;(m||T)&&(O=s.countEmptyCols(!0));let _=s.countCols();if(m&&!M.columns&&_<m){const Y=m-_;O+=Y,l.createCol(_,Y,{source:"auto"})}if(T&&!M.columns&&s.dataType==="array"&&O<T){_=s.countCols();const Y=T-O,U=Math.min(Y,M.maxCols-_);l.createCol(_,U,{source:"auto"})}}if(q.isSelected()){const O=s.countRows(),_=s.countCols();H(q.selectedRange,Y=>{let U=!1,ie=Y.from.row,se=Y.from.col,oe=Y.to.row,de=Y.to.col;ie>O-1?(ie=O-1,U=!0,oe>ie&&(oe=ie)):oe>O-1&&(oe=O-1,U=!0,ie>oe&&(ie=oe)),se>_-1?(se=_-1,U=!0,de>se&&(de=se)):de>_-1&&(de=_-1,U=!0,se>de&&(se=de)),U&&s.selectCell(ie,se,oe,de)})}s.view&&s.view.adjustElementsSize()},populateFromArray(h,f,m,T,O){let _,Y,U,ie;const se=[],oe={},de=[],Se=h.row,pe=h.col;if(Y=f.length,Y===0)return!1;let we=0,ee=0;switch(Ke(m)&&(we=m.col-pe+1,ee=m.row-Se+1),O){case"shift_down":const ye=Mu(f),$e=ye.length,Pe=Math.max($e,we),Fe=s.getData().slice(Se),xe=Mu(Fe).slice(pe,pe+Pe);for(U=0;U<Pe;U+=1)if(U<$e){for(_=0,Y=ye[U].length;_<ee-Y;_+=1)ye[U].push(ye[U][_%Y]);U<xe.length?de.push(ye[U].concat(xe[U])):de.push(ye[U].concat(new Array(Fe.length).fill(null)))}else de.push(ye[U%$e].concat(xe[U]));s.populateFromArray(Se,pe,Mu(de));break;case"shift_right":const R=f.length,A=Math.max(R,ee),N=s.getData().slice(Se).map(ne=>ne.slice(pe));for(_=0;_<A;_+=1)if(_<R){for(U=0,ie=f[_].length;U<we-ie;U+=1)f[_].push(f[_][U%ie]);if(_<N.length)for(let ne=0;ne<N[_].length;ne+=1)f[_].push(N[_][ne]);else f[_].push(...new Array(N[0].length).fill(null))}else f.push(f[_%Y].slice(0,A).concat(N[_]));s.populateFromArray(Se,pe,f);break;case"overwrite":default:oe.row=h.row,oe.col=h.col;let J=0,F=0,Q=!0,K;const j=function(fe){let Te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const He=f[fe%f.length];return Te!==null?He[Te%He.length]:He},te=f.length,Z=m?m.row-h.row+1:0;for(m?Y=Z:Y=Math.max(te,Z),_=0;_<Y&&!(m&&oe.row>m.row&&Z>te||!M.allowInsertRow&&oe.row>s.countRows()-1||oe.row>=M.maxRows);_++){const ne=_-J,fe=j(ne).length,Te=m?m.col-h.col+1:0;if(m?ie=Te:ie=Math.max(fe,Te),oe.col=h.col,K=s.getCellMeta(oe.row,oe.col),(T==="CopyPaste.paste"||T==="Autofill.fill")&&K.skipRowOnPaste){J+=1,oe.row+=1,Y+=1;continue}for(F=0,U=0;U<ie&&!(m&&oe.col>m.col&&Te>fe||!M.allowInsertColumn&&oe.col>s.countCols()-1||oe.col>=M.maxCols);U++){if(K=s.getCellMeta(oe.row,oe.col),(T==="CopyPaste.paste"||T==="Autofill.fill")&&K.skipColumnOnPaste){F+=1,oe.col+=1,ie+=1;continue}if(K.readOnly&&T!=="UndoRedo.undo"){oe.col+=1;continue}const He=U-F;let ke=j(ne,He),ze=s.getDataAtCell(oe.row,oe.col);if(ke!==null&&typeof ke=="object")if(Array.isArray(ke)&&ze===null&&(ze=[]),ze===null||typeof ze!="object")Q=!1;else{const Tt=Ka(Array.isArray(ze)?ze:ze[0]||ze),et=Ka(Array.isArray(ke)?ke:ke[0]||ke);Cd(Tt,et)||Array.isArray(Tt)&&Array.isArray(et)?ke=kn(ke):Q=!1}else ze!==null&&typeof ze=="object"&&(Q=!1);Q&&se.push([oe.row,oe.col,ke]),Q=!0,oe.col+=1}oe.row+=1}s.setDataAtCell(se,null,null,T||"populateFromArray");break}}};function v(h){const f=HM(h);hS(f)?(s.runHooks("beforeLanguageChange",f),y.language=f,s.runHooks("afterLanguageChange",f)):DM(h)}function S(h,f){const m=h==="className"?s.rootElement:s.table;if(p)ce(m,f);else{let T=[],O=[];y[h]&&(T=Array.isArray(y[h])?y[h]:Jp(y[h])),f&&(O=Array.isArray(f)?f:Jp(f));const _=Qp(T,O),Y=Qp(O,T);_.length&&Ue(m,_),Y.length&&ce(m,Y)}y[h]=f}this.init=function(){u.setData(M.data),s.runHooks("beforeInit"),(po()||yw())&&ce(s.rootElement,"mobile"),this.updateSettings(M,!0),this.view=new j3(this),d=oz.getInstance(s,M,q),g=new lz(s),zd(this)&&qq(s),s.runHooks("init"),this.forceFullRender=!0,this.view.render(),p&&s.rootElement.offsetParent===null&&yT(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.render(),s.view.adjustElementsSize()}),typeof p=="object"&&(s.runHooks("afterChange",p[0],p[1]),p=!1),s.runHooks("afterInit")};function b(){let h=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,h=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&h===!1&&(h=!0,this.onQueueEmpty(this.valid))}}}function L(h){const f=h.replace(",",".");return isNaN(parseFloat(f))===!1?parseFloat(f):h}function P(h,f,m){if(!h.length)return;const T=s.getActiveEditor(),O=new b;let _=!0;O.onQueueEmpty=Y=>{T&&_&&T.cancelChanges(),m(Y)};for(let Y=h.length-1;Y>=0;Y--){const[U,ie,,se]=h[Y],oe=l.propToCol(ie),de=s.getCellMeta(U,oe);de.type==="numeric"&&typeof se=="string"&&c_(se)&&(h[Y][3]=L(se)),s.getCellValidator(de)&&(O.addValidatorToQueue(),s.validateCell(h[Y][3],de,function(Se,pe){return function(we){if(typeof we!="boolean")throw new Error("Validation error: result is not boolean");if(we===!1&&pe.allowInvalid===!1){_=!1,h.splice(Se,1),pe.valid=!0;const ee=s.getCell(pe.visualRow,pe.visualCol);ee!==null&&Ue(ee,M.invalidCellClassName)}O.removeValidatorFormQueue()}}(Y,de),f))}O.checkIfQueueIsEmpty()}function x(h,f){let m=h.length-1;if(m<0)return;for(;m>=0;m--){let O=!1;if(h[m]===null){h.splice(m,1);continue}if(!((h[m][2]===null||h[m][2]===void 0)&&(h[m][3]===null||h[m][3]===void 0))){if(M.allowInsertRow)for(;h[m][0]>s.countRows()-1;){const{delta:_}=l.createRow(void 0,void 0,{source:f});if(_===0){O=!0;break}}if(s.dataType==="array"&&(!M.columns||M.columns.length===0)&&M.allowInsertColumn)for(;l.propToCol(h[m][1])>s.countCols()-1;){const{delta:_}=l.createCol(void 0,void 0,{source:f});if(_===0){O=!0;break}}O||l.set(h[m][0],h[m][1],h[m][3])}}s.forceFullRender=!0,c.adjustRowsAndCols(),s.runHooks("beforeChangeRender",h,f),d.lockEditor(),s._refreshBorders(null),d.unlockEditor(),s.view.adjustElementsSize(),s.runHooks("afterChange",h,f||"edit");const T=s.getActiveEditor();T&&be(T.refreshValue)&&T.refreshValue()}this._createCellCoords=function(h,f){return s.view._wt.createCellCoords(h,f)},this._createCellRange=function(h,f,m){return s.view._wt.createCellRange(h,f,m)},this.validateCell=function(h,f,m,T){let O=s.getCellValidator(f);function _(Y){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||f.hidden===!0){m(Y);return}const ie=f.visualCol,se=f.visualRow,oe=s.getCell(se,ie,!0);if(oe&&oe.nodeName!=="TH"){const de=s.rowIndexMapper.getRenderableFromVisualIndex(se),Se=s.columnIndexMapper.getRenderableFromVisualIndex(ie);s.view._wt.getSetting("cellRenderer",de,Se,oe)}m(Y)}Q0(O)&&(O=function(Y){return function(U,ie){ie(Y.test(U))}}(O)),Ot(O)?(h=s.runHooks("beforeValidate",h,f.visualRow,f.prop,T),s._registerImmediate(()=>{O.call(f,h,Y=>{s&&(Y=s.runHooks("afterValidate",Y,h,f.visualRow,f.prop,T),f.valid=Y,_(Y),s.runHooks("postAfterValidate",Y,h,f.visualRow,f.prop,T))})})):s._registerImmediate(()=>{f.valid=!0,_(f.valid,!1)})};function W(h,f,m){return Array.isArray(h)?h:[[h,f,m]]}function D(h,f){const m=s.getActiveEditor(),T=s.runHooks("beforeChange",h,f||"edit"),O=h.filter(_=>_!==null);return T===!1||O.length===0?(m&&m.cancelChanges(),[]):O}this.setDataAtCell=function(h,f,m,T){const O=W(h,f,m),_=[];let Y=T,U,ie,se;for(U=0,ie=O.length;U<ie;U++){if(typeof O[U]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof O[U][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");O[U][1]>=this.countCols()?se=O[U][1]:se=l.colToProp(O[U][1]),_.push([O[U][0],se,u.getAtCell(this.toPhysicalRow(O[U][0]),O[U][1]),O[U][2]])}!Y&&typeof h=="object"&&(Y=f);const oe=D(_,T);s.runHooks("afterSetDataAtCell",oe,Y),P(oe,Y,()=>{x(oe,Y)})},this.setDataAtRowProp=function(h,f,m,T){const O=W(h,f,m),_=[];let Y=T,U,ie;for(U=0,ie=O.length;U<ie;U++)_.push([O[U][0],O[U][1],u.getAtCell(this.toPhysicalRow(O[U][0]),O[U][1]),O[U][2]]);!Y&&typeof h=="object"&&(Y=f);const se=D(_,T);s.runHooks("afterSetDataAtRowProp",se,Y),P(se,Y,()=>{x(se,Y)})},this.listen=function(){s&&!s.isListening()&&(_S.forEach(h=>{s!==h&&h.unlisten()}),TS=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(TS=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return TS===s.guid},this.destroyEditor=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;s._refreshBorders(h,f)},this.populateFromArray=function(h,f,m,T,O,_,Y){if(!(typeof m=="object"&&typeof m[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const U=typeof T=="number"?s._createCellCoords(T,O):null;return c.populateFromArray(s._createCellCoords(h,f),m,U,_,Y)},this.spliceCol=function(h,f,m){for(var T=arguments.length,O=new Array(T>3?T-3:0),_=3;_<T;_++)O[_-3]=arguments[_];return l.spliceCol(h,f,m,...O)},this.spliceRow=function(h,f,m){for(var T=arguments.length,O=new Array(T>3?T-3:0),_=3;_<T;_++)O[_-3]=arguments[_];return l.spliceRow(h,f,m,...O)},this.getSelected=function(){if(q.isSelected())return qe(q.getSelectedRange(),h=>{let{from:f,to:m}=h;return[f.row,f.col,m.row,m.col]})},this.getSelectedLast=function(){const h=this.getSelected();let f;return h&&h.length>0&&(f=h[h.length-1]),f},this.getSelectedRange=function(){if(q.isSelected())return Array.from(q.getSelectedRange())},this.getSelectedRangeLast=function(){const h=this.getSelectedRange();let f;return h&&h.length>0&&(f=h[h.length-1]),f},this.emptySelectedCells=function(h){if(!q.isSelected()||this.countRows()===0||this.countCols()===0)return;const f=[];H(q.getSelectedRange(),m=>{if(m.isSingleHeader())return;const T=m.getTopStartCorner(),O=m.getBottomEndCorner();Ie(T.row,O.row,_=>{Ie(T.col,O.col,Y=>{this.getCellMeta(_,Y).readOnly||f.push([_,Y,null])})})}),f.length>0&&this.setDataAtCell(f,h)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const h=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(h,0),!this.isRenderSuspended()&&h===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(d.lockEditor(),this._refreshBorders(null),d.unlockEditor()))},this.batchRender=function(h){this.suspendRender();const f=h();return this.resumeRender(),f},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const f=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(f,0),(!this.isExecutionSuspended()&&f===this.executionSuspendedCounter||h)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(h){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const m=h();return this.resumeExecution(f),m},this.batch=function(h){this.suspendRender(),this.suspendExecution();const f=h();return this.resumeExecution(),this.resumeRender(),f},this.refreshDimensions=function(){if(!s.view)return;const{width:h,height:f}=s.view.getLastSize(),{width:m,height:T}=s.rootElement.getBoundingClientRect(),O=m!==h||T!==f;s.runHooks("beforeRefreshDimensions",{width:h,height:f},{width:m,height:T},O)!==!1&&((O||s.view._wt.wtOverlays.scrollableElement===s.rootWindow)&&(s.view.setLastSize(m,T),s.render()),s.runHooks("afterRefreshDimensions",{width:h,height:f},{width:m,height:T},O))},this.updateData=function(h,f){fO(h,m=>{l=m},m=>{l=m,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),c.adjustRowsAndCols()},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"updateData",source:f,metaManager:I,firstRun:p})},this.loadData=function(h,f){fO(h,m=>{l=m},()=>{I.clearCellsCache(),s.initIndexMappers(),c.adjustRowsAndCols(),p&&(p=[null,"loadData"])},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"loadData",source:f,metaManager:I,firstRun:p})},this.getInitialColumnCount=function(){const h=M.columns;let f=0;if(Array.isArray(h))f=h.length;else if(Ot(h))if(s.dataType==="array"){const m=this.countSourceCols();for(let T=0;T<m;T+=1)h(T)&&(f+=1)}else(s.dataType==="object"||s.dataType==="function")&&(f=l.colToPropCache.length);else if(be(M.dataSchema)){const m=l.getSchema();f=Array.isArray(m)?m.length:Sd(m)}else f=this.countSourceCols();return f},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(h,f,m,T){return Mt(h)?l.getAll():l.getRange(s._createCellCoords(h,f),s._createCellCoords(m,T),l.DESTINATION_RENDERER)},this.getCopyableText=function(h,f,m,T){return l.getCopyableText(s._createCellCoords(h,f),s._createCellCoords(m,T))},this.getCopyableData=function(h,f){return l.getCopyable(h,l.colToProp(f))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(h){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const m=(p?s.loadData:s.updateData).bind(this);let T=!1,O,_;if(be(h.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(be(h.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(be(h.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(O in h)O==="data"||(O==="language"?v(h.language):O==="className"?S("className",h.className):O==="tableClassName"&&s.table?(S("tableClassName",h.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames()):_e.getSingleton().isRegistered(O)||_e.getSingleton().isDeprecated(O)?(Ot(h[O])||Array.isArray(h[O]))&&(h[O].initialHook=!0,s.addHook(O,h[O])):!f&&Vt(h,O)&&(y[O]=h[O]));h.data===void 0&&M.data===void 0?m(null,"updateSettings"):h.data!==void 0?m(h.data,"updateSettings"):h.columns!==void 0&&(l.createMap(),s.initIndexMappers());const Y=s.countCols(),U=M.columns;if(U&&Ot(U)&&(T=!0),(h.cell!==void 0||h.cells!==void 0||h.columns!==void 0)&&I.clearCache(),Y>0)for(O=0,_=0;O<Y;O++){if(U){const oe=T?U(O):U[_];oe&&I.updateColumnMeta(_,oe)}_+=1}be(h.cell)&&Ze(h.cell,oe=>{s.setCellMetaObject(oe.row,oe.col,oe)}),s.runHooks("afterCellMetaReset");let ie=s.rootElement.style.height;ie!==""&&(ie=parseInt(s.rootElement.style.height,10));let se=h.height;if(Ot(se)&&(se=se()),f&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style")),se===null){const oe=s.rootElement.getAttribute("data-initialstyle");oe&&(oe.indexOf("height")>-1||oe.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",oe):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else se!==void 0&&(s.rootElement.style.height=isNaN(se)?`${se}`:`${se}px`,s.rootElement.style.overflow="hidden");if(typeof h.width<"u"){let oe=h.width;Ot(oe)&&(oe=oe()),s.rootElement.style.width=isNaN(oe)?`${oe}`:`${oe}px`}f||(s.view&&(s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames()),s.runHooks("afterUpdateSettings",h)),c.adjustRowsAndCols(),s.view&&!p&&(s.forceFullRender=!0,d.lockEditor(),s._refreshBorders(null),s.view._wt.wtOverlays.adjustElementsSize(),d.unlockEditor()),!f&&s.view&&(ie===""||se===""||se===void 0)&&ie!==se&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const h=s.getSelectedLast();if(M.getValue){if(Ot(M.getValue))return M.getValue.call(s);if(h)return s.getData()[h[0][0]][M.getValue]}else if(h)return s.getDataAtCell(h[0],h[1])},this.getSettings=function(){return M},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(h,f,m,T,O){c.alter(h,f,m,T,O)},this.getCell=function(h,f){let m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,T=f,O=h;if(f>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(f)))return null;T=this.columnIndexMapper.getRenderableFromVisualIndex(f)}if(h>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(h)))return null;O=this.rowIndexMapper.getRenderableFromVisualIndex(h)}return O===null||T===null?null:s.view.getCellAtCoords(s._createCellCoords(O,T),m)},this.getCoords=function(h){const f=this.view._wt.wtTable.getCoords(h);if(f===null)return null;const{row:m,col:T}=f;let O=m,_=T;return m>=0&&(O=this.rowIndexMapper.getVisualFromRenderableIndex(m)),T>=0&&(_=this.columnIndexMapper.getVisualFromRenderableIndex(T)),s._createCellCoords(O,_)},this.colToProp=function(h){return l.colToProp(h)},this.propToCol=function(h){return l.propToCol(h)},this.toVisualRow=h=>this.rowIndexMapper.getVisualFromPhysicalIndex(h),this.toVisualColumn=h=>this.columnIndexMapper.getVisualFromPhysicalIndex(h),this.toPhysicalRow=h=>this.rowIndexMapper.getPhysicalFromVisualIndex(h),this.toPhysicalColumn=h=>this.columnIndexMapper.getPhysicalFromVisualIndex(h),this.getDataAtCell=function(h,f){return l.get(h,l.colToProp(f))},this.getDataAtRowProp=function(h,f){return l.get(h,f)},this.getDataAtCol=function(h){const f=[],m=l.getRange(s._createCellCoords(0,h),s._createCellCoords(M.data.length-1,h),l.DESTINATION_RENDERER);for(let T=0;T<m.length;T+=1)for(let O=0;O<m[T].length;O+=1)f.push(m[T][O]);return f},this.getDataAtProp=function(h){const f=[],m=l.getRange(s._createCellCoords(0,l.propToCol(h)),s._createCellCoords(M.data.length-1,l.propToCol(h)),l.DESTINATION_RENDERER);for(let T=0;T<m.length;T+=1)for(let O=0;O<m[T].length;O+=1)f.push(m[T][O]);return f},this.getSourceData=function(h,f,m,T){let O;return h===void 0?O=u.getData():O=u.getByRange(s._createCellCoords(h,f),s._createCellCoords(m,T)),O},this.getSourceDataArray=function(h,f,m,T){let O;return h===void 0?O=u.getData(!0):O=u.getByRange(s._createCellCoords(h,f),s._createCellCoords(m,T),!0),O},this.getSourceDataAtCol=function(h){return u.getAtColumn(h)},this.setSourceDataAtCell=function(h,f,m,T){const O=W(h,f,m),_=this.hasHook("afterSetSourceDataAtCell"),Y=[];_&&H(O,ie=>{let[se,oe,de]=ie;Y.push([se,oe,u.getAtCell(se,oe),de])}),H(O,ie=>{let[se,oe,de]=ie;u.setAtCell(se,oe,de)}),_&&this.runHooks("afterSetSourceDataAtCell",Y,T),this.render();const U=s.getActiveEditor();U&&be(U.refreshValue)&&U.refreshValue()},this.getSourceDataAtRow=function(h){return u.getAtRow(h)},this.getSourceDataAtCell=function(h,f){return u.getAtCell(h,f)},this.getDataAtRow=function(h){return l.getRange(s._createCellCoords(h,0),s._createCellCoords(h,this.countCols()-1),l.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(h,f,m,T){const O=h===void 0?[0,0,this.countRows(),this.countCols()]:[h,f,m,T],[_,Y]=O;let[,,U,ie]=O,se=null,oe=null;U===void 0&&(U=_),ie===void 0&&(ie=Y);let de="mixed";return Ie(Math.max(Math.min(_,U),0),Math.max(_,U),Se=>{let pe=!0;return Ie(Math.max(Math.min(Y,ie),0),Math.max(Y,ie),we=>(oe=this.getCellMeta(Se,we).type,se?pe=se===oe:se=oe,pe)),de=pe?oe:"mixed",pe}),de},this.removeCellMeta=function(h,f,m){const[T,O]=[this.toPhysicalRow(h),this.toPhysicalColumn(f)];let _=I.getCellMetaKeyValue(T,O,m);s.runHooks("beforeRemoveCellMeta",h,f,m,_)!==!1&&(I.removeCellMeta(T,O,m),s.runHooks("afterRemoveCellMeta",h,f,m,_)),_=null},this.spliceCellsMeta=function(h){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var m=arguments.length,T=new Array(m>2?m-2:0),O=2;O<m;O++)T[O-2]=arguments[O];if(T.length>0&&!Array.isArray(T[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");f>0&&I.removeRow(this.toPhysicalRow(h),f),T.length>0&&H(T.reverse(),_=>{I.createRow(this.toPhysicalRow(h)),H(_,(Y,U)=>this.setCellMetaObject(h,U,Y))}),s.render()},this.setCellMetaObject=function(h,f,m){typeof m=="object"&&Ze(m,(T,O)=>{this.setCellMeta(h,f,O,T)})},this.setCellMeta=function(h,f,m,T){if(s.runHooks("beforeSetCellMeta",h,f,m,T)===!1)return;let _=h,Y=f;h<this.countRows()&&(_=this.toPhysicalRow(h)),f<this.countCols()&&(Y=this.toPhysicalColumn(f)),I.setCellMeta(_,Y,m,T),s.runHooks("afterSetCellMeta",h,f,m,T)},this.getCellsMeta=function(){return I.getCellsMeta()},this.getCellMeta=function(h,f){let m=this.toPhysicalRow(h),T=this.toPhysicalColumn(f);return m===null&&(m=h),T===null&&(T=f),I.getCellMeta(m,T,{visualRow:h,visualColumn:f})},this.getCellMetaAtRow=function(h){return I.getCellsMetaAtRow(h)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||M.columns)},this.getCellRenderer=function(h,f){const m=typeof h=="number"?s.getCellMeta(h,f).renderer:h.renderer;return typeof m=="string"?Dd(m):Mt(m)?Dd("text"):m},this.getCellEditor=function(h,f){const m=typeof h=="number"?s.getCellMeta(h,f).editor:h.editor;return typeof m=="string"?Rd(m):Mt(m)?Rd("text"):m},this.getCellValidator=function(h,f){const m=typeof h=="number"?s.getCellMeta(h,f).validator:h.validator;return typeof m=="string"?kw(m):m},this.validateCells=function(h){this._validateCells(h)},this.validateRows=function(h,f){if(!Array.isArray(h))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(f,h)},this.validateColumns=function(h,f){if(!Array.isArray(h))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(f,void 0,h)},this._validateCells=function(h,f,m){const T=new b;h&&(T.onQueueEmpty=h);let O=s.countRows()-1;for(;O>=0;){if(f!==void 0&&f.indexOf(O)===-1){O-=1;continue}let _=s.countCols()-1;for(;_>=0;){if(m!==void 0&&m.indexOf(_)===-1){_-=1;continue}T.addValidatorToQueue(),s.validateCell(s.getDataAtCell(O,_),s.getCellMeta(O,_),Y=>{if(typeof Y!="boolean")throw new Error("Validation error: result is not boolean");Y===!1&&(T.valid=!1),T.removeValidatorFormQueue()},"validateCells"),_-=1}O-=1}T.checkIfQueueIsEmpty()},this.getRowHeader=function(h){let f=M.rowHeaders,m=h;return m!==void 0&&(m=s.runHooks("modifyRowHeader",m)),m===void 0?(f=[],Ie(s.countRows()-1,T=>{f.push(s.getRowHeader(T))})):Array.isArray(f)&&f[m]!==void 0?f=f[m]:Ot(f)?f=f(m):f&&typeof f!="string"&&typeof f!="number"&&(f=m+1),f},this.hasRowHeaders=function(){return!!M.rowHeaders},this.hasColHeaders=function(){if(M.colHeaders!==void 0&&M.colHeaders!==null)return!!M.colHeaders;for(let h=0,f=s.countCols();h<f;h++)if(s.getColHeader(h))return!0;return!1},this.getColHeader=function(h){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const m=s.runHooks("modifyColHeader",h);if(m===void 0){const U=[],ie=s.countCols();for(let se=0;se<ie;se++)U.push(s.getColHeader(se));return U}let T=M.colHeaders;const O=function(U){const ie=[],se=s.countCols();let oe=0;for(;oe<se;oe++)Ot(M.columns)&&M.columns(oe)&&ie.push(oe);return ie[U]},_=s.toPhysicalColumn(m),Y=O(_);return M.colHeaders===!1?T=null:M.columns&&Ot(M.columns)&&M.columns(Y)&&M.columns(Y).title?T=M.columns(Y).title:M.columns&&M.columns[_]&&M.columns[_].title?T=M.columns[_].title:Array.isArray(M.colHeaders)&&M.colHeaders[_]!==void 0?T=M.colHeaders[_]:Ot(M.colHeaders)?T=M.colHeaders(_):M.colHeaders&&typeof M.colHeaders!="string"&&typeof M.colHeaders!="number"&&(T=Xd(m)),T=s.runHooks("modifyColumnHeaderValue",T,h,f),T},this._getColWidthFromSettings=function(h){let f;if(h>=0&&(f=s.getCellMeta(0,h).width),(f===void 0||f===M.width)&&(f=M.colWidths),f!=null){switch(typeof f){case"object":f=f[h];break;case"function":f=f(h);break}typeof f=="string"&&(f=parseInt(f,10))}return f},this.getColWidth=function(h){let f=s._getColWidthFromSettings(h);return f=s.runHooks("modifyColWidth",f,h),f===void 0&&(f=Gw.DEFAULT_WIDTH),f},this._getRowHeightFromSettings=function(h){let f=M.rowHeights;if(f!=null){switch(typeof f){case"object":f=f[h];break;case"function":f=f(h);break}typeof f=="string"&&(f=parseInt(f,10))}return f},this.getRowHeight=function(h){let f=s._getRowHeightFromSettings(h);return f=s.runHooks("modifyRowHeight",f,h),f},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){const h=M.maxCols,f=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(h,f)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,f=0;return xd(s.countRows()-1,m=>{if(s.isEmptyRow(m))f+=1;else if(h===!0)return!1}),f},this.countEmptyCols=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,f=0;return xd(s.countCols()-1,m=>{if(s.isEmptyCol(m))f+=1;else if(h===!0)return!1}),f},this.isEmptyRow=function(h){return M.isEmptyRow.call(s,h)},this.isEmptyCol=function(h){return M.isEmptyCol.call(s,h)},this.selectCell=function(h,f,m,T){let O=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,_=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Mt(h)||Mt(f)?!1:this.selectCells([[h,f,m,T]],O,_)},this.selectCells=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;f===!1&&(o=!0);const T=q.selectCells(h);return T&&m&&s.listen(),o=!1,T},this.selectColumns=function(h){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h,m=arguments.length>2?arguments[2]:void 0;return q.selectColumns(h,f,m)},this.selectRows=function(h){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h,m=arguments.length>2?arguments[2]:void 0;return q.selectRows(h,f,m)},this.deselectCell=function(){q.deselect()},this.selectAll=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h,m=arguments.length>2?arguments[2]:void 0;o=!0,q.selectAll(h,f,m),o=!1};const B=(h,f)=>h.getNearestNotHiddenIndex(f,1,!0);this.scrollViewportTo=function(h){var f;if(typeof h=="number"){var m;h={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(m=arguments[4])!==null&&m!==void 0?m:!0}}const{row:T,col:O,verticalSnap:_,horizontalSnap:Y,considerHiddenIndexes:U}=(f=h)!==null&&f!==void 0?f:{};let ie,se,oe,de;_!==void 0&&(ie=_==="top",se=!ie),Y!==void 0&&(oe=Y==="start",de=!oe);let Se=T,pe=O;if(U===void 0||U){const ye=Number.isInteger(T)&&T>=0,$e=Number.isInteger(O)&&O>=0,Pe=ye?B(this.rowIndexMapper,T):void 0,Fe=$e?B(this.columnIndexMapper,O):void 0;if(Pe===null||Fe===null)return!1;Se=ye?s.rowIndexMapper.getRenderableFromVisualIndex(Pe):T,pe=$e?s.columnIndexMapper.getRenderableFromVisualIndex(Fe):O}const we=Number.isInteger(Se),ee=Number.isInteger(pe);return we&&Se>=0&&ee&&pe>=0?s.view.scrollViewport(s._createCellCoords(Se,pe),ie,de,se,oe):we&&Se>=0&&(ee&&pe<0||!ee)?s.view.scrollViewportVertically(Se,ie,se):ee&&pe>=0&&(we&&Se<0||!we)?s.view.scrollViewportHorizontally(pe,de,oe):!1},this.scrollToFocusedCell=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",h);const{highlight:f}=this.getSelectedRangeLast();this.scrollViewportTo(f.toObject())?this.view.render():(this.removeHook("afterScroll",h),this._registerImmediate(()=>h()))},this.destroy=function(){if(s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),u&&u.destroy(),u=null,this.getShortcutManager().destroy(),I.clearCache(),_S.delete(this.guid),zd(s)){const h=this.rootDocument.querySelector(".hot-display-license-info");h&&h.parentNode.removeChild(h)}ii(s.rootElement),a.destroy(),d&&d.destroy(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),$.getItems().forEach(h=>{let[,f]=h;f.destroy()}),$.clear(),s.runHooks("afterDestroy")},!0),_e.getSingleton().destroy(s),Ze(s,(h,f,m)=>{Ot(h)?m[f]=z(f):f!=="guid"&&(m[f]=null)}),s.isDestroyed=!0,l&&l.destroy(),l=null,c=null,q=null,d=null,s=null};function z(h){return()=>{throw new Error(`The "${h}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return d.getActiveEditor()},this.getPlugin=function(h){const f=$n(h);return f==="UndoRedo"?this.undoRedo:$.getItem(f)},this.getPluginName=function(h){return h===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:$.getId(h)},this.getInstance=function(){return s},this.addHook=function(h,f){_e.getSingleton().add(h,f,s)},this.hasHook=function(h){return _e.getSingleton().has(h,s)||_e.getSingleton().has(h)},this.addHookOnce=function(h,f){_e.getSingleton().once(h,f,s)},this.removeHook=function(h,f){_e.getSingleton().remove(h,f,s)},this.runHooks=function(h,f,m,T,O,_,Y){return _e.getSingleton().run(s,h,f,m,T,O,_,Y)},this.getTranslatedPhrase=function(h,f){return WM(M.language,h,f)},this.toHTML=()=>Pw(this),this.toTableElement=()=>{const h=this.rootDocument.createElement("div");return h.insertAdjacentHTML("afterbegin",Pw(this)),h.firstElementChild},this.timeouts=[],this._registerTimeout=function(h){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,m=h;typeof m=="function"&&(m=setTimeout(m,f)),this.timeouts.push(m)},this._clearTimeouts=function(){H(this.timeouts,h=>{clearTimeout(h)})},this.immediates=[],this._registerImmediate=function(h){this.immediates.push(setImmediate(h))},this._clearImmediates=function(){H(this.immediates,h=>{clearImmediate(h)})},this._refreshBorders=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;d.destroyEditor(h),s.view.render(),f&&q.isSelected()&&d.prepareEditor()},this._getEditorManager=function(){return d},this.isRtl=function(){return s.rootWindow.getComputedStyle(s.rootElement).direction==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1};const w=r6({handleEvent(){return s.isListening()},beforeKeyDown:h=>this.runHooks("beforeKeyDown",h),afterKeyDown:h=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",h)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",h=>{h.ctrlKey===!1&&h.metaKey===!1&&w.releasePressedKeys()}),this.getShortcutManager=function(){return w},this.getFocusManager=function(){return g},$w().forEach(h=>{const f=Uu(h);$.addItem(h,new f(this))}),Kq(s),w.setActiveContextName("grid"),_e.getSingleton().run(s,"construct")}const i6="hooksRefRegisterer",TO={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){H(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Ze(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};Pi(TO,"MIXIN_NAME",i6,{writable:!1,enumerable:!1});const o6=TO;function hi(t,e,n){return e=s6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s6(t){var e=a6(t,"string");return typeof e=="symbol"?e:String(e)}function a6(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const l6="base",gn=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),MS="baseEditor";class ul{static get EDITOR_TYPE(){return l6}constructor(e){hi(this,"hot",void 0),hi(this,"state",gn.VIRGIN),hi(this,"_opened",!1),hi(this,"_fullEditMode",!1),hi(this,"_closeCallback",null),hi(this,"TD",null),hi(this,"row",null),hi(this,"col",null),hi(this,"prop",null),hi(this,"originalValue",null),hi(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,r,i,o,s){this.TD=i,this.row=e,this.col=n,this.prop=r,this.originalValue=o,this.cellProperties=s,this.state=gn.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let r,i,o,s;if(n){const d=this.hot.getSelectedLast();r=Math.max(Math.min(d[0],d[2]),0),i=Math.max(Math.min(d[1],d[3]),0),o=Math.max(d[0],d[2]),s=Math.max(d[1],d[3])}else[r,i,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",r,i);Array.isArray(a)&&([r,i]=a);const u=this.hot.getShortcutManager().getContext("editor"),c={runOnlyIf:()=>be(this.hot.getSelected()),group:MS};this.isInFullEditMode()&&u.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],c),this.hot.populateFromArray(r,i,e,o,s,"edit")}beginEditing(e,n){if(this.state!==gn.VIRGIN)return;const r=this.hot,i=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=r.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(r.view.scrollViewport(r._createCellCoords(i,o)),this.state=gn.EDITING,this.isInFullEditMode()){const s=typeof e=="string"?e:Yt(this.originalValue);this.setValue(s)}this.open(n),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(e,n,r){let i;if(r){const a=this._closeCallback;this._closeCallback=l=>{a&&a(l),r(l),this.hot.view.render()}}if(this.isWaiting())return;const s=this.hot.getShortcutManager().getContext("editor");if(s.removeShortcutsByGroup(MS),s.removeShortcutsByGroup(Td),this.state===gn.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===gn.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const a=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof a=="string"?String.prototype.trim.call(a||""):a]]:i=[[a]],this.state=gn.WAITING,this.saveValue(i,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",l=>{this.state=gn.FINISHED,this.discardEditor(l)}):(this.state=gn.FINISHED,this.discardEditor(!0))}}cancelChanges(){this.state=gn.FINISHED,this.discardEditor()}discardEditor(e){this.state===gn.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=gn.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=gn.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===gn.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:r,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=sn(n),a=yt(n),l=sn(this.hot.rootElement),u=yt(this.hot.rootElement),c=r.topOverlay.holder,d=r.inlineStartOverlay.holder,g=c!==o?c.scrollTop:0,p=d!==o?d.scrollLeft:0,C=o.innerWidth-l.left-u,{wtTable:E}=(e=r.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,I=E.name,M=["master","inline_start"].includes(I)?g:0,y=["master","top","bottom"].includes(I)?p:0,$=s.top===l.top?0:1;let X=s.top-l.top-$-M,G=0;this.hot.isRtl()?G=o.innerWidth-s.left-a-C-1+y:G=s.left-l.left-1-y,["top","top_inline_start_corner"].includes(I)&&(X+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(I)&&(G+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const q=this.hot.hasColHeaders(),re=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),v=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),b=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(q&&re<=0||re===b)&&(X+=1),v<=0&&(G+=1);const L=i.rowsRenderCalculator.startPosition,P=i.columnsRenderCalculator.startPosition,x=Math.abs(r.inlineStartOverlay.getScrollPosition()),W=r.topOverlay.getScrollPosition(),D=wn(this.hot.rootDocument);let B=n.offsetTop;if(["inline_start","master"].includes(I)&&(B+=L-W),["bottom","bottom_inline_start_corner"].includes(I)){const{wtViewport:se,wtTable:oe}=r.bottomOverlay.clone;B+=se.getWorkspaceHeight()-oe.getHeight()-D}let z=n.offsetLeft;this.hot.isRtl()?(z>=0?z=E.getWidth()-n.offsetLeft:z=Math.abs(z),z+=P-x-a):["top","master","bottom"].includes(I)&&(z+=P-x);const w=ho(this.TD,this.hot.rootWindow),h=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",f=parseInt(w[h],10)>0?0:1,m=parseInt(w.borderTopWidth,10)>0?0:1,T=yt(n)+f,O=Wt(n)+m,_=vT(c)?D:0,Y=ST(d)?D:0,U=this.hot.view.maximumVisibleElementWidth(z)-_+f,ie=Math.max(this.hot.view.maximumVisibleElementHeight(B)-Y+m,23);return{top:X,start:G,height:O,maxHeight:ie,width:T,maxWidth:U}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}Et(ul,o6);function _O(t,e,n){t.addEventListener(e,n,!1)}function MO(t,e,n){t.removeEventListener(e,n,!1)}function OO(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function u6(t){const e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},n=t.body,r=t.createTextNode(""),i=t.createElement("span");let o;function s(){r.textContent=o.value,i.style.position="absolute",i.style.fontSize=OO(o).fontSize,i.style.fontFamily=OO(o).fontFamily,i.style.whiteSpace="pre",n.appendChild(i);const c=i.clientWidth+2;n.removeChild(i);const d=o.style;d.height=`${e.minHeight}px`,e.minWidth>c?d.width=`${e.minWidth}px`:c>e.maxWidth?d.width=`${e.maxWidth}px`:d.width=`${c}px`;const g=o.scrollHeight?o.scrollHeight-1:0;e.minHeight>g?d.height=`${e.minHeight}px`:e.maxHeight<g?(d.height=`${e.maxHeight}px`,d.overflowY="visible"):d.height=`${g}px`}function a(){t.defaultView.setTimeout(s,0)}function l(c){if(c&&c.minHeight)if(c.minHeight==="inherit")e.minHeight=o.clientHeight;else{const d=parseInt(c.minHeight,10);isNaN(d)||(e.minHeight=d)}if(c&&c.maxHeight)if(c.maxHeight==="inherit")e.maxHeight=o.clientHeight;else{const d=parseInt(c.maxHeight,10);isNaN(d)||(e.maxHeight=d)}if(c&&c.minWidth)if(c.minWidth==="inherit")e.minWidth=o.clientWidth;else{const d=parseInt(c.minWidth,10);isNaN(d)||(e.minWidth=d)}if(c&&c.maxWidth)if(c.maxWidth==="inherit")e.maxWidth=o.clientWidth;else{const d=parseInt(c.maxWidth,10);isNaN(d)||(e.maxWidth=d)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(r))}function u(c,d){let g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;o=c,l(d),o.nodeName==="TEXTAREA"&&(o.style.resize="none",o.style.overflowY="",o.style.height=`${e.minHeight}px`,o.style.minWidth=`${e.minWidth}px`,o.style.maxWidth=`${e.maxWidth}px`,o.style.overflowY="hidden"),g&&(_O(o,"input",s),_O(o,"keydown",a)),s()}return{init:u,resize:s,unObserve(){MO(o,"input",s),MO(o,"keydown",a)}}}function AO(t,e){const n=hw(e),r=e.value.split(`
`);let i=n,o=0;for(let s=0;s<r.length;s++){const a=r[s];s!==0&&(o+=r[s-1].length+1);const l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),n<=l)break}Lu(e,i)}function na(t,e,n){return e=c6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c6(t){var e=h6(t,"string");return typeof e=="symbol"?e:String(e)}function h6(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const d6="ht_editor_visible",Cf="ht_editor_hidden",IO="textEditor",f6="text";class ra extends ul{static get EDITOR_TYPE(){return f6}constructor(e){super(e),na(this,"eventManager",new br(this)),na(this,"autoResize",u6(this.hot.rootDocument)),na(this,"TEXTAREA",void 0),na(this,"textareaStyle",void 0),na(this,"TEXTAREA_PARENT",void 0),na(this,"textareaParentStyle",void 0),na(this,"layerClass",void 0),this.eventManager=new br(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),dT(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,n,r,i,o,s){const a=this.state;if(super.prepare(e,n,r,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&(this.TEXTAREA.value=""),a!==gn.FINISHED&&this.hideEditableElement()}}beginEditing(e,n){this.state===gn.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),Lu(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Le(this.TEXTAREA,[["data-hot-input",""],za(-1)]),this.hot.getSettings().ariaTags&&Le(this.TEXTAREA,[co()]),ce(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),ce(this.TEXTAREA_PARENT,"handsontableInputHolder"),We(this.TEXTAREA_PARENT,this.layerClass)&&Ue(this.TEXTAREA_PARENT,this.layerClass),ce(this.TEXTAREA_PARENT,Cf),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){YT()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Ue(this.TEXTAREA_PARENT,this.layerClass),ce(this.TEXTAREA_PARENT,Cf)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;Ie(e.length-1,r=>{const i=e[r];if(We(i,"handsontableEditor"))return n=!0,!1}),We(this.TEXTAREA_PARENT,Cf)&&Ue(this.TEXTAREA_PARENT,Cf),n?(this.layerClass=d6,ce(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),ce(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==gn.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:r,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const l=ho(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const u=ho(this.TEXTAREA),c=parseInt(u.paddingLeft,10)+parseInt(u.paddingRight,10),d=parseInt(u.paddingTop,10)+parseInt(u.paddingBottom,10),g=i-c,p=s-d,C=o-c,E=a-d;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(g,C),minHeight:Math.min(p,E),maxWidth:C,maxHeight:E},!0)}bindEvents(){Sw()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===gn.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===gn.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("editor"),r=e.getContext("grid"),i={runOnlyIf:()=>be(this.hot.getSelected()),group:IO},o=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Tab"],["Shift","Tab"],["PageUp"],["PageDown"]],forwardToContext:r,callback:()=>{}},{keys:[["Control","Enter"]],callback:()=>(o(),!1),runOnlyIf:s=>!this.hot.selection.isMultiple()&&!s.altKey},{keys:[["Meta","Enter"]],callback:()=>(o(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(o(),!1)},{keys:[["Home"]],callback:(s,a)=>{let[l]=a;AO(l,this.TEXTAREA)}},{keys:[["End"]],callback:(s,a)=>{let[l]=a;AO(l,this.TEXTAREA)}}],i)}unregisterShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");n.removeShortcutsByGroup(Td),n.removeShortcutsByGroup(IO),n.removeShortcutsByGroup(MS)}}const g6="base";function lc(t,e,n,r,i,o,s){const a=s.ariaTags,l=[],u=[],c=[],d=[];s.className&&ce(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&d.push(uT())):a&&c.push(uT()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&d.push(cT())):(u.push(s.invalidCellClassName),a&&c.push(cT()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),Ue(e,u),ce(e,l),Us(e,c),Le(e,d)}lc.RENDERER_TYPE=g6;const m6="text";function Eo(t,e,n,r,i,o,s){lc.apply(this,[t,e,n,r,i,o,s]);let a=o;if(!a&&s.placeholder&&(a=s.placeholder),a=Yt(a),s.trimWhitespace&&(a=a.trim()),s.rendererTemplate){ii(e);const l=t.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=s.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=t.getSourceDataAtRow(n),e.appendChild(l)}else es(e,a)}Eo.RENDERER_TYPE=m6;const PO={CELL_TYPE:"text",editor:ra,renderer:Eo};Vr(PO),Be.editors={BaseEditor:ul};function Be(t,e){const n=new EO(t,e||{},RC);return n.init(),n}Be.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new EO(t,e,RC)},Be.DefaultSettings=aO(),Be.hooks=_e.getSingleton(),Be.CellCoords=Fd,Be.CellRange=qw,Be.packageName="handsontable",Be.buildDate="30/11/2023 10:10:40",Be.version="14.0.0",Be.languages={dictionaryKeys:NX,getLanguageDictionary:FM,getLanguagesDictionaries:WX,registerLanguageDictionary:kM,getTranslatedPhrase:WM};const xO="handsontableEditor",p6="handsontable";class OS extends ra{static get EDITOR_TYPE(){return p6}open(){super.open(),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Lu(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,afterOnCellMouseDown(u,c){const d=this.getSourceData(c.row,c.col);d!==void 0&&a.setValue(d),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&an(l,s.handsontable),this.htOptions=l}beginEditing(e,n){const r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,n,r)}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const r={group:xO,relativeToGroup:Td,position:"before"},i=(o,s)=>{const a=this.htEditor;if(o!==void 0&&(o<0||a.flipped&&o>a.countRows()-1?a.deselectCell():a.selectCell(o,0),a.getData().length))return s.preventDefault(),Lr(s),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const s=this.htEditor;let a,l;return!s.getSelectedLast()&&s.flipped?a=s.countRows()-1:s.getSelectedLast()&&(s.flipped?(l=s.getSelectedLast()[0],a=Math.max(0,l-1)):(l=s.getSelectedLast()[0],a=l-1)),i(a,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const s=this.htEditor;let a,l;if(!s.getSelectedLast()&&!s.flipped)a=0;else if(s.getSelectedLast()){if(s.flipped)a=s.getSelectedLast()[0]+1;else if(!s.flipped){const u=s.countRows()-1;l=s.getSelectedLast()[0],a=Math.min(u,l+1)}}return i(a,o)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(xO)}}function w6(t,e,n){C6(t,e),e.set(t,n)}function C6(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vf(t,e,n){return e=v6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function v6(t){var e=S6(t,"string");return typeof e=="symbol"?e:String(e)}function S6(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function HO(t,e){var n=y6(t,e,"get");return b6(t,n)}function y6(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function b6(t,e){return e.get?e.get.call(t):e.value}const R6="autocomplete";var AS=new WeakMap;class IS extends OS{constructor(){super(...arguments),vf(this,"query",null),vf(this,"strippedChoices",[]),vf(this,"rawChoices",[]),w6(this,AS,{writable:!0,value:this.hot.guid.slice(0,9)}),vf(this,"sortByRelevance",function(e,n,r){const i=[],o=[],s=e.length;let a=n.length,l,u,c,d;if(s===0){for(c=0;c<a;c++)o.push(c);return o}for(c=0;c<a;c++){if(u=iw(Yt(n[c])),r)d=u.indexOf(e);else{const g=this.cellProperties.locale;d=u.toLocaleLowerCase(g).indexOf(e.toLocaleLowerCase(g))}d!==-1&&(l=u.length-d-s,i.push({baseIndex:c,index:d,charsLeft:l,value:u}))}for(i.sort((g,p)=>{if(p.index===-1)return-1;if(g.index===-1)return 1;if(g.index<p.index)return-1;if(p.index<g.index)return 1;if(g.index===p.index){if(g.charsLeft<p.charsLeft)return-1;if(g.charsLeft>p.charsLeft)return 1}return 0}),c=0,a=i.length;c<a;c++)o.push(i[c].baseIndex);return o})}static get EDITOR_TYPE(){return R6}getValue(){const e=this.rawChoices.find(n=>this.stripValueIfNeeded(n)===this.TEXTAREA.value);return be(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),ce(this.htContainer,"autocompleteEditor"),ce(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&Le(this.TEXTAREA,[GY(),WY(),sT("listbox"),qY()])}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.hot.getSettings().ariaTags&&Le(this.TEXTAREA,[Dr("false"),ZY(`${HO(this,AS)}-listbox-${e}-${n}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,r=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=r==null?void 0:r.length,{row:o,col:s}=this;this.showEditableElement(),this.focus();let a=wn();a===0&&Wu()&&(a+=15),this.addHook("beforeKeyDown",l=>this.onBeforeKeyDown(l)),this.htEditor.updateSettings({colWidths:e?[yt(this.TEXTAREA)-2]:void 0,width:e?yt(this.TEXTAREA)+a:void 0,autoColumnSize:!0,renderer:(l,u,c,d,g,p,C)=>{Eo(l,u,c,d,g,p,C);const{filteringCaseSensitive:E,allowHtml:I,locale:M}=this.cellProperties,y=this.query;let $=Yt(p),X,G;$&&!I&&(X=E===!0?$.indexOf(y):$.toLocaleLowerCase(M).indexOf(y.toLocaleLowerCase(M)),X!==-1&&(G=$.substr(X,y.length),$=$.replace(G,`<strong>${G}</strong>`))),n&&Le(u,[VY(),...r?[tG(i)]:[],...r?[nG(r.indexOf(p)+1)]:[],["id",`${this.htEditor.rootElement.id}_${c}-${d}`]]),u.innerHTML=$},afterSelection:(l,u)=>{if(n){const c=this.htEditor.getCell(l,u,!0);Le(c,[lw()]),Le(this.TEXTAREA,...QY(c.id))}}}),n&&(Le(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...Ii()),Le(this.htEditor.rootElement,[oT(),JY("polite"),eG("text"),["id",`${HO(this,AS)}-listbox-${o}-${s}`]]),Le(this.TEXTAREA,...Dr("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&Le(this.TEXTAREA,[Dr("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=hw(this.TEXTAREA),r=CT(this.TEXTAREA),i=this.cellProperties.sortByRelevance,o=this.cellProperties.filter;let s=null,a=null,l=e;i&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(s)?s.length:0;if(o===!1)u&&(a=s[0]);else{const c=[];for(let d=0,g=l.length;d<g&&!(i&&u<=d);d++)u?c.push(l[s[d]]):c.push(l[d]);a=0,l=c}this.strippedChoices=l,this.htEditor.loadData(Mu([l])),l.length===0?this.htEditor.rootElement.style.display="none":(this.htEditor.rootElement.style.display="",this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),Lu(this.TEXTAREA,n,n===r?void 0:r)}flipDropdownIfNeeded(){const e=Gs(this.hot.view._wt.wtTable.TABLE),n=e===this.hot.rootWindow,r=this.cellProperties.preventOverflow;if(n||!n&&(r||r==="horizontal"))return!1;const i=sn(this.TEXTAREA),o=Wt(this.TEXTAREA),s=this.getDropdownHeight(),a=e.scrollTop,l=Wt(this.hot.view._wt.wtTable.THEAD),u=sn(e),c=i.top-u.top-l+a,d=e.scrollHeight-c-l-o,g=s>d&&c>d;return g?this.flipDropdown(s):this.unflipDropdown(),this.limitDropdownIfNeeded(g?c:d,s),g}limitDropdownIfNeeded(e,n){if(n>e){let r=0,i=0,o=0,s=null;do o=this.htEditor.getRowHeight(i)||this.htEditor.view._wt.getSetting("defaultRowHeight"),r+=o,i+=1;while(r<e);s=r-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-s}px`),this.setDropdownHeight(r-o)}}flipDropdown(e){const n=this.htEditor.rootElement.style;n.position="absolute",n.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownHeight(){const e=this.htEditor.getColWidth(0)+wn(this.hot.rootDocument)+2,n=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:n?void 0:e}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){const e=this.htEditor.getRowHeight(0)||23,n=this.cellProperties.visibleRows;return this.strippedChoices.length>=n?n*e:this.strippedChoices.length*e+8}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,r=qe(e,o=>Yt(o));return qe(r,o=>n?o:iw(o))}allowKeyEventPropagation(e){const n=this.htEditor.getSelectedRangeLast(),r={row:n?n.from.row:-1};let i=!1;return e===Ae.ARROW_DOWN&&r.row>0&&r.row<this.htEditor.countRows()-1&&(i=!0),e===Ae.ARROW_UP&&r.row>-1&&(i=!0),i}onBeforeKeyDown(e){if(GT(e.keyCode)||e.keyCode===Ae.BACKSPACE||e.keyCode===Ae.DELETE||e.keyCode===Ae.INSERT){let n=10;if(e.keyCode===Ae.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}const E6="checkbox";class DO extends ul{static get EDITOR_TYPE(){return E6}beginEditing(e,n){if(n&&n.type==="mouseup"){const r=this.TD.querySelector('input[type="checkbox"]');We(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}var Sf={},T6={get exports(){return Sf},set exports(t){Sf=t}};const _6=wN(yY);/*!
 * Pikaday
 *
 * Copyright Â© 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */(function(t,e){(function(n,r){var i;{try{i=_6}catch{}t.exports=r(i)}})(ru,function(n){var r=typeof n=="function",i=!!window.addEventListener,o=window.document,s=window.setTimeout,a=function(w,h,f,m){i?w.addEventListener(h,f,!!m):w.attachEvent("on"+h,f)},l=function(w,h,f,m){i?w.removeEventListener(h,f,!!m):w.detachEvent("on"+h,f)},u=function(w){return w.trim?w.trim():w.replace(/^\s+|\s+$/g,"")},c=function(w,h){return(" "+w.className+" ").indexOf(" "+h+" ")!==-1},d=function(w,h){c(w,h)||(w.className=w.className===""?h:w.className+" "+h)},g=function(w,h){w.className=u((" "+w.className+" ").replace(" "+h+" "," "))},p=function(w){return/Array/.test(Object.prototype.toString.call(w))},C=function(w){return/Date/.test(Object.prototype.toString.call(w))&&!isNaN(w.getTime())},E=function(w){var h=w.getDay();return h===0||h===6},I=function(w){return w%4===0&&w%100!==0||w%400===0},M=function(w,h){return[31,I(w)?29:28,31,30,31,30,31,31,30,31,30,31][h]},y=function(w){C(w)&&w.setHours(0,0,0,0)},$=function(w,h){return w.getTime()===h.getTime()},X=function(w,h,f){var m,T;for(m in h)T=w[m]!==void 0,T&&typeof h[m]=="object"&&h[m]!==null&&h[m].nodeName===void 0?C(h[m])?f&&(w[m]=new Date(h[m].getTime())):p(h[m])?f&&(w[m]=h[m].slice(0)):w[m]=X({},h[m],f):(f||!T)&&(w[m]=h[m]);return w},G=function(w,h,f){var m;o.createEvent?(m=o.createEvent("HTMLEvents"),m.initEvent(h,!0,!1),m=X(m,f),w.dispatchEvent(m)):o.createEventObject&&(m=o.createEventObject(),m=X(m,f),w.fireEvent("on"+h,m))},q=function(w){return w.month<0&&(w.year-=Math.ceil(Math.abs(w.month)/12),w.month+=12),w.month>11&&(w.year+=Math.floor(Math.abs(w.month)/12),w.month-=12),w},re={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},v=function(w,h,f){for(h+=w.firstDay;h>=7;)h-=7;return f?w.i18n.weekdaysShort[h]:w.i18n.weekdays[h]},S=function(w){var h=[],f="false";if(w.isEmpty)if(w.showDaysInNextAndPreviousMonths)h.push("is-outside-current-month"),w.enableSelectionDaysInNextAndPreviousMonths||h.push("is-selection-disabled");else return'<td class="is-empty"></td>';return w.isDisabled&&h.push("is-disabled"),w.isToday&&h.push("is-today"),w.isSelected&&(h.push("is-selected"),f="true"),w.hasEvent&&h.push("has-event"),w.isInRange&&h.push("is-inrange"),w.isStartRange&&h.push("is-startrange"),w.isEndRange&&h.push("is-endrange"),'<td data-day="'+w.day+'" class="'+h.join(" ")+'" aria-selected="'+f+'"><button class="pika-button pika-day" type="button" data-pika-year="'+w.year+'" data-pika-month="'+w.month+'" data-pika-day="'+w.day+'">'+w.day+"</button></td>"},b=function(w,h){w.setHours(0,0,0,0);var f=w.getDate(),m=w.getDay(),T=h,O=T-1,_=7,Y=function(de){return(de+_-1)%_};w.setDate(f+O-Y(m));var U=new Date(w.getFullYear(),0,T),ie=24*60*60*1e3,se=(w.getTime()-U.getTime())/ie,oe=1+Math.round((se-O+Y(U.getDay()))/_);return oe},L=function(w,h,f,m){var T=new Date(f,h,w),O=r?n(T).isoWeek():b(T,m);return'<td class="pika-week">'+O+"</td>"},P=function(w,h,f,m){return'<tr class="pika-row'+(f?" pick-whole-week":"")+(m?" is-selected":"")+'">'+(h?w.reverse():w).join("")+"</tr>"},x=function(w){return"<tbody>"+w.join("")+"</tbody>"},W=function(w){var h,f=[];for(w.showWeekNumber&&f.push("<th></th>"),h=0;h<7;h++)f.push('<th scope="col"><abbr title="'+v(w,h)+'">'+v(w,h,!0)+"</abbr></th>");return"<thead><tr>"+(w.isRTL?f.reverse():f).join("")+"</tr></thead>"},D=function(w,h,f,m,T,O){var _,Y,U,ie=w._o,se=f===ie.minYear,oe=f===ie.maxYear,de='<div id="'+O+'" class="pika-title" role="heading" aria-live="assertive">',Se,pe,we=!0,ee=!0;for(U=[],_=0;_<12;_++)U.push('<option value="'+(f===T?_-h:12+_-h)+'"'+(_===m?' selected="selected"':"")+(se&&_<ie.minMonth||oe&&_>ie.maxMonth?' disabled="disabled"':"")+">"+ie.i18n.months[_]+"</option>");for(Se='<div class="pika-label">'+ie.i18n.months[m]+'<select class="pika-select pika-select-month" tabindex="-1">'+U.join("")+"</select></div>",p(ie.yearRange)?(_=ie.yearRange[0],Y=ie.yearRange[1]+1):(_=f-ie.yearRange,Y=1+f+ie.yearRange),U=[];_<Y&&_<=ie.maxYear;_++)_>=ie.minYear&&U.push('<option value="'+_+'"'+(_===f?' selected="selected"':"")+">"+_+"</option>");return pe='<div class="pika-label">'+f+ie.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+U.join("")+"</select></div>",ie.showMonthAfterYear?de+=pe+Se:de+=Se+pe,se&&(m===0||ie.minMonth>=m)&&(we=!1),oe&&(m===11||ie.maxMonth<=m)&&(ee=!1),h===0&&(de+='<button class="pika-prev'+(we?"":" is-disabled")+'" type="button">'+ie.i18n.previousMonth+"</button>"),h===w._o.numberOfMonths-1&&(de+='<button class="pika-next'+(ee?"":" is-disabled")+'" type="button">'+ie.i18n.nextMonth+"</button>"),de+="</div>"},B=function(w,h,f){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+f+'">'+W(w)+x(h)+"</table>"},z=function(w){var h=this,f=h.config(w);h._onMouseDown=function(T){if(h._v){T=T||window.event;var O=T.target||T.srcElement;if(O)if(c(O,"is-disabled")||(c(O,"pika-button")&&!c(O,"is-empty")&&!c(O.parentNode,"is-disabled")?(h.setDate(new Date(O.getAttribute("data-pika-year"),O.getAttribute("data-pika-month"),O.getAttribute("data-pika-day"))),f.bound&&s(function(){h.hide(),f.blurFieldOnSelect&&f.field&&f.field.blur()},100)):c(O,"pika-prev")?h.prevMonth():c(O,"pika-next")&&h.nextMonth()),c(O,"pika-select"))h._c=!0;else if(T.preventDefault)T.preventDefault();else return T.returnValue=!1,!1}},h._onChange=function(T){T=T||window.event;var O=T.target||T.srcElement;O&&(c(O,"pika-select-month")?h.gotoMonth(O.value):c(O,"pika-select-year")&&h.gotoYear(O.value))},h._onKeyChange=function(T){if(T=T||window.event,h.isVisible())switch(T.keyCode){case 13:case 27:f.field&&f.field.blur();break;case 37:h.adjustDate("subtract",1);break;case 38:h.adjustDate("subtract",7);break;case 39:h.adjustDate("add",1);break;case 40:h.adjustDate("add",7);break;case 8:case 46:h.setDate(null);break}},h._parseFieldValue=function(){if(f.parse)return f.parse(f.field.value,f.format);if(r){var T=n(f.field.value,f.format,f.formatStrict);return T&&T.isValid()?T.toDate():null}else return new Date(Date.parse(f.field.value))},h._onInputChange=function(T){var O;T.firedBy!==h&&(O=h._parseFieldValue(),C(O)&&h.setDate(O),h._v||h.show())},h._onInputFocus=function(){h.show()},h._onInputClick=function(){h.show()},h._onInputBlur=function(){var T=o.activeElement;do if(c(T,"pika-single"))return;while(T=T.parentNode);h._c||(h._b=s(function(){h.hide()},50)),h._c=!1},h._onClick=function(T){T=T||window.event;var O=T.target||T.srcElement,_=O;if(O){!i&&c(O,"pika-select")&&(O.onchange||(O.setAttribute("onchange","return;"),a(O,"change",h._onChange)));do if(c(_,"pika-single")||_===f.trigger)return;while(_=_.parentNode);h._v&&O!==f.trigger&&_!==f.trigger&&h.hide()}},h.el=o.createElement("div"),h.el.className="pika-single"+(f.isRTL?" is-rtl":"")+(f.theme?" "+f.theme:""),a(h.el,"mousedown",h._onMouseDown,!0),a(h.el,"touchend",h._onMouseDown,!0),a(h.el,"change",h._onChange),f.keyboardInput&&a(o,"keydown",h._onKeyChange),f.field&&(f.container?f.container.appendChild(h.el):f.bound?o.body.appendChild(h.el):f.field.parentNode.insertBefore(h.el,f.field.nextSibling),a(f.field,"change",h._onInputChange),f.defaultDate||(f.defaultDate=h._parseFieldValue(),f.setDefaultDate=!0));var m=f.defaultDate;C(m)?f.setDefaultDate?h.setDate(m,!0):h.gotoDate(m):h.gotoDate(new Date),f.bound?(this.hide(),h.el.className+=" is-bound",a(f.trigger,"click",h._onInputClick),a(f.trigger,"focus",h._onInputFocus),a(f.trigger,"blur",h._onInputBlur)):this.show()};return z.prototype={config:function(w){this._o||(this._o=X({},re,!0));var h=X(this._o,w,!0);h.isRTL=!!h.isRTL,h.field=h.field&&h.field.nodeName?h.field:null,h.theme=typeof h.theme=="string"&&h.theme?h.theme:null,h.bound=!!(h.bound!==void 0?h.field&&h.bound:h.field),h.trigger=h.trigger&&h.trigger.nodeName?h.trigger:h.field,h.disableWeekends=!!h.disableWeekends,h.disableDayFn=typeof h.disableDayFn=="function"?h.disableDayFn:null;var f=parseInt(h.numberOfMonths,10)||1;if(h.numberOfMonths=f>4?4:f,C(h.minDate)||(h.minDate=!1),C(h.maxDate)||(h.maxDate=!1),h.minDate&&h.maxDate&&h.maxDate<h.minDate&&(h.maxDate=h.minDate=!1),h.minDate&&this.setMinDate(h.minDate),h.maxDate&&this.setMaxDate(h.maxDate),p(h.yearRange)){var m=new Date().getFullYear()-10;h.yearRange[0]=parseInt(h.yearRange[0],10)||m,h.yearRange[1]=parseInt(h.yearRange[1],10)||m}else h.yearRange=Math.abs(parseInt(h.yearRange,10))||re.yearRange,h.yearRange>100&&(h.yearRange=100);return h},toString:function(w){return w=w||this._o.format,C(this._d)?this._o.toString?this._o.toString(this._d,w):r?n(this._d).format(w):this._d.toDateString():""},getMoment:function(){return r?n(this._d):null},setMoment:function(w,h){r&&n.isMoment(w)&&this.setDate(w.toDate(),h)},getDate:function(){return C(this._d)?new Date(this._d.getTime()):null},setDate:function(w,h){if(!w)return this._d=null,this._o.field&&(this._o.field.value="",G(this._o.field,"change",{firedBy:this})),this.draw();if(typeof w=="string"&&(w=new Date(Date.parse(w))),!!C(w)){var f=this._o.minDate,m=this._o.maxDate;C(f)&&w<f?w=f:C(m)&&w>m&&(w=m),this._d=new Date(w.getTime()),y(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),G(this._o.field,"change",{firedBy:this})),!h&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function(w){var h=!0;if(C(w)){if(this.calendars){var f=new Date(this.calendars[0].year,this.calendars[0].month,1),m=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),T=w.getTime();m.setMonth(m.getMonth()+1),m.setDate(m.getDate()-1),h=T<f.getTime()||m.getTime()<T}h&&(this.calendars=[{month:w.getMonth(),year:w.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(w,h){var f=this.getDate()||new Date,m=parseInt(h)*24*60*60*1e3,T;w==="add"?T=new Date(f.valueOf()+m):w==="subtract"&&(T=new Date(f.valueOf()-m)),this.setDate(T)},adjustCalendars:function(){this.calendars[0]=q(this.calendars[0]);for(var w=1;w<this._o.numberOfMonths;w++)this.calendars[w]=q({month:this.calendars[0].month+w,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(w){isNaN(w)||(this.calendars[0].month=parseInt(w,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(w){isNaN(w)||(this.calendars[0].year=parseInt(w,10),this.adjustCalendars())},setMinDate:function(w){w instanceof Date?(y(w),this._o.minDate=w,this._o.minYear=w.getFullYear(),this._o.minMonth=w.getMonth()):(this._o.minDate=re.minDate,this._o.minYear=re.minYear,this._o.minMonth=re.minMonth,this._o.startRange=re.startRange),this.draw()},setMaxDate:function(w){w instanceof Date?(y(w),this._o.maxDate=w,this._o.maxYear=w.getFullYear(),this._o.maxMonth=w.getMonth()):(this._o.maxDate=re.maxDate,this._o.maxYear=re.maxYear,this._o.maxMonth=re.maxMonth,this._o.endRange=re.endRange),this.draw()},setStartRange:function(w){this._o.startRange=w},setEndRange:function(w){this._o.endRange=w},draw:function(w){if(!(!this._v&&!w)){var h=this._o,f=h.minYear,m=h.maxYear,T=h.minMonth,O=h.maxMonth,_="",Y;this._y<=f&&(this._y=f,!isNaN(T)&&this._m<T&&(this._m=T)),this._y>=m&&(this._y=m,!isNaN(O)&&this._m>O&&(this._m=O));for(var U=0;U<h.numberOfMonths;U++)Y="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),_+='<div class="pika-lendar">'+D(this,U,this.calendars[U].year,this.calendars[U].month,this.calendars[0].year,Y)+this.render(this.calendars[U].year,this.calendars[U].month,Y)+"</div>";this.el.innerHTML=_,h.bound&&h.field.type!=="hidden"&&s(function(){h.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),h.bound&&h.field.setAttribute("aria-label",h.ariaLabel)}},adjustPosition:function(){var w,h,f,m,T,O,_,Y,U,ie,se,oe;if(!this._o.container){if(this.el.style.position="absolute",w=this._o.trigger,h=w,f=this.el.offsetWidth,m=this.el.offsetHeight,T=window.innerWidth||o.documentElement.clientWidth,O=window.innerHeight||o.documentElement.clientHeight,_=window.pageYOffset||o.body.scrollTop||o.documentElement.scrollTop,se=!0,oe=!0,typeof w.getBoundingClientRect=="function")ie=w.getBoundingClientRect(),Y=ie.left+window.pageXOffset,U=ie.bottom+window.pageYOffset;else for(Y=h.offsetLeft,U=h.offsetTop+h.offsetHeight;h=h.offsetParent;)Y+=h.offsetLeft,U+=h.offsetTop;(this._o.reposition&&Y+f>T||this._o.position.indexOf("right")>-1&&Y-f+w.offsetWidth>0)&&(Y=Y-f+w.offsetWidth,se=!1),(this._o.reposition&&U+m>O+_||this._o.position.indexOf("top")>-1&&U-m-w.offsetHeight>0)&&(U=U-m-w.offsetHeight,oe=!1),this.el.style.left=Y+"px",this.el.style.top=U+"px",d(this.el,se?"left-aligned":"right-aligned"),d(this.el,oe?"bottom-aligned":"top-aligned"),g(this.el,se?"right-aligned":"left-aligned"),g(this.el,oe?"top-aligned":"bottom-aligned")}},render:function(w,h,f){var m=this._o,T=new Date,O=M(w,h),_=new Date(w,h,1).getDay(),Y=[],U=[];y(T),m.firstDay>0&&(_-=m.firstDay,_<0&&(_+=7));for(var ie=h===0?11:h-1,se=h===11?0:h+1,oe=h===0?w-1:w,de=h===11?w+1:w,Se=M(oe,ie),pe=O+_,we=pe;we>7;)we-=7;pe+=7-we;for(var ee=!1,ye=0,$e=0;ye<pe;ye++){var Pe=new Date(w,h,1+(ye-_)),Fe=C(this._d)?$(Pe,this._d):!1,xe=$(Pe,T),R=m.events.indexOf(Pe.toDateString())!==-1,A=ye<_||ye>=O+_,N=1+(ye-_),J=h,F=w,Q=m.startRange&&$(m.startRange,Pe),K=m.endRange&&$(m.endRange,Pe),j=m.startRange&&m.endRange&&m.startRange<Pe&&Pe<m.endRange,te=m.minDate&&Pe<m.minDate||m.maxDate&&Pe>m.maxDate||m.disableWeekends&&E(Pe)||m.disableDayFn&&m.disableDayFn(Pe);A&&(ye<_?(N=Se+N,J=ie,F=oe):(N=N-O,J=se,F=de));var Z={day:N,month:J,year:F,hasEvent:R,isSelected:Fe,isToday:xe,isDisabled:te,isEmpty:A,isStartRange:Q,isEndRange:K,isInRange:j,showDaysInNextAndPreviousMonths:m.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:m.enableSelectionDaysInNextAndPreviousMonths};m.pickWholeWeek&&Fe&&(ee=!0),U.push(S(Z)),++$e===7&&(m.showWeekNumber&&U.unshift(L(ye-_,h,w,m.firstWeekOfYearMinDays)),Y.push(P(U,m.isRTL,m.pickWholeWeek,ee)),U=[],$e=0,ee=!1)}return B(m,Y,f)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),g(this.el,"is-hidden"),this._o.bound&&(a(o,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var w=this._v;w!==!1&&(this._o.bound&&l(o,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),d(this.el,"is-hidden"),this._v=!1,w!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){var w=this._o;this.hide(),l(this.el,"mousedown",this._onMouseDown,!0),l(this.el,"touchend",this._onMouseDown,!0),l(this.el,"change",this._onChange),w.keyboardInput&&l(o,"keydown",this._onKeyChange),w.field&&(l(w.field,"change",this._onInputChange),w.bound&&(l(w.trigger,"click",this._onInputClick),l(w.trigger,"focus",this._onInputFocus),l(w.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},z})})(T6);function yf(t,e,n){return e=M6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function M6(t){var e=O6(t,"string");return typeof e=="symbol"?e:String(e)}function O6(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const NO="date",LO="dateEditor";class $O extends ra{constructor(){super(...arguments),yf(this,"defaultDateFormat","DD/MM/YYYY"),yf(this,"isCellEdited",!1),yf(this,"parentDestroyed",!1),yf(this,"$datePicker",null)}static get EDITOR_TYPE(){return NO}init(){if(typeof le!="function")throw new Error("You need to include moment.js to your project.");if(typeof Sf!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),ce(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);const e=new br(this);e.addEventListener(this.datePicker,"mousedown",n=>{We(n.target,"pika-day")&&this.hideDatepicker(),n.stopPropagation()}),e.addEventListener(this.TEXTAREA,"keydown",n=>{["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(n.code)&&n.preventDefault()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.hot.getShortcutManager().getContext("editor");super.open(),this.showDatepicker(e),r.addShortcut({keys:[["Enter"]],callback:i=>{i.stopPropagation()},group:LO})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{this.hot._refreshBorders()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(LO),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e){const r=this.originalValue;r!==void 0&&this.setValue(r)}super.finishEditing(e,n)}showDatepicker(e){const n=this.TD.getBoundingClientRect(),r=this.cellProperties.dateFormat||this.defaultDateFormat,i=this.hot.view.isMouseDown(),o=e?Rw(e.keyCode):!1;let s;this.datePicker.style.display="block",this.$datePicker=new Sf(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+n.top+Wt(this.TD)}px`;let a=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?a=n.right-yt(this.datePicker):a=n.left,this.datePickerStyle.left=`${a}px`,this.originalValue?(s=this.originalValue,le(s,r,!0).isValid()&&this.$datePicker.setMoment(le(s,r),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!o&&!i&&this.setValue("")):this.cellProperties.defaultDate?(s=this.cellProperties.defaultDate,le(s,r,!0).isValid()&&this.$datePicker.setMoment(le(s,r),!0),!o&&!i&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const e=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&Fu(n,this.cellProperties.datePickerConfig);const r=n.onSelect,i=n.onClose;return n.field=e,n.trigger=e,n.container=this.datePicker,n.bound=!1,n.format=n.format||this.defaultDateFormat,n.reposition=n.reposition||!1,n.isRTL=!1,n.onSelect=o=>{let s=o;isNaN(s.getTime())||(s=le(s).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(s),r&&r()},n.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),i&&i()},n}}const A6="dropdown";class PS extends IS{static get EDITOR_TYPE(){return A6}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}_e.getSingleton().add("beforeValidate",function(t,e,n){const r=this.getCellMeta(e,this.propToCol(n));r.editor===PS&&r.strict===void 0&&(r.filter=!1,r.strict=!0)});const I6="numeric";class kO extends ra{static get EDITOR_TYPE(){return I6}}const P6="password";class FO extends ra{static get EDITOR_TYPE(){return P6}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.hot.getSettings().ariaTags&&Le(this.TEXTAREA,[co()]),ii(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const xS="ht_editor_visible",WO="selectEditor",x6="select";class VO extends ul{static get EDITOR_TYPE(){return x6}init(){this.select=this.hot.rootDocument.createElement("SELECT"),ce(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",We(this.select,xS)&&Ue(this.select,xS),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),ii(this.select),Ze(l,(u,c)=>{const d=this.hot.rootDocument.createElement("OPTION");d.value=c,Ys(d,u),this.select.appendChild(d)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let r=0,i=e.length;r<i;r++)n[e[r]]=e[r];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==gn.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:r,height:i}=this.getEditedCellRect(),o=this.select.style;o.height=`${i}px`,o.width=`${r}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${n}px`,o.margin="0px",ce(this.select,xS)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={group:WO};this.isInFullEditMode()!==!1&&n.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(WO)}}const H6="time";class BO extends ra{static get EDITOR_TYPE(){return H6}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.TEXTAREA.dir="ltr"}}function D6(){sr(ul),sr(IS),sr(DO),sr($O),sr(PS),sr(OS),sr(kO),sr(FO),sr(VO),sr(ra),sr(BO)}const N6="html";function HS(t,e,n,r,i,o,s){lc.apply(this,[t,e,n,r,i,o,s]),Ys(e,o??"",!1)}HS.RENDERER_TYPE=N6;const L6="autocomplete";function cl(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=s.allowHtml?HS:Eo,u=a.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...co()),u.appendChild(a.createTextNode(String.fromCharCode(9660))),l.apply(this,[t,e,n,r,i,o,s]),e.firstChild||e.appendChild(a.createTextNode(String.fromCharCode(160))),e.insertBefore(u,e.firstChild),ce(e,"htAutocomplete"),!t.acArrowListener){const d=new br(t);t.acArrowListener=function(g){We(g.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,r),e)},d.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{d.destroy()})}}cl.RENDERER_TYPE=L6;const UO=new WeakMap,YO=new WeakMap,$6="htBadValue",hl="data-row",dl="data-col",k6="checkboxRenderer",GO="checkbox";_e.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:r,type:i,row:o,column:s,prop:a}=e;if(i===GO){if(r){const{value:l,property:u}=r;let c=n;if(l)c=typeof l=="function"?l(o,s,a,n):l;else if(u){const d=this.getDataAtRowProp(o,u);c=d!==null?d:n}t=c}return t}});function DS(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=t.getSettings().ariaTags;lc.apply(this,[t,e,n,r,i,o,s]),F6(t);let u=W6(a);const c=s.label;let d=!1;if(typeof s.checkedTemplate>"u"&&(s.checkedTemplate=!0),typeof s.uncheckedTemplate>"u"&&(s.uncheckedTemplate=!1),ii(e),o===s.checkedTemplate||Yt(o).toLocaleLowerCase(s.locale)===Yt(s.checkedTemplate).toLocaleLowerCase(s.locale)?u.checked=!0:o===s.uncheckedTemplate||Yt(o).toLocaleLowerCase(s.locale)===Yt(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?u.checked=!1:hn(o)?ce(u,"noValue"):(u.style.display="none",ce(u,$6),d=!0),Le(u,[[hl,n],[dl,r]]),l&&Le(u,[sw(u.checked?t.getTranslatedPhrase(lS):t.getTranslatedPhrase(uS)),XY(u.checked),BY()]),!d&&c){let E="";if(c.value)E=typeof c.value=="function"?c.value.call(this,n,r,i,o):c.value;else if(c.property){const M=t.getDataAtRowProp(n,c.property);E=M!==null?M:""}const I=V6(a,E,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(I),e.appendChild(u)):(I.appendChild(u),u=I):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(I)):(I.insertBefore(u,I.firstChild),u=I))}(!c||c&&!c.separated)&&e.appendChild(u),d&&e.appendChild(a.createTextNode("#bad-value#")),UO.has(t)||(UO.set(t,!0),g());function g(){const I=t.getShortcutManager().getContext("grid"),M={group:k6};I.addShortcuts([{keys:[["space"]],callback:()=>(p(),!C())},{keys:[["enter"]],callback:()=>(p(),!C()),runOnlyIf:()=>t.getSettings().enterBeginsEditing},{keys:[["delete"],["backspace"]],callback:()=>(p(!0),!C()),relativeToGroup:RS,position:"before"}],M)}function p(){let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const I=t.getSelectedRange();if(I)for(let M=0;M<I.length;M++){const{row:y,col:$}=I[M].getTopStartCorner(),{row:X,col:G}=I[M].getBottomEndCorner(),q=[];for(let re=y;re<=X;re+=1)for(let v=$;v<=G;v+=1){const S=t.getCellMeta(re,v);if(S.type!=="checkbox")return;if(S.readOnly===!0)continue;typeof S.checkedTemplate>"u"&&(S.checkedTemplate=!0),typeof S.uncheckedTemplate>"u"&&(S.uncheckedTemplate=!1);const b=t.getDataAtCell(re,v);E===!1?[S.checkedTemplate,S.checkedTemplate.toString()].includes(b)?q.push([re,v,S.uncheckedTemplate]):[S.uncheckedTemplate,S.uncheckedTemplate.toString(),null,void 0].includes(b)&&q.push([re,v,S.checkedTemplate]):q.push([re,v,S.uncheckedTemplate])}q.length>0&&t.setDataAtCell(q)}}function C(){const E=t.getSelectedRange();if(E){for(let I=0;I<E.length;I++){const M=E[I].getTopStartCorner(),y=E[I].getBottomEndCorner();for(let $=M.row;$<=y.row;$++)for(let X=M.col;X<=y.col;X++){const G=t.getCellMeta($,X);if(G.type!=="checkbox")return!1;const q=t.getCell($,X);if(q==null)return!0;if(q.querySelectorAll("input[type=checkbox]").length>0&&!G.readOnly)return!0}}return!1}}}DS.RENDERER_TYPE=GO;function F6(t){let e=YO.get(t);if(!e){const{rootElement:n}=t;e=new br(t),e.addEventListener(n,"click",r=>U6(r,t)),e.addEventListener(n,"mouseup",r=>B6(r,t)),e.addEventListener(n,"change",r=>Y6(r,t)),YO.set(t,e)}return e}function W6(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function V6(t,e,n){const r=t.createElement("label");return r.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`,r.appendChild(t.createTextNode(e)),r.cloneNode(!0)}function B6(t,e){const{target:n}=t;NS(n)&&(!n.hasAttribute(hl)||!n.hasAttribute(dl)||setTimeout(e.listen,10))}function U6(t,e){const{target:n}=t;if(!NS(n)||!n.hasAttribute(hl)||!n.hasAttribute(dl))return;const r=parseInt(n.getAttribute(hl),10),i=parseInt(n.getAttribute(dl),10);e.getCellMeta(r,i).readOnly&&t.preventDefault()}function Y6(t,e){const{target:n}=t;if(!NS(n)||!n.hasAttribute(hl)||!n.hasAttribute(dl))return;const r=parseInt(n.getAttribute(hl),10),i=parseInt(n.getAttribute(dl),10),o=e.getCellMeta(r,i);if(!o.readOnly){let s=null;t.target.checked?s=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:s=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(r,i,s)}}function NS(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}function bf(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var LS={},G6={get exports(){return LS},set exports(t){LS=t}};(function(t,e){(function(n){t.exports=n()})(function(){return function n(r,i,o){function s(u,c){if(!i[u]){if(!r[u]){var d=typeof bf=="function"&&bf;if(!c&&d)return d(u,!0);if(a)return a(u,!0);var g=new Error("Cannot find module '"+u+"'");throw g.code="MODULE_NOT_FOUND",g}var p=i[u]={exports:{}};r[u][0].call(p.exports,function(C){return s(r[u][1][C]||C)},p,p.exports,n,r,i,o)}return i[u].exports}for(var a=typeof bf=="function"&&bf,l=0;l<o.length;l++)s(o[l]);return s}({1:[function(n,r,i){(function(o){var s,a=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,l=Math.ceil,u=Math.floor,c="[BigNumber Error] ",d=c+"Number primitive has more than 15 significant digits: ",g=1e14,p=14,C=9007199254740991,E=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],I=1e7,M=1e9;function y(S){var b=0|S;return 0<S||S===b?b:b-1}function $(S){for(var b,L,P=1,x=S.length,W=S[0]+"";P<x;){for(b=S[P++]+"",L=p-b.length;L--;b="0"+b);W+=b}for(x=W.length;W.charCodeAt(--x)===48;);return W.slice(0,x+1||1)}function X(S,b){var L,P,x=S.c,W=b.c,D=S.s,B=b.s,z=S.e,w=b.e;if(!D||!B)return null;if(L=x&&!x[0],P=W&&!W[0],L||P)return L?P?0:-B:D;if(D!=B)return D;if(L=D<0,P=z==w,!x||!W)return P?0:!x^L?1:-1;if(!P)return w<z^L?1:-1;for(B=(z=x.length)<(w=W.length)?z:w,D=0;D<B;D++)if(x[D]!=W[D])return x[D]>W[D]^L?1:-1;return z==w?0:w<z^L?1:-1}function G(S,b,L,P){if(S<b||L<S||S!==(S<0?l(S):u(S)))throw Error(c+(P||"Argument")+(typeof S=="number"?S<b||L<S?" out of range: ":" not an integer: ":" not a primitive number: ")+String(S))}function q(S){var b=S.c.length-1;return y(S.e/p)==b&&S.c[b]%2!=0}function re(S,b){return(1<S.length?S.charAt(0)+"."+S.slice(1):S)+(b<0?"e":"e+")+b}function v(S,b,L){var P,x;if(b<0){for(x=L+".";++b;x+=L);S=x+S}else if(++b>(P=S.length)){for(x=L,b-=P;--b;x+=L);S+=x}else b<P&&(S=S.slice(0,b)+"."+S.slice(b));return S}(s=function S(b){var L,P,x,W,D,B,z,w,h,f,m=ee.prototype={constructor:ee,toString:null,valueOf:null},T=new ee(1),O=20,_=4,Y=-7,U=21,ie=-1e7,se=1e7,oe=!1,de=1,Se=0,pe={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},we="0123456789abcdefghijklmnopqrstuvwxyz";function ee(R,A){var N,J,F,Q,K,j,te,Z,ne=this;if(!(ne instanceof ee))return new ee(R,A);if(A==null){if(R instanceof ee)return ne.s=R.s,ne.e=R.e,void(ne.c=(R=R.c)?R.slice():R);if((j=typeof R=="number")&&0*R==0){if(ne.s=1/R<0?(R=-R,-1):1,R===~~R){for(Q=0,K=R;10<=K;K/=10,Q++);return ne.e=Q,void(ne.c=[R])}Z=String(R)}else{if(Z=String(R),!a.test(Z))return x(ne,Z,j);ne.s=Z.charCodeAt(0)==45?(Z=Z.slice(1),-1):1}-1<(Q=Z.indexOf("."))&&(Z=Z.replace(".","")),0<(K=Z.search(/e/i))?(Q<0&&(Q=K),Q+=+Z.slice(K+1),Z=Z.substring(0,K)):Q<0&&(Q=Z.length)}else{if(G(A,2,we.length,"Base"),Z=String(R),A==10)return Fe(ne=new ee(R instanceof ee?R:Z),O+ne.e+1,_);if(j=typeof R=="number"){if(0*R!=0)return x(ne,Z,j,A);if(ne.s=1/R<0?(Z=Z.slice(1),-1):1,ee.DEBUG&&15<Z.replace(/^0\.0*|\./,"").length)throw Error(d+R);j=!1}else ne.s=Z.charCodeAt(0)===45?(Z=Z.slice(1),-1):1;for(N=we.slice(0,A),Q=K=0,te=Z.length;K<te;K++)if(N.indexOf(J=Z.charAt(K))<0){if(J=="."){if(Q<K){Q=te;continue}}else if(!F&&(Z==Z.toUpperCase()&&(Z=Z.toLowerCase())||Z==Z.toLowerCase()&&(Z=Z.toUpperCase()))){F=!0,K=-1,Q=0;continue}return x(ne,String(R),j,A)}-1<(Q=(Z=P(Z,A,10,ne.s)).indexOf("."))?Z=Z.replace(".",""):Q=Z.length}for(K=0;Z.charCodeAt(K)===48;K++);for(te=Z.length;Z.charCodeAt(--te)===48;);if(Z=Z.slice(K,++te)){if(te-=K,j&&ee.DEBUG&&15<te&&(C<R||R!==u(R)))throw Error(d+ne.s*R);if(se<(Q=Q-K-1))ne.c=ne.e=null;else if(Q<ie)ne.c=[ne.e=0];else{if(ne.e=Q,ne.c=[],K=(Q+1)%p,Q<0&&(K+=p),K<te){for(K&&ne.c.push(+Z.slice(0,K)),te-=p;K<te;)ne.c.push(+Z.slice(K,K+=p));Z=Z.slice(K),K=p-Z.length}else K-=te;for(;K--;Z+="0");ne.c.push(+Z)}}else ne.c=[ne.e=0]}function ye(R,A,N,J){var F,Q,K,j,te;if(N==null?N=_:G(N,0,8),!R.c)return R.toString();if(F=R.c[0],K=R.e,A==null)te=$(R.c),te=J==1||J==2&&(K<=Y||U<=K)?re(te,K):v(te,K,"0");else if(Q=(R=Fe(new ee(R),A,N)).e,j=(te=$(R.c)).length,J==1||J==2&&(A<=Q||Q<=Y)){for(;j<A;te+="0",j++);te=re(te,Q)}else if(A-=K,te=v(te,Q,"0"),j<Q+1){if(0<--A)for(te+=".";A--;te+="0");}else if(0<(A+=Q-j))for(Q+1==j&&(te+=".");A--;te+="0");return R.s<0&&F?"-"+te:te}function $e(R,A){for(var N,J=1,F=new ee(R[0]);J<R.length;J++){if(!(N=new ee(R[J])).s){F=N;break}A.call(F,N)&&(F=N)}return F}function Pe(R,A,N){for(var J=1,F=A.length;!A[--F];A.pop());for(F=A[0];10<=F;F/=10,J++);return(N=J+N*p-1)>se?R.c=R.e=null:R.c=N<ie?[R.e=0]:(R.e=N,A),R}function Fe(R,A,N,J){var F,Q,K,j,te,Z,ne,fe=R.c,Te=E;if(fe){e:{for(F=1,j=fe[0];10<=j;j/=10,F++);if((Q=A-F)<0)Q+=p,K=A,ne=(te=fe[Z=0])/Te[F-K-1]%10|0;else if((Z=l((Q+1)/p))>=fe.length){if(!J)break e;for(;fe.length<=Z;fe.push(0));te=ne=0,K=(Q%=p)-p+(F=1)}else{for(te=j=fe[Z],F=1;10<=j;j/=10,F++);ne=(K=(Q%=p)-p+F)<0?0:te/Te[F-K-1]%10|0}if(J=J||A<0||fe[Z+1]!=null||(K<0?te:te%Te[F-K-1]),J=N<4?(ne||J)&&(N==0||N==(R.s<0?3:2)):5<ne||ne==5&&(N==4||J||N==6&&(0<Q?0<K?te/Te[F-K]:0:fe[Z-1])%10&1||N==(R.s<0?8:7)),A<1||!fe[0])return fe.length=0,J?(A-=R.e+1,fe[0]=Te[(p-A%p)%p],R.e=-A||0):fe[0]=R.e=0,R;if(Q==0?(fe.length=Z,j=1,Z--):(fe.length=Z+1,j=Te[p-Q],fe[Z]=0<K?u(te/Te[F-K]%Te[K])*j:0),J)for(;;){if(Z==0){for(Q=1,K=fe[0];10<=K;K/=10,Q++);for(K=fe[0]+=j,j=1;10<=K;K/=10,j++);Q!=j&&(R.e++,fe[0]==g&&(fe[0]=1));break}if(fe[Z]+=j,fe[Z]!=g)break;fe[Z--]=0,j=1}for(Q=fe.length;fe[--Q]===0;fe.pop());}R.e>se?R.c=R.e=null:R.e<ie&&(R.c=[R.e=0])}return R}function xe(R){var A,N=R.e;return N===null?R.toString():(A=$(R.c),A=N<=Y||U<=N?re(A,N):v(A,N,"0"),R.s<0?"-"+A:A)}return ee.clone=S,ee.ROUND_UP=0,ee.ROUND_DOWN=1,ee.ROUND_CEIL=2,ee.ROUND_FLOOR=3,ee.ROUND_HALF_UP=4,ee.ROUND_HALF_DOWN=5,ee.ROUND_HALF_EVEN=6,ee.ROUND_HALF_CEIL=7,ee.ROUND_HALF_FLOOR=8,ee.EUCLID=9,ee.config=ee.set=function(R){var A,N;if(R!=null){if(typeof R!="object")throw Error(c+"Object expected: "+R);if(R.hasOwnProperty(A="DECIMAL_PLACES")&&(G(N=R[A],0,M,A),O=N),R.hasOwnProperty(A="ROUNDING_MODE")&&(G(N=R[A],0,8,A),_=N),R.hasOwnProperty(A="EXPONENTIAL_AT")&&((N=R[A])&&N.pop?(G(N[0],-M,0,A),G(N[1],0,M,A),Y=N[0],U=N[1]):(G(N,-M,M,A),Y=-(U=N<0?-N:N))),R.hasOwnProperty(A="RANGE"))if((N=R[A])&&N.pop)G(N[0],-M,-1,A),G(N[1],1,M,A),ie=N[0],se=N[1];else{if(G(N,-M,M,A),!N)throw Error(c+A+" cannot be zero: "+N);ie=-(se=N<0?-N:N)}if(R.hasOwnProperty(A="CRYPTO")){if((N=R[A])!==!!N)throw Error(c+A+" not true or false: "+N);if(N){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw oe=!N,Error(c+"crypto unavailable");oe=N}else oe=N}if(R.hasOwnProperty(A="MODULO_MODE")&&(G(N=R[A],0,9,A),de=N),R.hasOwnProperty(A="POW_PRECISION")&&(G(N=R[A],0,M,A),Se=N),R.hasOwnProperty(A="FORMAT")){if(typeof(N=R[A])!="object")throw Error(c+A+" not an object: "+N);pe=N}if(R.hasOwnProperty(A="ALPHABET")){if(typeof(N=R[A])!="string"||/^.$|[+-.\s]|(.).*\1/.test(N))throw Error(c+A+" invalid: "+N);we=N}}return{DECIMAL_PLACES:O,ROUNDING_MODE:_,EXPONENTIAL_AT:[Y,U],RANGE:[ie,se],CRYPTO:oe,MODULO_MODE:de,POW_PRECISION:Se,FORMAT:pe,ALPHABET:we}},ee.isBigNumber=function(R){return R instanceof ee||R&&R._isBigNumber===!0||!1},ee.maximum=ee.max=function(){return $e(arguments,m.lt)},ee.minimum=ee.min=function(){return $e(arguments,m.gt)},ee.random=(W=9007199254740992,D=Math.random()*W&2097151?function(){return u(Math.random()*W)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(R){var A,N,J,F,Q,K=0,j=[],te=new ee(T);if(R==null?R=O:G(R,0,M),F=l(R/p),oe)if(crypto.getRandomValues){for(A=crypto.getRandomValues(new Uint32Array(F*=2));K<F;)9e15<=(Q=131072*A[K]+(A[K+1]>>>11))?(N=crypto.getRandomValues(new Uint32Array(2)),A[K]=N[0],A[K+1]=N[1]):(j.push(Q%1e14),K+=2);K=F/2}else{if(!crypto.randomBytes)throw oe=!1,Error(c+"crypto unavailable");for(A=crypto.randomBytes(F*=7);K<F;)9e15<=(Q=281474976710656*(31&A[K])+1099511627776*A[K+1]+4294967296*A[K+2]+16777216*A[K+3]+(A[K+4]<<16)+(A[K+5]<<8)+A[K+6])?crypto.randomBytes(7).copy(A,K):(j.push(Q%1e14),K+=7);K=F/7}if(!oe)for(;K<F;)(Q=D())<9e15&&(j[K++]=Q%1e14);for(F=j[--K],R%=p,F&&R&&(Q=E[p-R],j[K]=u(F/Q)*Q);j[K]===0;j.pop(),K--);if(K<0)j=[J=0];else{for(J=-1;j[0]===0;j.splice(0,1),J-=p);for(K=1,Q=j[0];10<=Q;Q/=10,K++);K<p&&(J-=p-K)}return te.e=J,te.c=j,te}),ee.sum=function(){for(var R=1,A=arguments,N=new ee(A[0]);R<A.length;)N=N.plus(A[R++]);return N},P=function(){var R="0123456789";function A(N,J,F,Q){for(var K,j,te=[0],Z=0,ne=N.length;Z<ne;){for(j=te.length;j--;te[j]*=J);for(te[0]+=Q.indexOf(N.charAt(Z++)),K=0;K<te.length;K++)te[K]>F-1&&(te[K+1]==null&&(te[K+1]=0),te[K+1]+=te[K]/F|0,te[K]%=F)}return te.reverse()}return function(N,J,F,Q,K){var j,te,Z,ne,fe,Te,He,ke,ze=N.indexOf("."),Tt=O,et=_;for(0<=ze&&(ne=Se,Se=0,N=N.replace(".",""),Te=(ke=new ee(J)).pow(N.length-ze),Se=ne,ke.c=A(v($(Te.c),Te.e,"0"),10,F,R),ke.e=ke.c.length),Z=ne=(He=A(N,J,F,K?(j=we,R):(j=R,we))).length;He[--ne]==0;He.pop());if(!He[0])return j.charAt(0);if(ze<0?--Z:(Te.c=He,Te.e=Z,Te.s=Q,He=(Te=L(Te,ke,Tt,et,F)).c,fe=Te.r,Z=Te.e),ze=He[te=Z+Tt+1],ne=F/2,fe=fe||te<0||He[te+1]!=null,fe=et<4?(ze!=null||fe)&&(et==0||et==(Te.s<0?3:2)):ne<ze||ze==ne&&(et==4||fe||et==6&&1&He[te-1]||et==(Te.s<0?8:7)),te<1||!He[0])N=fe?v(j.charAt(1),-Tt,j.charAt(0)):j.charAt(0);else{if(He.length=te,fe)for(--F;++He[--te]>F;)He[te]=0,te||(++Z,He=[1].concat(He));for(ne=He.length;!He[--ne];);for(ze=0,N="";ze<=ne;N+=j.charAt(He[ze++]));N=v(N,Z,j.charAt(0))}return N}}(),L=function(){function R(J,F,Q){var K,j,te,Z,ne=0,fe=J.length,Te=F%I,He=F/I|0;for(J=J.slice();fe--;)ne=((j=Te*(te=J[fe]%I)+(K=He*te+(Z=J[fe]/I|0)*Te)%I*I+ne)/Q|0)+(K/I|0)+He*Z,J[fe]=j%Q;return ne&&(J=[ne].concat(J)),J}function A(J,F,Q,K){var j,te;if(Q!=K)te=K<Q?1:-1;else for(j=te=0;j<Q;j++)if(J[j]!=F[j]){te=J[j]>F[j]?1:-1;break}return te}function N(J,F,Q,K){for(var j=0;Q--;)J[Q]-=j,j=J[Q]<F[Q]?1:0,J[Q]=j*K+J[Q]-F[Q];for(;!J[0]&&1<J.length;J.splice(0,1));}return function(J,F,Q,K,j){var te,Z,ne,fe,Te,He,ke,ze,Tt,et,Ct,_t,zo,Kr,xt,cn,eo,In=J.s==F.s?1:-1,rn=J.c,Pt=F.c;if(!(rn&&rn[0]&&Pt&&Pt[0]))return new ee(J.s&&F.s&&(rn?!Pt||rn[0]!=Pt[0]:Pt)?rn&&rn[0]==0||!Pt?0*In:In/0:NaN);for(Tt=(ze=new ee(In)).c=[],In=Q+(Z=J.e-F.e)+1,j||(j=g,Z=y(J.e/p)-y(F.e/p),In=In/p|0),ne=0;Pt[ne]==(rn[ne]||0);ne++);if(Pt[ne]>(rn[ne]||0)&&Z--,In<0)Tt.push(1),fe=!0;else{for(Kr=rn.length,cn=Pt.length,In+=2,1<(Te=u(j/(Pt[ne=0]+1)))&&(Pt=R(Pt,Te,j),rn=R(rn,Te,j),cn=Pt.length,Kr=rn.length),zo=cn,Ct=(et=rn.slice(0,cn)).length;Ct<cn;et[Ct++]=0);eo=Pt.slice(),eo=[0].concat(eo),xt=Pt[0],Pt[1]>=j/2&&xt++;do{if(Te=0,(te=A(Pt,et,cn,Ct))<0){if(_t=et[0],cn!=Ct&&(_t=_t*j+(et[1]||0)),1<(Te=u(_t/xt)))for(j<=Te&&(Te=j-1),ke=(He=R(Pt,Te,j)).length,Ct=et.length;A(He,et,ke,Ct)==1;)Te--,N(He,cn<ke?eo:Pt,ke,j),ke=He.length,te=1;else Te==0&&(te=Te=1),ke=(He=Pt.slice()).length;if(ke<Ct&&(He=[0].concat(He)),N(et,He,Ct,j),Ct=et.length,te==-1)for(;A(Pt,et,cn,Ct)<1;)Te++,N(et,cn<Ct?eo:Pt,Ct,j),Ct=et.length}else te===0&&(Te++,et=[0]);Tt[ne++]=Te,et[0]?et[Ct++]=rn[zo]||0:(et=[rn[zo]],Ct=1)}while((zo++<Kr||et[0]!=null)&&In--);fe=et[0]!=null,Tt[0]||Tt.splice(0,1)}if(j==g){for(ne=1,In=Tt[0];10<=In;In/=10,ne++);Fe(ze,Q+(ze.e=ne+Z*p-1)+1,K,fe)}else ze.e=Z,ze.r=+fe;return ze}}(),B=/^(-?)0([xbo])(?=\w[\w.]*$)/i,z=/^([^.]+)\.$/,w=/^\.([^.]+)$/,h=/^-?(Infinity|NaN)$/,f=/^\s*\+(?=[\w.])|^\s+|\s+$/g,x=function(R,A,N,J){var F,Q=N?A:A.replace(f,"");if(h.test(Q))R.s=isNaN(Q)?null:Q<0?-1:1,R.c=R.e=null;else{if(!N&&(Q=Q.replace(B,function(K,j,te){return F=(te=te.toLowerCase())=="x"?16:te=="b"?2:8,J&&J!=F?K:j}),J&&(F=J,Q=Q.replace(z,"$1").replace(w,"0.$1")),A!=Q))return new ee(Q,F);if(ee.DEBUG)throw Error(c+"Not a"+(J?" base "+J:"")+" number: "+A);R.c=R.e=R.s=null}},m.absoluteValue=m.abs=function(){var R=new ee(this);return R.s<0&&(R.s=1),R},m.comparedTo=function(R,A){return X(this,new ee(R,A))},m.decimalPlaces=m.dp=function(R,A){var N,J,F;if(R!=null)return G(R,0,M),A==null?A=_:G(A,0,8),Fe(new ee(this),R+this.e+1,A);if(!(N=this.c))return null;if(J=((F=N.length-1)-y(this.e/p))*p,F=N[F])for(;F%10==0;F/=10,J--);return J<0&&(J=0),J},m.dividedBy=m.div=function(R,A){return L(this,new ee(R,A),O,_)},m.dividedToIntegerBy=m.idiv=function(R,A){return L(this,new ee(R,A),0,1)},m.exponentiatedBy=m.pow=function(R,A){var N,J,F,Q,K,j,te,Z,ne=this;if((R=new ee(R)).c&&!R.isInteger())throw Error(c+"Exponent not an integer: "+xe(R));if(A!=null&&(A=new ee(A)),K=14<R.e,!ne.c||!ne.c[0]||ne.c[0]==1&&!ne.e&&ne.c.length==1||!R.c||!R.c[0])return Z=new ee(Math.pow(+xe(ne),K?2-q(R):+xe(R))),A?Z.mod(A):Z;if(j=R.s<0,A){if(A.c?!A.c[0]:!A.s)return new ee(NaN);(J=!j&&ne.isInteger()&&A.isInteger())&&(ne=ne.mod(A))}else{if(9<R.e&&(0<ne.e||ne.e<-1||(ne.e==0?1<ne.c[0]||K&&24e7<=ne.c[1]:ne.c[0]<8e13||K&&ne.c[0]<=9999975e7)))return Q=ne.s<0&&q(R)?-0:0,-1<ne.e&&(Q=1/Q),new ee(j?1/Q:Q);Se&&(Q=l(Se/p+2))}for(te=K?(N=new ee(.5),j&&(R.s=1),q(R)):(F=Math.abs(+xe(R)))%2,Z=new ee(T);;){if(te){if(!(Z=Z.times(ne)).c)break;Q?Z.c.length>Q&&(Z.c.length=Q):J&&(Z=Z.mod(A))}if(F){if((F=u(F/2))===0)break;te=F%2}else if(Fe(R=R.times(N),R.e+1,1),14<R.e)te=q(R);else{if((F=+xe(R))==0)break;te=F%2}ne=ne.times(ne),Q?ne.c&&ne.c.length>Q&&(ne.c.length=Q):J&&(ne=ne.mod(A))}return J?Z:(j&&(Z=T.div(Z)),A?Z.mod(A):Q?Fe(Z,Se,_,void 0):Z)},m.integerValue=function(R){var A=new ee(this);return R==null?R=_:G(R,0,8),Fe(A,A.e+1,R)},m.isEqualTo=m.eq=function(R,A){return X(this,new ee(R,A))===0},m.isFinite=function(){return!!this.c},m.isGreaterThan=m.gt=function(R,A){return 0<X(this,new ee(R,A))},m.isGreaterThanOrEqualTo=m.gte=function(R,A){return(A=X(this,new ee(R,A)))===1||A===0},m.isInteger=function(){return!!this.c&&y(this.e/p)>this.c.length-2},m.isLessThan=m.lt=function(R,A){return X(this,new ee(R,A))<0},m.isLessThanOrEqualTo=m.lte=function(R,A){return(A=X(this,new ee(R,A)))===-1||A===0},m.isNaN=function(){return!this.s},m.isNegative=function(){return this.s<0},m.isPositive=function(){return 0<this.s},m.isZero=function(){return!!this.c&&this.c[0]==0},m.minus=function(R,A){var N,J,F,Q,K=this,j=K.s;if(A=(R=new ee(R,A)).s,!j||!A)return new ee(NaN);if(j!=A)return R.s=-A,K.plus(R);var te=K.e/p,Z=R.e/p,ne=K.c,fe=R.c;if(!te||!Z){if(!ne||!fe)return ne?(R.s=-A,R):new ee(fe?K:NaN);if(!ne[0]||!fe[0])return fe[0]?(R.s=-A,R):new ee(ne[0]?K:_==3?-0:0)}if(te=y(te),Z=y(Z),ne=ne.slice(),j=te-Z){for((F=(Q=j<0)?(j=-j,ne):(Z=te,fe)).reverse(),A=j;A--;F.push(0));F.reverse()}else for(J=(Q=(j=ne.length)<(A=fe.length))?j:A,j=A=0;A<J;A++)if(ne[A]!=fe[A]){Q=ne[A]<fe[A];break}if(Q&&(F=ne,ne=fe,fe=F,R.s=-R.s),0<(A=(J=fe.length)-(N=ne.length)))for(;A--;ne[N++]=0);for(A=g-1;j<J;){if(ne[--J]<fe[J]){for(N=J;N&&!ne[--N];ne[N]=A);--ne[N],ne[J]+=g}ne[J]-=fe[J]}for(;ne[0]==0;ne.splice(0,1),--Z);return ne[0]?Pe(R,ne,Z):(R.s=_==3?-1:1,R.c=[R.e=0],R)},m.modulo=m.mod=function(R,A){var N,J,F=this;return R=new ee(R,A),!F.c||!R.s||R.c&&!R.c[0]?new ee(NaN):!R.c||F.c&&!F.c[0]?new ee(F):(de==9?(J=R.s,R.s=1,N=L(F,R,0,3),R.s=J,N.s*=J):N=L(F,R,0,de),(R=F.minus(N.times(R))).c[0]||de!=1||(R.s=F.s),R)},m.multipliedBy=m.times=function(R,A){var N,J,F,Q,K,j,te,Z,ne,fe,Te,He,ke,ze,Tt,et=this,Ct=et.c,_t=(R=new ee(R,A)).c;if(!(Ct&&_t&&Ct[0]&&_t[0]))return!et.s||!R.s||Ct&&!Ct[0]&&!_t||_t&&!_t[0]&&!Ct?R.c=R.e=R.s=null:(R.s*=et.s,Ct&&_t?(R.c=[0],R.e=0):R.c=R.e=null),R;for(J=y(et.e/p)+y(R.e/p),R.s*=et.s,(te=Ct.length)<(fe=_t.length)&&(ke=Ct,Ct=_t,_t=ke,F=te,te=fe,fe=F),F=te+fe,ke=[];F--;ke.push(0));for(ze=g,Tt=I,F=fe;0<=--F;){for(N=0,Te=_t[F]%Tt,He=_t[F]/Tt|0,Q=F+(K=te);F<Q;)N=((Z=Te*(Z=Ct[--K]%Tt)+(j=He*Z+(ne=Ct[K]/Tt|0)*Te)%Tt*Tt+ke[Q]+N)/ze|0)+(j/Tt|0)+He*ne,ke[Q--]=Z%ze;ke[Q]=N}return N?++J:ke.splice(0,1),Pe(R,ke,J)},m.negated=function(){var R=new ee(this);return R.s=-R.s||null,R},m.plus=function(R,A){var N,J=this,F=J.s;if(A=(R=new ee(R,A)).s,!F||!A)return new ee(NaN);if(F!=A)return R.s=-A,J.minus(R);var Q=J.e/p,K=R.e/p,j=J.c,te=R.c;if(!Q||!K){if(!j||!te)return new ee(F/0);if(!j[0]||!te[0])return te[0]?R:new ee(j[0]?J:0*F)}if(Q=y(Q),K=y(K),j=j.slice(),F=Q-K){for((N=0<F?(K=Q,te):(F=-F,j)).reverse();F--;N.push(0));N.reverse()}for((F=j.length)-(A=te.length)<0&&(N=te,te=j,j=N,A=F),F=0;A;)F=(j[--A]=j[A]+te[A]+F)/g|0,j[A]=g===j[A]?0:j[A]%g;return F&&(j=[F].concat(j),++K),Pe(R,j,K)},m.precision=m.sd=function(R,A){var N,J,F;if(R!=null&&R!==!!R)return G(R,1,M),A==null?A=_:G(A,0,8),Fe(new ee(this),R,A);if(!(N=this.c))return null;if(J=(F=N.length-1)*p+1,F=N[F]){for(;F%10==0;F/=10,J--);for(F=N[0];10<=F;F/=10,J++);}return R&&this.e+1>J&&(J=this.e+1),J},m.shiftedBy=function(R){return G(R,-C,C),this.times("1e"+R)},m.squareRoot=m.sqrt=function(){var R,A,N,J,F,Q=this,K=Q.c,j=Q.s,te=Q.e,Z=O+4,ne=new ee("0.5");if(j!==1||!K||!K[0])return new ee(!j||j<0&&(!K||K[0])?NaN:K?Q:1/0);if((N=(j=Math.sqrt(+xe(Q)))==0||j==1/0?(((A=$(K)).length+te)%2==0&&(A+="0"),j=Math.sqrt(+A),te=y((te+1)/2)-(te<0||te%2),new ee(A=j==1/0?"1e"+te:(A=j.toExponential()).slice(0,A.indexOf("e")+1)+te)):new ee(j+"")).c[0]){for((j=(te=N.e)+Z)<3&&(j=0);;)if(F=N,N=ne.times(F.plus(L(Q,F,Z,1))),$(F.c).slice(0,j)===(A=$(N.c)).slice(0,j)){if(N.e<te&&--j,(A=A.slice(j-3,j+1))!="9999"&&(J||A!="4999")){+A&&(+A.slice(1)||A.charAt(0)!="5")||(Fe(N,N.e+O+2,1),R=!N.times(N).eq(Q));break}if(!J&&(Fe(F,F.e+O+2,0),F.times(F).eq(Q))){N=F;break}Z+=4,j+=4,J=1}}return Fe(N,N.e+O+1,_,R)},m.toExponential=function(R,A){return R!=null&&(G(R,0,M),R++),ye(this,R,A,1)},m.toFixed=function(R,A){return R!=null&&(G(R,0,M),R=R+this.e+1),ye(this,R,A)},m.toFormat=function(R,A,N){var J;if(N==null)R!=null&&A&&typeof A=="object"?(N=A,A=null):R&&typeof R=="object"?(N=R,R=A=null):N=pe;else if(typeof N!="object")throw Error(c+"Argument not an object: "+N);if(J=this.toFixed(R,A),this.c){var F,Q=J.split("."),K=+N.groupSize,j=+N.secondaryGroupSize,te=N.groupSeparator||"",Z=Q[0],ne=Q[1],fe=this.s<0,Te=fe?Z.slice(1):Z,He=Te.length;if(j&&(F=K,K=j,He-=j=F),0<K&&0<He){for(F=He%K||K,Z=Te.substr(0,F);F<He;F+=K)Z+=te+Te.substr(F,K);0<j&&(Z+=te+Te.slice(F)),fe&&(Z="-"+Z)}J=ne?Z+(N.decimalSeparator||"")+((j=+N.fractionGroupSize)?ne.replace(new RegExp("\\d{"+j+"}\\B","g"),"$&"+(N.fractionGroupSeparator||"")):ne):Z}return(N.prefix||"")+J+(N.suffix||"")},m.toFraction=function(R){var A,N,J,F,Q,K,j,te,Z,ne,fe,Te,He=this,ke=He.c;if(R!=null&&(!(j=new ee(R)).isInteger()&&(j.c||j.s!==1)||j.lt(T)))throw Error(c+"Argument "+(j.isInteger()?"out of range: ":"not an integer: ")+xe(j));if(!ke)return new ee(He);for(A=new ee(T),Z=N=new ee(T),J=te=new ee(T),Te=$(ke),Q=A.e=Te.length-He.e-1,A.c[0]=E[(K=Q%p)<0?p+K:K],R=!R||0<j.comparedTo(A)?0<Q?A:Z:j,K=se,se=1/0,j=new ee(Te),te.c[0]=0;ne=L(j,A,0,1),(F=N.plus(ne.times(J))).comparedTo(R)!=1;)N=J,J=F,Z=te.plus(ne.times(F=Z)),te=F,A=j.minus(ne.times(F=A)),j=F;return F=L(R.minus(N),J,0,1),te=te.plus(F.times(Z)),N=N.plus(F.times(J)),te.s=Z.s=He.s,fe=L(Z,J,Q*=2,_).minus(He).abs().comparedTo(L(te,N,Q,_).minus(He).abs())<1?[Z,J]:[te,N],se=K,fe},m.toNumber=function(){return+xe(this)},m.toPrecision=function(R,A){return R!=null&&G(R,1,M),ye(this,R,A,2)},m.toString=function(R){var A,N=this,J=N.s,F=N.e;return F===null?J?(A="Infinity",J<0&&(A="-"+A)):A="NaN":(A=R==null?F<=Y||U<=F?re($(N.c),F):v($(N.c),F,"0"):R===10?v($((N=Fe(new ee(N),O+F+1,_)).c),N.e,"0"):(G(R,2,we.length,"Base"),P(v($(N.c),F,"0"),10,R,J,!0)),J<0&&N.c[0]&&(A="-"+A)),A},m.valueOf=m.toJSON=function(){return xe(this)},m._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(m[Symbol.toStringTag]="BigNumber",m[Symbol.for("nodejs.util.inspect.custom")]=m.valueOf),b!=null&&ee.set(b),ee}()).default=s.BigNumber=s,r!==void 0&&r.exports?r.exports=s:(o||(o=typeof self<"u"&&self?self:window),o.BigNumber=s)})(this)},{}],2:[function(n,r,i){r.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(o){var s=o%10;return~~(o%100/10)==1?"th":s===1?"st":s===2?"nd":s===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(n,r,i){function o(y,$){return function(X){if(Array.isArray(X))return X}(y)||function(X,G){var q=[],re=!0,v=!1,S=void 0;try{for(var b,L=X[Symbol.iterator]();!(re=(b=L.next()).done)&&(q.push(b.value),!G||q.length!==G);re=!0);}catch(P){v=!0,S=P}finally{try{re||L.return==null||L.return()}finally{if(v)throw S}}return q}(y,$)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var s=n("./globalState"),a=n("./validating"),l=n("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],c={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},d={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function g(y){var $=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},X=2<arguments.length?arguments[2]:void 0;if(typeof $=="string"&&($=l.parseFormat($)),!a.validateFormat($))return"ERROR: invalid format";var G=$.prefix||"",q=$.postfix||"",re=function(v,S,b){switch(S.output){case"currency":return S=M(S,s.currentCurrencyDefaultFormat()),function(we,ee,ye){var $e=ye.currentCurrency(),Pe=Object.assign({},d,ee),Fe=void 0,xe="",R=!!Pe.totalLength||!!Pe.forceAverage||Pe.average,A=ee.currencyPosition||$e.position,N=ee.currencySymbol||$e.symbol;Pe.spaceSeparated&&(xe=" "),A==="infix"&&(Fe=xe+N+xe);var J=I({instance:we,providedFormat:ee,state:ye,decimalSeparator:Fe});return A==="prefix"&&(J=we._value<0&&Pe.negative==="sign"?"-".concat(xe).concat(N).concat(J.slice(1)):N+xe+J),A&&A!=="postfix"||(J=J+(xe=R?"":xe)+N),J}(v,S,s);case"percent":return S=M(S,s.currentPercentageDefaultFormat()),function(we,ee,ye,$e){var Pe=ee.prefixSymbol,Fe=I({instance:$e(100*we._value),providedFormat:ee,state:ye}),xe=Object.assign({},d,ee);return Pe?"%".concat(xe.spaceSeparated?" ":"").concat(Fe):"".concat(Fe).concat(xe.spaceSeparated?" ":"","%")}(v,S,s,b);case"byte":return S=M(S,s.currentByteDefaultFormat()),T=v,_=s,Y=b,U=(O=S).base||"binary",ie=c[U],se=p(T._value,ie.suffixes,ie.scale),oe=se.value,de=se.suffix,Se=I({instance:Y(oe),providedFormat:O,state:_,defaults:_.currentByteDefaultFormat()}),pe=_.currentAbbreviations(),"".concat(Se).concat(pe.spaced?" ":"").concat(de);case"time":return S=M(S,s.currentTimeDefaultFormat()),w=v,h=Math.floor(w._value/60/60),f=Math.floor((w._value-60*h*60)/60),m=Math.round(w._value-60*h*60-60*f),"".concat(h,":").concat(f<10?"0":"").concat(f,":").concat(m<10?"0":"").concat(m);case"ordinal":return S=M(S,s.currentOrdinalDefaultFormat()),L=v,P=S,W=(x=s).currentOrdinal(),D=Object.assign({},d,P),B=I({instance:L,providedFormat:P,state:x}),z=W(L._value),"".concat(B).concat(D.spaceSeparated?" ":"").concat(z);case"number":default:return I({instance:v,providedFormat:S,numbro:b})}var L,P,x,W,D,B,z,w,h,f,m,T,O,_,Y,U,ie,se,oe,de,Se,pe}(y,$,X);return re=(re=G+re)+q}function p(y,$,X){var G=$[0],q=Math.abs(y);if(X<=q){for(var re=1;re<$.length;++re){var v=Math.pow(X,re),S=Math.pow(X,re+1);if(v<=q&&q<S){G=$[re],y/=v;break}}G===$[0]&&(y/=Math.pow(X,$.length-1),G=$[$.length-1])}return{value:y,suffix:G}}function C(y){for(var $="",X=0;X<y;X++)$+="0";return $}function E(y,$){return y.toString().indexOf("e")!==-1?function(X,G){var q=X.toString(),re=o(q.split("e"),2),v=re[0],S=re[1],b=o(v.split("."),2),L=b[0],P=b[1],x=P===void 0?"":P;if(0<+S)q=L+x+C(S-x.length);else{var W=".";W=+L<0?"-0".concat(W):"0".concat(W);var D=(C(-S-1)+Math.abs(L)+x).substr(0,G);D.length<G&&(D+=C(G-D.length)),q=W+D}return 0<+S&&0<G&&(q+=".".concat(C(G))),q}(y,$):(Math.round(+"".concat(y,"e+").concat($))/Math.pow(10,$)).toFixed($)}function I(y){var $=y.instance,X=y.providedFormat,G=y.state,q=G===void 0?s:G,re=y.decimalSeparator,v=y.defaults,S=v===void 0?q.currentDefaults():v,b=$._value;if(b===0&&q.hasZeroFormat())return q.getZeroFormat();if(!isFinite(b))return b.toString();var L,P,x,W,D,B,z,w,h=Object.assign({},d,S,X),f=h.totalLength,m=f?0:h.characteristic,T=h.optionalCharacteristic,O=h.forceAverage,_=!!f||!!O||h.average,Y=f?-1:_&&X.mantissa===void 0?0:h.mantissa,U=!f&&(X.optionalMantissa===void 0?Y===-1:h.optionalMantissa),ie=h.trimMantissa,se=h.thousandSeparated,oe=h.spaceSeparated,de=h.negative,Se=h.forceSign,pe=h.exponential,we="";if(_){var ee=function(R){var A=R.value,N=R.forceAverage,J=R.abbreviations,F=R.spaceSeparated,Q=F!==void 0&&F,K=R.totalLength,j=K===void 0?0:K,te="",Z=Math.abs(A),ne=-1;if(Z>=Math.pow(10,12)&&!N||N==="trillion"?(te=J.trillion,A/=Math.pow(10,12)):Z<Math.pow(10,12)&&Z>=Math.pow(10,9)&&!N||N==="billion"?(te=J.billion,A/=Math.pow(10,9)):Z<Math.pow(10,9)&&Z>=Math.pow(10,6)&&!N||N==="million"?(te=J.million,A/=Math.pow(10,6)):(Z<Math.pow(10,6)&&Z>=Math.pow(10,3)&&!N||N==="thousand")&&(te=J.thousand,A/=Math.pow(10,3)),te&&(te=(Q?" ":"")+te),j){var fe=A.toString().split(".")[0];ne=Math.max(j-fe.length,0)}return{value:A,abbreviation:te,mantissaPrecision:ne}}({value:b,forceAverage:O,abbreviations:q.currentAbbreviations(),spaceSeparated:oe,totalLength:f});b=ee.value,we+=ee.abbreviation,f&&(Y=ee.mantissaPrecision)}if(pe){var ye=(P=(L={value:b,characteristicPrecision:m}).value,x=L.characteristicPrecision,W=x===void 0?0:x,D=o(P.toExponential().split("e"),2),B=D[0],z=D[1],w=+B,W&&1<W&&(w*=Math.pow(10,W-1),z=0<=(z=+z-(W-1))?"+".concat(z):z),{value:w,abbreviation:"e".concat(z)});b=ye.value,we=ye.abbreviation+we}var $e,Pe,Fe,xe=function(R,A,N,J,F){if(J===-1)return R;var Q=E(A,J),K=o(Q.toString().split("."),2),j=K[0],te=K[1],Z=te===void 0?"":te;if(Z.match(/^0+$/)&&(N||F))return j;var ne=Z.match(/0+$/);return F&&ne?"".concat(j,".").concat(Z.toString().slice(0,ne.index)):Q.toString()}(b.toString(),b,U,Y,ie);return xe=function(R,A,N,J,F){var Q=J.currentDelimiters(),K=Q.thousands;F=F||Q.decimal;var j=Q.thousandsSize||3,te=R.toString(),Z=te.split(".")[0],ne=te.split(".")[1];return N&&(A<0&&(Z=Z.slice(1)),function(fe,Te){for(var He=[],ke=0,ze=fe;0<ze;ze--)ke===Te&&(He.unshift(ze),ke=0),ke++;return He}(Z.length,j).forEach(function(fe,Te){Z=Z.slice(0,fe+Te)+K+Z.slice(fe+Te)}),A<0&&(Z="-".concat(Z))),te=ne?Z+F+ne:Z}(xe=function(R,A,N,J){var F=R,Q=o(F.toString().split("."),2),K=Q[0],j=Q[1];if(K.match(/^-?0$/)&&N)return j?"".concat(K.replace("0",""),".").concat(j):K.replace("0","");if(K.length<J)for(var te=J-K.length,Z=0;Z<te;Z++)F="0".concat(F);return F.toString()}(xe,0,T,m),b,se,q,re),(_||pe)&&(xe=xe+we),(Se||b<0)&&($e=xe,Fe=de,xe=(Pe=b)===0?$e:+$e==0?$e.replace("-",""):0<Pe?"+".concat($e):Fe==="sign"?$e:"(".concat($e.replace("-",""),")")),xe}function M(y,$){if(!y)return $;var X=Object.keys(y);return X.length===1&&X[0]==="output"?$:y}r.exports=function(y){return{format:function(){for(var $=arguments.length,X=new Array($),G=0;G<$;G++)X[G]=arguments[G];return g.apply(void 0,X.concat([y]))},getByteUnit:function(){for(var $=arguments.length,X=new Array($),G=0;G<$;G++)X[G]=arguments[G];return function(q){var re=c.general;return p(q._value,re.suffixes,re.scale).suffix}.apply(void 0,X.concat([y]))},getBinaryByteUnit:function(){for(var $=arguments.length,X=new Array($),G=0;G<$;G++)X[G]=arguments[G];return function(q){var re=c.binary;return p(q._value,re.suffixes,re.scale).suffix}.apply(void 0,X.concat([y]))},getDecimalByteUnit:function(){for(var $=arguments.length,X=new Array($),G=0;G<$;G++)X[G]=arguments[G];return function(q){var re=c.decimal;return p(q._value,re.suffixes,re.scale).suffix}.apply(void 0,X.concat([y]))},formatOrDefault:M}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(n,r,i){var o=n("./en-US"),s=n("./validating"),a=n("./parsing"),l={},u=void 0,c={},d=null,g={};function p(E){u=E}function C(){return c[u]}l.languages=function(){return Object.assign({},c)},l.currentLanguage=function(){return u},l.currentCurrency=function(){return C().currency},l.currentAbbreviations=function(){return C().abbreviations},l.currentDelimiters=function(){return C().delimiters},l.currentOrdinal=function(){return C().ordinal},l.currentDefaults=function(){return Object.assign({},C().defaults,g)},l.currentOrdinalDefaultFormat=function(){return Object.assign({},l.currentDefaults(),C().ordinalFormat)},l.currentByteDefaultFormat=function(){return Object.assign({},l.currentDefaults(),C().byteFormat)},l.currentPercentageDefaultFormat=function(){return Object.assign({},l.currentDefaults(),C().percentageFormat)},l.currentCurrencyDefaultFormat=function(){return Object.assign({},l.currentDefaults(),C().currencyFormat)},l.currentTimeDefaultFormat=function(){return Object.assign({},l.currentDefaults(),C().timeFormat)},l.setDefaults=function(E){E=a.parseFormat(E),s.validateFormat(E)&&(g=E)},l.getZeroFormat=function(){return d},l.setZeroFormat=function(E){return d=typeof E=="string"?E:null},l.hasZeroFormat=function(){return d!==null},l.languageData=function(E){if(E){if(c[E])return c[E];throw new Error('Unknown tag "'.concat(E,'"'))}return C()},l.registerLanguage=function(E){var I=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!s.validateLanguage(E))throw new Error("Invalid language data");c[E.languageTag]=E,I&&p(E.languageTag)},l.setLanguage=function(E){var I=1<arguments.length&&arguments[1]!==void 0?arguments[1]:o.languageTag;if(!c[E]){var M=E.split("-")[0],y=Object.keys(c).find(function($){return $.split("-")[0]===M});return c[y]?void p(y):void p(I)}p(E)},l.registerLanguage(o),u=o.languageTag,r.exports=l},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(n,r,i){r.exports=function(o){return{loadLanguagesInNode:function(s){return a=o,void s.forEach(function(l){var u=void 0;try{u=n("../languages/".concat(l))}catch{console.error('Unable to load "'.concat(l,'". No matching language file found.'))}u&&a.registerLanguage(u)});var a}}}},{}],6:[function(n,r,i){var o=n("bignumber.js");function s(a,l,u){var c=new o(a._value),d=l;return u.isNumbro(l)&&(d=l._value),d=new o(d),a._value=c.minus(d).toNumber(),a}r.exports=function(a){return{add:function(l,u){return d=u,g=a,p=new o((c=l)._value),C=d,g.isNumbro(d)&&(C=d._value),C=new o(C),c._value=p.plus(C).toNumber(),c;var c,d,g,p,C},subtract:function(l,u){return s(l,u,a)},multiply:function(l,u){return d=u,g=a,p=new o((c=l)._value),C=d,g.isNumbro(d)&&(C=d._value),C=new o(C),c._value=p.times(C).toNumber(),c;var c,d,g,p,C},divide:function(l,u){return d=u,g=a,p=new o((c=l)._value),C=d,g.isNumbro(d)&&(C=d._value),C=new o(C),c._value=p.dividedBy(C).toNumber(),c;var c,d,g,p,C},set:function(l,u){return c=l,g=d=u,a.isNumbro(d)&&(g=d._value),c._value=g,c;var c,d,g},difference:function(l,u){return c=u,s(g=(d=a)(l._value),c,d),Math.abs(g._value);var c,d,g}}}},{"bignumber.js":1}],7:[function(n,r,i){function o(I,M){for(var y=0;y<M.length;y++){var $=M[y];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(I,$.key,$)}}var s=n("./globalState"),a=n("./validating"),l=n("./loading")(E),u=n("./unformatting"),c=n("./formatting")(E),d=n("./manipulating")(E),g=n("./parsing"),p=function(){function I($){(function(X,G){if(!(X instanceof G))throw new TypeError("Cannot call a class as a function")})(this,I),this._value=$}var M,y;return M=I,(y=[{key:"clone",value:function(){return E(this._value)}},{key:"format",value:function(){var $=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return c.format(this,$)}},{key:"formatCurrency",value:function($){return typeof $=="string"&&($=g.parseFormat($)),($=c.formatOrDefault($,s.currentCurrencyDefaultFormat())).output="currency",c.format(this,$)}},{key:"formatTime",value:function(){var $=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return $.output="time",c.format(this,$)}},{key:"binaryByteUnits",value:function(){return c.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return c.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return c.getByteUnit(this)}},{key:"difference",value:function($){return d.difference(this,$)}},{key:"add",value:function($){return d.add(this,$)}},{key:"subtract",value:function($){return d.subtract(this,$)}},{key:"multiply",value:function($){return d.multiply(this,$)}},{key:"divide",value:function($){return d.divide(this,$)}},{key:"set",value:function($){return d.set(this,C($))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&o(M.prototype,y),I}();function C(I){var M=I;return E.isNumbro(I)?M=I._value:typeof I=="string"?M=E.unformat(I):isNaN(I)&&(M=NaN),M}function E(I){return new p(C(I))}E.version="2.1.2",E.isNumbro=function(I){return I instanceof p},E.language=s.currentLanguage,E.registerLanguage=s.registerLanguage,E.setLanguage=s.setLanguage,E.languages=s.languages,E.languageData=s.languageData,E.zeroFormat=s.setZeroFormat,E.defaultFormat=s.currentDefaults,E.setDefaults=s.setDefaults,E.defaultCurrencyFormat=s.currentCurrencyDefaultFormat,E.validate=a.validate,E.loadLanguagesInNode=l.loadLanguagesInNode,E.unformat=u.unformat,r.exports=E},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(n,r,i){r.exports={parseFormat:function(o){var s,a,l,u,c,d,g,p,C,E,I,M,y,$,X,G,q,re,v,S,b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof o!="string"?o:(a=b,o=(l=(s=o).match(/^{([^}]*)}/))?(a.prefix=l[1],s.slice(l[0].length)):s,c=b,function(L,P){if(L.indexOf("$")===-1){if(L.indexOf("%")===-1)return L.indexOf("bd")!==-1?(P.output="byte",P.base="general"):L.indexOf("b")!==-1?(P.output="byte",P.base="binary"):L.indexOf("d")!==-1?(P.output="byte",P.base="decimal"):L.indexOf(":")===-1?L.indexOf("o")!==-1&&(P.output="ordinal"):P.output="time";P.output="percent"}else P.output="currency"}(o=(d=(u=o).match(/{([^}]*)}$/))?(c.postfix=d[1],u.slice(0,-d[0].length)):u,b),g=b,(p=o.match(/[1-9]+[0-9]*/))&&(g.totalLength=+p[0]),C=b,(E=o.split(".")[0].match(/0+/))&&(C.characteristic=E[0].length),function(L,P){if(L.indexOf(".")!==-1){var x=L.split(".")[0];P.optionalCharacteristic=x.indexOf("0")===-1}}(o,b),I=b,o.indexOf("a")!==-1&&(I.average=!0),y=b,(M=o).indexOf("K")!==-1?y.forceAverage="thousand":M.indexOf("M")!==-1?y.forceAverage="million":M.indexOf("B")!==-1?y.forceAverage="billion":M.indexOf("T")!==-1&&(y.forceAverage="trillion"),function(L,P){var x=L.split(".")[1];if(x){var W=x.match(/0+/);W&&(P.mantissa=W[0].length)}}(o,b),X=b,($=o).match(/\[\.]/)?X.optionalMantissa=!0:$.match(/\./)&&(X.optionalMantissa=!1),G=b,o.indexOf(",")!==-1&&(G.thousandSeparated=!0),q=b,o.indexOf(" ")!==-1&&(q.spaceSeparated=!0),v=b,(re=o).match(/^\+?\([^)]*\)$/)&&(v.negative="parenthesis"),re.match(/^\+?-/)&&(v.negative="sign"),S=b,o.match(/^\+/)&&(S.forceSign=!0),b)}}},{}],9:[function(n,r,i){var o=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function s(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function a(l,u){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",d=3<arguments.length?arguments[3]:void 0,g=4<arguments.length?arguments[4]:void 0,p=5<arguments.length?arguments[5]:void 0,C=6<arguments.length?arguments[6]:void 0;if(l!=="")return l===g?0:function E(I,M){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",$=3<arguments.length?arguments[3]:void 0,X=4<arguments.length?arguments[4]:void 0,G=5<arguments.length?arguments[5]:void 0,q=6<arguments.length?arguments[6]:void 0;if(!isNaN(+I))return+I;var re="",v=I.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(v!==I)return-1*E(v,M,y,$,X,G,q);for(var S=0;S<o.length;S++){var b=o[S];if((re=I.replace(b.key,""))!==I)return E(re,M,y,$,X,G,q)*b.factor}if((re=I.replace("%",""))!==I)return E(re,M,y,$,X,G,q)/100;var L=parseFloat(I);if(!isNaN(L)){var P=$(L);if(P&&P!=="."&&(re=I.replace(new RegExp("".concat(s(P),"$")),""))!==I)return E(re,M,y,$,X,G,q);var x={};Object.keys(G).forEach(function(f){x[G[f]]=f});for(var W=Object.keys(x).sort().reverse(),D=W.length,B=0;B<D;B++){var z=W[B],w=x[z];if((re=I.replace(z,""))!==I){var h=void 0;switch(w){case"thousand":h=Math.pow(10,3);break;case"million":h=Math.pow(10,6);break;case"billion":h=Math.pow(10,9);break;case"trillion":h=Math.pow(10,12)}return E(re,M,y,$,X,G,q)*h}}}}(function(E,I){var M=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",y=E.replace(M,"");return y=(y=y.replace(new RegExp("([0-9])".concat(s(I.thousands),"([0-9])"),"g"),"$1$2")).replace(I.decimal,".")}(l,u,c),u,c,d,g,p,C)}r.exports={unformat:function(l,u){var c,d,g,p=n("./globalState"),C=p.currentDelimiters(),E=p.currentCurrency().symbol,I=p.currentOrdinal(),M=p.getZeroFormat(),y=p.currentAbbreviations(),$=void 0;if(typeof l=="string")$=function(X,G){if(!X.indexOf(":")||G.thousands===":")return!1;var q=X.split(":");if(q.length!==3)return!1;var re=+q[0],v=+q[1],S=+q[2];return!isNaN(re)&&!isNaN(v)&&!isNaN(S)}(l,C)?(c=l.split(":"),d=+c[0],g=+c[1],+c[2]+60*g+3600*d):a(l,C,E,I,M,y,u);else{if(typeof l!="number")return;$=l}if($!==void 0)return $}}},{"./globalState":4}],10:[function(n,r,i){function o(C){return function(E){if(Array.isArray(E)){for(var I=0,M=new Array(E.length);I<E.length;I++)M[I]=E[I];return M}}(C)||function(E){if(Symbol.iterator in Object(E)||Object.prototype.toString.call(E)==="[object Arguments]")return Array.from(E)}(C)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(C){return(s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(E){return typeof E}:function(E){return E&&typeof Symbol=="function"&&E.constructor===Symbol&&E!==Symbol.prototype?"symbol":typeof E})(C)}var a=n("./unformatting"),l=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(C,E){return E.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(C){return C.output==="byte"}},characteristic:{type:"number",restriction:function(C){return 0<=C},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(C){return 0<=C},message:"value must be positive"},{restriction:function(C,E){return!E.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(C){return 0<=C},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(C,E){return E.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:function(C){return C.match(l)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function d(C){return!!a.unformat(C)}function g(C,E,I){var M=3<arguments.length&&arguments[3]!==void 0&&arguments[3],y=Object.keys(C).map(function($){if(!E[$])return console.error("".concat(I," Invalid key: ").concat($)),!1;var X=C[$],G=E[$];if(typeof G=="string"&&(G={type:G}),G.type==="format"){if(!g(X,u,"[Validate ".concat($,"]"),!0))return!1}else if(s(X)!==G.type)return console.error("".concat(I," ").concat($,' type mismatched: "').concat(G.type,'" expected, "').concat(s(X),'" provided')),!1;if(G.restrictions&&G.restrictions.length)for(var q=G.restrictions.length,re=0;re<q;re++){var v=G.restrictions[re],S=v.restriction,b=v.message;if(!S(X,C))return console.error("".concat(I," ").concat($," invalid value: ").concat(b)),!1}return G.restriction&&!G.restriction(X,C)?(console.error("".concat(I," ").concat($," invalid value: ").concat(G.message)),!1):G.validValues&&G.validValues.indexOf(X)===-1?(console.error("".concat(I," ").concat($," invalid value: must be among ").concat(JSON.stringify(G.validValues),', "').concat(X,'" provided')),!1):!(G.children&&!g(X,G.children,"[Validate ".concat($,"]")))});return M||y.push.apply(y,o(Object.keys(E).map(function($){var X=E[$];if(typeof X=="string"&&(X={type:X}),X.mandatory){var G=X.mandatory;if(typeof G=="function"&&(G=G(C)),G&&C[$]===void 0)return console.error("".concat(I,' Missing mandatory key "').concat($,'"')),!1}return!0}))),y.reduce(function($,X){return $&&X},!0)}function p(C){return g(C,u,"[Validate format]")}r.exports={validate:function(C,E){var I=d(C),M=p(E);return I&&M},validateFormat:p,validateInput:d,validateLanguage:function(C){return g(C,c,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(G6);const ia=LS,z6="numeric";function $S(t,e,n,r,i,o,s){let a=o;if(Xn(a)){const l=s.numericFormat,u=l&&l.culture||"-",c=l&&l.pattern,d=s.className||"",g=d.length?d.split(" "):[];if(typeof u<"u"&&!ia.languages()[u]){const p=u.replace("-",""),C=ia.allLanguages?ia.allLanguages[u]:ia[p];C&&ia.registerLanguage(C)}ia.setLanguage(u),a=ia(a).format(c||"0"),g.indexOf("htLeft")<0&&g.indexOf("htCenter")<0&&g.indexOf("htRight")<0&&g.indexOf("htJustify")<0&&g.push("htRight"),g.indexOf("htNumeric")<0&&g.push("htNumeric"),s.className=g.join(" "),e.dir="ltr"}Eo(t,e,n,r,i,a,s)}$S.RENDERER_TYPE=z6;const j6="password";function kS(t,e,n,r,i,o,s){Eo.apply(this,[t,e,n,r,i,o,s]);const a=s.hashLength||e.innerHTML.length,l=s.hashSymbol||"*";let u="";Ie(a-1,()=>{u+=l}),Ys(e,u)}kS.RENDERER_TYPE=j6;const K6="time";function FS(t,e,n,r,i,o,s){Eo.apply(this,[t,e,n,r,i,o,s]),e.dir="ltr"}FS.RENDERER_TYPE=K6;function X6(){xi(cl),xi(lc),xi(DS),xi(HS),xi($S),xi(kS),xi(Eo),xi(FS)}const q6="autocomplete";function Rf(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,zO(n,e)):zO(n,e)(this.source):e(!0)}Rf.VALIDATOR_TYPE=q6;function zO(t,e){const n=t;return function(r){let i=!1;for(let o=0,s=r.length;o<s;o++)if(n===r[o]){i=!0;break}e(i)}}function jO(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const Z6=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:jO},Symbol.toStringTag,{value:"Module"})),Q6="date";function WS(t,e){const n=ZT(NO,this.instance);let r=t,i=!0;r==null&&(r="");let o=le(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=le(new Date(r)).isValid()||o;if(this.allowEmpty&&r===""&&(s=!0,o=!0),s||(i=!1),!s&&o&&(i=!0),s&&!o)if(this.correctFormat===!0){const a=J6(r,this.dateFormat),l=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(l,u,a,"dateValidator"),i=!0}else i=!1;e(i)}WS.VALIDATOR_TYPE=Q6;function J6(t,e){const n=le(jO(t)),r=le(t,e),i=t.search(/[A-z]/g)>-1;let o;return n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||i?o=n:o=r,o.format(e)}const e9="numeric";function VS(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:Xn(t))}VS.VALIDATOR_TYPE=e9;const t9=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],n9="time";function BS(t,e){const n=this.timeFormat||"h:mm:ss a";let r=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const o=/^\d{1,2}$/.test(i);o&&(i+=":00");const s=le(i,t9,!0).isValid()?le(i):le(i,n);let a=s.isValid(),l=le(i,n,!0).isValid()&&!o;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(r=!1),!a&&l&&(r=!0),a&&!l)if(this.correctFormat===!0){const u=s.format(n),c=this.instance.toVisualRow(this.row),d=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(c,d,u,"timeValidator"),r=!0}else r=!1;e(r)}BS.VALIDATOR_TYPE=n9;function r9(){Ja(Rf),Ja(WS),Ja(VS),Ja(BS)}const i9={CELL_TYPE:"autocomplete",editor:IS,renderer:cl,validator:Rf},o9={CELL_TYPE:"checkbox",editor:DO,renderer:DS},s9="date";function KO(t,e,n,r,i,o,s){cl.apply(this,[t,e,n,r,i,o,s])}KO.RENDERER_TYPE=s9;const a9={CELL_TYPE:"date",editor:$O,renderer:KO,validator:WS},l9={CELL_TYPE:"dropdown",editor:PS,renderer:cl,validator:Rf},u9="handsontable";function XO(t,e,n,r,i,o,s){cl.apply(this,[t,e,n,r,i,o,s])}XO.RENDERER_TYPE=u9;const c9={CELL_TYPE:"handsontable",editor:OS,renderer:XO},h9={CELL_TYPE:"numeric",editor:kO,renderer:$S,validator:VS,dataType:"number"},d9={CELL_TYPE:"password",editor:FO,renderer:kS,copyable:!1},f9="select";function qO(t,e,n,r,i,o,s){Eo.apply(this,[t,e,n,r,i,o,s])}qO.RENDERER_TYPE=f9;const g9={CELL_TYPE:"select",editor:VO,renderer:qO},m9={CELL_TYPE:"time",editor:BO,renderer:FS,validator:BS};function p9(){Vr(i9),Vr(o9),Vr(a9),Vr(l9),Vr(c9),Vr(h9),Vr(d9),Vr(g9),Vr(PO),Vr(m9)}function w9(t,e){ZO(t,e),e.add(t)}function C9(t,e,n){ZO(t,e),e.set(t,n)}function ZO(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fl(t,e,n){return e=v9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function v9(t){var e=S9(t,"string");return typeof e=="symbol"?e:String(e)}function S9(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function y9(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function gl(t,e){var n=b9(t,e,"get");return R9(t,n)}function b9(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function R9(t,e){return e.get?e.get.call(t):e.value}const QO=new Map([["plugin",Rz],["cell-type",sO],["editor",qT],["renderer",g_],["validator",m_]]),E9="base",US=[];let Fi=null;var oa=new WeakMap,JO=new WeakSet;class gt{static get PLUGIN_KEY(){return E9}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(e){w9(this,JO),fl(this,"eventManager",new br(this)),fl(this,"pluginName",null),fl(this,"pluginsInitializedCallbacks",[]),fl(this,"isPluginsReady",!1),fl(this,"enabled",!1),fl(this,"initialized",!1),C9(this,oa,{writable:!0,value:{}}),Pi(this,"hot",e,{writable:!1}),Fi=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const i=[];if(n.forEach(o=>{const[s,a]=o.split(":");if(!QO.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);QO.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");US.push(o)}}if(Fi||(Fi=$w()),Fi.indexOf("UndoRedo")>=0&&Fi.splice(Fi.indexOf("UndoRedo"),1),Fi.indexOf(this.pluginName)>=0&&Fi.splice(Fi.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),Fi.length===0){if(US.length>0){const i=[`${US.join(`
`)}
`,"You have to import and register them manually."].join("");throw new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}addHook(e,n){gl(this,oa)[e]=gl(this,oa)[e]||[];const r=gl(this,oa)[e];this.hot.addHook(e,n),r.push(n),gl(this,oa)[e]=r}removeHooks(e){H(gl(this,oa)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=gl(this,oa);Ze(e,(n,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){H(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=y9(this,JO,T9).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),Ze(this,(n,r)=>{r!=="hot"&&(this[r]=null)}),delete this.t,delete this.hot}}function T9(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function sa(t,e,n){return e=_9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _9(t){var e=M9(t,"string");return typeof e=="symbol"?e:String(e)}function M9(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const YS=class{constructor(e){sa(this,"hot",null),sa(this,"container",null),sa(this,"injected",!1),sa(this,"rows",[]),sa(this,"columns",[]),sa(this,"samples",null),sa(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={row:e};this.rows.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={col:e};this.columns.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),H(this.rows,n=>{e(n.row,Wt(n.table)-1)})}getWidths(e){this.injected||this.injectTable(),H(this.columns,n=>{const{width:r}=n.table.getBoundingClientRect();e(n.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(r=>{H(r.strings,i=>{n.appendChild(this.createColElement(i.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),r.appendChild(i)),this.samples.forEach(o=>{H(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a);l.col=a,l.row=e;const u=this.hot.getCellRenderer(l),c=n.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),r.appendChild(c)})}),r}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");r.push([-1,i]),n.appendChild(i)}this.samples.forEach(i=>{H(i.strings,o=>{const s=o.col,a=e.createElement("th");r.push([s,a]),n.appendChild(a)})}),this.table.tHead.appendChild(n),H(r,i=>{const[o,s]=i;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment();return this.samples.forEach(i=>{H(i.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e);a.col=e,a.row=s;const l=this.hot.getCellRenderer(a),u=n.createElement("td"),c=n.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),r.appendChild(c)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const r=this.hot.rootDocument.createElement("col");let i=0;n>=0&&e>=0&&(i=this.hot.getCellMeta(n,e).colspan);let o=this.hot.view._wt.wtTable.getStretchedColumnWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)o+=this.hot.view._wt.wtTable.getStretchedColumnWidth(s);return r.style.width=`${o}px`,r}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("table"),o=n.createElement("thead"),s=n.createElement("tbody"),a=n.createElement("colgroup"),l=n.createElement("tr"),u=n.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&s.appendChild(l),i.appendChild(s),ce(i,e),r.appendChild(i),{fragment:r,table:i,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return ce(i,o),r.appendChild(i),{fragment:r,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function Ef(t,e,n){return e=O9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function O9(t){var e=A9(t,"string");return typeof e=="symbol"?e:String(e)}function A9(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class GS{static get SAMPLE_COUNT(){return 3}constructor(e){Ef(this,"samples",null),Ef(this,"dataFactory",null),Ef(this,"customSampleCount",null),Ef(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:GS.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,r){const i=new Map,{from:o,to:s}=typeof r=="number"?{from:r,to:r}:r;return Ie(o,s,a=>{const l=this.generateSample(e,n,a);i.set(a,l)}),i}generateSample(e,n,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,o=e==="row"?"col":"row",s=[];return Ie(n.from,n.to,a=>{const l=e==="row"?this.dataFactory(r,a):this.dataFactory(a,r);if(l===!1)return;const{value:u,bundleSeed:c}=l,d=typeof c=="string"&&c.length>0;let g;d?g=c:Ke(u)?g=`${Object.keys(u).length}`:Array.isArray(u)?g=`${u.length}`:g=`${Yt(u).length}`,i.has(g)||i.set(g,{needed:this.getSampleCount(),strings:[]});const p=i.get(g);p.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||d)&&(p.strings.push({value:u,[o]:a}),s.push(u),p.needed-=1)}),i}}const eA=GS;function ml(t,e){tA(t,e),e.add(t)}function I9(t,e,n){tA(t,e),e.set(t,n)}function tA(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pl(t,e,n){return e=P9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function P9(t){var e=x9(t,"string");return typeof e=="symbol"?e:String(e)}function x9(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function H9(t,e,n){var r=nA(t,e,"set");return D9(t,r,n),n}function D9(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Tf(t,e){var n=nA(t,e,"get");return N9(t,n)}function nA(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function N9(t,e){return e.get?e.get.call(t):e.value}function aa(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}_e.getSingleton().register("modifyAutoColumnSizeSeed");const uc="autoColumnSize",L9=10,$9="autoColumnSize";var wl=new WeakMap,rA=new WeakSet,iA=new WeakSet,oA=new WeakSet,zS=new WeakSet,sA=new WeakSet,aA=new WeakSet;class cc extends gt{static get PLUGIN_KEY(){return uc}static get PLUGIN_PRIORITY(){return L9}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),ml(this,aA),ml(this,sA),ml(this,zS),ml(this,oA),ml(this,iA),ml(this,rA),pl(this,"ghostTable",new YS(this.hot)),pl(this,"samplesGenerator",new eA((n,r)=>{const i=this.hot.getCellMeta(n,r);let o="";i.spanned||(o=this.hot.getDataAtCell(n,r));let s="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(s=this.hot.runHooks("modifyAutoColumnSizeSeed",s,i,o)),{value:o,bundleSeed:s}})),pl(this,"firstCalculation",!0),pl(this,"inProgress",!1),pl(this,"measuredColumns",0),pl(this,"columnWidthsMap",new cs),I9(this,wl,{writable:!0,value:[]}),this.hot.columnIndexMapper.registerMap($9,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,r,i)=>aa(this,zS,lA).call(this,n,r,i))}isEnabled(){return this.hot.getSettings()[uc]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[uc];n&&n.useHeaders!==null&&n.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",n.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return aa(e,iA,F9).call(e,...i)}),this.addHook("beforeChangeRender",r=>aa(this,oA,W9).call(this,r)),this.addHook("afterFormulasValuesUpdate",r=>aa(this,aA,B9).call(this,r)),this.addHook("beforeViewRender",r=>aa(this,rA,k9).call(this,r)),this.addHook("modifyColWidth",(r,i)=>this.getColumnWidth(i,r)),this.addHook("afterInit",()=>aa(this,sA,V9).call(this)),super.enablePlugin()}updatePlugin(){const e=this.findColumnsWhereHeaderWasChanged();e.length&&(this.clearCache(e),this.calculateVisibleColumnsWidth()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,r)=>aa(this,zS,lA).call(this,e,n,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const n=this.hot.renderCall,r=this.getFirstVisibleColumn(),i=this.getLastVisibleColumn();r===-1||i===-1||this.calculateColumnsWidth({from:r,to:i},void 0,n)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;Ie(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);if(a===null&&(a=s),r||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a)){const l=this.samplesGenerator.generateColumnSamples(s,o);H(l,u=>{let[c,d]=u;return this.ghostTable.addColumn(c,d)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((s,a)=>{const l=this.hot.toPhysicalColumn(s);this.columnWidthsMap.setValueAtIndex(l,a)})},!0),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=0;const r=this.hot.countCols()-1;let i=null;this.inProgress=!0;const o=()=>{if(!this.hot){zu(i),this.inProgress=!1;return}this.calculateColumnsWidth({from:n,to:Math.min(n+cc.CALCULATION_STEP,r)},e),n=n+cc.CALCULATION_STEP+1,n<r?i=Wd(o):(zu(i),this.inProgress=!1,this.hot.view.adjustElementsSize())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateColumnsWidth({from:0,to:s},e),this.firstCalculation=!1,n=s+1),n<r?o():this.inProgress=!1}setSamplingOptions(){const e=this.hot.getSettings()[uc],n=e&&Vt(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&Vt(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllColumnsWidth(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}getSyncCalculationLimit(){const e=this.hot.getSettings()[uc];let n=cc.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return Ke(e)&&(n=e.syncLimit,nw(n)?n=Hw(r,n):n>>=0),Math.min(n,r)}getColumnWidth(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=n;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof i=="number"&&(i=Math.max(i,Gw.DEFAULT_WIDTH))),i}getFirstVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const n=e.wtTable.getFirstVisibleColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}if(e.wtViewport.columnsRenderCalculator){const n=e.wtTable.getFirstRenderedColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}getLastVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const n=e.wtTable.getLastVisibleColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}if(e.wtViewport.columnsRenderCalculator){const n=e.wtTable.getLastRenderedColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}findColumnsWhereHeaderWasChanged(){const e=this.hot.getColHeader();return en(e,(r,i,o)=>{const s=Tf(this,wl).length;return(s-1<o||Tf(this,wl)[o]!==i)&&r.push(o),s-1<o?Tf(this,wl).push(i):Tf(this,wl)[o]=i,r},[])}clearCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];e.length?this.hot.batchExecution(()=>{H(e,n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!yr(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function k9(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}function F9(){this.hot.view?this.recalculateAllColumnsWidth():setTimeout(()=>{this.hot&&this.recalculateAllColumnsWidth()},0)}function W9(t){const e=qe(t,n=>{let[,r]=n;return this.hot.toPhysicalColumn(this.hot.propToCol(r))});this.clearCache(Array.from(new Set(e)))}function lA(t,e,n){let r=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function V9(){H9(this,wl,this.hot.getColHeader())}function B9(t){const e=yr(t,r=>{var i;return be((i=r.address)===null||i===void 0?void 0:i.col)}),n=qe(e,r=>r.address.col);this.clearCache(Array.from(new Set(n)))}const la={horizontal:"horizontal",vertical:"vertical"};function U9(t,e,n){let r,i,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",r=n(e[0],e[1]),i=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",r=n(e[0],t[3]+1),i=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",r=n(e[0],e[1]),i=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",r=n(t[2]+1,e[1]),i=n(e[2],e[3])),r&&r.normalize(),i&&i.normalize(),{directionOfDrag:o,startOfDragCoords:r,endOfDragCoords:i}}function Y9(t){const e={};return t===!0?(e.directions=Object.keys(la),e.autoInsertRow=!0):Ke(t)?(be(t.autoInsertRow)?t.direction===la.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,be(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(la)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function hc(t,e){G9(t,e),e.add(t)}function G9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cl(t,e,n){return e=z9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function z9(t){var e=j9(t,"string");return typeof e=="symbol"?e:String(e)}function j9(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dc(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}_e.getSingleton().register("modifyAutofillRange"),_e.getSingleton().register("beforeAutofill"),_e.getSingleton().register("afterAutofill");const uA="autofill",K9=20,X9=["fillHandle"],q9="insert_row_below",Z9=200;var cA=new WeakSet,hA=new WeakSet,dA=new WeakSet,fA=new WeakSet,gA=new WeakSet;class Q9 extends gt{constructor(){super(...arguments),hc(this,gA),hc(this,fA),hc(this,dA),hc(this,hA),hc(this,cA),Cl(this,"addingStarted",!1),Cl(this,"mouseDownOnCellCorner",!1),Cl(this,"mouseDragOutside",!1),Cl(this,"handleDraggedCells",0),Cl(this,"directions",[]),Cl(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return uA}static get PLUGIN_PRIORITY(){return K9}static get SETTING_KEYS(){return[uA,...X9]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>dc(this,hA,e8).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>dc(this,cA,J9).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>dc(this,dA,t8).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:r,endRow:i,endCol:o}]),a=[],l=[],u=[];return H(s,c=>{for(let d=c.startRow;d<=c.endRow;d+=1)a.indexOf(d)===-1&&a.push(d);for(let d=c.startCol;d<=c.endCol;d+=1)l.indexOf(d)===-1&&l.push(d)}),H(a,c=>{const d=[];H(l,g=>{d.push(this.hot.getCopyableData(c,g))}),u.push(d)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,r,i]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),s=o.getTopStartCorner(),a=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[s.row,s.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,n),Math.max(a.row,r),Math.max(a.col,i)],l),{directionOfDrag:c,startOfDragCoords:d,endOfDragCoords:g}=U9(l,u,(p,C)=>this.hot._createCellCoords(p,C));if(d&&d.row>-1&&d.col>-1){const p=this.getSelectionData(),C=o.clone(),E=this.hot._createCellRange(d,d,g),I=this.hot.runHooks("beforeAutofill",p,C,E,c);if(I===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let M=I;const y=I;if(["up","left"].indexOf(c)>-1&&!(y.length===1&&y[0].length===0))if(M=[],c==="up"){const $=g.row-d.row+1,X=$%y.length;for(let G=0;G<$;G++)M.push(y[(G+(y.length-X))%y.length])}else{const $=g.col-d.col+1,X=$%y[0].length;for(let G=0;G<y.length;G++){M.push([]);for(let q=0;q<$;q++)M[G].push(y[G][(q+(y[G].length-X))%y[G].length])}}this.hot.populateFromArray(d.row,d.col,M,g.row,g.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",M,C,E,c),this.hot.render()}else this.hot._refreshBorders();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),r=n.getBottomEndCorner();let i=e;if(this.directions.includes(la.vertical)&&this.directions.includes(la.horizontal)){const o=n.getTopStartCorner();(r.col<=e.col||o.col>=e.col)&&(i=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||o.row>e.row)&&(i=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(la.vertical))i=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(la.horizontal))i=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(q9,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},Z9)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&n[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),r=this.hot.countRows();let i;for(let o=e[2]+1;o<r;o++){for(let l=e[1];l<=e[3];l++)if(n[o][l])return-1;const s=n[o][e[1]-1],a=n[o][e[3]+1];(s||a)&&(i=o)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...qe(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,r=sn(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+Wt(this.hot.table),i=sn(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+yt(this.hot.table);return e.clientY>r&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>dc(this,fA,n8).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>dc(this,gA,r8).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=Y9(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function J9(){this.selectAdjacent()&&this.fillIn()}function e8(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function t8(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function n8(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function r8(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function _f(t,e){i8(t,e),e.add(t)}function i8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ua(t,e,n){return e=o8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o8(t){var e=s8(t,"string");return typeof e=="symbol"?e:String(e)}function s8(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fc(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Mf="autoRowSize",a8=40,l8="autoRowSize";var mA=new WeakSet,jS=new WeakSet,pA=new WeakSet,wA=new WeakSet;class gc extends gt{static get PLUGIN_KEY(){return Mf}static get PLUGIN_PRIORITY(){return a8}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),_f(this,wA),_f(this,pA),_f(this,jS),_f(this,mA),ua(this,"headerHeight",null),ua(this,"ghostTable",new YS(this.hot)),ua(this,"samplesGenerator",new eA((n,r)=>{if(n>=0&&r>=0&&this.hot.getCellMeta(n,r).hidden)return!1;let i;return n>=0?i=this.hot.getDataAtCell(n,r):n===-1&&(i=this.hot.getColHeader(r)),{value:i}})),ua(this,"firstCalculation",!0),ua(this,"inProgress",!1),ua(this,"measuredRows",0),ua(this,"rowHeightsMap",new cs),this.hot.rowIndexMapper.registerMap(l8,this.rowHeightsMap),this.addHook("beforeRowResize",(n,r,i)=>fc(this,jS,CA).call(this,n,r,i))}isEnabled(){const e=this.hot.getSettings()[Mf];return e===!0||Ke(e)}enablePlugin(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fc(e,pA,c8).call(e,...r)}),this.addHook("beforeChangeRender",n=>fc(this,wA,h8).call(this,n)),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("beforeViewRender",n=>fc(this,mA,u8).call(this,n)),this.addHook("modifyRowHeight",(n,r)=>this.getRowHeight(r,n)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,n,r)=>fc(this,jS,CA).call(this,e,n,r))}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const s=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(s.get(-1))}Ie(i.from,i.to,s=>{if(r||this.rowHeightsMap.getValueAtIndex(s)===null){const a=this.samplesGenerator.generateRowSamples(s,o);H(a,l=>{let[u,c]=l;return this.ghostTable.addRow(u,c)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((s,a)=>{s<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(s),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=0;const r=this.hot.countRows()-1;let i=null;this.inProgress=!0;const o=()=>{if(!this.hot){zu(i),this.inProgress=!1;return}this.calculateRowsHeight({from:n,to:Math.min(n+gc.CALCULATION_STEP,r)},e),n=n+gc.CALCULATION_STEP+1,n<r?i=Wd(o):(zu(i),this.inProgress=!1,this.hot.view.adjustElementsSize(!0),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateRowsHeight({from:0,to:s},e),this.firstCalculation=!1,n=s+1),n<r?o():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}setSamplingOptions(){const e=this.hot.getSettings()[Mf],n=e&&Vt(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&Vt(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllRowsHeight(){ts(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}getSyncCalculationLimit(){const e=this.hot.getSettings()[Mf];let n=gc.SYNC_CALCULATION_LIMIT;const r=this.hot.countRows()-1;return Ke(e)&&(n=e.syncLimit,nw(n)?n=Hw(r,n):n>>=0),Math.min(n,r)}getRowHeight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0;const r=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let i=n;return r!==null&&r>(n||0)&&(i=r),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getFirstVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getFirstRenderedRow():-1}getLastVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getLastVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getLastRenderedRow():-1}clearCache(){this.headerHeight=null,this.rowHeightsMap.init()}clearCacheByRange(e){const{from:n,to:r}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{Ie(Math.min(n,r),Math.max(n,r),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!yr(this.rowHeightsMap.getValues().slice(0,this.measuredRows),e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function u8(){const t=this.hot.renderCall,e=this.hot.getSettings().fixedRowsBottom,n=this.getFirstVisibleRow(),r=this.getLastVisibleRow();if(!(n===-1||r===-1)){if(this.calculateRowsHeight({from:n,to:r},void 0,t),e){const i=this.hot.countRows()-1;this.calculateRowsHeight({from:i-e,to:i})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}function CA(t,e,n){let r=t;return n&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}function c8(){this.hot.view?this.recalculateAllRowsHeight():this.hot._registerTimeout(()=>{this.hot&&this.recalculateAllRowsHeight()})}function h8(t){let e=null;t.length===1?e=t[0][0]:t.length>1&&(e={from:t[0][0],to:t[t.length-1][0]}),e!==null&&this.clearCacheByRange(e)}const{getListWithInsertedItems:d8,getListWithRemovedItems:f8}=TM("physicallyIndexed");class g8 extends Js{constructor(){super(e=>e)}insert(e,n){const r=LC(this.indexedValues,n);this.indexedValues=d8(r,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=f8(this.indexedValues,e);this.indexedValues=NC(n,e),super.remove(e)}}const m8=g8,{getListWithInsertedItems:p8,getListWithRemovedItems:w8}=TM("physicallyIndexed");class C8 extends Js{constructor(){super(e=>e)}insert(e,n){this.indexedValues=p8(this.indexedValues,e,n,(r,i)=>this.getNextValue(i)),super.insert(e,n)}remove(e){this.indexedValues=w8(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}const v8=C8;function S8(t,e){y8(t,e),e.add(t)}function y8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function b8(t,e,n){return e=R8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function R8(t){var e=E8(t,"string");return typeof e=="symbol"?e:String(e)}function E8(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function T8(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const KS="bindRowsWithHeaders",_8=210,M8="loose",O8=new Map([["loose",m8],["strict",v8]]);var vA=new WeakSet;class A8 extends gt{constructor(){super(...arguments),S8(this,vA),b8(this,"headerIndexes",null)}static get PLUGIN_KEY(){return KS}static get PLUGIN_PRIORITY(){return _8}isEnabled(){return!!this.hot.getSettings()[KS]}enablePlugin(){if(this.enabled)return;let e=this.hot.getSettings()[KS];typeof e!="string"&&(e=M8);const n=O8.get(e);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",r=>T8(this,vA,I8).call(this,r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function I8(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function Of(t,e){SA(t,e),e.add(t)}function P8(t,e,n){SA(t,e),e.set(t,n)}function SA(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yA(t,e,n){return e=x8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function x8(t){var e=H8(t,"string");return typeof e=="symbol"?e:String(e)}function H8(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bA(t,e){var n=RA(t,e,"get");return D8(t,n)}function D8(t,e){return e.get?e.get.call(t):e.value}function Af(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function XS(t,e,n){var r=RA(t,e,"set");return N8(t,r,n),n}function RA(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function N8(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const If="collapsibleColumns",L8=290,$8=["nestedHeaders"],vl="collapsibleIndicator",EA=If,TA=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var Sl=new WeakMap,_A=new WeakSet,MA=new WeakSet,OA=new WeakSet,AA=new WeakSet;class k8 extends gt{constructor(){super(...arguments),Of(this,AA),Of(this,OA),Of(this,MA),Of(this,_A),yA(this,"nestedHeadersPlugin",null),yA(this,"headerStateManager",null),P8(this,Sl,{writable:!0,value:null})}static get PLUGIN_KEY(){return If}static get PLUGIN_PRIORITY(){return L8}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[If,...$8]}isEnabled(){return!!this.hot.getSettings()[If]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||At("You need to configure the Nested Headers plugin in order to use collapsible headers."),XS(this,Sl,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>Af(this,OA,V8).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Af(e,AA,B8).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Af(e,_A,F8).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(r,i,o)=>Af(this,MA,W8).call(this,r,i,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),XS(this,Sl,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:r}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:o,columnIndex:s}=(e=this.headerStateManager.getHeaderTreeNodeData(n,r))!==null&&e!==void 0?e:{};i&&(o?this.expandSection({row:n,col:s}):this.collapseSection({row:n,col:s}))},runOnlyIf:()=>{var e;return(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight.isHeader()},group:EA})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(EA)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(s){s&&s.parentNode.removeChild(s)};Ie(0,e-1,s=>{const a=n.childNodes[s],l=r.childNodes[s],u=i?i.childNodes[s]:null;Ie(0,a.childNodes.length-1,c=>{let d=a.childNodes[c].querySelector(`.${vl}`);o(d),l&&l.childNodes[c]&&(d=l.childNodes[c].querySelector(`.${vl}`),o(d)),i&&u&&u.childNodes[c]&&(d=u.childNodes[c].querySelector(`.${vl}`),o(d))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(r=>{const{collapsible:i,origColspan:o,headerLevel:s,columnIndex:a,isCollapsed:l}=r;if(i===!0&&o>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(s),col:a}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!TA.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const r=yr(e,g=>{let{row:p}=g;return p<0});let i=r.length>0;H(r,g=>{var p;let{row:C,col:E}=g;const{collapsible:I,isCollapsed:M}=(p=this.headerStateManager.getHeaderSettings(C,E))!==null&&p!==void 0?p:{};if(!I||M&&n==="collapse"||!M&&n==="expand")return i=!1,!1});const o=[],s=[];i&&H(r,g=>{let{row:p,col:C}=g;const{colspanCompensation:E,affectedColumns:I,rollbackModification:M}=this.headerStateManager.triggerNodeModification(n,p,C);E>0&&(s.push(...I),o.push(M))});const a=this.getCollapsedColumns();let l=[];n==="collapse"?l=Zp([...a,...s]):n==="expand"&&(l=yr(a,g=>!s.includes(g)));const u=TA.get(n);if(this.hot.runHooks(u.beforeHook,a,l,i)===!1){H(o,g=>{g()});return}this.hot.batchExecution(()=>{H(s,g=>{bA(this,Sl).setValueAtIndex(this.hot.toPhysicalColumn(g),u.hideColumn)})},!0);const d=this.getCollapsedColumns().length!==a.length;this.hot.runHooks(u.afterHook,a,l,i,d),this.hot.render(),this.hot.view.adjustElementsSize(!0)}getCollapsedColumns(){return bA(this,Sl).getHiddenIndexes()}destroy(){XS(this,Sl,null),super.destroy()}}function F8(t,e,n){var r;const{collapsible:i,origColspan:o,isCollapsed:s}=(r=this.headerStateManager.getHeaderSettings(n,t))!==null&&r!==void 0?r:{},a=i&&o>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${vl}`);if(Us(e,[Dr("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),ce(u,vl),e.querySelector("div:first-child").appendChild(u)),Ue(u,["collapsed","expanded"]),s?(ce(u,"collapsed"),es(u,"+"),l&&Le(e,...Dr(!1))):(ce(u,"expanded"),es(u,"-"),l&&Le(e,...Dr(!0))),l&&Le(u,...co());else{var c;(c=u)===null||c===void 0||c.remove()}}function W8(t,e){We(t.target,vl)&&(We(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):We(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),Lr(t))}function V8(){this.updatePlugin()}function B8(t,e){e||this.updatePlugin()}function ca(t,e,n){return e=U8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function U8(t){var e=Y8(t,"string");return typeof e=="symbol"?e:String(e)}function Y8(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const G8=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],z8=!1,j8=!0,K8=!0;class X8{constructor(e,n){ca(this,"hot",void 0),ca(this,"sortingStates",new Zd),ca(this,"sortEmptyCells",z8),ca(this,"indicator",j8),ca(this,"headerAction",K8),ca(this,"compareFunctionFactory",void 0),ca(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){Ke(e)&&Ze(e,(n,r)=>{G8.includes(r)&&(this[r]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[r]=n;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return Ke(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[r,i]=n;return{column:this.hot.toVisualColumn(r),...i}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(be(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}const Pf="asc",xf="desc",IA="colHeader";function q8(t){if(Ke(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[Pf,xf].includes(n)}function Z8(t){if(t.some(n=>q8(n)===!1))return!1;const e=t.map(n=>{let{column:r}=n;return r});return new Set(e).size===e.length}function PA(t){if(t!==xf)return t===Pf?xf:Pf}function xA(t){return t.querySelector(`.${IA}`)}function HA(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function qS(t,e,n){return t===-1&&e>=0&&is(n)===!1}const Q8="ascending",J8="descending",DA="indicatorDisabled",NA="columnSorting",LA="sortAction",$A=new Map([[Pf,Q8],[xf,J8]]);function e7(t,e,n,r){const i=[NA];if(r&&i.push(LA),n===!1)return i.push(DA),i;const o=t.getSortOrderOfColumn(e);return be(o)&&i.push($A.get(o)),i}function t7(){return Array.from($A.values()).concat(LA,DA,NA)}function kA(t,e,n){const r=e.locale;return function(i,o){const{sortEmptyCells:s}=n;return typeof i=="string"&&(i=i.toLocaleLowerCase(r)),typeof o=="string"&&(o=o.toLocaleLowerCase(r)),i===o?Wi:hn(i)?hn(o)?Wi:s&&t==="asc"?jt:Kt:hn(o)?s&&t==="asc"?Kt:jt:isNaN(i)&&!isNaN(o)?t==="asc"?Kt:jt:!isNaN(i)&&isNaN(o)||(isNaN(i)||isNaN(o)||(i=parseFloat(i),o=parseFloat(o)),i<o)?t==="asc"?jt:Kt:i>o?t==="asc"?Kt:jt:Wi}}const FA="default";function n7(t,e,n){return function(r,i){const o=parseFloat(r),s=parseFloat(i),{sortEmptyCells:a}=n;if(o===s||isNaN(o)&&isNaN(s))return Wi;if(a){if(hn(r))return t==="asc"?jt:Kt;if(hn(i))return t==="asc"?Kt:jt}return isNaN(o)?Kt:isNaN(s)?jt:o<s?t==="asc"?jt:Kt:o>s?t==="asc"?Kt:jt:Wi}}const r7="numeric";function i7(t,e,n){const r=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:o}=n;return function(s,a){const l=hn(s),u=hn(a),c=l?i:s,d=u?i:a,g=c===i||c===r,p=d===i||d===r;if(o===!1){if(l&&u===!1)return Kt;if(l===!1&&u)return jt}return g===!1&&p?t==="asc"?jt:Kt:g&&p===!1?t==="asc"?Kt:jt:g===!1&&p===!1?kA(t,e,n)(s,a):c===i&&d===r?t==="asc"?jt:Kt:c===r&&d===i?t==="asc"?Kt:jt:Wi}}const o7="checkbox";function s7(t,e,n){return function(r,i){const{sortEmptyCells:o}=n;if(r===i)return Wi;if(hn(r))return hn(i)?Wi:o&&t==="asc"?jt:Kt;if(hn(i))return o&&t==="asc"?Kt:jt;const s=e.dateFormat,a=le(r,s),l=le(i,s);return a.isValid()?l.isValid()?l.isAfter(a)?t==="asc"?jt:Kt:l.isBefore(a)?t==="asc"?Kt:jt:Wi:jt:Kt}}const a7="date",{register:Hf,getItem:WA,hasItem:l7}=si("sorting.compareFunctionFactory"),{register:VA,getItem:u7}=si("sorting.mainSortComparator");function BA(t){return l7(t)?WA(t):WA(FA)}Hf(r7,n7),Hf(o7,i7),Hf(a7,s7),Hf(FA,kA);const Wi=0,jt=-1,Kt=1;function c7(t,e){const n=u7(e);for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];t.sort(n(...i))}function h7(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function(a){const l=t[a],u=e[a],c=i[a],d=o[a],g=u.columnSorting;return(g.compareFunctionFactory?g.compareFunctionFactory:BA(u.type))(l,u,g)(c,d)}(0)}}function Df(t,e){d7(t,e),e.add(t)}function d7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nf(t,e,n){return e=f7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f7(t){var e=g7(t,"string");return typeof e=="symbol"?e:String(e)}function g7(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yl(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Lf="columnSorting",m7=50,$f="append",p7="replace",UA=Lf;VA(Lf,h7),_e.getSingleton().register("beforeColumnSort"),_e.getSingleton().register("afterColumnSort");var kf=new WeakSet,YA=new WeakSet,GA=new WeakSet,zA=new WeakSet;class jA extends gt{constructor(){super(...arguments),Df(this,zA),Df(this,GA),Df(this,YA),Df(this,kf),Nf(this,"columnStatesManager",null),Nf(this,"columnMetaCache",null),Nf(this,"pluginKey",Lf),Nf(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return Lf}static get PLUGIN_PRIORITY(){return m7}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new X8(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new cs(n=>{let r=this.hot.toVisualColumn(n);return r===null&&(r=n),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,r)=>yl(this,YA,w7).call(this,n,r)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return yl(e,zA,v7).call(e,...r)}),this.addHook("afterOnCellMouseDown",(n,r)=>this.onAfterOnCellMouseDown(n,r)),this.addHook("afterInit",()=>yl(this,kf,ZS).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return yl(e,GA,C7).call(e,...r)}),this.hot.view&&yl(this,kf,ZS).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,r)=>{const i=xA(r);HA(n,r)===!1||i===null||this.updateHeaderClasses(i)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();e.row===-1&&e.col>=0&&this.sort(this.getColumnNextConfig(e.col))},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()},group:UA})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(UA)}sort(e){const n=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",n,r,i)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new _M),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",n,i?r:n,i),i&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return be(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return Z8(e)&&e.every(r=>{let{column:i}=r;return i<=n&&i>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),r=i=>{let{column:o,...s}=i;return{column:this.hot.toPhysicalColumn(o),...s}};n.initialConfig=qe(e,r),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,r=i=>{let{column:o,...s}=i;return{column:this.hot.toVisualColumn(o),...s}};return be(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=qe(n.initialConfig,r)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(be(n)){const i=PA(n);return be(i)?{column:e,sortOrder:i}:void 0}const r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:PA()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:$f;const r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=r!==-1,o=this.getSortConfig(),s=this.getColumnNextConfig(e);if(i){if(Mt(s))return[...o.slice(0,r),...o.slice(r+1)];if(n===$f)return[...o.slice(0,r),...o.slice(r+1),s];if(n===p7)return[...o.slice(0,r),s,...o.slice(r+1)]}return be(s)?o.concat(s):o}getPluginColumnConfig(e){if(Ke(e)){const n=e[this.pluginKey];if(Ke(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(i);return Array.isArray(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns[e])):Ot(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns(e))):Object.assign(r,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),r=Object.create(n);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(e.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}const n=[],r=this.hot.countRows(),i=u=>qe(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(r);u+=1)n.push([this.hot.toPhysicalRow(u)].concat(i(u)));const o=qe(n,u=>u[0]);c7(n,this.pluginKey,qe(e,u=>u.sortOrder),qe(e,u=>this.getFirstCellSettings(u.column)));for(let u=n.length;u<r;u+=1)n.push([u].concat(i(u)));const s=qe(n,u=>u[0]),a=new Map(qe(o,(u,c)=>[u,s[c]])),l=qe(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(Ke(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||Ke(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if(Ue(e,t7()),this.enabled!==!1){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];ce(e,e7(...r))}}onUpdateSettings(e){super.onUpdateSettings(),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),be(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&We(e.target,IA)}onAfterOnCellMouseDown(e,n){qS(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col)),this.sort(this.getColumnNextConfig(n.col)))}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function ZS(){const t=this.getAllSavedSortSettings();if(Ke(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function w7(t,e){const n=xA(e);if(HA(t,e)===!1||n===null)return;const r=this.getFirstCellSettings(t)[this.pluginKey],i=r.indicator,o=r.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,i,o),this.hot.getSettings().ariaTags){const s=this.columnStatesManager.getSortOrderOfColumn(t);Le(e,...KY(s?`${s}ending`:"none"))}}function C7(t){t===!0&&this.hot.view&&yl(this,kf,ZS).call(this)}function v7(t,e,n,r){qS(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function ha(t,e,n){return e=S7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function S7(t){var e=y7(t,"string");return typeof e=="symbol"?e:String(e)}function y7(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class b7{constructor(e,n){ha(this,"plugin",void 0),ha(this,"hot",void 0),ha(this,"endpoints",[]),ha(this,"settings",void 0),ha(this,"settingsType","array"),ha(this,"currentEndpoint",null),ha(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),H(r,i=>{const o={};this.assignSetting(i,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,o,"reversedRowCoords",!1),this.assignSetting(i,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"sourceColumn",i.destinationColumn),this.assignSetting(i,o,"type","sum"),this.assignSetting(i,o,"forceNumeric",!1),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"customFunction",null),this.assignSetting(i,o,"readOnly",!0),this.assignSetting(i,o,"roundFloat",!1),n.push(o)}),n}assignSetting(e,n,r,i){if(r==="ranges"&&e[r]===void 0){n[r]=i;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(i instanceof Error)throw i;n[r]=i}else r==="destinationRow"&&n.reversedRowCoords?n[r]=this.hot.countRows()-e[r]-1:n[r]=e[r]}resetSetupBeforeStructureAlteration(e,n,r){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();H(o,s=>{i==="row"&&s.destinationRow>=n&&(e==="insert_row"?s.alterRowOffset=r:e==="remove_row"&&(s.alterRowOffset=-1*r)),i==="col"&&s.destinationColumn>=n&&(e==="insert_col"?s.alterColumnOffset=r:e==="remove_col"&&(s.alterColumnOffset=-1*r))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,n,r,i,o){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const g=()=>(this.hot.removeHook("beforeViewRender",g),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",g);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,d=n;H(u,g=>{a==="row"&&g.destinationRow>=d&&(g.alterRowOffset=l*r),a==="col"&&g.destinationColumn>=d&&(g.alterColumnOffset=l*r)}),this.resetAllEndpoints(u,!c),c?H(u,g=>{this.extendEndpointRanges(g,d,i[0],i.length),this.recreatePhysicalRanges(g),this.clearOffsetInformation(g)}):H(u,g=>{this.shiftEndpointCoordinates(g,d)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,r,i){H(e.ranges,o=>{o[1]&&(n>=o[0]&&n<=o[1]?r>o[1]?o[1]+=i:r<o[0]&&(o[0]-=i):r>=o[0]&&r<=o[1]&&(o[1]-=i,n<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,r=[],i=[];H(n,o=>{const s=[];if(o[1])for(let a=o[0];a<=o[1];a++)s.push(this.hot.toPhysicalRow(a));else s.push(this.hot.toPhysicalRow(o[0]));i.push(s)}),H(i,o=>{let s=[];H(o,(a,l)=>{l===0?s.push(a):o[l]!==o[l-1]+1&&(s.push(o[l-1]),r.push(s),s=[],s.push(a)),l===o.length-1&&(s.push(a),r.push(s))})}),e.ranges=r}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,H(e.ranges,r=>{H(r,(i,o)=>{i>=n&&(r[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const o=i.alterRowOffset||0,s=i.alterColumnOffset||0;return i.destinationRow+o>=this.hot.countRows()||i.destinationColumn+s>=this.hot.countCols()})||(this.cellsToSetCache=[],H(e,i=>{this.resetEndpointValue(i,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],H(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],H(e,(r,i,o)=>{`${r[2]||""}`!=`${r[3]}`&&H(this.getAllEndpoints(),(s,a)=>{this.hot.propToCol(o[i][1])===s.sourceColumn&&n.indexOf(a)===-1&&n.push(a)})}),H(n,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?r:0)),this.hot.toVisualColumn(e.destinationColumn+(n?i:0)),""])}setEndpointValue(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const s=this.hot.getCellMeta(o,e.destinationColumn);(n==="init"||s.readOnly!==e.readOnly)&&(s.readOnly=e.readOnly,s.className="columnSummaryResult")}e.roundFloat&&!isNaN(e.result)&&(e.result=e.result.toFixed(e.roundFloat)),r?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){At("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}const R7=b7;function QS(t){return t==null||isNaN(t)}function JS(t,e){E7(t,e),e.add(t)}function E7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function T7(t,e,n){return e=_7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _7(t){var e=M7(t,"string");return typeof e=="symbol"?e:String(e)}function M7(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ey(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const ty="columnSummary",O7=220;var KA=new WeakSet,XA=new WeakSet,qA=new WeakSet;class A7 extends gt{constructor(){super(...arguments),JS(this,qA),JS(this,XA),JS(this,KA),T7(this,"endpoints",null)}static get PLUGIN_KEY(){return ty}static get PLUGIN_PRIORITY(){return O7}isEnabled(){return!!this.hot.getSettings()[ty]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[ty],this.endpoints=new R7(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ey(e,KA,I7).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ey(e,XA,P7).call(e,...r)}),this.addHook("beforeCreateRow",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,r,null,i)),this.addHook("beforeCreateCol",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,r,null,i)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,r,null,i)),this.addHook("afterCreateCol",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,r,null,i)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ey(e,qA,x7).call(e,...r)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return Ze(e.ranges,r=>{n+=this.getPartialSum(r,e.sourceColumn)}),n}getPartialSum(e,n){let r=0,i=e[1]||e[0],o=null,s=0;do{if(o=this.getCellValue(i,n),o=QS(o)?null:o,o!==null){const a=(`${o}`.split(".")[1]||[]).length||1;a>s&&(s=a)}r+=o||0,i-=1}while(i>=e[0]);return Math.round(r*10**s)/10**s}calculateMinMax(e,n){let r=null;return Ze(e.ranges,i=>{const o=this.getPartialMinMax(i,e.sourceColumn,n);if(r===null&&o!==null&&(r=o),o!==null)switch(n){case"min":r=Math.min(r,o);break;case"max":r=Math.max(r,o);break}}),r===null?"Not enough data":r}getPartialMinMax(e,n,r){let i=null,o=e[1]||e[0],s;do{if(s=this.getCellValue(o,n),s=QS(s)?null:s,i===null)i=s;else if(s!==null)switch(r){case"min":i=Math.min(i,s);break;case"max":i=Math.max(i,s);break}o-=1}while(o>=e[0]);return i}countEmpty(e,n){let r,i=0,o=e[1]||e[0];do r=this.getCellValue(o,n),r=QS(r)?null:r,r===null&&(i+=1),o-=1;while(o>=e[0]);return i}countEntries(e){let n=0;const r=e.ranges;return Ze(r,i=>{const o=i[1]===void 0?1:i[1]-i[0]+1,s=this.countEmpty(i,e.sourceColumn);n+=o,n-=s}),n}calculateAverage(e){const n=this.calculateSum(e),r=this.countEntries(e);return n/r}getCellValue(e,n){const r=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(n);let o=this.hot.getSourceDataAtCell(e,n),s="";if(r!==null&&i!==null&&(s=this.hot.getCellMeta(r,i).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(St`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}}function I7(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}function P7(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function x7(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function bl(t,e,n){return e=H7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function H7(t){var e=D7(t,"string");return typeof e=="symbol"?e:String(e)}function D7(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Rl{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n){bl(this,"rootDocument",void 0),bl(this,"isRtl",!1),bl(this,"container",null),bl(this,"editor",void 0),bl(this,"editorStyle",void 0),bl(this,"hidden",!0),this.rootDocument=e,this.isRtl=n,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hide()}setPosition(e,n){this.editorStyle.left=`${e}px`,this.editorStyle.top=`${n}px`}setSize(e,n){if(e&&n){const r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${n}px`}}getSize(){return{width:yt(this.getInputElement()),height:Wt(this.getInputElement())}}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){this.editorStyle.display="block",this.hidden=!1}hide(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}isVisible(){return this.editorStyle.display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return this.rootDocument.activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return e.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),ce(this.container,Rl.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),ce(e,Rl.CLASS_EDITOR),ce(n,Rl.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),this.container.appendChild(e),e}getInputElement(){return this.editor.querySelector(`.${Rl.CLASS_INPUT}`)}destroy(){const e=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,e&&e.removeChild(this.container)}}const N7=Rl;function ny(t,e,n){return e=L7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function L7(t){var e=$7(t,"string");return typeof e=="symbol"?e:String(e)}function $7(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const k7=250,F7=250;class ZA{constructor(e){ny(this,"wasLastActionShow",!0),ny(this,"showDebounced",null),ny(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},F7)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:k7;this.showDebounced=md(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}Et(ZA,lr);const W7=ZA;function V7(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function B7(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function da(t,e){const n={};return H(t,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&(n[i]||(n[i]=[]),n[i][o]=e(i,o))})}),n}function fs(t,e,n,r,i){H(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&U7(s,a,e,n,r,i)})})}function U7(t,e,n,r,i,o){const s=i(t,e);let a=r;s.className&&(n==="vertical"?a=V7(s.className,r):a=B7(s.className,r)),o(t,e,"className",a)}function To(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function Vi(t,e){let n=!1;return Array.isArray(t)&&H(t,r=>(r.forAll((i,o)=>{if(i>=0&&o>=0&&e(i,o))return n=!0,!1}),n)),n}function Ff(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:r}=e.defaultView,{top:i,left:o}=r.getBoundingClientRect();n.top=i,n.left=o}return n}const Je="---------";function Y7(){return{name:Je}}const Br="alignment";function G7(){return{key:Br,name(){return this.getTranslatedPhrase(dv)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${Br}:left`,name(){let t=this.getTranslatedPhrase(fv);return Vi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htLeft")!==-1)return!0})&&(t=To(t)),t},callback(){const t=this.getSelectedRange(),e=da(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,t,n,r),fs(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Br}:center`,name(){let t=this.getTranslatedPhrase(gv);return Vi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htCenter")!==-1)return!0})&&(t=To(t)),t},callback(){const t=this.getSelectedRange(),e=da(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,t,n,r),fs(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Br}:right`,name(){let t=this.getTranslatedPhrase(mv);return Vi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htRight")!==-1)return!0})&&(t=To(t)),t},callback(){const t=this.getSelectedRange(),e=da(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,t,n,r),fs(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Br}:justify`,name(){let t=this.getTranslatedPhrase(pv);return Vi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htJustify")!==-1)return!0})&&(t=To(t)),t},callback(){const t=this.getSelectedRange(),e=da(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,t,n,r),fs(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{name:Je},{key:`${Br}:top`,name(){let t=this.getTranslatedPhrase(wv);return Vi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htTop")!==-1)return!0})&&(t=To(t)),t},callback(){const t=this.getSelectedRange(),e=da(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,t,n,r),fs(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Br}:middle`,name(){let t=this.getTranslatedPhrase(Cv);return Vi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htMiddle")!==-1)return!0})&&(t=To(t)),t},callback(){const t=this.getSelectedRange(),e=da(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,r),fs(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Br}:bottom`,name(){let t=this.getTranslatedPhrase(vv);return Vi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htBottom")!==-1)return!0})&&(t=To(t)),t},callback(){const t=this.getSelectedRange(),e=da(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,t,n,r),fs(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1}]}}}const Wf="clear_column";function z7(){return{key:Wf,name(){return this.getTranslatedPhrase(QC)},callback(t,e){const n=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:!this.selection.isSelectedByColumnHeader()}}}const mc="col_left";function j7(){return{key:mc,name(){return this.getTranslatedPhrase(GC)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?this.countCols()===0:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const pc="col_right";function K7(){return{key:pc,name(){return this.getTranslatedPhrase(zC)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const wc="make_read_only";function X7(){return{key:wc,name(){let t=this.getTranslatedPhrase(ZC);return Vi(this.getSelectedRange(),(n,r)=>this.getCellMeta(n,r).readOnly)&&(t=To(t)),t},callback(){const t=this.getSelectedRange(),e=Vi(t,(n,r)=>this.getCellMeta(n,r).readOnly);H(t,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&this.setCellMeta(r,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const Vf="redo";function q7(){return{key:Vf,name(){return this.getTranslatedPhrase(qC)},callback(){this.redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const Cc="remove_col";function Z7(){return{key:Cc,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(KC,e)},callback(){this.alter("remove_col",m4(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const Bf="remove_row";function Q7(){return{key:Bf,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(jC,e)},callback(){this.alter("remove_row",p4(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const Uf="row_above";function J7(){return{key:Uf,name(){return this.getTranslatedPhrase(UC)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?this.countRows()===0:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const Yf="row_below";function e5(){return{key:Yf,name(){return this.getTranslatedPhrase(YC)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const vc="no_items";function t5(){return{key:vc,name(){return this.getTranslatedPhrase(BC)},disabled:!0,isCommand:!1}}const Gf="undo";function n5(){return{key:Gf,name(){return this.getTranslatedPhrase(XC)},callback(){this.undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const r5=[Uf,Yf,mc,pc,Wf,Bf,Cc,Gf,Vf,wc,Br,Je,vc],i5={[Je]:Y7,[vc]:t5,[Uf]:J7,[Yf]:e5,[mc]:j7,[pc]:K7,[Wf]:z7,[Bf]:Q7,[Cc]:Z7,[Gf]:n5,[Vf]:q7,[wc]:X7,[Br]:G7};function QA(){const t={};return Ze(i5,(e,n)=>{t[n]=e()}),t}function o5(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(uv):this.getTranslatedPhrase(lv)},callback(){const e=this.getSelectedRangeLast();this.deselectCell(),t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function s5(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(cv)},callback(){this.getSelectedRangeLast().forAll((n,r)=>{n>=0&&r>=0&&t.removeCommentAtCell(n,r,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function a5(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(hv);return Vi(this.getSelectedRange(),(r,i)=>t.getCommentMeta(r,i,zf))?To(e):e},callback(){this.getSelectedRangeLast().forAll((n,r)=>{if(n>=0&&r>=0){const i=!!t.getCommentMeta(n,r,zf);t.updateCommentMeta(n,r,{[zf]:!i})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Bi(t,e){JA(t,e),e.add(t)}function fa(t,e,n){JA(t,e),e.set(t,n)}function JA(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function l5(t,e,n){return e=u5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u5(t){var e=c5(t,"string");return typeof e=="symbol"?e:String(e)}function c5(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ui(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function _o(t,e,n){var r=e1(t,e,"set");return h5(t,r,n),n}function h5(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function it(t,e){var n=e1(t,e,"get");return d5(t,n)}function e1(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function d5(t,e){return e.get?e.get.call(t):e.value}const Sc="comments",f5=60,Mo="comment",yc="value",t1="style",zf="readOnly",jf=Sc,ry=`plugin:${Sc}`;var $t=new WeakMap,di=new WeakMap,Kf=new WeakMap,Xf=new WeakMap,qf=new WeakMap,iy=new WeakMap,Zf=new WeakMap,n1=new WeakSet,r1=new WeakSet,i1=new WeakSet,o1=new WeakSet,s1=new WeakSet,a1=new WeakSet,l1=new WeakSet,u1=new WeakSet,c1=new WeakSet,h1=new WeakSet;class g5 extends gt{constructor(){super(...arguments),Bi(this,h1),Bi(this,c1),Bi(this,u1),Bi(this,l1),Bi(this,a1),Bi(this,s1),Bi(this,o1),Bi(this,i1),Bi(this,r1),Bi(this,n1),l5(this,"range",{}),fa(this,$t,{writable:!0,value:null}),fa(this,di,{writable:!0,value:null}),fa(this,Kf,{writable:!0,value:!1}),fa(this,Xf,{writable:!0,value:!1}),fa(this,qf,{writable:!0,value:{}}),fa(this,iy,{writable:!0,value:null}),fa(this,Zf,{writable:!0,value:""})}static get PLUGIN_KEY(){return Sc}static get PLUGIN_PRIORITY(){return f5}isEnabled(){return!!this.hot.getSettings()[Sc]}enablePlugin(){this.enabled||(it(this,$t)||_o(this,$t,new N7(this.hot.rootDocument,this.hot.isRtl())),it(this,di)||_o(this,di,new W7(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",e=>this.addToContextMenu(e)),this.addHook("afterRenderer",(e,n,r,i,o,s)=>Ui(this,o1,C5).call(this,e,s)),this.addHook("afterScroll",()=>Ui(this,h1,E5).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",e=>Ui(this,c1,R5).call(this,e)),it(this,di).addLocalHook("hide",()=>this.hide()),it(this,di).addLocalHook("show",(e,n)=>this.showAtCell(e,n)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){it(this,di).updateDelay(this.getDisplayDelaySetting()),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),r=e.addContext(ry);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeLast();_o(this,Xf,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(ry),this.hot._registerTimeout(()=>{_o(this,Xf,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&!it(this,$t).isVisible()},group:jf}),r.addShortcut({keys:[["Escape"]],callback:()=>{it(this,$t).setValue(it(this,Zf)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&it(this,$t).isVisible()},group:jf}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&it(this,$t).isVisible()},group:jf})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(jf)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",r=>Ui(this,r1,p5).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Ui(this,n1,m5).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Ui(this,i1,w5).call(this)),this.eventManager.addEventListener(n,"focus",()=>Ui(this,a1,S5).call(this)),this.eventManager.addEventListener(n,"blur",()=>Ui(this,s1,v5).call(this)),this.eventManager.addEventListener(n,"mousedown",r=>Ui(this,l1,y5).call(this,r)),this.eventManager.addEventListener(n,"mouseup",r=>Ui(this,u1,b5).call(this,r))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=Zo(e.target,"TD","TBODY");return!!(n&&We(n,"htCommentCell")&&Zo(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=it(this,$t).getValue();let r="";e!=null?r=e:n!=null&&(r=n);const i=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(i,o,{[yc]:r}),this.hot.render()}setCommentAtCell(e,n,r){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Mo),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(r)}getComment(){const e=this.range.from.row,n=this.range.from.col;return this.getCommentMeta(e,n,yc)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,yc)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:n,col:r}}=this.range;if(n<0||n>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return it(this,di).cancelHiding(),it(this,$t).setValue((e=i[Mo]?i[Mo][yc]:null)!==null&&e!==void 0?e:""),it(this,$t).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){it(this,$t).hide()}refreshEditor(){var e,n;if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!it(this,$t).isVisible()))return;const{rowIndexMapper:i,columnIndexMapper:o}=this.hot,{row:s,col:a}=this.range.from;let l=i.getRenderableFromVisualIndex(s),u=o.getRenderableFromVisualIndex(a);const c=l===null;it(this,$t).setPosition(0,0),l===null&&(l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s,-1))),u===null&&(u=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(a,-1)));const d=l===null,g=u===null;l=(e=l)!==null&&e!==void 0?e:0,u=(n=u)!==null&&n!==void 0?n:0;const{rootWindow:p,view:{_wt:C}}=this.hot,{wtTable:E}=C,I=C.getCell({row:l,col:u},!0),M=this.getCommentMeta(s,a,t1);M?it(this,$t).setSize(M.width,M.height):it(this,$t).resetSize();const y=g?0:E.getStretchedColumnWidth(u),$=c&&!d?Wt(I):0,{left:X,top:G,width:q,height:re}=I.getBoundingClientRect(),{width:v,height:S}=it(this,$t).getSize(),{innerWidth:b,innerHeight:L}=this.hot.rootWindow,P=this.hot.rootDocument.documentElement;let x=X+p.scrollX+y,W=G+p.scrollY+$;this.hot.isRtl()&&(x-=v+y),this.hot.isLtr()&&X+q+v>b?x=X+p.scrollX-v-1:this.hot.isRtl()&&x<-(P.scrollWidth-P.clientWidth)&&(x=X+p.scrollX+y+1),G+S>L&&(W-=S-re+1),it(this,$t).setPosition(x,W),it(this,$t).setReadOnlyState(this.getCommentMeta(s,a,zf))}focusEditor(){it(this,$t).focus()}updateCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n)[Mo];let o;i?(o=kn(i),Fu(o,r)):o=r,this.hot.setCellMeta(e,n,Mo,o)}getCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n);if(i[Mo])return i[Mo][r]}addToContextMenu(e){e.items.push({name:Je},o5(this),s5(this),a5(this))}getDisplayDelaySetting(){const e=this.hot.getSettings()[Sc];if(Ke(e))return e.displayDelay}getEditorInputElement(){return it(this,$t).getInputElement()}destroy(){it(this,$t)&&it(this,$t).destroy(),it(this,di)&&it(this,di).destroy(),super.destroy()}}function m5(t){if(!(!this.hot.view||!this.hot.view._wt)&&!it(this,Kf)&&!this.targetIsCommentTextArea(t)){const e=Zo(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function p5(t){const{rootDocument:e}=this.hot;if(!(it(this,Kf)||it(this,$t).isFocused()||We(t.target,"wtBorder")||it(this,iy)===t.target||!it(this,$t)))if(_o(this,iy,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));it(this,di).show(n)}else Qo(t.target,e)&&!this.targetIsCommentTextArea(t)&&it(this,di).hide()}function w5(){_o(this,Kf,!1)}function C5(t,e){e[Mo]&&e[Mo][yc]&&ce(t,e.commentedCellClassName)}function v5(){_o(this,Zf,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function S5(){_o(this,Zf,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(ry)}function y5(t){_o(this,qf,{width:yt(t.target),height:Wt(t.target)})}function b5(t){const e=yt(t.target),n=Wt(t.target);(e!==it(this,qf).width+1||n!==it(this,qf).height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,{[t1]:{width:e,height:n}})}function R5(t){it(this,$t).isVisible()&&Lr(t)}function E5(){it(this,Xf)||this.hide()}var d1=xR,T5=TypeError,_5=function(t,e){if(!delete t[e])throw new T5("Cannot delete property "+d1(e)+" of "+d1(t))},M5=Ns,O5=bh,A5=Ah,I5=lE,P5=_5,x5=uE,H5=[].unshift(0)!==1,D5=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}},N5=H5||!D5();M5({target:"Array",proto:!0,arity:1,forced:N5},{unshift:function(e){var n=O5(this),r=A5(n),i=arguments.length;if(i){x5(r+i);for(var o=r;o--;){var s=o+i;o in n?n[s]=n[o]:P5(n,s)}for(var a=0;a<i;a++)n[a]=arguments[a]}return I5(n,r+i)}});function oy(t,e,n){return e=L5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function L5(t){var e=$5(t,"string");return typeof e=="symbol"?e:String(e)}function $5(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class f1{constructor(e){oy(this,"hot",void 0),oy(this,"commands",{}),oy(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=k5(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||Vt(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),r.unshift(o.join(":")),H(u,c=>c.apply(this.hot,r))}}function k5(t,e){let n;return H(e,r=>{const i=r.key?r.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return n=r,!1}),n}function sy(t,e,n){return e=F5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function F5(t){var e=W5(t,"string");return typeof e=="symbol"?e:String(e)}function W5(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class g1{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;sy(this,"hot",void 0),sy(this,"predefinedItems",QA()),sy(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,Ze(e,(r,i)=>{let o="";r.name===Je?(n[Je]=r,o=Je):isNaN(parseInt(i,10))?(r.key=r.key===void 0?i:r.key,n[i]=r,o=r.key):(n[r.key]=r,o=r.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return V5(e,this.defaultOrderPattern,this.predefinedItems)}}function V5(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),Ke(i)?Ze(i,(o,s)=>{let a=n[typeof o=="string"?o:s];a||(a=o),Ke(o)?an(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),r.push(a)}):H(i,(o,s)=>{let a=n[o];!a&&r5.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),Ke(o)&&an(a,o),a.key===void 0&&(a.key=s),r.push(a))}),r}function gs(t,e,n){return e=B5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function B5(t){var e=U5(t,"string");return typeof e=="symbol"?e:String(e)}function U5(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Y5{constructor(e,n){gs(this,"top",void 0),gs(this,"topRelative",void 0),gs(this,"left",void 0),gs(this,"leftRelative",void 0),gs(this,"scrollTop",void 0),gs(this,"scrollLeft",void 0),gs(this,"cellHeight",void 0),gs(this,"cellWidth",void 0);const r=n.scrollY,i=n.scrollX;let o,s,a,l,u,c;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=r,a+=i):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-r,l=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=r,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function bc(t,e,n){G5(t,e),e.set(t,n)}function G5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rt(t,e){var n=m1(t,e,"get");return z5(t,n)}function z5(t,e){return e.get?e.get.call(t):e.value}function Qf(t,e,n){var r=m1(t,e,"set");return j5(t,r,n),n}function m1(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function j5(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Qn=new WeakMap,ms=new WeakMap,On=new WeakMap,ay=new WeakMap,El=new WeakMap;class K5{constructor(e){bc(this,Qn,{writable:!0,value:void 0}),bc(this,ms,{writable:!0,value:void 0}),bc(this,On,{writable:!0,value:void 0}),bc(this,ay,{writable:!0,value:!1}),bc(this,El,{writable:!0,value:{above:0,below:0,left:0,right:0}}),Qf(this,ay,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return rt(this,El)[e]=n,this}setElement(e){return Qf(this,Qn,e),this}setParentElement(e){return Qf(this,ms,e),this}updatePosition(e){Qf(this,On,new Y5(e,rt(this,Qn).ownerDocument.defaultView)),rt(this,ay)?(rt(this,On).fitsBelow(rt(this,Qn))?this.setPositionBelowCursor():rt(this,On).fitsAbove(rt(this,Qn))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){rt(this,Qn).dir==="rtl"?rt(this,On).fitsOnLeft(rt(this,Qn))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():rt(this,On).fitsOnRight(rt(this,Qn))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=rt(this,El).above+rt(this,On).top-rt(this,Qn).offsetHeight;rt(this,ms)&&(e=rt(this,On).top+rt(this,On).cellHeight-rt(this,Qn).offsetHeight+3),rt(this,Qn).style.top=`${e}px`}setPositionBelowCursor(){let e=rt(this,El).below+rt(this,On).top+1;rt(this,ms)&&(e=rt(this,On).top-1),rt(this,Qn).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=rt(this,On).left;if(rt(this,ms)){const{right:n}=rt(this,ms).getBoundingClientRect();e+=rt(this,On).cellWidth+n-(rt(this,On).left+rt(this,On).cellWidth)}else e+=rt(this,El).right;rt(this,Qn).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=rt(this,El).left+rt(this,On).left-rt(this,Qn).offsetWidth;if(rt(this,ms)){const{left:n}=rt(this,ms).getBoundingClientRect();e-=rt(this,On).left-n}rt(this,Qn).style.left=`${e}px`}}function p1(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:r=()=>{},onClear:i=()=>{}}=t;const o=new Set;let s=ar(e,-1,C()-1);function a(I,M){const y=C()-1;return I<0&&(I=y),I>y&&(I=0),o.has(I)?-1:(o.add(I),r(I,!1)===!1&&(I=a(M===1?++I:--I,M)),I)}function l(I){I>-1&&I<C()&&r(I,!0)!==!1&&(s=I)}function u(){return s}function c(){C()>0&&(o.clear(),s=a(0,1))}function d(){C()>0&&(o.clear(),s=a(C()-1,-1))}function g(){C()>0&&(o.clear(),s=a(++s,1))}function p(){C()>0&&(o.clear(),s=a(--s,-1))}function C(){return Math.max(n(),0)}function E(){o.clear(),s=e,i()}return{setCurrentPage:l,getCurrentPage:u,toFirstItem:c,toLastItem:d,toNextItem:g,toPreviousItem:p,getSize:C,clear:E}}function X5(t){return qe(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function ly(t){return Vt(t,"submenu")}function uy(t){return new RegExp(Je,"i").test(t.name)}function Jf(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function w1(t){return Vt(t,"disableSelection")}function q5(t){return We(t,"htSeparator")}function Z5(t){return We(t,"htSubmenu")}function Q5(t){return We(t,"htDisabled")}function J5(t){return We(t,"htSelectionDisabled")}function eZ(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function C1(t,e){const n=t.slice(0);for(let r=0;r<n.length&&n[r].name===e;)n.shift();return n}function tZ(t,e){let n=t.slice(0);return n.reverse(),n=C1(n,e),n.reverse(),n}function nZ(t){const e=[];return H(t,(n,r)=>{r>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function rZ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Je,n=t.slice(0);return n=C1(n,e),n=tZ(n,e),n=nZ(n),n}function iZ(t){return p1({size:()=>t.countRows(),onItemSelect(e,n){const r=t.getCell(e,0);if(!r||q5(r)||Q5(r)||J5(r))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function oZ(t){return[{keys:[["Tab"],["Shift","Tab"],["Control/Meta","A"]],forwardToContext:t.hot.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const e=t.hotMenu.getSelectedLast();if(e){const n=t.openSubMenu(e[0]);n&&n.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{t.hotMenu.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:e=>{const n=t.hotMenu.getSelectedLast();n&&(t.hotMenu.getSourceDataAtRow(n[0]).submenu?t.openSubMenu(n[0]).getNavigator().toFirstItem():(t.executeCommand(e),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{t.hotMenu.getSelectedLast()?t.hotMenu.selection.transformStart(-t.hotMenu.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{t.hotMenu.getSelectedLast()?t.hotMenu.selection.transformStart(t.hotMenu.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const v1="menu",S1=v1;function sZ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];r(oZ(t)),e.forEach(u=>{let{shortcuts:c,contextName:d}=u;i(c,d)});function r(u,c){a(c).addShortcuts(u,{group:v1})}function i(u,c){const d=a(c);u.forEach(g=>{let{keys:p}=g;p.forEach(C=>d.removeShortcutsByKeys(C))}),n.push({shortcuts:u,contextName:c}),r(u,c)}function o(){return[...n]}function s(u){return u?`${S1}:${u}`:S1}function a(u){var c;const d=t.hotMenu.getShortcutManager(),g=s(u);return(c=d.getContext(g))!==null&&c!==void 0?c:d.addContext(g)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:i,getCustomShortcuts:o,getContext:a,listen:l}}function aZ(t){return(e,n,r,i,o,s)=>{if(n.hasAttribute("ghost-table"))return;const a=e.getSourceDataAtRow(r),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s;if(ii(n),ce(l,"htItemWrapper"),t.getSettings().ariaTags){const c=!Jf(a,t)&&!w1(a)&&!uy(a);Le(n,[FY(),sw(u),...c?[za(-1)]:[],...Jf(a,t)?[zY()]:[],...ly(a)?[Dr(!1)]:[]])}n.className="",n.appendChild(l),uy(a)?ce(n,"htSeparator"):typeof a.renderer=="function"?(ce(n,"htCustomMenuRenderer"),n.appendChild(a.renderer(e,l,r,i,o,u))):Ys(l,u),Jf(a,t)?ce(n,"htDisabled"):w1(a)?ce(n,"htSelectionDisabled"):ly(a)&&ce(n,"htSubmenu")}}function y1(t,e,n){lZ(t,e),e.set(t,n)}function lZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yi(t,e,n){return e=uZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uZ(t){var e=cZ(t,"string");return typeof e=="symbol"?e:String(e)}function cZ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function b1(t,e,n){var r=R1(t,e,"set");return hZ(t,r,n),n}function hZ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Rc(t,e){var n=R1(t,e,"get");return dZ(t,n)}function R1(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function dZ(t,e){return e.get?e.get.call(t):e.value}const E1=215;var Ec=new WeakMap,eg=new WeakMap;class Tl{constructor(e,n){var r=this;Yi(this,"hot",void 0),Yi(this,"options",void 0),Yi(this,"eventManager",new br(this)),Yi(this,"container",void 0),Yi(this,"positioner",void 0),Yi(this,"hotMenu",null),Yi(this,"hotSubMenus",{}),Yi(this,"parentMenu",void 0),Yi(this,"menuItems",null),Yi(this,"origOutsideClickDeselects",null),y1(this,Ec,{writable:!0,value:void 0}),y1(this,eg,{writable:!0,value:void 0}),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:E1,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new K5(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.parentMenu.runLocalHooks("afterSelectionChange",...o)})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=Pu(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return Rc(this,Ec)}getKeyboardShortcutsCtrl(){return Rc(this,eg)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=md(a=>this.openSubMenu(a),300),n=this.options.minWidth||E1;let r=!1,i=yr(this.menuItems,a=>(a.key===vc&&(r=!0),eZ(a,this.hot)));if(i.length<1&&!r)i.push(QA()[vc]);else if(i.length===0)return;i=rZ(i,Je);let o=!1;const s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return be(a)&&a<n?n:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:aZ(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,beforeOnCellMouseOver:(a,l)=>{Rc(this,Ec).setCurrentPage(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},rowHeights:a=>i[a].name===Je?1:23,afterOnCellContextMenu:a=>{a.preventDefault(),bw()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,d)=>{this.hotMenu.view.isMouseDown()&&(d.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!bw()||!is(a))&&o&&this.hasSelectedItem()&&(po()||yw()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),b1(this,Ec,iZ(this.hotMenu)),b1(this,eg,sZ(this)),Rc(this,eg).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(Rc(this,Ec).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedLast();if(n){const r=this.parentMenu.hotMenu.getCell(n[0],0);Le(r,[Dr(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!Z5(n))return!1;const r=this.hotMenu.getSourceDataAtRow(e),i=new Tl(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(r.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=i,this.hot.getSettings().ariaTags&&Le(n,[Dr(!0)]),i}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[n.key];if(r){r.destroy(),delete this.hotSubMenus[n.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Le(i,[Dr(!1)])}}closeAllSubMenus(){H(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const r=this.hot.getSelectedRange(),i=r?X5(r):[];this.runLocalHooks("executeCommand",n.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,e)}isCommandPassive(e){return e.isCommand===!1||uy(e)||Jf(e,this.hot)||ly(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let r=e,i;return r&&(Ot(r)&&(r=r.call(this.hot),r===null||Mt(r)?r="":r=r.toString()),r=r.replace(/[^A-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,i=n.querySelector(`.${this.options.className}.${r}`)),i||(i=n.createElement("div"),ce(i,`htMenu ${this.options.className}`),r&&ce(i,r),this.options.container.appendChild(i)),i}onAfterInit(){const{wtTable:e}=this.hotMenu.view._wt,n=this.hotMenu.getSettings().data,r=e.hider.style,i=e.holder.style,o=parseInt(r.width,10),s=en(n,(a,l)=>a+(l.name===Je?1:26),0);i.width=`${o+3}px`,i.height=`${s+3}px`,r.height=i.height,this.hot.getSettings().ariaTags&&Le(this.hotMenu.rootElement,[kY(),za(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Qo(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!Qo(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&We(e.target,"htCore")&&Qo(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}Et(Tl,lr);function tg(t,e){fZ(t,e),e.add(t)}function fZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cy(t,e,n){return e=gZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gZ(t){var e=mZ(t,"string");return typeof e=="symbol"?e:String(e)}function mZ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ng(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Tc="contextMenu",pZ=70,T1=Tc;_e.getSingleton().register("afterContextMenuDefaultOptions"),_e.getSingleton().register("beforeContextMenuShow"),_e.getSingleton().register("afterContextMenuShow"),_e.getSingleton().register("afterContextMenuHide"),_e.getSingleton().register("afterContextMenuExecute");var _1=new WeakSet,M1=new WeakSet,O1=new WeakSet,A1=new WeakSet;class rg extends gt{constructor(){super(...arguments),tg(this,A1),tg(this,O1),tg(this,M1),tg(this,_1),cy(this,"commandExecutor",new f1(this.hot)),cy(this,"itemsFactory",null),cy(this,"menu",null)}static get PLUGIN_KEY(){return Tc}static get PLUGIN_PRIORITY(){return pZ}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Uf,Yf,Je,mc,pc,Je,Bf,Cc,Je,Gf,Vf,Je,wc,Je,Br]}isEnabled(){return!!this.hot.getSettings()[Tc]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Tc];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new Tl(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>ng(this,M1,CZ).call(this)),this.menu.addLocalHook("afterOpen",()=>ng(this,O1,vZ).call(this)),this.menu.addLocalHook("afterClose",()=>ng(this,A1,SZ).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",r=>ng(this,_1,wZ).call(this,r)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),r=Ff(this.menu.container,this.hot.rootDocument);this.open({left:n.left+r.left,top:n.top+r.top-1+n.height},{left:n.width,above:-n.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:T1})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(T1)}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.prepareMenuItems(),this.menu.open(),Ze(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new g1(this.hot,rg.DEFAULT_ITEMS);const e=this.hot.getSettings()[Tc],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),H(r,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function wZ(t){const e=this.hot.getSettings(),n=e.rowHeaders,r=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),We(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||r)&&!i(o)&&!(We(o,"current")&&We(o,"wtBorder"))))return;const s=Ff(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function CZ(){this.hot.runHooks("beforeContextMenuShow",this)}function vZ(){this.hot.runHooks("afterContextMenuShow",this)}function SZ(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}rg.SEPARATOR={name:Je};function yZ(t){return{key:"copy",name(){return this.getTranslatedPhrase(JC)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function bZ(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),n=e?ar(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(nv,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function RZ(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),n=e?ar(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(tv,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function EZ(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),n=e?ar(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(ev,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function TZ(t){return{key:"cut",name(){return this.getTranslatedPhrase(rv)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class _Z{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class MZ{constructor(){this.clipboardData=new _Z}}function I1(t,e){P1(t,e),e.add(t)}function _l(t,e,n){P1(t,e),e.set(t,n)}function P1(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ig(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Jn(t,e){var n=x1(t,e,"get");return OZ(t,n)}function OZ(t,e){return e.get?e.get.call(t):e.value}function Ml(t,e,n){var r=x1(t,e,"set");return AZ(t,r,n),n}function x1(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function AZ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var ps=new WeakMap,hy=new WeakMap,_c=new WeakMap,dy=new WeakMap,fy=new WeakMap,Mc=new WeakMap,og=new WeakSet,H1=new WeakSet;class IZ{constructor(e){let{countRows:n,countColumns:r,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;I1(this,H1),I1(this,og),_l(this,ps,{writable:!0,value:void 0}),_l(this,hy,{writable:!0,value:void 0}),_l(this,_c,{writable:!0,value:void 0}),_l(this,dy,{writable:!0,value:void 0}),_l(this,fy,{writable:!0,value:void 0}),_l(this,Mc,{writable:!0,value:void 0}),Ml(this,hy,n),Ml(this,_c,r),Ml(this,dy,i),Ml(this,fy,o),Ml(this,Mc,s)}setSelectedRange(e){Ml(this,ps,e)}getCellsRange(){if(Jn(this,hy).call(this)===0||Jn(this,_c).call(this)===0)return null;const{row:e,col:n}=Jn(this,ps).getTopStartCorner(),{row:r,col:i}=Jn(this,ps).getBottomEndCorner(),o=ig(this,H1,PZ).call(this,e,r),s=ig(this,og,gy).call(this,n,i);return{isRangeTrimmed:r!==o||i!==s,startRow:e,startCol:n,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(Jn(this,_c).call(this)===0||Jn(this,Mc).call(this)===0)return null;const{col:e}=Jn(this,ps).getTopStartCorner(),{col:n}=Jn(this,ps).getBottomEndCorner(),r=ig(this,og,gy).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(Jn(this,_c).call(this)===0||Jn(this,Mc).call(this)===0)return null;const{col:e}=Jn(this,ps).getTopStartCorner(),{col:n}=Jn(this,ps).getBottomEndCorner(),r=ig(this,og,gy).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-Jn(this,Mc).call(this),startCol:e,endRow:-1,endCol:r}}}function gy(t,e){return Math.min(e,Math.max(t+Jn(this,fy).call(this)-1,t))}function PZ(t,e){return Math.min(e,Math.max(t+Jn(this,dy).call(this)-1,t))}function D1(t){const e=[],n=[];return H(t,r=>{const i=Math.min(r.startRow,r.endRow),o=Math.max(r.startRow,r.endRow);Ie(i,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(r.startCol,r.endCol),a=Math.max(r.startCol,r.endCol);Ie(s,a,l=>{n.indexOf(l)===-1&&n.push(l)})}),{rows:e,columns:n}}function Oo(t,e){N1(t,e),e.add(t)}function ga(t,e,n){N1(t,e),e.set(t,n)}function N1(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Oc(t,e,n){return e=xZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xZ(t){var e=HZ(t,"string");return typeof e=="symbol"?e:String(e)}function HZ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Rr(t,e){var n=L1(t,e,"get");return DZ(t,n)}function DZ(t,e){return e.get?e.get.call(t):e.value}function fi(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Ao(t,e,n){var r=L1(t,e,"set");return NZ(t,r,n),n}function L1(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function NZ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}_e.getSingleton().register("afterCopyLimit"),_e.getSingleton().register("modifyCopyableRange"),_e.getSingleton().register("beforeCut"),_e.getSingleton().register("afterCut"),_e.getSingleton().register("beforePaste"),_e.getSingleton().register("afterPaste"),_e.getSingleton().register("beforeCopy"),_e.getSingleton().register("afterCopy");const sg="copyPaste",LZ=80,$Z=["fragmentSelection"],$1=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var my=new WeakMap,py=new WeakMap,wy=new WeakMap,Ol=new WeakMap,ag=new WeakMap,lg=new WeakMap,Al=new WeakMap,Cy=new WeakSet,k1=new WeakSet,F1=new WeakSet,vy=new WeakSet,W1=new WeakSet,V1=new WeakSet,B1=new WeakSet,U1=new WeakSet,Y1=new WeakSet;class kZ extends gt{constructor(){super(...arguments),Oo(this,Y1),Oo(this,U1),Oo(this,B1),Oo(this,V1),Oo(this,W1),Oo(this,vy),Oo(this,F1),Oo(this,k1),Oo(this,Cy),Oc(this,"columnsLimit",1/0),Oc(this,"rowsLimit",1/0),Oc(this,"pasteMode","overwrite"),Oc(this,"uiContainer",this.hot.rootDocument.body),ga(this,my,{writable:!0,value:!1}),ga(this,py,{writable:!0,value:!1}),ga(this,wy,{writable:!0,value:!1}),ga(this,Ol,{writable:!0,value:"cells-only"}),ga(this,ag,{writable:!0,value:!1}),ga(this,lg,{writable:!0,value:!1}),ga(this,Al,{writable:!0,value:new IZ({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})}),Oc(this,"copyableRanges",[])}static get PLUGIN_KEY(){return sg}static get SETTING_KEYS(){return[sg,...$Z]}static get PLUGIN_PRIORITY(){return LZ}isEnabled(){return!!this.hot.getSettings()[sg]}enablePlugin(){var e=this;if(this.enabled)return;const{[sg]:n}=this.hot.getSettings();if(typeof n=="object"){var r,i;this.pasteMode=(r=n.pasteMode)!==null&&r!==void 0?r:this.pasteMode,this.rowsLimit=isNaN(n.rowsLimit)?this.rowsLimit:n.rowsLimit,this.columnsLimit=isNaN(n.columnsLimit)?this.columnsLimit:n.columnsLimit,Ao(this,my,!!n.copyColumnHeaders),Ao(this,py,!!n.copyColumnGroupHeaders),Ao(this,wy,!!n.copyColumnHeadersOnly),this.uiContainer=(i=n.uiContainer)!==null&&i!==void 0?i:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",o=>fi(this,W1,VZ).call(this,o)),this.addHook("afterSelectionEnd",()=>fi(this,V1,BZ).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return e.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return e.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return e.onPaste(...arguments)}),vw()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return fi(e,B1,UZ).call(e,...s)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return fi(e,U1,YZ).call(e,...s)}),this.addHook("afterSelection",()=>fi(this,Y1,GZ).call(this))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Ao(this,Ol,e),Ao(this,ag,!0),fi(this,Cy,G1).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Ao(this,lg,!0),fi(this,Cy,G1).call(this,"cut")}getRangedCopyableData(e){return sc(this.getRangedData(e))}getRangedData(e){const n=[],{rows:r,columns:i}=D1(e);return H(r,o=>{const s=[];H(i,a=>{o<0?s.push(this.hot.getColHeader(a,o)):s.push(this.hot.getCopyableData(o,a))}),n.push(s)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const r=new MZ;e&&r.clipboardData.setData("text/plain",e),n&&r.clipboardData.setData("text/html",n),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}Rr(this,Al).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);Rr(this,Ol)==="column-headers-only"?n.set("headers",Rr(this,Al).getMostBottomColumnHeadersRange()):(Rr(this,Ol)==="with-column-headers"?n.set("headers",Rr(this,Al).getMostBottomColumnHeadersRange()):Rr(this,Ol)==="with-column-group-headers"&&n.set("headers",Rr(this,Al).getAllColumnHeadersRange()),n.set("cells",Rr(this,Al).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=i;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=n.get("cells");if(r!==null&&r.isRangeTrimmed){const{startRow:i,startCol:o,endRow:s,endCol:a}=r;this.hot.runHooks("afterCopyLimit",s-i+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const r=e.length,i=e[0].length,o=[],{row:s,col:a}=n.getTopStartCorner(),{row:l,col:u}=n.getBottomEndCorner();let c=s,d=a,g=s,p=a;for(;o.length<r||c<=l;){const{skipRowOnPaste:C,visualRow:E}=this.hot.getCellMeta(c,a);if(c=E+1,C===!0)continue;g=E,d=a;const I=[],M=o.length%r;for(;I.length<i||d<=u;){const{skipColumnOnPaste:y,visualCol:$}=this.hot.getCellMeta(s,d);if(d=$+1,y===!0)continue;p=$;const X=I.length%i;I.push(e[M][X])}o.push(I)}return this.hot.populateFromArray(s,a,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,a,g,p]}onCopy(e){if(!this.hot.isListening()&&!Rr(this,ag)||this.isEditorOpened())return;this.setCopyableText(),Ao(this,ag,!1);const n=this.getRangedData(this.copyableRanges),r=fi(this,k1,FZ).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",n,this.copyableRanges,r)){const o=sc(n);if(e&&e.clipboardData){const s=xw(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",o),e.clipboardData.setData("text/html",[$1,s].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",o);this.hot.runHooks("afterCopy",n,this.copyableRanges,r)}Ao(this,Ol,"cells-only"),e.preventDefault()}onCut(e){if(!this.hot.isListening()&&!Rr(this,lg)||this.isEditorOpened())return;this.setCopyableText(),Ao(this,lg,!1);const n=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",n,this.copyableRanges)){const i=sc(n);if(e&&e.clipboardData){const o=xw(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",i),e.clipboardData.setData("text/html",[$1,o].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",i);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",n,this.copyableRanges)}e.preventDefault()}onPaste(e){if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected())return;e&&e.preventDefault&&e.preventDefault();let n;if(e&&typeof e.clipboardData<"u"){const a=ld(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});a&&/(<table)|(<TABLE)/g.test(a)?n=u_(a,this.hot.rootDocument).data:n=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(n=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof n=="string"&&(n=T4(n)),n===void 0||n&&n.length===0||this.hot.runHooks("beforePaste",n,this.copyableRanges)===!1)return;const[r,i,o,s]=this.populateValues(n);this.hot.selectCell(r,i,Math.min(this.hot.countRows()-1,o),Math.min(this.hot.countCols()-1,s)),this.hot.runHooks("afterPaste",n,this.copyableRanges)}destroy(){super.destroy()}}function G1(t){if(vw()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:r}=e.highlight,i=this.hot.getCell(n,r,!0);i&&bT(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function FZ(t){const{rows:e}=D1(t);let n=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)n+=1;return{columnHeadersCount:n}}function WZ(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r&&mw(r)}}}function z1(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r!=null&&r.hasAttribute("contenteditable")&&pw(r)}}}function VZ(t){t.items.push({name:"---------"},yZ(this)),Rr(this,my)&&t.items.push(EZ(this)),Rr(this,py)&&t.items.push(RZ(this)),Rr(this,wy)&&t.items.push(bZ(this)),t.items.push(TZ(this))}function BZ(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function UZ(){fi(this,vy,z1).call(this)}function YZ(){fi(this,F1,WZ).call(this)}function GZ(){fi(this,vy,z1).call(this)}function j1(t,e){return`border_row${t}col${e}`}function Ac(){return{width:1,color:"#000"}}function Io(){return{hide:!0}}function zZ(){return{width:1,color:"#000",cornerVisible:!1}}function Sy(t){if(be(t.start)||be(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(be(t.end)||be(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function Ic(t){return be(t.start)&&(t.left=t.start),be(t.end)&&(t.right=t.end),t}function yy(t,e){return{id:j1(t,e),border:zZ(),row:t,col:e,top:Io(),bottom:Io(),start:Io(),end:Io()}}function jZ(t,e){return Vt(e,"border")&&e.border&&(t.border=e.border),Vt(e,"top")&&be(e.top)&&(e.top?(Ke(e.top)||(e.top=Ac()),t.top=e.top):(e.top=Io(),t.top=e.top)),Vt(e,"bottom")&&be(e.bottom)&&(e.bottom?(Ke(e.bottom)||(e.bottom=Ac()),t.bottom=e.bottom):(e.bottom=Io(),t.bottom=e.bottom)),Vt(e,"start")&&be(e.start)&&(e.start?(Ke(e.start)||(e.start=Ac()),t.start=e.start):(e.start=Io(),t.start=e.start)),Vt(e,"end")&&be(e.end)&&(e.end?(Ke(e.end)||(e.end=Ac()),t.end=e.end):(e.end=Io(),t.end=e.end)),t}function Po(t,e){let n=!1;return H(t.getSelectedRange(),r=>{r.forAll((i,o)=>{if(i<0||o<0)return;const s=t.getCellMeta(i,o).borders;if(s)if(e){if(!Vt(s[e],"hide")||s[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function ug(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function KZ(t){return t.some(e=>be(e.left)||be(e.right))}function XZ(t){return t.some(e=>be(e.start)||be(e.end))}const qZ=new Map([["left","start"],["right","end"]]);function ZZ(t){var e;return(e=qZ.get(t))!==null&&e!==void 0?e:t}function QZ(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(Rv);return Po(this,"bottom")&&(e=ug(e)),e},callback(e,n){const r=Po(this,"bottom");t.prepareBorder(n,"bottom",r)}}}function JZ(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(Ev);return Po(this,e)&&(n=ug(n)),n},callback(n,r){const i=Po(this,e);t.prepareBorder(r,e,i)}}}function eQ(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(Tv)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!Po(this)}}}function tQ(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(bv);return Po(this,e)&&(n=ug(n)),n},callback(n,r){const i=Po(this,e);t.prepareBorder(r,e,i)}}}function nQ(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(yv);return Po(this,"top")&&(e=ug(e)),e},callback(e,n){const r=Po(this,"top");t.prepareBorder(n,"top",r)}}}function K1(t,e){rQ(t,e),e.add(t)}function rQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function iQ(t,e,n){return e=oQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oQ(t){var e=sQ(t,"string");return typeof e=="symbol"?e:String(e)}function sQ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function X1(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const cg="customBorders",aQ=90;var q1=new WeakSet,Z1=new WeakSet;class lQ extends gt{constructor(){super(...arguments),K1(this,Z1),K1(this,q1),iQ(this,"savedBorders",[])}static get PLUGIN_KEY(){return cg}static get PLUGIN_PRIORITY(){return aQ}isEnabled(){return!!this.hot.getSettings()[cg]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>X1(this,q1,uQ).call(this,e)),this.addHook("init",()=>X1(this,Z1,cQ).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let r=["top","bottom","start","end"],i=null;n&&(this.checkSettingsCohesion([n]),r=Object.keys(n),i=Sy(n));const o=al(e),s=ic(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});H(e,a=>{s(a).forAll((l,u)=>{H(r,c=>{this.prepareBorderFromCustomAdded(l,u,i,ZZ(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=al(e),r=ic(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return H(e,o=>{r(o).forAll((s,a)=>{H(this.savedBorders,l=>{l.row===s&&l.col===a&&i.push(Ic(l))})})}),i}clearBorders(e){e?this.setBorders(e):(H(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,n,r,i){const o=this.hot.countRows(),s=this.hot.countCols();if(e>=o||n>=s)return;let a=yy(e,n);r&&(a=jZ(a,r),H(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,r),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",Ic(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,n){const r=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);Ie(e.from.row,r,o=>{Ie(e.from.col,i,s=>{const a=yy(o,s);let l=0;o===e.from.row&&Vt(n,"top")&&(l+=1,a.top=n.top),o===e.to.row&&Vt(n,"bottom")&&(l+=1,a.bottom=n.bottom),s===e.from.col&&Vt(n,"start")&&(l+=1,a.start=n.start),s===e.to.col&&Vt(n,"end")&&(l+=1,a.end=n.end),l>0&&(this.hot.setCellMeta(o,s,"borders",Ic(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,n){const r=j1(e,n);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,r,i){let o=this.hot.getCellMeta(e,n).borders;!o||o.border===void 0?o=yy(e,n):o=Sy(o),i?(o[r]=Io(),this.countHide(o)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",Ic(o)))):(o[r]=Ac(),this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",Ic(o)))}prepareBorder(e,n,r){H(e,i=>{let{start:o,end:s}=i;if(o.row===s.row&&o.col===s.col)n==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,n,r);else switch(n){case"noBorders":Ie(o.col,s.col,a=>{Ie(o.row,s.row,l=>{this.removeAllBorders(l,a)})});break;case"top":Ie(o.col,s.col,a=>{this.setBorder(o.row,a,n,r)});break;case"bottom":Ie(o.col,s.col,a=>{this.setBorder(s.row,a,n,r)});break;case"start":Ie(o.row,s.row,a=>{this.setBorder(a,o.col,n,r)});break;case"end":Ie(o.row,s.row,a=>{this.setBorder(a,s.col,n,r)});break}})}createCustomBorders(e){H(e,n=>{const r=Sy(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,r):this.prepareBorderFromCustomAdded(n.row,n.col,r)})}countHide(e){const{top:n,bottom:r,start:i,end:o}=e;return en([n,r,i,o],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const n=qe(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){H(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){H(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=qe(this.savedBorders,r=>r.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):H(this.savedBorders,(i,o)=>{if(e.id===i.id)return this.savedBorders[o]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,r){let i=!1;return H(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){const s=this.hot.view._wt.selectionManager.getBorderInstances(o);return H(s,a=>{a.toggleHiddenClass(n,r)}),i=!0,!1}}),i}checkCustomSelections(e,n,r){const i=this.countHide(e);let o=!1;return i===4?(this.removeAllBorders(e.row,e.col),o=!0):H(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){if(s.visualCellRange=n,s.commit(),r){const a=this.hot.view._wt.selectionManager.getBorderInstances(s);H(a,l=>{l.changeBorderStyle(r,e)})}return o=!0,!1}}),o}changeBorderSettings(){const e=this.hot.getSettings()[cg];if(Array.isArray(e)){const n=kn(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=KZ(e),r=XZ(e);if(n&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function uQ(t){this.hot.getSettings()[cg]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(Sv)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[nQ(this),tQ(this),QZ(this),JZ(this),eQ(this)]}})}function cQ(){this.changeBorderSettings()}function hQ(t,e){dQ(t,e),e.add(t)}function dQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function by(t,e,n){return e=fQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fQ(t){var e=gQ(t,"string");return typeof e=="symbol"?e:String(e)}function gQ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Q1(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const J1="dragToScroll",mQ=100;var Ry=new WeakSet;class pQ extends gt{constructor(){super(...arguments),hQ(this,Ry),by(this,"boundaries",null),by(this,"callback",null),by(this,"listening",!1)}static get PLUGIN_KEY(){return J1}static get PLUGIN_PRIORITY(){return mQ}isEnabled(){return!!this.hot.getSettings()[J1]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>Q1(this,Ry,eI).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>Q1(this,Ry,eI).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(e){this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let r=0,i=0;n<this.boundaries.top?i=n-this.boundaries.top:n>this.boundaries.bottom&&(i=n-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",r=>this.onMouseMove(r)),n=Pu(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function eI(t){if(is(t))return;const e=this.hot.view._wt.wtTable.holder;e!==this.hot.rootWindow&&(this.setBoundaries(e.getBoundingClientRect()),this.setCallback((n,r)=>{n<0?e.scrollLeft-=50:n>0&&(e.scrollLeft+=50),r<0?e.scrollTop-=20:r>0&&(e.scrollTop+=20)}),this.listen())}function ma(t,e){wQ(t,e),e.add(t)}function wQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ey(t,e,n){return e=CQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function CQ(t){var e=vQ(t,"string");return typeof e=="symbol"?e:String(e)}function vQ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ws(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}_e.getSingleton().register("afterDropdownMenuDefaultOptions"),_e.getSingleton().register("beforeDropdownMenuShow"),_e.getSingleton().register("afterDropdownMenuShow"),_e.getSingleton().register("afterDropdownMenuHide"),_e.getSingleton().register("afterDropdownMenuExecute");const hg="dropdownMenu",SQ=230,Ty="changeType",_y=hg;var My=new WeakSet,tI=new WeakSet,nI=new WeakSet,rI=new WeakSet,iI=new WeakSet,oI=new WeakSet,sI=new WeakSet;class dg extends gt{static get PLUGIN_KEY(){return hg}static get PLUGIN_PRIORITY(){return SQ}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[mc,pc,Je,Cc,Je,Wf,Je,wc,Je,Br]}constructor(e){super(e),ma(this,sI),ma(this,oI),ma(this,iI),ma(this,rI),ma(this,nI),ma(this,tI),ma(this,My),Ey(this,"commandExecutor",new f1(this.hot)),Ey(this,"itemsFactory",null),Ey(this,"menu",null),this.hot.addHook("afterGetColHeader",(n,r)=>ws(this,nI,bQ).call(this,n,r))}isEnabled(){return this.hot.getSettings()[hg]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new g1(this.hot,dg.DEFAULT_ITEMS);const n=this.hot.getSettings()[hg],r={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const i=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new Tl(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>ws(this,rI,RQ).call(this)),this.menu.addLocalHook("afterOpen",()=>ws(this,iI,EQ).call(this)),this.menu.addLocalHook("afterSubmenuOpen",o=>ws(this,oI,TQ).call(this,o)),this.menu.addLocalHook("afterClose",()=>ws(this,sI,_Q).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return e.executeCommand.call(e,...s)}),H(i,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:r}=this.hot.getSelectedRangeLast();if((r.isHeader()&&r.row===-1||r.isCell())&&r.col>=0){this.hot.selectColumns(r.col,r.col,-1);const{from:i}=this.hot.getSelectedRangeLast(),o=Ff(this.menu.container,this.hot.rootDocument),s=this.hot.getCell(-1,i.col,!0),a=s.getBoundingClientRect();this.open({left:a.left+o.left,top:a.top+s.offsetHeight+o.top},{left:a.width}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:_y},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:_y}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(_y)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>ws(this,tI,yQ).call(this,e))}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),Ze(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function aI(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function yQ(t){if(t.stopPropagation(),We(t.target,Ty)){const e=Ff(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+3+e.top},{left:n.width})}}function bQ(t,e){const n=e.parentNode;if(!n)return;const r=n.parentNode.childNodes,i=Array.prototype.indexOf.call(r,n);if(t<0||i!==r.length-1)return;const o=e.querySelector(`.${Ty}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}const s=this.hot.rootDocument.createElement("button");s.className=Ty,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(Le(s,[co(),sw(" ")]),Le(e,[sT("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function RQ(){this.hot.runHooks("beforeDropdownMenuShow",this)}function EQ(){this.hot.runHooks("afterDropdownMenuShow",this),ws(this,My,aI).call(this,this.menu)}function TQ(t){ws(this,My,aI).call(this,t)}function _Q(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}dg.SEPARATOR={name:Je};function lI(t,e,n){return e=MQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function MQ(t){var e=OQ(t,"string");return typeof e=="symbol"?e:String(e)}function OQ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class AQ{constructor(e){lI(this,"hot",void 0),lI(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:r,endCol:i}=this._getDataRange(),o=this.options,s=[];return Ie(e,r,a=>{const l=[];!o.exportHiddenRows&&this._isHiddenRow(a)||(Ie(n,i,u=>{!o.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),s.push(l))}),s}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:r}=this._getDataRange(),i=this.hot.getRowHeader();Ie(n,r,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(i[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:r}=this._getDataRange(),i=this.hot.getColHeader();Ie(n,r,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(i[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[r=0,i=0,o=n,s=e]=this.options.range;return r=Math.max(r,0),i=Math.max(i,0),o=Math.min(o,n),s=Math.min(s,e),{startRow:r,startCol:i,endRow:o,endCol:s}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}const IQ=AQ;function uI(t,e,n){return e=PQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function PQ(t){var e=xQ(t,"string");return typeof e=="symbol"?e:String(e)}function xQ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Oy{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){uI(this,"dataProvider",void 0),uI(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=Kn(this.constructor.DEFAULT_OPTIONS);const r=new Date;return n=an(Kn(Oy.DEFAULT_OPTIONS),n),n=an(n,e),n.filename=rw(n.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),n}}const HQ=Oy,DQ=String.fromCharCode(13),NQ=String.fromCharCode(34),LQ=String.fromCharCode(10);class $Q extends HQ{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}export(){const e=this.options,n=this.dataProvider.getData();let r=this.dataProvider.getColumnHeaders();const i=r.length>0,o=this.dataProvider.getRowHeaders(),s=o.length>0;let a=e.bom?String.fromCharCode(65279):"";return i&&(r=qe(r,l=>this._escapeCell(l,!0)),s&&(a+=e.columnDelimiter),a+=r.join(e.columnDelimiter),a+=e.rowDelimiter),H(n,(l,u)=>{u>0&&(a+=e.rowDelimiter),s&&(a+=this._escapeCell(o[u])+e.columnDelimiter),a+=l.map(c=>this._escapeCell(c)).join(e.columnDelimiter)}),a}_escapeCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=Yt(e);return r!==""&&(n||r.indexOf(DQ)>=0||r.indexOf(NQ)>=0||r.indexOf(LQ)>=0||r.indexOf(this.options.columnDelimiter)>=0)&&(r=r.replace(new RegExp('"',"g"),'""'),r=`"${r}"`),r}}const kQ=$Q,Ay={["csv"]:kQ};function FQ(t,e,n){return typeof Ay[t]=="function"?new Ay[t](e,n):null}const WQ="exportFile",VQ=240;class BQ extends gt{static get PLUGIN_KEY(){return WQ}static get PLUGIN_PRIORITY(){return VQ}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:r,rootWindow:i}=this.hot,o=this._createTypeFormatter(e,n),s=this._createBlob(o),a=i.URL||i.webkitURL,l=r.createElement("a"),u=`${o.options.filename}.${o.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(s);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),r.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),r.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,u)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Ay[e])throw new Error(`Export format type "${e}" is not supported.`);return FQ(e,new IQ(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function Il(t,e,n){return e=UQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function UQ(t){var e=YQ(t,"string");return typeof e=="symbol"?e:String(e)}function YQ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Pc{constructor(e,n){let{id:r,stateless:i=!0}=n;Il(this,"hot",void 0),Il(this,"id",void 0),Il(this,"elements",[]),Il(this,"hidden",!1),Il(this,"stateId",""),Il(this,"state",void 0),this.hot=e,this.id=r,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Zd)}getElements(){return this.elements}reset(){H(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),H(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}Et(Pc,lr);const xc={};function Cs(t,e){if(!xc[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:r}=xc[t];let i=e;return r.inputValuesDecorator&&(i=r.inputValuesDecorator(i)),function(o){return n.apply(o.meta.instance,[].concat([o],[i]))}}function pa(t){if(!xc[t])throw Error(`Filter condition "${t}" does not exist.`);return xc[t].descriptor}function un(t,e,n){n.key=t,xc[t]={condition:e,descriptor:n}}const bn="none";function GQ(){return!0}un(bn,GQ,{name:rf,inputsCount:0,showOperators:!1});const Hc="empty";function zQ(t){return hn(t.value)}un(Hc,zQ,{name:xv,inputsCount:0,showOperators:!0});const fg="not_empty";function jQ(t,e){return!Cs(Hc,e)(t)}un(fg,jQ,{name:Hv,inputsCount:0,showOperators:!0});const Dc="eq";function KQ(t,e){let[n]=e;return Yt(t.value).toLocaleLowerCase(t.meta.locale)===Yt(n)}un(Dc,KQ,{name:Dv,inputsCount:1,showOperators:!0});const gg="neq";function XQ(t,e){return!Cs(Dc,e)(t)}un(gg,XQ,{name:Nv,inputsCount:1,showOperators:!0});const cI="gt";function qQ(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>r}un(cI,qQ,{name:Wv,inputsCount:1,showOperators:!0});const hI="gte";function ZQ(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>=r}un(hI,ZQ,{name:Vv,inputsCount:1,showOperators:!0});const dI="lt";function QQ(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<r}un(dI,QQ,{name:Bv,inputsCount:1,showOperators:!0});const fI="lte";function JQ(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<=r}un(fI,JQ,{name:Uv,inputsCount:1,showOperators:!0});const Iy="date_after";function eJ(t,e){let[n]=e;const r=le(t.value,t.meta.dateFormat),i=le(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)>=0}un(Iy,eJ,{name:zv,inputsCount:1,showOperators:!0});const Py="date_before";function tJ(t,e){let[n]=e;const r=le(t.value,t.meta.dateFormat),i=le(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)<=0}un(Py,tJ,{name:jv,inputsCount:1,showOperators:!0});const mg="between";function nJ(t,e){let[n,r]=e,i=n,o=r;if(t.meta.type==="numeric"){const s=parseFloat(i,10),a=parseFloat(o,10);i=Math.min(s,a),o=Math.max(s,a)}else if(t.meta.type==="date"){const s=Cs(Py,[o]),a=Cs(Iy,[i]);return s(t)&&a(t)}return t.value>=i&&t.value<=o}un(mg,nJ,{name:Yv,inputsCount:2,showOperators:!0});const gI="not_between";function rJ(t,e){return!Cs(mg,e)(t)}un(gI,rJ,{name:Gv,inputsCount:2,showOperators:!0});const mI="begins_with";function iJ(t,e){let[n]=e;return Yt(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Yt(n))}un(mI,iJ,{name:Lv,inputsCount:1,showOperators:!0});const pI="ends_with";function oJ(t,e){let[n]=e;return Yt(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Yt(n))}un(pI,oJ,{name:$v,inputsCount:1,showOperators:!0});const xy="contains";function sJ(t,e){let[n]=e;return Yt(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Yt(n))>=0}un(xy,sJ,{name:kv,inputsCount:1,showOperators:!0});const wI="not_contains";function aJ(t,e){return!Cs(xy,e)(t)}un(wI,aJ,{name:Fv,inputsCount:1,showOperators:!0});const CI="date_tomorrow";function lJ(t){const e=le(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(le().subtract(-1,"days").startOf("day"),"d"):!1}un(CI,lJ,{name:Xv,inputsCount:0});const vI="date_today";function uJ(t){const e=le(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(le().startOf("day"),"d"):!1}un(vI,uJ,{name:Kv,inputsCount:0});const SI="date_yesterday";function cJ(t){const e=le(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(le().subtract(1,"days").startOf("day"),"d"):!1}un(SI,cJ,{name:qv,inputsCount:0}),H_();function hJ(t,e){let n=t;return n===""&&(n=`(${e})`),n}const Hy=new Set([1]).has(1),dJ=Hy&&typeof Array.from=="function";function Nc(t){let e=t;return Hy&&(e=new Set(e)),function(n){let r;return Hy?r=e.has(n):r=!!~e.indexOf(n),r}}function yI(t){return t??""}function Dy(t){let e=t;return dJ?e=Array.from(new Set(e)):e=Zp(e),e=e.sort((n,r)=>typeof n=="number"&&typeof r=="number"?n-r:n===r?0:n>r?1:-1),e}function bI(t,e,n,r){const i=[],o=t===e;let s;return o||(s=Nc(e)),H(t,a=>{let l=!1;(o||s(a))&&(l=!0);const u={checked:l,value:a,visualValue:hJ(a,n)};r&&r(u),i.push(u)}),i}const wa="by_value";function fJ(t,e){let[n]=e;return n(t.value)}un(wa,fJ,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[Nc(e)]},showOperators:!1});const Lc={};function gJ(t){if(!Lc[t])throw Error(`Operation with id "${t}" does not exist.`);const e=Lc[t].func;return function(n,r){return e(n,r)}}function mJ(t){return Lc[t].name}function Ny(t,e,n){Lc[t]={name:e,func:n}}const vs="conjunction",pJ=Jv;function wJ(t,e){return t.every(n=>n.func(e))}Ny(vs,pJ,wJ);const pg="disjunction",CJ=of;function vJ(t,e){return t.some(n=>n.func(e))}Ny(pg,CJ,vJ);const Ly="disjunctionWithExtraCondition",SJ=of;function yJ(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}Ny(Ly,SJ,yJ);const bJ="numeric",RI="text",RJ="date",EI={[bJ]:[bn,Je,Hc,fg,Je,Dc,gg,Je,cI,hI,dI,fI,mg,gI],[RI]:[bn,Je,Hc,fg,Je,Dc,gg,Je,mI,pI,Je,xy,wI],[RJ]:[bn,Je,Hc,fg,Je,Dc,gg,Je,Py,Iy,mg,Je,CI,vI,SI]};function EJ(t){const e=[];let n=t;return EI[n]||(n=RI),H(EI[n],r=>{let i;r===Je?i={name:Je}:i=Kn(pa(r)),e.push(i)}),e}function $c(t,e,n){return e=TJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function TJ(t){var e=_J(t,"string");return typeof e=="symbol"?e:String(e)}function _J(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const $y="built",ky="building",TI=["click","input","keydown","keypress","keyup","focus","blur","change"];let gi=class mN{static get DEFAULTS(){return Kn({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){$c(this,"hot",void 0),$c(this,"eventManager",new br(this)),$c(this,"options",void 0),$c(this,"_element",void 0),$c(this,"buildState",void 0),this.hot=e,this.options=an(mN.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===ky?this._element:this.buildState===$y?(this.update(),this._element):(this.buildState=ky,this.build(),this.buildState=$y,this._element)}isBuilt(){return this.buildState===$y}translateIfPossible(e){return typeof e=="string"&&e.startsWith(Zn)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,r)=>{this.eventManager.addEventListener(n,r,i=>this.runLocalHooks(r,i,this))};if(this.buildState||(this.buildState=ky),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&ce(this._element,this.options.className),this.options.children.length)H(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),Ze(this.options,(r,i)=>{n[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(n[i]=this.translateIfPossible(r))}),this._element.appendChild(n),H(TI,r=>e(n,r))}else H(TI,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};Et(gi,lr);function MJ(t,e){_I(t,e),e.add(t)}function OJ(t,e,n){_I(t,e),e.set(t,n)}function _I(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wg(t,e){var n=MI(t,e,"get");return AJ(t,n)}function AJ(t,e){return e.get?e.get.call(t):e.value}function IJ(t,e,n){var r=MI(t,e,"set");return PJ(t,r,n),n}function MI(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function PJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function xJ(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var Pl=new WeakMap,OI=new WeakSet;class Ss extends gi{static get DEFAULTS(){return Kn({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,an(Ss.DEFAULTS,n)),MJ(this,OI),OJ(this,Pl,{writable:!0,value:void 0}),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>xJ(this,OI,HJ).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");IJ(this,Pl,this._element.firstChild),ce(this._element,"htUIInput"),ce(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(wg(this,Pl).type=this.options.type,wg(this,Pl).placeholder=this.translateIfPossible(this.options.placeholder),wg(this,Pl).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&wg(this,Pl).focus()}}function HJ(t){this.options.value=t.target.value}function Fy(t,e){AI(t,e),e.add(t)}function kc(t,e,n){AI(t,e),e.set(t,n)}function AI(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xl(t,e,n){var r=II(t,e,"set");return DJ(t,r,n),n}function DJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Wy(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Xt(t,e){var n=II(t,e,"get");return NJ(t,n)}function II(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function NJ(t,e){return e.get?e.get.call(t):e.value}var Cn=new WeakMap,Cg=new WeakMap,vg=new WeakMap,Vy=new WeakMap,Sg=new WeakMap,PI=new WeakSet,xI=new WeakSet,HI=new WeakSet;class Fc extends gi{static get DEFAULTS(){return Kn({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,an(Fc.DEFAULTS,n)),Fy(this,HI),Fy(this,xI),Fy(this,PI),kc(this,Cn,{writable:!0,value:null}),kc(this,Cg,{writable:!0,value:[]}),kc(this,vg,{writable:!0,value:void 0}),kc(this,Vy,{writable:!0,value:void 0}),kc(this,Sg,{writable:!0,value:void 0}),this.registerHooks()}getMenu(){return Xt(this,Cn)}registerHooks(){this.addLocalHook("click",()=>Wy(this,HI,kJ).call(this))}setItems(e){xl(this,Cg,this.translateNames(e)),Xt(this,Cn)&&Xt(this,Cn).setMenuItems(Xt(this,Cg))}translateNames(e){return H(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),xl(this,Cn,new Tl(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),Xt(this,Cn).setMenuItems(Xt(this,Cg));const e=new gi(this.hot,{className:"htUISelectCaption"}),n=new gi(this.hot,{className:"htUISelectDropdown"});xl(this,vg,e),xl(this,Vy,e.element),xl(this,Sg,n),this.hot.getSettings().ariaTags&&(Le(n.element,[co()]),Le(this._element,[oT()])),H([e,n],r=>this._element.appendChild(r.element)),Xt(this,Cn).addLocalHook("select",r=>Wy(this,PI,LJ).call(this,r)),Xt(this,Cn).addLocalHook("afterClose",()=>Wy(this,xI,$J).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=Xt(this,Cn).hot.getTranslatedPhrase(rf),Xt(this,Vy).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();Xt(this,Cn)&&(Xt(this,Cn).open(),Xt(this,Cn).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),Xt(this,Cn).getNavigator().toFirstItem(),Xt(this,Cn).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){Xt(this,Cn)&&Xt(this,Cn).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){Xt(this,Cn)&&(Xt(this,Cn).destroy(),xl(this,Cn,null)),Xt(this,vg)&&Xt(this,vg).destroy(),Xt(this,Sg)&&Xt(this,Sg).destroy(),super.destroy()}}function LJ(t){t.name!==Je&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function $J(){this.runLocalHooks("afterClose")}function kJ(){this.openOptions()}function DI(t,e){FJ(t,e),e.add(t)}function FJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function NI(t,e,n){return e=WJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function WJ(t){var e=VJ(t,"string");return typeof e=="symbol"?e:String(e)}function VJ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function LI(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var $I=new WeakSet,kI=new WeakSet;class By extends Pc{constructor(e,n){super(e,{id:n.id,stateless:!1}),DI(this,kI),DI(this,$I),NI(this,"name",""),NI(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new Fc(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new Ss(this.hot,{placeholder:oS})),this.elements.push(new Ss(this.hot,{placeholder:sS})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>LI(this,$I,BJ).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),H(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>LI(this,kI,UJ).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=Kn(e.command);n.name.startsWith(zt)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),H(e.args,(r,i)=>{if(i>n.inputsCount-1)return!1;const o=this.getInputElement(i);o.setValue(r),o[n.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||pa(bn),n=[];return H(this.getInputElements(),(r,i)=>{e.inputsCount>i&&n.push(r.getValue())}),{command:e,args:n}}updateState(e,n){const r=pa(e?e.name:bn);this.state.setValueAtIndex(n,{command:r,args:e?e.args:[]}),e||H(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof Fc)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof Ss)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{ce(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&ce(n.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return ce(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),H(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[pa(bn)];if(e!==null){const{visualIndex:r}=e;n=EJ(this.hot.getDataType(0,r,this.hot.countRows(),r))}H(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function BJ(t){H(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function UJ(t){qa(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Lr(t))}function FI(t,e,n){YJ(t,e),e.set(t,n)}function YJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wc(t,e){var n=VI(t,e,"get");return GJ(t,n)}function GJ(t,e){return e.get?e.get.call(t):e.value}function WI(t,e,n){var r=VI(t,e,"set");return zJ(t,r,n),n}function VI(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function zJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Hl=new WeakMap,Uy=new WeakMap;class yg extends gi{static get DEFAULTS(){return Kn({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,an(yg.DEFAULTS,n)),FI(this,Hl,{writable:!0,value:void 0}),FI(this,Uy,{writable:!0,value:void 0})}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),WI(this,Uy,e),WI(this,Hl,this._element.firstChild),Wc(this,Hl).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Wc(this,Uy).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return Wc(this,Hl).checked}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(Wc(this,Hl).checked=e)}focus(){this.isBuilt()&&Wc(this,Hl).focus()}}function jJ(t,e){KJ(t,e),e.add(t)}function KJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function XJ(t,e,n){return e=qJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qJ(t){var e=ZJ(t,"string");return typeof e=="symbol"?e:String(e)}function ZJ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function QJ(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const BI=0;var UI=new WeakSet;class JJ extends Pc{constructor(e,n){super(e,{id:n.id,stateless:!1}),jJ(this,UI),XJ(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(ce(n.parentNode,"htFiltersMenuOperators"),H(this.elements,r=>n.appendChild(r.element)),n)}}buildOperatorsElement(){const e=[vs,pg];H(e,n=>{const r=new yg(this.hot,{name:"operator",label:{htmlFor:n,textContent:mJ(n)},value:n,checked:n===e[BI],id:n});r.addLocalHook("change",i=>QJ(this,UI,eee).call(this,i)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error(St`Radio button with index ${e} doesn't exist.`);H(this.elements,(n,r)=>{n.setChecked(r===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof yg&&n.isChecked());return e?e.getValue():vs}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&H(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:vs,n=arguments.length>1?arguments[1]:void 0,r=e;r===Ly&&(r=pg),this.state.setValueAtIndex(n,r)}reset(){this.setChecked(BI)}}function eee(t){this.setState(t.target.value)}function tee(t,e,n){nee(t,e),e.set(t,n)}function nee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yy(t,e){var n=YI(t,e,"get");return ree(t,n)}function ree(t,e){return e.get?e.get.call(t):e.value}function iee(t,e,n){var r=YI(t,e,"set");return oee(t,r,n),n}function YI(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function oee(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Vc=new WeakMap;class Bc extends gi{static get DEFAULTS(){return Kn({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,an(Bc.DEFAULTS,n)),tee(this,Vc,{writable:!0,value:void 0})}build(){super.build(),iee(this,Vc,this._element.firstChild)}update(){this.isBuilt()&&(Yy(this,Vc).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&Yy(this,Vc).focus()}activate(){Yy(this,Vc).click()}}function bg(t,e){GI(t,e),e.add(t)}function Dl(t,e,n){GI(t,e),e.set(t,n)}function GI(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rg(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Ye(t,e){var n=zI(t,e,"get");return see(t,n)}function see(t,e){return e.get?e.get.call(t):e.value}function mi(t,e,n){var r=zI(t,e,"set");return aee(t,r,n),n}function zI(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function aee(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const jI="multipleSelect.itemBox";var pi=new WeakMap,Bt=new WeakMap,Gy=new WeakMap,xo=new WeakMap,ys=new WeakMap,bs=new WeakMap,KI=new WeakSet,XI=new WeakSet,qI=new WeakSet,ZI=new WeakSet;class Uc extends gi{static get DEFAULTS(){return Kn({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,an(Uc.DEFAULTS,n)),bg(this,ZI),bg(this,qI),bg(this,XI),bg(this,KI),Dl(this,pi,{writable:!0,value:[]}),Dl(this,Bt,{writable:!0,value:void 0}),Dl(this,Gy,{writable:!0,value:void 0}),Dl(this,xo,{writable:!0,value:void 0}),Dl(this,ys,{writable:!0,value:void 0}),Dl(this,bs,{writable:!0,value:void 0}),mi(this,xo,new Ss(this.hot,{placeholder:iS,className:"htUIMultipleSelectSearch"})),mi(this,ys,new Bc(this.hot,{textContent:eS,className:"htUISelectAll"})),mi(this,bs,new Bc(this.hot,{textContent:tS,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return Ye(this,Bt)}registerHooks(){Ye(this,xo).addLocalHook("keydown",e=>Rg(this,XI,uee).call(this,e)),Ye(this,xo).addLocalHook("input",e=>Rg(this,KI,lee).call(this,e)),Ye(this,ys).addLocalHook("click",e=>Rg(this,qI,cee).call(this,e)),Ye(this,bs).addLocalHook("click",e=>Rg(this,ZI,hee).call(this,e))}setItems(e){mi(this,pi,e),Ye(this,Bt)&&Ye(this,Bt).loadData(Ye(this,pi))}setLocale(e){mi(this,Gy,e)}getLocale(){return Ye(this,Gy)}getItems(){return[...Ye(this,pi)]}getValue(){return fee(Ye(this,pi))}getSearchInputElement(){return Ye(this,xo)}getSelectAllElement(){return Ye(this,ys)}getClearAllElement(){return Ye(this,bs)}isSelectedAllValues(){return Ye(this,pi).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,n=e.createElement("div"),r=new gi(this.hot,{className:"htUISelectionControls",children:[Ye(this,ys),Ye(this,bs)]});this._element.appendChild(Ye(this,xo).element),this._element.appendChild(r.element),this._element.appendChild(n);const i=o=>{if(!this._element)return;Ye(this,Bt)&&Ye(this,Bt).destroy(),ce(o,"htUIMultipleSelectHot"),mi(this,Bt,new this.hot.constructor(o,{data:Ye(this,pi),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(l,u,c,d,g,p)=>{l.title=p.instance.getDataAtRowProp(u,p.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{Ye(this,Bt).listen()},maxCols:1,autoWrapCol:!0,height:110,colWidths:()=>Ye(this,Bt).container.scrollWidth-wn(e),copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),Ye(this,Bt).init();const a=Ye(this,Bt).getShortcutManager().getContext("grid");a.removeShortcutsByKeys(["Tab"]),a.removeShortcutsByKeys(["Shift","Tab"]),a.addShortcut({keys:[["Escape"]],callback:l=>{this.runLocalHooks("keydown",l,this)},group:jI}),a.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:l=>{Ye(this,Bt).deselectCell(),this.runLocalHooks("keydown",l,this),this.runLocalHooks("listTabKeydown",l,this)},group:jI})};i(n),this.hot._registerTimeout(()=>i(n),100)}focus(){this.isBuilt()&&Ye(this,Bt).listen()}reset(){Ye(this,xo).reset(),Ye(this,ys).reset(),Ye(this,bs).reset()}update(){this.isBuilt()&&(Ye(this,Bt).loadData(dee(Ye(this,pi),this.options.value)),super.update())}destroy(){Ye(this,Bt)&&Ye(this,Bt).destroy(),Ye(this,xo).destroy(),Ye(this,bs).destroy(),Ye(this,ys).destroy(),mi(this,xo,null),mi(this,bs,null),mi(this,ys,null),mi(this,Bt,null),mi(this,pi,null),super.destroy()}}function lee(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;e===""?n=[...Ye(this,pi)]:n=yr(Ye(this,pi),r=>`${r.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),Ye(this,Bt).loadData(n)}function uee(t){this.runLocalHooks("keydown",t,this),ww(qa,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),Lr(t),Ye(this,Bt).listen(),Ye(this,Bt).selectCell(0,0))}function cee(t){const e=[];t.preventDefault(),H(Ye(this,Bt).getSourceData(),(n,r)=>{n.checked=!0,e.push(IC(n,r)[0])}),Ye(this,Bt).setSourceDataAtCell(e)}function hee(t){const e=[];t.preventDefault(),H(Ye(this,Bt).getSourceData(),(n,r)=>{n.checked=!1,e.push(IC(n,r)[0])}),Ye(this,Bt).setSourceDataAtCell(e)}function dee(t,e){const n=Nc(e);return qe(t,r=>(r.checked=n(r.value),r))}function fee(t){const e=[];return H(t,n=>{n.checked&&e.push(n.value)}),e}function gee(t,e){mee(t,e),e.add(t)}function mee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pee(t,e,n){return e=wee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wee(t){var e=Cee(t,"string");return typeof e=="symbol"?e:String(e)}function Cee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vee(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var QI=new WeakSet;class See extends Pc{constructor(e,n){super(e,{id:n.id,stateless:!1}),gee(this,QI),pee(this,"name",""),this.name=n.name,this.elements.push(new Uc(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>vee(this,QI,yee).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===wa){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?bn:wa},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(r,i,o,s,a)=>{const[l]=yr(i,d=>d.name===wa),u={},c=this.hot.getTranslatedPhrase(sf);if(l){const d=Dy(qe(s(r,a),E=>E.value));o&&(l.args[0]=o);const g=[],p=bI(d,l.args[0],c,E=>{E.checked&&g.push(E.value)}),C=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,C).locale,u.args=[g],u.command=pa(wa),u.itemsSnapshot=p}else u.args=[],u.command=pa(bn);this.state.setValueAtIndex(r,u)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof Uc)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{ce(n.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return ce(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),H(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(sf),n=Dy(this._getColumnVisibleValues()),r=bI(n,n,e);this.getMultipleSelectElement().setItems(r),super.reset(),this.getMultipleSelectElement().setValue(n);const i=this.hot.getPlugin("filters").getSelectedColumn();i!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,i.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:qe(this.hot.getDataAtCol(e.visualIndex),n=>yI(n))}}function yee(t){qa(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Lr(t))}var JI;function bee(t,e){Ree(t,e),e.add(t)}function Ree(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Eee(t,e,n){return e=Tee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tee(t){var e=_ee(t,"string");return typeof e=="symbol"?e:String(e)}function _ee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Mee(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var eP=new WeakSet;class Yc extends Pc{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),bee(this,eP),Eee(this,"name",""),this.name=n.name,this.elements.push(new Ss(this.hot,{type:"button",value:nS,className:"htUIButton htUIButtonOK",identifier:Yc.BUTTON_OK})),this.elements.push(new Ss(this.hot,{type:"button",value:rS,className:"htUIButton htUIButtonCancel",identifier:Yc.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){H(this.elements,e=>{e.addLocalHook("click",(n,r)=>Mee(this,eP,Oee).call(this,n,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(ce(n.parentNode,"htFiltersMenuActionBar"),H(this.elements,r=>n.appendChild(r.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}JI=Yc;function Oee(t,e){e.options.identifier===JI.BUTTON_OK?this.accept():this.cancel()}function zy(t,e,n){return e=Aee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Aee(t){var e=Iee(t,"string");return typeof e=="symbol"?e:String(e)}function Iee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const tP="ConditionCollection.filteringStates";class nP{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;zy(this,"hot",void 0),zy(this,"isMapRegistrable",void 0),zy(this,"filteringStates",new Zd),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(tP,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var r;const i=this.filteringStates.getValueAtIndex(n),o=(r=i==null?void 0:i.conditions)!==null&&r!==void 0?r:[],s=i==null?void 0:i.operation;return this.isMatchInConditions(o,e,s)}isMatchInConditions(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:vs;return e.length?gJ(r)(e,n):!0}addCondition(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:vs,i=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,s=qe(n.args,c=>typeof c=="string"?c.toLocaleLowerCase(o):c),a=n.name||n.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==r)throw Error(St`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(Mt(Lc[r]))throw new Error(St`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:a,args:s,func:Cs(a,s)}]},i):u.push({name:a,args:s,func:Cs(a,s)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,r;return(n=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return en(this.filteringStates.getEntries(),(e,n)=>{let[r,{operation:i,conditions:o}]=n;return e.push({column:r,operation:i,conditions:qe(o,s=>{let{name:a,args:l}=s;return{name:a,args:l}})}),e},[])}importAllConditions(e){this.clean(),H(e,n=>{H(n.conditions,r=>this.addCondition(n.column,r))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const r=this.getConditions(e);return n?r.some(i=>i.name===n):r.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(tP),this.filteringStates=null,this.clearLocalHooks()}}Et(nP,lr);const rP=nP;function iP(t,e,n){return e=Pee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pee(t){var e=xee(t,"string");return typeof e=="symbol"?e:String(e)}function xee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Hee{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];iP(this,"conditionCollection",void 0),iP(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return H(this.conditionCollection.getFilteredColumns(),(n,r)=>{let i=this.columnDataFactory(n);r&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(n,i)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];return H(n,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&r.push(i)}),r}_getIntersectData(e,n){const r=[];return H(n,i=>{const o=i.meta.visualRow;e[o]!==void 0&&(r[o]=e[o])}),r}}const oP=Hee;function jy(t,e){Dee(t,e),e.add(t)}function Dee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ca(t,e,n){return e=Nee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nee(t){var e=Lee(t,"string");return typeof e=="symbol"?e:String(e)}function Lee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ky(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var sP=new WeakSet,aP=new WeakSet,lP=new WeakSet;class uP{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];jy(this,lP),jy(this,aP),jy(this,sP),Ca(this,"hot",void 0),Ca(this,"conditionCollection",void 0),Ca(this,"columnDataFactory",void 0),Ca(this,"changes",[]),Ca(this,"grouping",!1),Ca(this,"latestEditedColumnPosition",-1),Ca(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",i=>Ky(this,sP,$ee).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>Ky(this,aP,kee).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>Ky(this,lP,Fee).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,H(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const s=i.slice(0,o),a=i.slice(o);a.length&&a[0].column===e&&a.shift();const l=ET(function(c,d){let g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const p=new rP(r.hot,!1),C=[].concat(c,g);p.importAllConditions(C);const E=r.columnDataFactory(d);let I;p.isEmpty()?I=E:I=new oP(p,y=>r.columnDataFactory(y)).filter(),I=qe(I,y=>y.meta.visualRow);const M=Nc(I);return p.destroy(),yr(E,y=>M(y.meta.visualRow))})(s),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),Ze(this,(e,n)=>{this[n]=null})}}function $ee(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function kee(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function Fee(){H(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}Et(uP,lr);const Wee=uP;function Vee(t){return p1({initialPage:0,size:()=>t.length,onItemSelect:(n,r)=>{const i=t[n];if(i instanceof Uc)return r;if(i.element&&!ts(i.element))return!1;i.focus()}})}const Gc="filters";function Bee(t,e){let n=-1;const r=Vee(e),i=l=>()=>{t.isOpened()&&t.getKeyboardShortcutsCtrl().listen(Gc),r.setCurrentPage(e.indexOf(l))};e.forEach(l=>{l instanceof gi&&(l.addLocalHook("click",i(l)),l.addLocalHook("focus",i(l)),l.addLocalHook("afterClose",i(l)))}),t.addLocalHook("afterSelectionChange",l=>{l.key.startsWith("filter_")||r.clear()});function o(l){const u=t.getKeyboardShortcutsCtrl(),c=l.getKeyboardShortcutsCtrl();r.clear(),c.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:u.getContext(Gc),callback:()=>{l.isSubMenu()&&l.close(),u.listen(Gc)}}]),!l.isSubMenu()&&u.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:d=>{const g=t.getNavigator();g.getCurrentPage()>-1&&(n=g.getCurrentPage()),g.clear(),d.shiftKey?r.toPreviousItem():r.toNextItem()}},{keys:[["Escape"]],callback:()=>{t.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:d=>{const g=e[r.getCurrentPage()];g instanceof Fc&&(g.openOptions(),d.preventDefault()),g instanceof Bc&&(g.activate(),d.preventDefault()),g instanceof gi||d.preventDefault()}}],Gc)}t.addLocalHook("afterSubmenuOpen",o),t.addLocalHook("afterOpen",o);function s(){t.focus(),t.getKeyboardShortcutsCtrl().listen(Gc)}function a(){return n}return{...r,listen:s,getLastMenuPage:a}}function Ho(t,e){cP(t,e),e.add(t)}function Uee(t,e,n){cP(t,e),e.set(t,n)}function cP(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zc(t,e,n){return e=Yee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yee(t){var e=Gee(t,"string");return typeof e=="symbol"?e:String(e)}function Gee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zee(t,e,n){var r=hP(t,e,"set");return jee(t,r,n),n}function jee(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function jc(t,e){var n=hP(t,e,"get");return Kee(t,n)}function hP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Kee(t,e){return e.get?e.get.call(t):e.value}function wi(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Xy="filters",Xee=250,dP=Xy;var va=new WeakMap,fP=new WeakSet,gP=new WeakSet,mP=new WeakSet,pP=new WeakSet,qy=new WeakSet,wP=new WeakSet,Zy=new WeakSet,CP=new WeakSet,vP=new WeakSet;class qee extends gt{static get PLUGIN_KEY(){return Xy}static get PLUGIN_PRIORITY(){return Xee}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),Ho(this,vP),Ho(this,CP),Ho(this,Zy),Ho(this,wP),Ho(this,qy),Ho(this,pP),Ho(this,mP),Ho(this,gP),Ho(this,fP),zc(this,"dropdownMenuPlugin",null),zc(this,"conditionCollection",null),zc(this,"conditionUpdateObserver",null),zc(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),zc(this,"filtersRowsMap",null),Uee(this,va,{writable:!0,value:void 0}),this.hot.addHook("afterGetColHeader",(n,r)=>wi(this,CP,nte).call(this,n,r))}isEnabled(){return!!this.hot.getSettings()[Xy]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new ec),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const e=this.hot.getSettings().dropdownMenu,n=e&&e.uiContainer||this.hot.rootDocument.body,r=s=>(s.addLocalHook("accept",()=>wi(this,qy,SP).call(this,"accept")),s.addLocalHook("cancel",()=>wi(this,qy,SP).call(this,"cancel")),s.addLocalHook("change",a=>wi(this,wP,tte).call(this,s,a)),s),i=()=>`${this.hot.getTranslatedPhrase(Zv)}:`,o=()=>`${this.hot.getTranslatedPhrase(Qv)}:`;if(!this.components.get("filter_by_condition")){const s=new By(this.hot,{id:"filter_by_condition",name:i,addSeparator:!1,menuContainer:n});s.addLocalHook("afterClose",()=>wi(this,Zy,yP).call(this)),this.components.set("filter_by_condition",r(s))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new JJ(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const s=new By(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:n});s.addLocalHook("afterClose",()=>wi(this,Zy,yP).call(this)),this.components.set("filter_by_condition2",r(s))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",r(new See(this.hot,{id:"filter_by_value",name:o}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",r(new Yc(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new rP(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new Wee(this.hot,this.conditionCollection,s=>this.getDataMapAtColumn(s)),this.conditionUpdateObserver.addLocalHook("update",s=>wi(this,vP,rte).call(this,s))),this.components.forEach(s=>s.show()),this.addHook("afterDropdownMenuDefaultOptions",s=>wi(this,pP,ete).call(this,s)),this.addHook("afterDropdownMenuShow",()=>wi(this,gP,Qee).call(this)),this.addHook("afterDropdownMenuHide",()=>wi(this,mP,Jee).call(this)),this.addHook("afterChange",s=>wi(this,fP,Zee).call(this,s)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!jc(this,va)&&this.dropdownMenuPlugin.enabled){const s=this.dropdownMenuPlugin.menu,a=[{focus:()=>{const u=s.getNavigator(),c=jc(this,va).getLastMenuPage();s.focus(),c>0?u.setCurrentPage(c):u.toFirstItem()}},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];zee(this,va,Bee(s,a));const l=u=>{jc(this,va).listen(),u.preventDefault(),qa(u.keyCode,"TAB")&&(u.shiftKey?jc(this,va).toPreviousItem():jc(this,va).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,r)=>{n.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:dP})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(dP)}addCondition(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:vs;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:n},args:r},i)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),r=!this.conditionCollection.isEmpty();let i=[];const o=this.conditionCollection.exportAllConditions();if(this.hot.runHooks("beforeFilter",o)!==!1)if(r){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=qe(n.filter(),u=>u.meta.visualRow);const l=Nc(i);Ie(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),H(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!i.length&&this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),r=[];return H(this.hot.getSourceDataAtCol(n),(i,o)=>{var s;const{row:a,col:l,visualCol:u,visualRow:c,type:d,instance:g,dateFormat:p,locale:C}=this.hot.getCellMeta(o,n),E=(s=this.hot.getDataAtCell(this.hot.toVisualRow(o),n))!==null&&s!==void 0?s:i;r.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:d,instance:g,dateFormat:p,locale:C},value:yI(E)})}),r}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),r=Dy(n);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var n;const r=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(r)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,r,i){let o=e;return o===pg&&n.command.key!==bn&&r.command.key!==bn&&i.command.key!==bn?o=Ly:i.command.key!==bn&&(n.command.key===bn||r.command.key===bn)&&(o=vs),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...r):this.hideComponents(...r)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new oP(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return H(i,s=>{H(n.menuItems,(a,l)=>{a.key===s.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const r=this.dropdownMenuPlugin.menu.hotMenu,i=r.getPlugin("hiddenRows");for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];const l=this.getIndexesOfComponents(...s);e?i.showRows(l):i.hideRows(l),r.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function Zee(t){t&&H(t,e=>{const[,n]=e,r=this.hot.propToCol(n);this.conditionCollection.hasConditions(r)&&this.updateValueComponentCondition(r)})}function Qee(){this.restoreComponents(Array.from(this.components.values()))}function Jee(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function ete(t){t.items.push({name:Je}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function SP(t){var e;if(t==="accept"){const r=this.getSelectedColumn();if(r===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:i}=r,o=this.components.get("filter_by_condition").getState(),s=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,s,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(i);u===-1&&(u=void 0),this.conditionCollection.removeConditions(i),o.command.key!==bn&&(this.conditionCollection.addCondition(i,o,l,u),s.command.key!==bn&&this.conditionCollection.addCondition(i,s,l,u)),a.command.key!==bn&&this.conditionCollection.addCondition(i,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(i)),this.filtersRowsMap.clear(),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function tte(t,e){this.updateDependentComponentsVisibility(),t.constructor===By&&!e.inputsCount&&this.setListeningDropdownMenu()}function yP(){this.setListeningDropdownMenu()}function nte(t,e){const n=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(n)?ce(e,"htFiltersActive"):Ue(e,"htFiltersActive")}function rte(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:r}}=t,i=n.filter(s=>s.name===wa),o=n.filter(s=>s.name!==wa);if(i.length>=2||o.length>=3)At(St`The filter conditions have been applied properly, but couldnât be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const s=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(o[0],r),this.components.get("filter_by_condition2").updateState(o[1],r),this.components.get("filter_operators").updateState(s,r),this.components.get("filter_by_value").updateState(t)}}const bP="internal-use-in-handsontable",Qy={licenseKey:bP,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function RP(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[Vn])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function EP(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function ite(t){var e;const n=t[Vn],r=EP(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=RP(t);return{...Qy,...r,...i}}function ote(t){var e;const n=t[Vn],r=EP(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=RP(t);return{...r,...i}}function ste(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function Eg(){const t="engine_relationship",e=si(Vn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function Jy(){const t="shared_engine_usage",e=si(Vn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function ate(t){const e=t.getSettings(),n=e[Vn],r=n==null?void 0:n.engine;if(n===!0||Mt(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var i;return lte((i=r.hyperformula)!==null&&i!==void 0?i:r,e,t)}else if(typeof r=="object"&&Mt(r.hyperformula)){const o=Eg(),s=Jy().get(r);return o.has(r)||o.set(r,[]),o.get(r).push(t),s&&s.push(t.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:bP}),(r.getConfig().leapYear1900!==Qy.leapYear1900||Cd(r.getConfig().nullDate,Qy.nullDate)===!1)&&At(St`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function lte(t,e,n){const r=e[Vn],i=ite(e),o=Eg(),s=Jy();ute(t,r.functions),cte(t,r.language);const a=t.buildEmpty(i);return o.set(a,[n]),s.set(a,[n.guid]),hte(a,r.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function TP(t){var e;const n=Eg(),r=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(r.map(i=>[i.getPlugin("formulas").sheetId,i]))}function _P(t,e){if(t){const n=Eg(),r=n.get(t),i=Jy(),o=i.get(t);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),r.length===0&&n.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(i.delete(t),t.destroy()))}}function ute(t,e){e&&e.forEach(n=>{const{name:r,plugin:i,translations:o}=n;try{t.registerFunction(r,i,o)}catch(s){At(s.message)}})}function cte(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(r){At(r.message)}}}function hte(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:r,expression:i,scope:o,options:s}=n;try{t.addNamedExpression(r,i,o,s)}catch(a){At(a.message)}}),t.resumeEvaluation())}function dte(t,e){return(Mt(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const MP="DD/MM/YYYY";function OP(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function fte(t){return OP(t)?t.substr(1):t}function gte(t){return typeof t=="string"&&t.startsWith("=")}function eb(t,e){return typeof t=="string"&&e==="date"}function AP(t,e){return le(t,e,!0).isValid()}function IP(t,e){return le(t,e,!0).format(MP)}function mte(t,e){return le(t,MP,!0).format(e)}function PP(t,e){const r=new Date(Date.UTC(0,0,t+-1));return le(r).format(e)}function Sa(t,e,n){pte(t,e),e.set(t,n)}function pte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kt(t,e){var n=xP(t,e,"get");return wte(t,n)}function wte(t,e){return e.get?e.get.call(t):e.value}function Rs(t,e,n){var r=xP(t,e,"set");return Cte(t,r,n),n}function xP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Cte(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Kc=new WeakMap,Es=new WeakMap,Er=new WeakMap,Tg=new WeakMap,tb=new WeakMap,nb=new WeakMap,_g=new WeakMap;class vte{constructor(e,n,r){Sa(this,Kc,{writable:!0,value:void 0}),Sa(this,Es,{writable:!0,value:void 0}),Sa(this,Er,{writable:!0,value:void 0}),Sa(this,Tg,{writable:!0,value:[]}),Sa(this,tb,{writable:!0,value:[]}),Sa(this,nb,{writable:!0,value:void 0}),Sa(this,_g,{writable:!0,value:[]}),Rs(this,Kc,e),Rs(this,Es,n),Rs(this,Er,r)}setRemovedHfIndexes(e){return Rs(this,_g,e.map(n=>{const r=kt(this,Es).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(r)})),kt(this,_g)}getRemovedHfIndexes(){return kt(this,_g)}getHfIndexFromVisualIndex(e){const n=kt(this,Es).getIndexesSequence(),r=kt(this,Es).getNotTrimmedIndexes();return n.indexOf(r[e])}syncMoves(e){const r=`move${$n(kt(this,Kc))}s`;kt(this,Er).getEngine().batch(()=>{e.forEach(i=>{const o=i.from!==i.to,s=i.from+1!==i.to;o&&s&&kt(this,Er).getEngine()[r](kt(this,Er).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,n,r){r!==!1&&(Rs(this,tb,e.map(i=>this.getHfIndexFromVisualIndex(i))),Rs(this,nb,this.getHfIndexFromVisualIndex(n)))}getMoveLine(e,n){const r=kt(this,Es).getNumberOfIndexes(),i=Array.from(Array(r).keys()).filter(s=>e.includes(s)===!1);if(n===0){var o;return(o=i[n])!==null&&o!==void 0?o:0}return i[n-1]+1}getInitiallyCalculatedMoves(e,n){let r=this.getMoveLine(e,n);const i=[];return e.forEach(o=>{const s={from:o,to:r};i.forEach(a=>{const l=a.from>a.to,u=a.to<=s.from;a.from>s.from&&u&&l&&(s.from+=1)}),s.from>=r&&(r+=1),i.push(s)}),i}adjustedCalculatedMoves(e){return e.forEach((n,r)=>{e.slice(r+1).forEach(o=>{const s=o.from<o.to;o.from>n.from&&s&&(o.from-=1)})}),e}calculateAndSyncMoves(e,n){if(kt(this,Er).isPerformingUndoRedo()||e===!1||n===!1)return;const r=this.adjustedCalculatedMoves(this.getInitiallyCalculatedMoves(kt(this,tb),kt(this,nb)));kt(this,Er).getSheetId()===null?kt(this,Er).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){const e=`set${$n(kt(this,Kc))}Order`;return n=>{if(kt(this,Er).isPerformingUndoRedo())return;const r=kt(this,Es).getIndexesSequence();if(n==="update"){const i=kt(this,Tg).map(l=>r.indexOf(l)),o=kt(this,Er).getEngine().getSheetDimensions(kt(this,Er).getSheetId());let s;kt(this,Kc)==="row"?s=o.height:s=o.width;const a=i.length;for(let l=a;l<s;l+=1)i.push(l);kt(this,Er).getEngine()[e](kt(this,Er).getSheetId(),i)}Rs(this,Tg,r)}}init(){Rs(this,Tg,kt(this,Es).getIndexesSequence())}}const HP=vte;function ya(t,e,n){Ste(t,e),e.set(t,n)}function Ste(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Do(t,e){var n=DP(t,e,"get");return yte(t,n)}function yte(t,e){return e.get?e.get.call(t):e.value}function ba(t,e,n){var r=DP(t,e,"set");return bte(t,r,n),n}function DP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function bte(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Mg=new WeakMap,Og=new WeakMap,rb=new WeakMap,ib=new WeakMap,ob=new WeakMap,sb=new WeakMap,ab=new WeakMap;class Rte{constructor(e,n,r){ya(this,Mg,{writable:!0,value:void 0}),ya(this,Og,{writable:!0,value:void 0}),ya(this,rb,{writable:!0,value:void 0}),ya(this,ib,{writable:!0,value:!1}),ya(this,ob,{writable:!0,value:!1}),ya(this,sb,{writable:!0,value:null}),ya(this,ab,{writable:!0,value:null}),ba(this,Mg,new HP("row",e,this)),ba(this,Og,new HP("column",n,this)),ba(this,rb,r)}getForAxis(e){return e==="row"?Do(this,Mg):Do(this,Og)}setPerformUndo(e){ba(this,ib,e)}setPerformRedo(e){ba(this,ob,e)}isPerformingUndoRedo(){return Do(this,ib)||Do(this,ob)}getSheetId(){return Do(this,ab)}getEngine(){return Do(this,sb)}getPostponeAction(){return Do(this,rb)}setupSyncEndpoint(e,n){ba(this,sb,e),ba(this,ab,n),Do(this,Mg).init(),Do(this,Og).init()}}const Ete=Rte;function Ut(t,e){NP(t,e),e.add(t)}function Nl(t,e,n){return e=Tte(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tte(t){var e=_te(t,"string");return typeof e=="symbol"?e:String(e)}function _te(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lb(t,e,n){NP(t,e),e.set(t,n)}function NP(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ts(t,e,n){var r=LP(t,e,"set");return Mte(t,r,n),n}function Mte(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Ll(t,e){var n=LP(t,e,"get");return Ote(t,n)}function LP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Ote(t,e){return e.get?e.get.call(t):e.value}function It(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Vn="formulas",Ate=["maxRows","maxColumns","language"],Ite=260;_e.getSingleton().register("afterNamedExpressionAdded"),_e.getSingleton().register("afterNamedExpressionRemoved"),_e.getSingleton().register("afterSheetAdded"),_e.getSingleton().register("afterSheetRemoved"),_e.getSingleton().register("afterSheetRenamed"),_e.getSingleton().register("afterFormulasValuesUpdate");const $l=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var No=new WeakMap,ub=new WeakMap,Xc=new WeakMap,$P=new WeakSet,kP=new WeakSet,cb=new WeakSet,FP=new WeakSet,hb=new WeakSet,WP=new WeakSet,VP=new WeakSet,db=new WeakSet,BP=new WeakSet,UP=new WeakSet,YP=new WeakSet,GP=new WeakSet,zP=new WeakSet,jP=new WeakSet,KP=new WeakSet,XP=new WeakSet,qP=new WeakSet,ZP=new WeakSet,QP=new WeakSet,JP=new WeakSet,ex=new WeakSet,tx=new WeakSet,nx=new WeakSet,rx=new WeakSet;class Pte extends gt{constructor(){var e;super(...arguments),e=this,Ut(this,rx),Ut(this,nx),Ut(this,tx),Ut(this,ex),Ut(this,JP),Ut(this,QP),Ut(this,ZP),Ut(this,qP),Ut(this,XP),Ut(this,KP),Ut(this,jP),Ut(this,zP),Ut(this,GP),Ut(this,YP),Ut(this,UP),Ut(this,BP),Ut(this,db),Ut(this,VP),Ut(this,WP),Ut(this,hb),Ut(this,FP),Ut(this,cb),Ut(this,kP),Ut(this,$P),lb(this,No,{writable:!0,value:!1}),lb(this,ub,{writable:!0,value:!1}),lb(this,Xc,{writable:!0,value:[["valuesUpdated",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,QP,jte).call(e,...r)}],["namedExpressionAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,JP,Kte).call(e,...r)}],["namedExpressionRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,ex,Xte).call(e,...r)}],["sheetAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,tx,qte).call(e,...r)}],["sheetRenamed",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,nx,Zte).call(e,...r)}],["sheetRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,rx,Qte).call(e,...r)}]]}),Nl(this,"staticRegister",si("formulas")),Nl(this,"engine",null),Nl(this,"sheetName",null),Nl(this,"indexSyncer",null),Nl(this,"rowAxisSyncer",null),Nl(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return Vn}static get PLUGIN_PRIORITY(){return Ite}static get SETTING_KEYS(){return[Vn,...Ate]}get sheetId(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[Vn]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=ate(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){At("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());r!==!1&&(this.sheetName=r)}this.addHook("beforeLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return It(n,cb,ix).call(n,...i)}),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return It(n,hb,ox).call(n,...i)}),this.addHook("beforeUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return It(n,cb,ix).call(n,...i)}),this.addHook("afterUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return It(n,hb,ox).call(n,...i)}),this.addHook("modifyData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return It(n,WP,Nte).call(n,...i)}),this.addHook("modifySourceData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return It(n,VP,Lte).call(n,...i)}),this.addHook("beforeValidate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return It(n,$P,xte).call(n,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return It(n,BP,$te).call(n,...i)}),this.addHook("afterSetDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return It(n,db,sx).call(n,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return It(n,db,sx).call(n,...i)}),this.addHook("beforeCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return It(n,UP,kte).call(n,...i)}),this.addHook("beforeCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return It(n,YP,Fte).call(n,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return It(n,jP,Bte).call(n,...i)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return It(n,KP,Ute).call(n,...i)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return It(n,GP,Wte).call(n,...i)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return It(n,zP,Vte).call(n,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return It(n,XP,Yte).call(n,...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return It(n,qP,Gte).call(n,...i)}),this.indexSyncer=new Ete(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,i,o,s)=>{this.rowAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("beforeColumnMove",(r,i,o,s)=>{this.columnAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("afterRowMove",(r,i,o,s,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("afterColumnMove",(r,i,o,s,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("beforeColumnFreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return It(n,FP,Dte).call(n,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return It(n,ZP,zte).call(n,...i)}),this.addHook("beforeAutofill",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return It(n,kP,Hte).call(n,...i)}),Ll(this,Xc).forEach(r=>{let[i,o]=r;return this.engine.on(i,o)}),super.enablePlugin()}}disablePlugin(){Ll(this,Xc).forEach(e=>{let[n,r]=e;return this.engine.off(n,r)}),_P(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=ote(this.hot.getSettings());ste(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const r=this.hot.getSettings()[Vn];if(be(r)&&be(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[Vn].sheetName;i&&this.engine.doesSheetExist(i)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(i??void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){Ll(this,Xc).forEach(e=>{var n;let[r,i]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(r,i)}),Ts(this,Xc,null),_P(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(be(n)&&!yM(n))return At("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return At("Sheet with the provided name already exists."),!1;try{const r=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(r),n),r}catch(r){return At(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){Ew(`The sheet named \`${e}\` does not exist, switch aborted.`);return}this.sheetName=e;const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${$n(Vn)}.switchSheet`)}getCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(n);return i!==null&&o!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=new Set;e.forEach(i=>{var o;const s=i==null||(o=i.address)===null||o===void 0?void 0:o.sheet;s!==void 0&&(r.has(s)||r.add(s))}),TP(this.engine).forEach((i,o)=>{if((n||o!==this.sheetId)&&r.has(o)){var s;i.render(),(s=i.view)===null||s===void 0||s.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=o=>{var s;const{row:a,col:l,sheet:u}=(s=o==null?void 0:o.address)!==null&&s!==void 0?s:{};return be(u)?`${u}:${a}x${l}`:""},i=new Set(n.map(o=>r(o)));e.forEach(o=>{var s,a;const{row:l,col:u}=(s=o.address)!==null&&s!==void 0?s:{};if(be(l)===!1||be(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=o==null||(a=o.address)===null||a===void 0?void 0:a.sheet,d=r(o);if(c!==void 0&&!i.has(d)){const g=TP(this.engine).get(c);if(!g)return;g.validateCell(g.getDataAtCell(l,u),g.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,n,r){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){At(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const o=this.hot.getCellMeta(e,n);return eb(r,o.type)&&(AP(r,o.dateFormat)?r=IP(r,o.dateFormat):gte(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(i,r)}}function xte(t,e,n){const r=this.hot.propToCol(n);if(this.isFormulaCellType(e,r)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},o=this.hot.getCellMeta(e,r);let s=this.engine.getCellValue(i);return o.type==="date"&&Xn(s)&&(s=PP(s,o.dateFormat)),typeof s=="object"&&s!==null?s.value:s}return t}function Hte(t,e,n){const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner(),d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},g={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(g)===!1)return!1;const p=this.engine.getFillRangeData(d,g),{row:C,col:E}=d.start,{row:I,col:M}=d.end,y=I-C+1,$=M-E+1;for(let X=0;X<p.length;X+=1)for(let G=0;G<p[X].length;G+=1){const q=p[X][G],re=X%y,v=G%$,S=this.hot.getCellMeta(re,v);eb(q,S.type)&&(q.startsWith("'")?p[X][G]=q.slice(1):this.isFormulaCellType(re,v,this.sheetId)===!1&&(p[X][G]=mte(q,S.dateFormat)))}return p}function ix(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes($n(Vn))||Ts(this,ub,Mt(this.hot.getSettings().data))}function Dte(){const t=this.hot.getSourceDataArray();let e=!1;t.forEach((n,r)=>{n.forEach((i,o)=>{const s=this.hot.getCellMeta(r,o),a=s.dateFormat;eb(i,s.type)&&(e=!0,AP(i,a)?t[r][o]=IP(i,a):this.isFormulaCellType(r,o)===!1&&(t[r][o]=`'${i}`))})}),e===!0&&(Ts(this,No,!0),this.engine.setSheetContent(this.sheetId,t),Ts(this,No,!1))}function ox(t,e){if(!(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes($n(Vn)))if(this.sheetName=dte(this.engine,this.hot.getSettings()[Vn].sheetName),Ll(this,ub))this.switchSheet(this.sheetName);else{const r=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,r)){Ts(this,No,!0);const i=this.engine.setSheetContent(this.sheetId,r);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(i),Ts(this,No,!1)}}}function Nte(t,e,n,r){if(r!=="get"||Ll(this,No)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t);if(i===null||e===null)return;if(!this.isFormulaCellType(i,e)&&this.getCellType(i,e)!=="ARRAY"){OP(n.value)&&(n.value=fte(n.value));return}const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let a=this.engine.getCellValue(s);const l=this.hot.getCellMeta(i,e);l.type==="date"&&Xn(a)&&(a=PP(a,l.dateFormat));const u=typeof a=="object"&&a!==null?a.value:a;n.value=u}function Lte(t,e,n,r){if(r!=="get"||Ll(this,No)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),o=this.hot.propToCol(e);if(i===null||o===null||!this.isFormulaCellType(i,o)&&this.getCellType(i,o)!=="ARRAY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function sx(t,e){if($l(e))return;const n=[],r=[],i=this.engine.batch(()=>{t.forEach(o=>{let[s,a,,l]=o;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(s),d=this.hot.toPhysicalColumn(u),g={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};c!==null&&d!==null?this.syncChangeWithEngine(s,u,l):n.push([s,u,l]),r.push({address:g})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const o=this.engine.batch(()=>{n.forEach(s=>{let[a,l,u]=s;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function $te(t,e){if($l(e))return;const n=[],r=[];t.forEach(i=>{let[o,s,,a]=i;const l=this.hot.propToCol(s);if(!Xn(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){At(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}r.push({address:u}),n.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(n),this.validateDependentCells(n,r)}function kte(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function Fte(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function Wte(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}function Vte(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}function Bte(t,e,n){if($l(n))return;const r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function Ute(t,e,n){if($l(n))return;const r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function Yte(t,e,n,r){if($l(r))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeRows(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function Gte(t,e,n,r){if($l(r))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeColumns(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function zte(t,e,n){var r;Ts(this,No,!0);const i=this.hot.getSourceDataArray(n,0,n+(((r=e.__children)===null||r===void 0?void 0:r.length)||0),this.hot.countSourceCols());Ts(this,No,!1),i.forEach((o,s)=>{o.forEach((a,l)=>{this.engine.setCellContents({col:l,row:n+s,sheet:this.sheetId},[[a]])})})}function jte(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function Kte(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function Xte(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function qte(t){this.hot.runHooks("afterSheetAdded",t)}function Zte(t,e){this.hot.runHooks("afterSheetRenamed",t,e)}function Qte(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function Jte(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[,r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(Ov,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,n.col),0),i=Math.max(e.col,n.col),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideColumns(o);const s=o[o.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function ene(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(Av,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(!0),o-i+1===this.countCols()||this.selectColumns(i,o)},disabled:!1,hidden(){const n=qe(t.getHiddenColumns(),d=>this.toPhysicalColumn(d));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().col,o=r.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const d=o-i+1,g=l-a+1;if(d>g){const p=u.slice(i,o+1);c.push(...p.filter(C=>n.includes(C)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const d=this.countCols()-1,g=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(d,-1));l===g&&d>o&&c.push(...u.slice(o+1))}return H(c,d=>{e.push(this.toVisualColumn(d))}),e.length===0}}}function kl(t,e){lx(t,e),e.add(t)}function ax(t,e,n){lx(t,e),e.set(t,n)}function lx(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fl(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Tr(t,e){var n=ux(t,e,"get");return tne(t,n)}function tne(t,e){return e.get?e.get.call(t):e.value}function qc(t,e,n){var r=ux(t,e,"set");return nne(t,r,n),n}function ux(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function nne(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}_e.getSingleton().register("beforeHideColumns"),_e.getSingleton().register("afterHideColumns"),_e.getSingleton().register("beforeUnhideColumns"),_e.getSingleton().register("afterUnhideColumns");const fb="hiddenColumns",rne=310;var Gi=new WeakMap,zi=new WeakMap,cx=new WeakSet,hx=new WeakSet,dx=new WeakSet,fx=new WeakSet,gx=new WeakSet,mx=new WeakSet;class ine extends gt{constructor(){super(...arguments),kl(this,mx),kl(this,gx),kl(this,fx),kl(this,dx),kl(this,hx),kl(this,cx),ax(this,Gi,{writable:!0,value:{}}),ax(this,zi,{writable:!0,value:null})}static get PLUGIN_KEY(){return fb}static get PLUGIN_PRIORITY(){return rne}isEnabled(){return!!this.hot.getSettings()[fb]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[fb];Ke(n)&&(qc(this,Gi,n),Mt(n.copyPasteEnabled)&&(n.copyPasteEnabled=!0)),qc(this,zi,new qd),Tr(this,zi).addLocalHook("init",()=>Fl(this,mx,cne).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Tr(this,zi)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Fl(e,gx,une).call(e,...i)}),this.addHook("afterGetCellMeta",(r,i,o)=>Fl(this,hx,sne).call(this,r,i,o)),this.addHook("modifyColWidth",(r,i)=>Fl(this,cx,one).call(this,r,i)),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Fl(e,fx,lne).call(e,...i)}),this.addHook("modifyCopyableRange",r=>Fl(this,dx,ane).call(this,r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),qc(this,Gi,{}),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;const o=Tr(this,zi).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalColumn(u));H(l,u=>{o[u]=!1}),i=en(o,(u,c,d)=>(c&&u.push(this.hot.toVisualColumn(d)),u),[])}this.hot.runHooks("beforeUnhideColumns",n,i,r&&s)!==!1&&(r&&s&&Tr(this,zi).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,i,r&&s,r&&i.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{H(e,s=>{Tr(this,zi).setValueAtIndex(this.hot.toPhysicalColumn(s),!0)})},!0),this.hot.runHooks("afterHideColumns",n,i,r,r&&i.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideColumns(n)}getHiddenColumns(){return qe(Tr(this,zi).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return Tr(this,zi).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){H(this.hot.getCellsMeta(),e=>{e&&(e.skipColumnOnPaste=!1)})}destroy(){qc(this,Gi,null),qc(this,zi,null),super.destroy()}}function one(t,e){if(this.isHidden(e))return 0;if(Tr(this,Gi).indicators&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function sne(t,e,n){if(Tr(this,Gi).copyPasteEnabled===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenColumn");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function ane(t){if(Tr(this,Gi).copyPasteEnabled)return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return H(t,r=>{let i=!0,o=0;Ie(r.startCol,r.endCol,s=>{this.isHidden(s)?(i||n(r.startRow,r.endRow,o,s-1),i=!0):(i&&(o=s),s===r.endCol&&n(r.startRow,r.endRow,o,s),i=!1)})}),e}function lne(t,e){if(!Tr(this,Gi).indicators||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),ce(e,n)}function une(t){t.items.push({name:Je},Jte(this),ene(this))}function cne(){Array.isArray(Tr(this,Gi).columns)&&this.hideColumns(Tr(this,Gi).columns)}function hne(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(Iv,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,n.row),0),i=Math.max(e.row,n.row),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideRows(o);const s=o[o.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function dne(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(Pv,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(!0),o-i+1===this.countRows()||this.selectRows(i,o)},disabled:!1,hidden(){const n=qe(t.getHiddenRows(),d=>this.toPhysicalRow(d));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().row,o=r.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const d=o-i+1,g=l-a+1;if(d>g){const p=u.slice(i,o+1);c.push(...p.filter(C=>n.includes(C)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const d=this.countRows()-1,g=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(d,-1));l===g&&d>o&&c.push(...u.slice(o+1))}return H(c,d=>{e.push(this.toVisualRow(d))}),e.length===0}}}function Wl(t,e){wx(t,e),e.add(t)}function px(t,e,n){wx(t,e),e.set(t,n)}function wx(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vl(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Ur(t,e){var n=Cx(t,e,"get");return fne(t,n)}function fne(t,e){return e.get?e.get.call(t):e.value}function Zc(t,e,n){var r=Cx(t,e,"set");return gne(t,r,n),n}function Cx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function gne(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}_e.getSingleton().register("beforeHideRows"),_e.getSingleton().register("afterHideRows"),_e.getSingleton().register("beforeUnhideRows"),_e.getSingleton().register("afterUnhideRows");const gb="hiddenRows",mne=320;var Lo=new WeakMap,ji=new WeakMap,vx=new WeakSet,Sx=new WeakSet,yx=new WeakSet,bx=new WeakSet,Rx=new WeakSet,Ex=new WeakSet;class pne extends gt{constructor(){super(...arguments),Wl(this,Ex),Wl(this,Rx),Wl(this,bx),Wl(this,yx),Wl(this,Sx),Wl(this,vx),px(this,Lo,{writable:!0,value:{}}),px(this,ji,{writable:!0,value:null})}static get PLUGIN_KEY(){return gb}static get PLUGIN_PRIORITY(){return mne}isEnabled(){return!!this.hot.getSettings()[gb]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[gb];Ke(n)&&(Zc(this,Lo,n),Mt(n.copyPasteEnabled)&&(n.copyPasteEnabled=!0)),Zc(this,ji,new qd),Ur(this,ji).addLocalHook("init",()=>Vl(this,Ex,bne).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Ur(this,ji)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Vl(e,Rx,yne).call(e,...i)}),this.addHook("afterGetCellMeta",(r,i,o)=>Vl(this,Sx,Cne).call(this,r,i,o)),this.addHook("modifyRowHeight",(r,i)=>Vl(this,vx,wne).call(this,r,i)),this.addHook("afterGetRowHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Vl(e,bx,Sne).call(e,...i)}),this.addHook("modifyCopyableRange",r=>Vl(this,yx,vne).call(this,r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),Zc(this,Lo,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;const o=Ur(this,ji).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalRow(u));H(l,u=>{o[u]=!1}),i=en(o,(u,c,d)=>(c&&u.push(this.hot.toVisualRow(d)),u),[])}this.hot.runHooks("beforeUnhideRows",n,i,r&&s)!==!1&&(r&&s&&Ur(this,ji).setValues(o),this.hot.runHooks("afterUnhideRows",n,i,r&&s,r&&i.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{H(e,s=>{Ur(this,ji).setValueAtIndex(this.hot.toPhysicalRow(s),!0)})},!0),this.hot.runHooks("afterHideRows",n,i,r,r&&i.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideRows(n)}getHiddenRows(){return qe(Ur(this,ji).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return Ur(this,ji).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){H(this.hot.getCellsMeta(),e=>{e&&(e.skipRowOnPaste=!1)})}destroy(){Zc(this,Lo,null),Zc(this,ji,null),super.destroy()}}function wne(t,e){return this.isHidden(e)?0:t}function Cne(t,e,n){if(Ur(this,Lo).copyPasteEnabled===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenRow");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function vne(t){if(Ur(this,Lo).copyPasteEnabled)return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return H(t,r=>{let i=!0,o=0;Ie(r.startRow,r.endRow,s=>{this.isHidden(s)?(i||n(o,s-1,r.startCol,r.endCol),i=!0):(i&&(o=s),s===r.endRow&&n(o,s,r.startCol,r.endCol),i=!1)})}),e}function Sne(t,e){if(!Ur(this,Lo).indicators||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),ce(e,n)}function yne(t){t.items.push({name:Je},hne(this),dne(this))}function bne(){Array.isArray(Ur(this,Lo).rows)&&this.hideRows(Ur(this,Lo).rows)}function Rne(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(iv)},callback(e,n){const[{start:{col:r}}]=n;t.freezeColumn(r),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function Ene(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(ov)},callback(e,n){const[{start:{col:r}}]=n;t.unfreezeColumn(r),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function Tx(t,e){_x(t,e),e.add(t)}function Tne(t,e,n){_x(t,e),e.set(t,n)}function _x(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mb(t,e){var n=Mx(t,e,"get");return _ne(t,n)}function _ne(t,e){return e.get?e.get.call(t):e.value}function pb(t,e,n){var r=Mx(t,e,"set");return Mne(t,r,n),n}function Mx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Mne(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Ox(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}_e.getSingleton().register("beforeColumnFreeze"),_e.getSingleton().register("afterColumnFreeze"),_e.getSingleton().register("beforeColumnUnfreeze"),_e.getSingleton().register("afterColumnUnfreeze");const Ax="manualColumnFreeze",One=110;var Ra=new WeakMap,Ix=new WeakSet,Px=new WeakSet;class Ane extends gt{constructor(){super(...arguments),Tx(this,Px),Tx(this,Ix),Tne(this,Ra,{writable:!0,value:!1})}static get PLUGIN_KEY(){return Ax}static get PLUGIN_PRIORITY(){return One}isEnabled(){return!!this.hot.getSettings()[Ax]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>Ox(this,Ix,Ine).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>Ox(this,Px,Pne).call(this,e,n)),super.enablePlugin())}disablePlugin(){pb(this,Ra,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;mb(this,Ra)||pb(this,Ra,!0),this.hot.runHooks("beforeColumnFreeze",e,r)!==!1&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;mb(this,Ra)||pb(this,Ra,!0),this.hot.runHooks("beforeColumnUnfreeze",e,r)!==!1&&(r&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}}function Ine(t){t.items.push({name:"---------"},Rne(this),Ene(this))}function Pne(t,e){if(mb(this,Ra)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(r=>r<n))return!1}}function Ag(t,e,n){return e=xne(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xne(t){var e=Hne(t,"string");return typeof e=="symbol"?e:String(e)}function Hne(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const wb=0,xx=1,Hx=2,Bl="px",Dx=class{constructor(e){Ag(this,"hot",void 0),Ag(this,"_element",null),Ag(this,"state",wb),Ag(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=Hx}build(){this.state===wb&&(this._element=this.hot.rootDocument.createElement("div"),this.state=xx)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=wb}isAppended(){return this.state===Hx}isBuilt(){return this.state>=xx}setPosition(e,n){Xn(e)&&(this._element.style.top=e+Bl),Xn(n)&&(this._element.style[this.inlineProperty]=n+Bl)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){Xn(e)&&(this._element.style.width=e+Bl),Xn(n)&&(this._element.style.height=n+Bl)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){Xn(e)&&(this._element.style.marginTop=e+Bl),Xn(n)&&(this._element.style[`margin${$n(this.inlineProperty)}`]=n+Bl)}getOffset(){const e=this._element.style,n=`margin${$n(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}},Dne="ht__manualColumnMove--backlight",Nne=class extends Dx{build(){super.build(),ce(this._element,Dne)}},Lne="ht__manualColumnMove--guideline",$ne=class extends Dx{build(){super.build(),ce(this._element,Lne)}};function Ul(t,e){Nx(t,e),e.add(t)}function Ci(t,e,n){Nx(t,e),e.set(t,n)}function Nx(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fr(t,e,n){var r=Lx(t,e,"set");return kne(t,r,n),n}function kne(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Oe(t,e){var n=Lx(t,e,"get");return Fne(t,n)}function Lx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Fne(t,e){return e.get?e.get.call(t):e.value}function Yl(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}_e.getSingleton().register("beforeColumnMove"),_e.getSingleton().register("afterColumnMove");const Cb="manualColumnMove",Wne=120,$x="ht__manualColumnMove",Ig="show-ui",vb="on-moving--columns",Sb="after-selection--columns";var er=new WeakMap,_s=new WeakMap,$o=new WeakMap,Pg=new WeakMap,Ms=new WeakMap,tr=new WeakMap,xg=new WeakMap,Yr=new WeakMap,Gl=new WeakMap,Hg=new WeakMap,Qc=new WeakMap,kx=new WeakSet,Fx=new WeakSet,Wx=new WeakSet,Vx=new WeakSet,Bx=new WeakSet,Ux=new WeakSet;class Vne extends gt{constructor(){super(...arguments),Ul(this,Ux),Ul(this,Bx),Ul(this,Vx),Ul(this,Wx),Ul(this,Fx),Ul(this,kx),Ci(this,er,{writable:!0,value:new Nne(this.hot)}),Ci(this,_s,{writable:!0,value:new $ne(this.hot)}),Ci(this,$o,{writable:!0,value:[]}),Ci(this,Pg,{writable:!0,value:0}),Ci(this,Ms,{writable:!0,value:!1}),Ci(this,tr,{writable:!0,value:{}}),Ci(this,xg,{writable:!0,value:void 0}),Ci(this,Yr,{writable:!0,value:void 0}),Ci(this,Gl,{writable:!0,value:void 0}),Ci(this,Hg,{writable:!0,value:void 0}),Ci(this,Qc,{writable:!0,value:void 0})}static get PLUGIN_KEY(){return Cb}static get PLUGIN_PRIORITY(){return Wne}isEnabled(){return!!this.hot.getSettings()[Cb]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Yl(e,kx,Bne).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Yl(e,Wx,Yne).call(e,...r)}),this.addHook("afterScrollVertically",()=>Yl(this,Bx,zne).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Yl(e,Ux,jne).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),ce(this.hot.rootElement,$x),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Ue(this.hot.rootElement,$x),this.unregisterEvents(),Oe(this,er).destroy(),Oe(this,_s).destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const r=Oe(this,xg),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeColumnMove",e,n,r,i);if(fr(this,xg,void 0),o===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,n);const s=i&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,r,i,s),s}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const r=this.countFinalIndex(e,n);return fr(this,xg,n),this.moveColumns(e,r)}isMovePossible(e,n){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isColumnOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=en(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getColumnsWidth(e,n){const r=this.hot.columnIndexMapper;let i=0;for(let o=e;o<=n;o+=1){const s=r.getRenderableFromVisualIndex(o);o<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:s!==null&&(i+=this.hot.view._wt.wtTable.getStretchedColumnWidth(s)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[Cb];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const r=[];return Ie(e,n,i=>{r.push(i)}),r}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(Oe(this,Yr))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof r.scrollX=="number"?r.scrollX:r.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,Oe(this,Yr)-1);const s=n.hider.offsetWidth,a=n.TBODY.offsetLeft,l=Oe(this,er).getOffset().start,u=Oe(this,er).getSize().width;let c=0,d=0;if(this.hot.isRtl()){const C=this.hot.rootWindow,E=yt(this.hot.rootElement),I=C.innerWidth-Oe(this,Gl)-E;d=C.innerWidth-Oe(this,tr).eventPageX-I-(r.scrollX===void 0?i:0)}else d=Oe(this,tr).eventPageX-(Oe(this,Gl)-(r.scrollX===void 0?i:0));if(Oe(this,Hg)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(Oe(this,Yr))&&(o+=i),o+=c,Oe(this,Yr)<0)Oe(this,Qc)>0?Oe(this,tr).col=0:Oe(this,tr).col=e>0?e-1:e;else if(Oe(this,tr).TD.offsetWidth/2+o<=d){const C=Oe(this,Yr)>=Oe(this,Pg)?Oe(this,Pg)-1:Oe(this,Yr);Oe(this,tr).col=C+1,o+=Oe(this,tr).TD.offsetWidth}else Oe(this,tr).col=Oe(this,Yr);let g=d,p=o;d+u+l>=s?g=s-u-l:d+l<a+c&&(g=a+c+Math.abs(l)),o>=s-1?p=s-1:p===0?p=1:r.scrollX!==void 0&&Oe(this,Yr)<Oe(this,Qc)&&(p-=Oe(this,Gl)<=r.scrollX?Oe(this,Gl):0),Oe(this,er).setPosition(null,g),Oe(this,_s).setPosition(null,p)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Yl(this,Fx,Une).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Yl(this,Vx,Gne).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Oe(this,er).build(),Oe(this,_s).build()}destroy(){Oe(this,er).destroy(),Oe(this,_s).destroy(),super.destroy()}}function Bne(t,e,n,r){const i=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),a=We(t.target,"sortAction");if(!s||!o||Oe(this,Ms)||t.button!==0||a){fr(this,Ms,!1),Oe(this,$o).length=0,Ue(this.hot.rootElement,[vb,Ig]);return}const l=Oe(this,_s).isBuilt()&&!Oe(this,_s).isAppended(),u=Oe(this,er).isBuilt()&&!Oe(this,er).isAppended();l&&u&&(Oe(this,_s).appendTo(i.hider),Oe(this,er).appendTo(i.hider));const{from:c,to:d}=s,g=Math.min(c.col,d.col),p=Math.max(c.col,d.col);if(e.row<0&&e.col>=g&&e.col<=p){r.column=!0,fr(this,Ms,!0);const C=n.firstChild?jT(t,n.firstChild).x:t.offsetX;Oe(this,tr).eventPageX=t.pageX,fr(this,Yr,e.col),Oe(this,tr).TD=n,Oe(this,tr).col=e.col,fr(this,$o,this.prepareColumnsToMoving(g,p)),fr(this,Hg,!!this.hot.getSettings().rowHeaders),fr(this,Pg,this.hot.countCols()),fr(this,Qc,this.hot.getSettings().fixedColumnsStart),fr(this,Gl,sn(this.hot.rootElement).left);const E=Oe(this,Hg)?-1:0,I=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,M=e.col<Oe(this,Qc),y=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),$=Math.abs(C-(this.hot.isRtl()?n.offsetWidth:0)),X=this.getColumnsWidth(g,e.col-1)+$,G=this.getColumnsWidth(E,g-1)+(M?y:0)+X;Oe(this,er).setPosition(I,G),Oe(this,er).setSize(this.getColumnsWidth(g,p),i.hider.offsetHeight-I),Oe(this,er).setOffset(null,-X),ce(this.hot.rootElement,vb)}else Ue(this.hot.rootElement,Sb),fr(this,Ms,!1),Oe(this,$o).length=0}function Une(t){Oe(this,Ms)&&(Oe(this,tr).eventPageX=t.pageX,this.refreshPositions())}function Yne(t,e,n,r){!this.hot.getSelectedRangeLast()||!Oe(this,Ms)||(Oe(this,$o).indexOf(e.col)>-1?Ue(this.hot.rootElement,Ig):ce(this.hot.rootElement,Ig),r.row=!0,r.column=!0,r.cell=!0,fr(this,Yr,e.col),Oe(this,tr).TD=n)}function Gne(){const t=Oe(this,tr).col,e=Oe(this,$o).length;if(fr(this,Yr,void 0),fr(this,Ms,!1),Ue(this.hot.rootElement,[vb,Ig,Sb]),this.hot.selection.isSelectedByColumnHeader()&&ce(this.hot.rootElement,Sb),e<1||t===void 0)return;const n=Oe(this,$o)[0],r=this.hot.toPhysicalColumn(n),i=this.dragColumns(Oe(this,$o),t);if(Oe(this,$o).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const o=this.hot.toVisualColumn(r),s=o+e-1;this.hot.selectColumns(o,s)}}function zne(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,r=e+n;Oe(this,er).setPosition(r),Oe(this,er).setSize(null,t.hider.offsetHeight-r)}function jne(){this.moveBySettingsOrLoad()}function ko(t,e){Yx(t,e),e.add(t)}function Bn(t,e,n){Yx(t,e),e.set(t,n)}function Yx(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fo(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function tn(t,e,n){var r=Gx(t,e,"set");return Kne(t,r,n),n}function Kne(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Ce(t,e){var n=Gx(t,e,"get");return Xne(t,n)}function Gx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Xne(t,e){return e.get?e.get.call(t):e.value}const Dg="manualColumnResize",qne=130,zx="manualColumnWidths";var Wo=new WeakMap,Ng=new WeakMap,_r=new WeakMap,Lg=new WeakMap,Ki=new WeakMap,Zne=new WeakMap,zl=new WeakMap,$g=new WeakMap,gr=new WeakMap,Vo=new WeakMap,Ea=new WeakMap,kg=new WeakMap,Jc=new WeakMap,eh=new WeakMap,Mr=new WeakMap,th=new WeakMap,jx=new WeakSet,Kx=new WeakSet,Xx=new WeakSet,qx=new WeakSet,Zx=new WeakSet,Qx=new WeakSet,Jx=new WeakSet,eH=new WeakSet,tH=new WeakSet;class Qne extends gt{static get PLUGIN_KEY(){return Dg}static get PLUGIN_PRIORITY(){return qne}constructor(e){super(e),ko(this,tH),ko(this,eH),ko(this,Jx),ko(this,Qx),ko(this,Zx),ko(this,qx),ko(this,Xx),ko(this,Kx),ko(this,jx),Bn(this,Wo,{writable:!0,value:null}),Bn(this,Ng,{writable:!0,value:null}),Bn(this,_r,{writable:!0,value:[]}),Bn(this,Lg,{writable:!0,value:null}),Bn(this,Ki,{writable:!0,value:null}),Bn(this,Zne,{writable:!0,value:null}),Bn(this,zl,{writable:!0,value:null}),Bn(this,$g,{writable:!0,value:null}),Bn(this,gr,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),Bn(this,Vo,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),Bn(this,Ea,{writable:!0,value:null}),Bn(this,kg,{writable:!0,value:!1}),Bn(this,Jc,{writable:!0,value:0}),Bn(this,eh,{writable:!0,value:null}),Bn(this,Mr,{writable:!0,value:void 0}),Bn(this,th,{writable:!0,value:void 0}),ce(Ce(this,gr),"manualColumnResizer"),ce(Ce(this,Vo),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Dg]}enablePlugin(){this.enabled||(tn(this,Mr,new cs),Ce(this,Mr).addLocalHook("init",()=>Fo(this,jx,Jne).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Ce(this,Mr)),this.addHook("modifyColWidth",(e,n)=>Fo(this,Jx,ore).call(this,e,n)),this.addHook("beforeStretchingColumnWidth",(e,n)=>Fo(this,eH,sre).call(this,e,n)),this.addHook("beforeColumnResize",(e,n,r)=>Fo(this,tH,are).call(this,e,n,r)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){tn(this,th,Ce(this,Mr).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",zx,Ce(this,Mr).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",zx,e),e.value}setManualSize(e,n){const r=Math.max(n,20),i=this.hot.toPhysicalColumn(e);return Ce(this,Mr).setValueAtIndex(i,r),r}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);Ce(this,Mr).setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode)return;tn(this,Wo,e);const{_wt:n}=this.hot.view,r=n.wtTable.getCoords(Ce(this,Wo)),i=r.col;if(i<0)return;const o=Wt(Ce(this,Wo)),s=Ce(this,Wo).getBoundingClientRect(),a=i<n.getSetting("fixedColumnsStart");let l;a&&(l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(Ce(this,Wo),r.row,r.col)),l||(l=n.wtOverlays.topOverlay.getRelativeCellPosition(Ce(this,Wo),r.row,r.col)),tn(this,Ng,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),tn(this,_r,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();H(c,d=>{const g=d.getTopStartCorner().col,p=d.getBottomEndCorner().col;Ie(g,p,C=>{Ce(this,_r).includes(C)||Ce(this,_r).push(C)})})}Ce(this,_r).includes(Ce(this,Ng))||tn(this,_r,[Ce(this,Ng)]),tn(this,$g,l.start-6),tn(this,zl,parseInt(s.width,10)),Ce(this,gr).style.top=`${l.top}px`,Ce(this,gr).style[this.inlineDir]=`${Ce(this,$g)+Ce(this,zl)}px`,Ce(this,gr).style.height=`${o}px`,this.hot.rootElement.appendChild(Ce(this,gr))}refreshHandlePosition(){Ce(this,gr).style[this.inlineDir]=`${Ce(this,$g)+Ce(this,Lg)}px`}setupGuidePosition(){const e=parseInt(Wt(Ce(this,gr)),10),n=parseInt(Ce(this,gr).style.top,10)+e,r=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);ce(Ce(this,gr),"active"),ce(Ce(this,Vo),"active"),Ce(this,Vo).style.top=`${n}px`,this.refreshGuidePosition(),Ce(this,Vo).style.height=`${r-e}px`,this.hot.rootElement.appendChild(Ce(this,Vo))}refreshGuidePosition(){Ce(this,Vo).style[this.inlineDir]=Ce(this,gr).style[this.inlineDir]}hideHandleAndGuide(){Ue(Ce(this,gr),"active"),Ue(Ce(this,Vo),"active")}checkIfColumnHeader(e){return!!Zo(e,["THEAD"],this.hot.rootElement)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},n=(r,i)=>{const o=this.hot.runHooks("beforeColumnResize",Ce(this,Ki),r,!0);o!==void 0&&tn(this,Ki,o),this.hot.getSettings().stretchH==="all"?this.clearManualSize(r):this.setManualSize(r,Ce(this,Ki)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",Ce(this,Ki),r,!0),i&&e()};Ce(this,Jc)>=2&&(Ce(this,_r).length>1?(H(Ce(this,_r),i=>{n(i)}),e()):H(Ce(this,_r),i=>{n(i,!0)})),tn(this,Jc,0),tn(this,eh,null)}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",r=>Fo(this,Kx,ere).call(this,r)),this.eventManager.addEventListener(n,"mousedown",r=>Fo(this,Xx,tre).call(this,r)),this.eventManager.addEventListener(e,"mousemove",r=>Fo(this,qx,nre).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Fo(this,Zx,rre).call(this)),this.eventManager.addEventListener(Ce(this,gr),"contextmenu",()=>Fo(this,Qx,ire).call(this))}destroy(){super.destroy()}}function Jne(){const t=this.hot.getSettings()[Dg],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,r)=>{Ce(this,Mr).setValueAtIndex(r,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,r)=>{Ce(this,Mr).setValueAtIndex(r,n)})},!0),tn(this,th,t)):t===!0&&Array.isArray(Ce(this,th))&&this.hot.batchExecution(()=>{Ce(this,th).forEach((n,r)=>{Ce(this,Mr).setValueAtIndex(r,n)})},!0)}function ere(t){if(!gw(t.target)&&Ce(this,kg)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(Ce(this,Ea)||this.setupHandlePosition(e))}}function tre(t){We(t.target,"manualColumnResizer")&&(this.setupHandlePosition(Ce(this,Wo)),this.setupGuidePosition(),tn(this,Ea,!0),Ce(this,eh)===null&&(tn(this,eh,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(Ce(this,eh))),tn(this,Jc,Ce(this,Jc)+1),this.startX=t.pageX,tn(this,Ki,Ce(this,zl)))}function nre(t){if(Ce(this,Ea)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();tn(this,Lg,Ce(this,zl)+e),H(Ce(this,_r),n=>{tn(this,Ki,this.setManualSize(n,Ce(this,Lg)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function rre(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(n,r)=>{this.hot.runHooks("beforeColumnResize",Ce(this,Ki),n,!1),r&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",Ce(this,Ki),n,!1)};Ce(this,Ea)&&(this.hideHandleAndGuide(),tn(this,Ea,!1),Ce(this,Ki)!==Ce(this,zl)&&(Ce(this,_r).length>1?(H(Ce(this,_r),r=>{e(r)}),t()):H(Ce(this,_r),r=>{e(r,!0)})),this.setupHandlePosition(Ce(this,Wo)))}function ire(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(Ce(this,gr)),this.hot.rootElement.removeChild(Ce(this,Vo)),tn(this,Ea,!1),tn(this,kg,!0),this.hot._registerImmediate(()=>{tn(this,kg,!1)})}function ore(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalColumn(e),i=Ce(this,Mr).getValueAtIndex(r);this.hot.getSettings()[Dg]&&i&&(n=i)}return n}function sre(t,e){let n=Ce(this,Mr).getValueAtIndex(e);return n===null&&(n=t),n}function are(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function yb(t,e,n){return e=lre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lre(t){var e=ure(t,"string");return typeof e=="symbol"?e:String(e)}function ure(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const bb=0,nH=1,rH=2,jl="px",iH=class{constructor(e){yb(this,"hot",void 0),yb(this,"_element",null),yb(this,"state",bb),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=rH}build(){this.state===bb&&(this._element=this.hot.rootDocument.createElement("div"),this.state=nH)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=bb}isAppended(){return this.state===rH}isBuilt(){return this.state>=nH}setPosition(e,n){e!==void 0&&(this._element.style.top=e+jl),n!==void 0&&(this._element.style.left=n+jl)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+jl),n&&(this._element.style.height=n+jl)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+jl),n&&(this._element.style.marginLeft=n+jl)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}},cre="ht__manualRowMove--backlight";class hre extends iH{build(){super.build(),ce(this._element,cre)}}const dre=hre,fre="ht__manualRowMove--guideline";class gre extends iH{build(){super.build(),ce(this._element,fre)}}const mre=gre;function Kl(t,e){oH(t,e),e.add(t)}function Xl(t,e,n){oH(t,e),e.set(t,n)}function oH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ta(t,e,n){var r=sH(t,e,"set");return pre(t,r,n),n}function pre(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Ge(t,e){var n=sH(t,e,"get");return wre(t,n)}function sH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function wre(t,e){return e.get?e.get.call(t):e.value}function ql(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}_e.getSingleton().register("beforeRowMove"),_e.getSingleton().register("afterRowMove");const Rb="manualRowMove",Cre=140,aH="ht__manualRowMove",Fg="show-ui",Eb="on-moving--rows",Tb="after-selection--rows";var nr=new WeakMap,Os=new WeakMap,Bo=new WeakMap,As=new WeakMap,mr=new WeakMap,Wg=new WeakMap,lH=new WeakSet,uH=new WeakSet,cH=new WeakSet,hH=new WeakSet,dH=new WeakSet,fH=new WeakSet;class vre extends gt{constructor(){super(...arguments),Kl(this,fH),Kl(this,dH),Kl(this,hH),Kl(this,cH),Kl(this,uH),Kl(this,lH),Xl(this,nr,{writable:!0,value:new dre(this.hot)}),Xl(this,Os,{writable:!0,value:new mre(this.hot)}),Xl(this,Bo,{writable:!0,value:[]}),Xl(this,As,{writable:!0,value:void 0}),Xl(this,mr,{writable:!0,value:{}}),Xl(this,Wg,{writable:!0,value:void 0})}static get PLUGIN_KEY(){return Rb}static get PLUGIN_PRIORITY(){return Cre}isEnabled(){return!!this.hot.getSettings()[Rb]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ql(e,lH,Sre).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ql(e,cH,bre).call(e,...r)}),this.addHook("afterScrollHorizontally",()=>ql(this,dH,Ere).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ql(e,fH,Tre).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),ce(this.hot.rootElement,aH),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Ue(this.hot.rootElement,aH),this.unregisterEvents(),Ge(this,nr).destroy(),Ge(this,Os).destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const r=Ge(this,Wg),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeRowMove",e,n,r,i);if(Ta(this,Wg,void 0),o===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,n);const s=i&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,r,i,s),s}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const r=this.countFinalIndex(e,n);return Ta(this,Wg,n),this.moveRows(e,r)}isMovePossible(e,n){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=en(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getRowsHeight(e,n){const r=this.hot.rowIndexMapper;let i=0;for(let o=e;o<=n;o++){const s=r.getRenderableFromVisualIndex(o);s!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(s)||23)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[Rb];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),n=[];if(!e)return n;const{from:r,to:i}=e,o=Math.min(r.row,i.row),s=Math.max(r.row,i.row);return Ie(o,s,a=>{n.push(a)}),n}refreshPositions(){const e=Ge(this,mr).coords,n=this.hot.view.getFirstFullyVisibleRow(),r=this.hot.view.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&r<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,s=Ge(this,mr).TD,a=this.hot.rootElement,l=sn(a),u=Gs(a),c=o.holder.scrollTop,d=this.hot.rootWindow!==u?u.scrollTop:0,g=l.top-d,p=Ge(this,mr).eventPageY-g+c,C=o.hider.offsetHeight,E=o.TBODY.offsetTop,I=Ge(this,nr).getOffset().top,M=Ge(this,nr).getSize().height,y=s.offsetHeight/2,$=s.offsetHeight;let X=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const G=p>=X+y;this.isFixedRowTop(e.row)&&(X+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?Ge(this,mr).row=n>0?n-1:n:G?(Ge(this,mr).row=e.row+1,X+=e.row===0?$-1:$):Ge(this,mr).row=e.row;let q=p,re=X;p+M+I>=C?q=C-M-I:p+I<E&&(q=E+Math.abs(I)),X>=C-1&&(re=C-1),Ge(this,nr).setPosition(q),Ge(this,Os).setPosition(re)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>ql(this,uH,yre).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>ql(this,hH,Rre).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Ge(this,nr).build(),Ge(this,Os).build()}destroy(){Ge(this,nr).destroy(),Ge(this,Os).destroy(),super.destroy()}}function Sre(t,e,n,r){const{wtTable:i,wtViewport:o}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!s||Ge(this,As)||t.button!==0){Ta(this,As,!1),Ge(this,Bo).length=0,Ue(this.hot.rootElement,[Eb,Fg]);return}const l=Ge(this,Os).isBuilt()&&!Ge(this,Os).isAppended(),u=Ge(this,nr).isBuilt()&&!Ge(this,nr).isAppended();l&&u&&(Ge(this,Os).appendTo(i.hider),Ge(this,nr).appendTo(i.hider));const{from:c,to:d}=a,g=Math.min(c.row,d.row),p=Math.max(c.row,d.row);if(e.col<0&&e.row>=g&&e.row<=p){r.row=!0,Ta(this,As,!0),Ge(this,mr).eventPageY=t.pageY,Ge(this,mr).coords=e,Ge(this,mr).TD=n,Ta(this,Bo,this.prepareRowsToMoving());const C=i.holder.scrollLeft+o.getRowHeaderWidth(),E=this.getRowsHeight(g,e.row-1)+t.offsetY;Ge(this,nr).setPosition(null,C),Ge(this,nr).setSize(i.hider.offsetWidth-C,this.getRowsHeight(g,p)),Ge(this,nr).setOffset(-E,null),ce(this.hot.rootElement,Eb),this.refreshPositions()}else Ue(this.hot.rootElement,Tb),Ta(this,As,!1),Ge(this,Bo).length=0}function yre(t){Ge(this,As)&&(Ge(this,mr).eventPageY=t.pageY,this.refreshPositions())}function bre(t,e,n,r){!this.hot.getSelectedRangeLast()||!Ge(this,As)||(Ge(this,Bo).indexOf(e.row)>-1?Ue(this.hot.rootElement,Fg):ce(this.hot.rootElement,Fg),r.row=!0,r.column=!0,r.cell=!0,Ge(this,mr).coords=e,Ge(this,mr).TD=n)}function Rre(){const t=Ge(this,mr).row,e=Ge(this,Bo).length;if(Ta(this,As,!1),Ue(this.hot.rootElement,[Eb,Fg,Tb]),this.hot.selection.isSelectedByRowHeader()&&ce(this.hot.rootElement,Tb),e<1||t===void 0)return;const n=Ge(this,Bo)[0],r=this.hot.toPhysicalRow(n),i=this.dragRows(Ge(this,Bo),t);if(Ge(this,Bo).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const o=this.hot.toVisualRow(r),s=o+e-1;this.hot.selectRows(o,s)}}function Ere(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,r=e+n;Ge(this,nr).setPosition(null,r),Ge(this,nr).setSize(t.hider.offsetWidth-r)}function Tre(){this.moveBySettingsOrLoad()}function _a(t,e){gH(t,e),e.add(t)}function Un(t,e,n){gH(t,e),e.set(t,n)}function gH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ma(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function qt(t,e,n){var r=mH(t,e,"set");return _re(t,r,n),n}function _re(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function ve(t,e){var n=mH(t,e,"get");return Mre(t,n)}function mH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Mre(t,e){return e.get?e.get.call(t):e.value}const Vg="manualRowResize",Ore=30,pH="manualRowHeights";var Xi=new WeakMap,Bg=new WeakMap,Or=new WeakMap,Ug=new WeakMap,Is=new WeakMap,_b=new WeakMap,Zl=new WeakMap,Yg=new WeakMap,rr=new WeakMap,qi=new WeakMap,Oa=new WeakMap,Gg=new WeakMap,nh=new WeakMap,rh=new WeakMap,vi=new WeakMap,ih=new WeakMap,wH=new WeakSet,CH=new WeakSet,vH=new WeakSet,SH=new WeakSet,yH=new WeakSet,bH=new WeakSet,RH=new WeakSet;class Are extends gt{static get PLUGIN_KEY(){return Vg}static get PLUGIN_PRIORITY(){return Ore}constructor(e){super(e),_a(this,RH),_a(this,bH),_a(this,yH),_a(this,SH),_a(this,vH),_a(this,CH),_a(this,wH),Un(this,Xi,{writable:!0,value:null}),Un(this,Bg,{writable:!0,value:null}),Un(this,Or,{writable:!0,value:[]}),Un(this,Ug,{writable:!0,value:null}),Un(this,Is,{writable:!0,value:null}),Un(this,_b,{writable:!0,value:null}),Un(this,Zl,{writable:!0,value:null}),Un(this,Yg,{writable:!0,value:null}),Un(this,rr,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),Un(this,qi,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),Un(this,Oa,{writable:!0,value:!1}),Un(this,Gg,{writable:!0,value:!1}),Un(this,nh,{writable:!0,value:0}),Un(this,rh,{writable:!0,value:null}),Un(this,vi,{writable:!0,value:void 0}),Un(this,ih,{writable:!0,value:void 0}),ce(ve(this,rr),"manualRowResizer"),ce(ve(this,qi),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Vg]}enablePlugin(){this.enabled||(qt(this,vi,new cs),ve(this,vi).addLocalHook("init",()=>Ma(this,RH,Lre).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,ve(this,vi)),this.addHook("modifyRowHeight",(e,n)=>Ma(this,bH,Nre).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){qt(this,ih,ve(this,vi).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",pH,ve(this,vi).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",pH,e),e.value}setManualSize(e,n){const r=this.hot.toPhysicalRow(e),i=Math.max(n,O_.DEFAULT_HEIGHT);return ve(this,vi).setValueAtIndex(r,i),i}setupHandlePosition(e){qt(this,Xi,e);const{view:n}=this.hot,{_wt:r}=n,i=r.wtTable.getCoords(ve(this,Xi)),o=i.row;if(o<0)return;const s=yt(ve(this,Xi)),a=ve(this,Xi).getBoundingClientRect(),l=o<r.getSetting("fixedRowsTop"),u=o>=n.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let c;l?c=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(ve(this,Xi),i.row,i.col):u&&(c=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(ve(this,Xi),i.row,i.col)),c||(c=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(ve(this,Xi),i.row,i.col)),qt(this,Bg,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),qt(this,Or,[]);const d=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&d){const g=this.hot.getSelectedRange();H(g,p=>{const C=p.getTopStartCorner().row,E=p.getBottomStartCorner().row;Ie(C,E,I=>{ve(this,Or).includes(I)||ve(this,Or).push(I)})})}ve(this,Or).includes(ve(this,Bg))||qt(this,Or,[ve(this,Bg)]),qt(this,Yg,c.top-6),qt(this,Zl,parseInt(a.height,10)),ve(this,rr).style.top=`${ve(this,Yg)+ve(this,Zl)}px`,ve(this,rr).style[this.inlineDir]=`${c.start}px`,ve(this,rr).style.width=`${s}px`,this.hot.rootElement.appendChild(ve(this,rr))}refreshHandlePosition(){ve(this,rr).style.top=`${ve(this,Yg)+ve(this,Ug)}px`}setupGuidePosition(){const e=parseInt(yt(ve(this,rr)),10),n=parseInt(ve(this,rr).style[this.inlineDir],10)+e,r=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);ce(ve(this,rr),"active"),ce(ve(this,qi),"active"),ve(this,qi).style.top=ve(this,rr).style.top,ve(this,qi).style[this.inlineDir]=`${n}px`,ve(this,qi).style.width=`${r-e}px`,this.hot.rootElement.appendChild(ve(this,qi))}refreshGuidePosition(){ve(this,qi).style.top=ve(this,rr).style.top}hideHandleAndGuide(){Ue(ve(this,rr),"active"),Ue(ve(this,qi),"active")}checkIfRowHeader(e){var n;return Zo(e,["TH"],this.hot.rootElement)&&((n=e.parentNode)===null||n===void 0||(n=n.parentNode)===null||n===void 0?void 0:n.tagName)==="TBODY"}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&ve(this,Is)<n?n:ve(this,Is)}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},n=(r,i)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);o!==void 0&&qt(this,Is,o),this.setManualSize(r,ve(this,Is)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),i&&e()};ve(this,nh)>=2&&(ve(this,Or).length>1?(H(ve(this,Or),i=>{n(i)}),e()):H(ve(this,Or),i=>{n(i,!0)})),qt(this,nh,0),qt(this,rh,null)}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>Ma(this,wH,Ire).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Ma(this,CH,Pre).call(this,r)),this.eventManager.addEventListener(n,"mousemove",r=>Ma(this,vH,xre).call(this,r)),this.eventManager.addEventListener(n,"mouseup",()=>Ma(this,SH,Hre).call(this)),this.eventManager.addEventListener(ve(this,rr),"contextmenu",()=>Ma(this,yH,Dre).call(this))}destroy(){super.destroy()}}function Ire(t){if(!gw(t.target)&&ve(this,Gg)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(ve(this,Oa)||this.setupHandlePosition(e))}}function Pre(t){We(t.target,"manualRowResizer")&&(this.setupHandlePosition(ve(this,Xi)),this.setupGuidePosition(),qt(this,Oa,!0),ve(this,rh)===null&&(qt(this,rh,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(ve(this,rh))),qt(this,nh,ve(this,nh)+1),qt(this,_b,t.pageY),qt(this,Is,ve(this,Zl)))}function xre(t){ve(this,Oa)&&(qt(this,Ug,ve(this,Zl)+(t.pageY-ve(this,_b))),H(ve(this,Or),e=>{qt(this,Is,this.setManualSize(e,ve(this,Ug)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function Hre(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(n,r)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),r&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};ve(this,Oa)&&(this.hideHandleAndGuide(),qt(this,Oa,!1),ve(this,Is)!==ve(this,Zl)&&(ve(this,Or).length>1?(H(ve(this,Or),r=>{e(r)}),t()):H(ve(this,Or),r=>{e(r,!0)})),this.setupHandlePosition(ve(this,Xi)))}function Dre(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(ve(this,rr)),this.hot.rootElement.removeChild(ve(this,qi)),qt(this,Oa,!1),qt(this,Gg,!0),this.hot._registerImmediate(()=>{qt(this,Gg,!1)})}function Nre(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalRow(e),i=ve(this,vi).getValueAtIndex(r);this.hot.getSettings()[Vg]&&i&&(n=i)}return n}function Lre(){const t=this.hot.getSettings()[Vg],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,r)=>{ve(this,vi).setValueAtIndex(r,n)}):Array.isArray(t)?(t.forEach((n,r)=>{ve(this,vi).setValueAtIndex(r,n)}),qt(this,ih,t)):t===!0&&Array.isArray(ve(this,ih))&&ve(this,ih).forEach((n,r)=>{ve(this,vi).setValueAtIndex(r,n)})},!0)}function Aa(t,e,n){return e=$re(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $re(t){var e=kre(t,"string");return typeof e=="symbol"?e:String(e)}function kre(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Fre{constructor(e,n,r,i,o,s){Aa(this,"row",void 0),Aa(this,"col",void 0),Aa(this,"rowspan",void 0),Aa(this,"colspan",void 0),Aa(this,"removed",!1),Aa(this,"cellCoordsFactory",void 0),Aa(this,"cellRangeFactory",void 0),this.row=e,this.col=n,this.rowspan=r,this.colspan=i,this.cellCoordsFactory=o,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(e){return St`The merged cell declared with {row: ${e.row}, col: ${e.col},\x20
      rowspan: ${e.rowspan}, colspan: ${e.colspan}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){return St`The merged cell declared at [${e.row}, ${e.col}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){return St`The merged cell declared at [${e.row}, ${e.col}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){return St`The merged cell declared at [${e.row}, ${e.col}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){return e.row<0||e.col<0||e.rowspan<0||e.colspan<0}static isSingleCell(e){return e.colspan===1&&e.rowspan===1}static containsZeroSpan(e){return e.colspan===0||e.rowspan===0}static isOutOfBounds(e,n,r){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=r||e.col+e.colspan-1>=r}normalize(e){const n=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const r=e[0]||e[1],i=n+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",s=e[0]?"col":"row",a=Math.min(n,i),l=Math.max(n,i),u=this[s],c=this[s]+this[o]-1;if(u>=n&&(this[s]+=r),r>0)n<=c&&n>u&&(this[o]+=r);else if(r<0){if(a<=u&&l>=c)return this.removed=!0,!1;if(u>=a&&u<=l){const d=l-u+1,g=Math.abs(r)-d;this[s]-=g+r,this[o]-=d}else if(u<=a&&c>=l)this[o]+=r;else if(u<=a&&c>=a&&c<l){const d=c-a+1;this[o]-=d}}return!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}const Zi=Fre;function Mb(t,e,n,r){e?e.row===n&&e.col===r?(t.setAttribute("rowspan",e.rowspan.toString()),t.setAttribute("colspan",e.colspan.toString())):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="none"):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="")}function Ob(t,e,n){return e=Wre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wre(t){var e=Vre(t,"string");return typeof e=="symbol"?e:String(e)}function Vre(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ab{constructor(e){Ob(this,"plugin",void 0),Ob(this,"mergedCells",[]),Ob(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){return St`The merged cell declared at [${e.row}, ${e.col}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){const r=this.mergedCells;let i=!1;return H(r,o=>o.row<=e&&o.row+o.rowspan-1>=e&&o.col<=n&&o.col+o.colspan-1>=n?(i=o,!1):!0),i}getByRange(e){const n=this.mergedCells;let r=!1;return H(n,i=>i.row<=e.from.row&&i.row+i.rowspan-1>=e.to.row&&i.col<=e.from.col&&i.col+i.colspan-1>=e.to.col?(r=i,r):!0),r}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCells,i=[];let o=e;if(!o.includesRange){const s=this.hot._createCellCoords(o.from.row,o.from.col),a=this.hot._createCellCoords(o.to.row,o.to.col);o=this.hot._createCellRange(s,s,a)}return H(r,s=>{const a=this.hot._createCellCoords(s.row,s.col),l=this.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1),u=this.hot._createCellRange(a,a,l);n?o.overlaps(u)&&i.push(s):o.includesRange(u)&&i.push(s)}),i.length?i:!1}add(e){const n=this.mergedCells,r=e.row,i=e.col,o=e.rowspan,s=e.colspan,a=new Zi(r,i,o,s,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(r,i),u=this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),n.push(a),a):(At(Ab.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,n){const r=this.mergedCells,i=this.get(e,n),o=i?this.mergedCells.indexOf(i):-1;return i&&o!==-1?(r.splice(o,1),i):!1}clear(){const e=this.mergedCells,n=[],r=[];H(e,i=>{const o=this.hot.getCell(i.row,i.col);o&&n.push([o,this.get(i.row,i.col),i.row,i.col])}),this.mergedCells.length=0,H(n,(i,o)=>{Ie(0,i.rowspan-1,s=>{Ie(0,i.colspan-1,a=>{if(a!==0||s!==0){const l=this.hot.getCell(i.row+s,i.col+a);l&&r.push([l,null,null,null])}})}),n[o][1]=null}),H(n,i=>{Mb(...i)}),H(r,i=>{Mb(...i)})}isOverlapping(e){const n=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(e.row,e.col),this.hot._createCellCoords(e.row+e.rowspan-1,e.col+e.colspan-1));let r=!1;return H(this.mergedCells,i=>this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(i.row,i.col),this.hot._createCellCoords(i.row+i.rowspan-1,i.col+i.colspan-1)).overlaps(n)?(r=!0,!1):!0),r}isFirstRenderableMergedCell(e,n){const r=this.get(e,n);return r&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1)===n}getFirstRenderableCoords(e,n){const r=this.get(e,n);if(!r||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(i,o)}shiftCollections(e,n,r){const i=[0,0];switch(e){case"right":i[0]+=r;break;case"left":i[0]-=r;break;case"down":i[1]+=r;break;case"up":i[1]-=r;break}H(this.mergedCells,o=>{o.shift(i,n)}),xd(this.mergedCells.length-1,0,o=>{const s=this.mergedCells[o];s&&s.removed&&this.mergedCells.splice(this.mergedCells.indexOf(s),1)})}}const Bre=Ab;function Ib(t,e,n){return e=Ure(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ure(t){var e=Yre(t,"string");return typeof e=="symbol"?e:String(e)}function Yre(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Gre{constructor(e){Ib(this,"plugin",void 0),Ib(this,"mergedCellsCollection",void 0),Ib(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(e){if(e[0]===e[2]&&e[1]===e[3]){const n=this.mergedCellsCollection.get(e[0],e[1]);n&&(e[2]=e[0]+n.rowspan-1,e[3]=e[1]+n.colspan-1)}}getDirection(e,n){let r=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?r="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?r="up":n[1]===e[1]&&n[2]===e[2]?r="right":r="left",r}snapDragArea(e,n,r,i){const o=n.slice(0),s=this.getAutofillSize(e,n,r),[a,l,u,c]=e,g=["up","down"].indexOf(r)>-1?u-a+1:c-l+1,p=Math.floor(s/g)*g,C=s-p,E=this.getFarthestCollection(e,n,r,i);if(E){if(r==="down"){const I=E.row+E.rowspan-a-C;o[2]+I>=this.plugin.hot.countRows()?o[2]-=C:o[2]+=C?I:0}else if(r==="right"){const I=E.col+E.colspan-l-C;o[3]+I>=this.plugin.hot.countCols()?o[3]-=C:o[3]+=C?I:0}else if(r==="up"){const I=u-C-E.row+1;o[0]+I<0?o[0]+=C:o[0]-=C?I:0}else if(r==="left"){const I=c-C-E.col+1;o[1]+I<0?o[1]+=C:o[1]-=C?I:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:i,fillSize:s,dragArea:o,cycleLength:g}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),an(this.currentFillData,e)}getAutofillSize(e,n,r){const[i,o,s,a]=e,[l,u,c,d]=n;switch(r){case"up":return i-l;case"down":return c-s;case"left":return o-u;case"right":return d-a;default:return null}}getDragArea(e,n,r){const[i,o,s,a]=e,[l,u,c,d]=n;switch(r){case"up":return[l,u,i-1,a];case"down":return[s+1,o,c,a];case"left":return[l,u,s,o-1];case"right":return[i,a+1,c,d];default:return null}}getFarthestCollection(e,n,r,i){const[o,s,a,l]=e,u=["up","down"].indexOf(r)>-1,c=u?a:l,d=u?o:s,g=this.getAutofillSize(e,n,r),p=u?a-o+1:l-s+1,C=Math.floor(g/p)*p,E=g-C;let I=null,M=null,y=null;switch(r){case"up":I="includesVertically",y=c-E+1;break;case"left":I="includesHorizontally",y=c-E+1;break;case"down":I="includesVertically",y=d+E-1;break;case"right":I="includesHorizontally",y=d+E-1;break}return H(i,$=>{$[I](y)&&$.isFarther(M,r)&&(M=$)}),M}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,o=(u,c)=>{switch(i){case"up":return u.row-c>=n.from.row;case"down":return u.row+u.rowspan-1+c<=n.to.row;case"left":return u.col-c>=n.from.column;case"right":return u.col+u.colspan-1+c<=n.to.column;default:return null}};let s=0,a=null,l=1;do for(let u=0;u<r.length;u+=1){if(a=r[u],s=l*this.currentFillData.cycleLength,o(a,s))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-s,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+s,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-s,colspan:a.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+s,colspan:a.colspan});break}u===r.length-1&&(l+=1)}while(o(a,s));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},r={min:null,max:null};return H(e,i=>{const o=i[0],s=this.plugin.hot.propToCol(i[1]);(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o),(r.min===null||s<r.min)&&(r.min=s),(r.max===null||s>r.max)&&(r.max=s)}),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}dragAreaOverlapsCollections(e,n,r){const i=this.getDragArea(e,n,r),[o,s,a,l]=i,u=this.plugin.hot._createCellCoords(o,s),c=this.plugin.hot._createCellCoords(a,l),d=this.plugin.hot._createCellRange(u,u,c);return!!this.mergedCellsCollection.getWithinRange(d,!0)}}const zre=Gre;function Pb(t,e,n){return e=jre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jre(t){var e=Kre(t,"string");return typeof e=="symbol"?e:String(e)}function Kre(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Xre{constructor(e){Pb(this,"plugin",void 0),Pb(this,"hot",void 0),Pb(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}snapDelta(e,n,r){const i=n.to,o=i.row+e.row,s=i.col+e.col;e.row?this.jumpOverMergedCell(e,r,o):e.col&&this.jumpOverMergedCell(e,r,s)}jumpOverMergedCell(e,n,r){let i=e.row||e.col,o=null,s=null,a=null;e.row?(o=n.includesVertically(r),s=n.row,a=n.getLastRow()):e.col&&(o=n.includesHorizontally(r),s=n.col,a=n.getLastColumn()),i!==0&&(i>0?o&&r!==s&&(i+=a-r+1):o&&r!==a&&(i-=r-s+1),e.row?e.row=i:e.col&&(e.col=i))}getUpdatedSelectionRange(e,n){return this.hot._createCellRange(e.highlight,e.from,this.hot._createCellCoords(e.to.row+n.row,e.to.col+n.col))}getSelectedMergedCellClassName(e,n,r,i){const o=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const c=this.plugin.mergedCellsCollection.get(e,n);if(!c)return;const d=c.getLastRow(),g=c.getLastColumn();if(o<=c.row&&s<=c.col&&a>=d&&l>=g)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.plugin.selectionCalculations.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const r=[];if(!n||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let o=0;o<e.colspan;o+=1)r.push(this.hot._createCellCoords(e.row+i,e.col+o));for(let i=0;i<r.length;i+=1){const o=[];for(let s=0;s<n.length;s+=1)o[s]=n[s].includes(r[i]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}const qre=Xre;function Zre(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(av)}return this.getTranslatedPhrase(sv)},callback(){t.toggleMergeOnSelection()},disabled(){const e=this.getSelectedLast();return e?Zi.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function nn(t,e){EH(t,e),e.add(t)}function Qre(t,e,n){EH(t,e),e.set(t,n)}function EH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xb(t,e,n){return e=Jre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jre(t){var e=eie(t,"string");return typeof e=="symbol"?e:String(e)}function eie(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Hb(t,e,n){var r=TH(t,e,"set");return tie(t,r,n),n}function tie(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Ql(t,e){var n=TH(t,e,"get");return nie(t,n)}function TH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function nie(t,e){return e.get?e.get.call(t):e.value}function Zt(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}_e.getSingleton().register("beforeMergeCells"),_e.getSingleton().register("afterMergeCells"),_e.getSingleton().register("beforeUnmergeCells"),_e.getSingleton().register("afterUnmergeCells");const oh="mergeCells",rie=150,_H=oh;var Qi=new WeakMap,MH=new WeakSet,OH=new WeakSet,AH=new WeakSet,IH=new WeakSet,PH=new WeakSet,xH=new WeakSet,HH=new WeakSet,Db=new WeakSet,DH=new WeakSet,NH=new WeakSet,LH=new WeakSet,$H=new WeakSet,kH=new WeakSet,FH=new WeakSet,WH=new WeakSet,VH=new WeakSet,BH=new WeakSet,UH=new WeakSet,YH=new WeakSet,GH=new WeakSet,zH=new WeakSet,jH=new WeakSet;class iie extends gt{constructor(){super(...arguments),nn(this,jH),nn(this,zH),nn(this,GH),nn(this,YH),nn(this,UH),nn(this,BH),nn(this,VH),nn(this,WH),nn(this,FH),nn(this,kH),nn(this,$H),nn(this,LH),nn(this,NH),nn(this,DH),nn(this,Db),nn(this,HH),nn(this,xH),nn(this,PH),nn(this,IH),nn(this,AH),nn(this,OH),nn(this,MH),xb(this,"mergedCellsCollection",null),xb(this,"autofillCalculations",null),xb(this,"selectionCalculations",null),Qre(this,Qi,{writable:!0,value:null})}static get PLUGIN_KEY(){return oh}static get PLUGIN_PRIORITY(){return rie}isEnabled(){return!!this.hot.getSettings()[oh]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new Bre(this),this.autofillCalculations=new zre(this),this.selectionCalculations=new qre(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Zt(e,MH,oie).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Zt(e,AH,aie).call(e,...r)}),this.addHook("afterModifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Zt(e,GH,Rie).call(e,...r)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Zt(e,IH,lie).call(e,...r)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Zt(e,PH,uie).call(e,...r)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Zt(e,Db,KH).call(e,...r)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Zt(e,Db,KH).call(e,...r)}),this.addHook("beforeSetRangeEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Zt(e,DH,die).call(e,...r)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Zt(e,OH,sie).call(e,...r)}),this.addHook("afterRenderer",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Zt(e,HH,hie).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Zt(e,xH,cie).call(e,...r)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Zt(e,NH,fie).call(e,...r)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Zt(e,LH,gie).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Zt(e,$H,mie).call(e,...r)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Zt(e,kH,pie).call(e,...r)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Zt(e,FH,wie).call(e,...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Zt(e,WH,Cie).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Zt(e,VH,vie).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Zt(e,BH,Sie).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Zt(e,UH,yie).call(e,...r)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Zt(e,YH,bie).call(e,...r)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Zt(e,zH,Eie).call(e,...r)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Zt(e,jH,Tie).call(e,...r)}),this.addHook("beforeUndoStackChange",(n,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){const e=this.hot.getSettings()[oh];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),super.updatePlugin()}ifChromeForceRepaint(){if(!Cw())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(r=>{const{row:i,rowspan:o}=r;for(let s=i+1;s<i+o;s++)n.push(s)}),n=[...new Set(n)],n.forEach(r=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>(o==null?void 0:o.name)==="master"?o:o.clone.wtTable).forEach(o=>{const s=o.getRow(i);s&&(s.style.background=ja(s,"backgroundColor").replace(")",", 0.99)"),e.push(s))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{r.style.background=ja(r,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){let n=!0;return e?(Zi.containsNegativeValues(e)?(At(Zi.NEGATIVE_VALUES_WARNING(e)),n=!1):Zi.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(At(Zi.IS_OUT_OF_BOUNDS_WARNING(e)),n=!1):Zi.isSingleCell(e)?(At(Zi.IS_SINGLE_CELL(e)),n=!1):Zi.containsZeroSpan(e)&&(At(Zi.ZERO_SPAN_WARNING(e)),n=!1),n):!1}generateFromSettings(e){if(Array.isArray(e)){const n=[];if(H(e,r=>{if(!this.validateSetting(r))return;const i=this.hot._createCellCoords(r.row,r.col),o=this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1),s=this.hot._createCellRange(i,i,o);this.mergeRange(s,!0,!0),Ie(r.row,r.row+r.rowspan-1,a=>{Ie(r.col,r.col+r.colspan-1,l=>{a===r.row&&l===r.col||n.push([a,l,null])})})}),n.length===0)return;this.hot.setDataAtCell(n)}}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}toggleMergeOnSelection(){const e=this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.toggleMerge(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:n,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),o=e.getBottomEndCorner(),s={row:i.row,col:i.col,rowspan:o.row-i.row+1,colspan:o.col-i.col+1},a=[];let l=null;return this.canMergeRange(s,n)?(this.hot.runHooks("beforeMergeCells",e,n),Ie(0,s.rowspan-1,c=>{Ie(0,s.colspan-1,d=>{let g=null;a[c]||(a[c]=[]),c===0&&d===0?g=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+c,s.col+d,"hidden",!0),a[c][d]=g})}),this.hot.setCellMeta(s.row,s.col,"spanned",!0),this.mergedCellsCollection.add(s)?(r?l=[s.row,s.col,a]:this.hot.populateFromArray(s.row,s.col,a,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,s,n),l):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCellsCollection.getWithinRange(e);r&&(this.hot.runHooks("beforeUnmergeCells",e,n),H(r,i=>{this.mergedCellsCollection.remove(i.row,i.col),Ie(0,i.rowspan-1,o=>{Ie(0,i.colspan-1,s=>{this.hot.removeCellMeta(i.row+o,i.col+s,"hidden"),this.hot.removeCellMeta(i.row+o,i.col+s,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const n=this.mergedCellsCollection.get(e.from.row,e.from.col);n.row===e.from.row&&n.col===e.from.col&&n.row+n.rowspan-1===e.to.row&&n.col+n.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.mergeRange(this.hot._createCellRange(o,o,s))}unmerge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.unmergeRange(this.hot._createCellRange(o,o,s))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const r=this.hot.getSelectedRangeLast();r&&!r.isSingleHeader()&&(this.toggleMerge(r),this.hot.render())},runOnlyIf:r=>!r.altKey,group:_H})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(_H)}modifyViewportRowStart(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(Ke(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(Ke(s)){const a=s.row+s.rowspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(Ke(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(Ke(s)){const a=s.col+s.colspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,r,i){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot;let a,l;n===0?a=o.getNearestNotHiddenIndex(e,1):a=o.getNearestNotHiddenIndex(e+n-1,-1),i===0?l=s.getNearestNotHiddenIndex(r,1):l=s.getNearestNotHiddenIndex(r+i-1,-1);const u=e>=0?o.getRenderableFromVisualIndex(a):e,c=r>=0?s.getRenderableFromVisualIndex(l):r;return[u,c]}}function oie(){this.generateFromSettings(this.hot.getSettings()[oh]),this.hot.render()}function sie(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast();for(let r=0;r<e.length;r+=1)if(n.from.row===e[r].row&&n.from.col===e[r].col&&n.to.row===e[r].row+e[r].rowspan-1&&n.to.col===e[r].col+e[r].colspan-1)return!1}return t}function aie(t){const e=this.hot.getSelectedRangeLast();let n={row:t.row,col:t.col},r=null;const i=this.hot._createCellCoords(e.highlight.row,e.highlight.col),o=this.mergedCellsCollection.get(i.row,i.col);if(Ql(this,Qi)||Hb(this,Qi,this.hot._createCellCoords(null,null)),o){const a=this.hot._createCellCoords(o.row,o.col),l=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);this.hot._createCellRange(a,a,l).includes(Ql(this,Qi))||Hb(this,Qi,this.hot._createCellCoords(null,null)),n.row=Ql(this,Qi).row?Ql(this,Qi).row-i.row:n.row,n.col=Ql(this,Qi).col?Ql(this,Qi).col-i.col:n.col,t.row>0?n.row=o.row+o.rowspan-1-i.row+t.row:t.row<0&&(n.row=i.row-o.row+t.row),t.col>0?n.col=o.col+o.colspan-1-i.col+t.col:t.col<0&&(n.col=i.col-o.col+t.col)}r=this.hot._createCellCoords(e.highlight.row+n.row,e.highlight.col+n.col);const s=this.mergedCellsCollection.get(r.row,r.col);if(s){const a=this.mergedCellsCollection.getFirstRenderableCoords(s.row,s.col);Hb(this,Qi,r),n={row:a.row-i.row,col:a.col-i.col}}n.row!==0&&(t.row=n.row),n.col!==0&&(t.col=n.col)}function lie(t){const e=this.hot.getSelectedRangeLast(),n=Kn(t),r=this.selectionCalculations.getUpdatedSelectionRange(e,t);let i=Kn(n);const o=this.mergedCellsCollection.getWithinRange(r,!0);do i=Kn(n),this.selectionCalculations.getUpdatedSelectionRange(e,n),H(o,s=>{this.selectionCalculations.snapDelta(n,e,s)});while(n.row!==i.row||n.col!==i.col);t.row=n.row,t.col=n.col}function uie(t,e){if(t<0||e<0)return;const n=this.mergedCellsCollection.get(t,e);if(!n)return;const{row:r,col:i,colspan:o,rowspan:s}=n;return[r,i,r+s-1,i+o-1]}function cie(t){t.items.push({name:"---------"},Zre(this))}function hie(t,e,n){const r=this.mergedCellsCollection.get(e,n),i=Ke(r)?Kn(r):void 0;if(Ke(i)){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot,{row:a,col:l,colspan:u,rowspan:c}=i,[d,g]=this.translateMergedCellToRenderable(a,c,l,u),p=o.getRenderableFromVisualIndex(e),C=s.getRenderableFromVisualIndex(n),E=d-p+1,I=g-C+1;i.row=o.getNearestNotHiddenIndex(i.row,1),i.col=s.getNearestNotHiddenIndex(i.col,1),i.rowspan=Math.min(i.rowspan,E),i.colspan=Math.min(i.colspan,I)}Mb(t,i,e,n)}function KH(t){if(this.mergedCellsCollection.isFirstRenderableMergedCell(t.row,t.col)){const e=this.mergedCellsCollection.get(t.row,t.col);[t.row,t.col]=[e.row,e.col]}}function die(t){const e=this.hot.getSelectedRangeLast();e.highlight=this.hot._createCellCoords(e.highlight.row,e.highlight.col),e.to=t;let n=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{n=!1;for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1){const o=this.mergedCellsCollection.mergedCells[r].getRange();e.expandByRange(o)&&(t.row=e.to.row,t.col=e.to.col,n=!0)}}while(n)}function fie(t,e,n){const r=this.mergedCellsCollection.get(t,e);r&&(r.row!==t||r.col!==e?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}function gie(t){const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function mie(t){const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function pie(t,e){this.autofillCalculations.correctSelectionAreaSize(e);const n=this.autofillCalculations.getDirection(e,t);let r=t;if(this.autofillCalculations.dragAreaOverlapsCollections(e,r,n))return r=e,r;const i=this.mergedCellsCollection.getWithinRange({from:{row:e[0],col:e[1]},to:{row:e[2],col:e[3]}});return i&&(r=this.autofillCalculations.snapDragArea(e,r,n,i)),r}function wie(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function Cie(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function vie(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function Sie(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function yie(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function bie(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(n);H(r,i=>{n.getBottomEndCorner().row===i.getLastRow()&&n.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function Rie(t,e,n){if(!this.enabled)return;const r=this.mergedCellsCollection.get(t.row,t.col);if(!r)return;const i=e>0,o=e<0,s=n<0,a=n>0,l=r.row+r.rowspan-1===this.hot.countRows()-1,u=r.row===0,c=r.col+r.colspan-1===this.hot.countCols()-1,d=r.col===0;(i&&l||o&&u||a&&c||s&&d)&&(t.row=r.row,t.col=r.col)}function Eie(t,e,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,r)}function Tie(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function _ie(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function s(a){const l=t[a],u=e[a],c=i[a],d=o[a],g=u.multiColumnSorting,C=(g.compareFunctionFactory?g.compareFunctionFactory:BA(u.type))(l,u,g)(c,d);if(C===Wi){const E=a+1;if(typeof e[E]<"u")return s(E)}return C}(0)}}function XH(){At(St`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work.`)}const qH="sort";function Mie(t,e,n){const r=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push(`${qH}-${t.getIndexOfColumnInSortQueue(e)+1}`),r}function Oie(t){const e=t.className.split(" "),n=new RegExp(`^${qH}-[0-9]{1,2}$`);return e.filter(r=>n.test(r))}function Aie(t,e,n){return e=Iie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Iie(t){var e=Pie(t,"string");return typeof e=="symbol"?e:String(e)}function Pie(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const zg="multiColumnSorting",xie=170,ZH="columnSorting",QH=zg;VA(zg,_ie);class Hie extends jA{constructor(){super(...arguments),Aie(this,"pluginKey",zg)}static get PLUGIN_KEY(){return zg}static get PLUGIN_PRIORITY(){return xie}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[ZH]&&XH(),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,$f))},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()},group:QH})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(QH)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];super.updateHeaderClasses(e,...r),Ue(e,Oie(e)),this.enabled!==!1&&ce(e,Mie(...r))}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[ZH]&&XH(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,n){qS(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,$f))):this.sort(this.getColumnNextConfig(n.col)))}}function JH(t,e,n){return e=Die(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Die(t){var e=Nie(t,"string");return typeof e=="symbol"?e:String(e)}function Nie(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Lie="multipleSelectionHandles",$ie=160;class kie extends gt{constructor(){super(...arguments),JH(this,"dragged",[]),JH(this,"lastSetCell",null)}static get PLUGIN_KEY(){return Lie}static get PLUGIN_PRIORITY(){return $ie}isEnabled(){return po()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function r(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(i);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",i=>{let o;if(We(i.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1;if(We(i.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",i=>{if(We(i.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(We(i.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",i=>{const{rootDocument:o}=this.hot;let s,a,l,u,c,d;if(e.dragged.length===0)return;const g=o.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!g||g===e.lastSetCell||((g.nodeName==="TD"||g.nodeName==="TH")&&(s=e.hot.getCoords(g),s.col===-1&&(s.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(s),d=e.getCurrentRangeCoords(a,s,e.touchStartRange.direction,c,e.dragged[0]),d.start!==null&&e.hot.selection.setRangeStart(d.start),e.hot.selection.setRangeEnd(d.end),e.lastSetCell=g),i.preventDefault())})}getCurrentRangeCoords(e,n,r,i,o){const s=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(r){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":o==="top"?c={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,s.col)};break;case"SE-NW":o==="bottom"&&(c={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,s.col)});break}break;case"NW-SE":switch(i){case"NE-SW":o==="top"?c={start:n,end:l}:c.end=n;break;case"NW-SE":o==="top"?c={start:n,end:a}:c.end=n;break;case"SE-NW":o==="top"?c={start:n,end:s}:c.end=n;break;case"SW-NE":o==="top"?c={start:n,end:u}:c.end=n;break}break;case"SW-NE":switch(i){case"NW-SE":o==="bottom"?c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(s.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SW-NE":o==="top"?c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)}:c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(s.row,n.col)};break;case"SE-NW":o==="bottom"?c={start:this.hot._createCellCoords(n.row,u.col),end:this.hot._createCellCoords(s.row,n.col)}:o==="top"&&(c={start:l,end:n});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(c.end=n);break;case"SE-NW":o==="top"?c.end=n:c={start:n,end:s};break}break}return c}isDragged(){return this.dragged.length>0}}function Nb(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:r,isCollapsed:o,crossHiddenColumns:i,isHidden:s,isRoot:a,isPlaceholder:l}}function eD(){return{label:"",isPlaceholder:!0}}function Fie(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;H(t,i=>{const o=[];let s=0;n.push(o),H(i,a=>{const l=Nb();if(Ke(a)){const{label:c,colspan:d}=a;l.label=Yt(c),typeof d=="number"&&d>1&&(l.colspan=d,l.origColspan=d)}else l.label=Yt(a);s+=l.origColspan;let u=!1;if(s>=e&&(l.colspan=l.origColspan-(s-e),l.origColspan=l.colspan,u=!0),o.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)o.push(eD());return!u})});const r=Math.max(...qe(n,i=>i.length));return H(n,i=>{if(i.length<r){const o=qe(new Array(r-i.length),()=>Nb());i.splice(i.length,0,...o)}}),n}function Lb(t,e,n){Wie(t,e),e.set(t,n)}function Wie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Si(t,e){var n=tD(t,e,"get");return Vie(t,n)}function Vie(t,e){return e.get?e.get.call(t):e.value}function sh(t,e,n){var r=tD(t,e,"set");return Bie(t,r,n),n}function tD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Bie(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const nD=["label","collapsible"];var Uo=new WeakMap,Ia=new WeakMap,$b=new WeakMap;class Uie{constructor(){Lb(this,Uo,{writable:!0,value:[]}),Lb(this,Ia,{writable:!0,value:0}),Lb(this,$b,{writable:!0,value:1/0})}setColumnsLimit(e){sh(this,$b,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];sh(this,Uo,Fie(e,Si(this,$b))),sh(this,Ia,Si(this,Uo).length)}getData(){return Si(this,Uo)}mergeWith(e){H(e,n=>{let{row:r,col:i,...o}=n;const s=this.getHeaderSettings(r,i);s!==null&&an(s,o,nD)})}map(e){H(Si(this,Uo),n=>{H(n,r=>{const i=e({...r});Ke(i)&&an(r,i,nD)})})}getHeaderSettings(e,n){var r;if(e>=Si(this,Ia)||e<0)return null;const i=Si(this,Uo)[e];return n>=i.length?null:(r=i[n])!==null&&r!==void 0?r:null}getHeadersSettings(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=Si(this,Ia)||e<0)return i;const o=Si(this,Uo)[e];let s=0;for(let a=n;a<o.length;a++){const l=o[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),s===r)break;if(s>r)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return Si(this,Ia)}getColumnsCount(){return Si(this,Ia)>0?Si(this,Uo)[0].length:0}clear(){sh(this,Uo,[]),sh(this,Ia,0)}}function kb(t,e,n){return e=Yie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yie(t){var e=Gie(t,"string");return typeof e=="symbol"?e:String(e)}function Gie(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const rD="DF-pre-order";function iD(t,e){let n=t.call(e,this);for(let r=0;r<this.childs.length;r++){if(n===!1)return!1;n=iD.call(this.childs[r],t,e)}return n}const zie="DF-post-order";function oD(t,e){for(let n=0;n<this.childs.length;n++)if(oD.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const sD="BF";function jie(t,e){const n=[this];function r(){if(n.length===0)return;const i=n.shift();n.push(...i.childs),t.call(e,i)!==!1&&r()}r()}const Kie=sD,aD=new Map([[rD,iD],[zie,oD],[sD,jie]]);class jg{constructor(e){kb(this,"data",{}),kb(this,"parent",null),kb(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new jg({...e.data});for(let r=0;r<e.childs.length;r++)n.addChild(this.cloneTree(e.childs[r]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Kie;if(!aD.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);aD.get(n).call(this,e,this)}walkUp(e){const n=this,r=i=>{e.call(n,i)!==!1&&i.parent!==null&&r(i.parent)};r(this)}}function Fb(t,e,n){Xie(t,e),e.set(t,n)}function Xie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ir(t,e){var n=lD(t,e,"get");return qie(t,n)}function qie(t,e){return e.get?e.get.call(t):e.value}function Zie(t,e,n){var r=lD(t,e,"set");return Qie(t,r,n),n}function lD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Qie(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Jl=new WeakMap,Pa=new WeakMap,eu=new WeakMap;class Jie{constructor(e){Fb(this,Jl,{writable:!0,value:new Map}),Fb(this,Pa,{writable:!0,value:new Map}),Fb(this,eu,{writable:!0,value:null}),Zie(this,eu,e)}getRoots(){return Array.from(ir(this,Jl).values())}getRootByColumn(e){let n;return ir(this,Pa).has(e)&&(n=ir(this,Jl).get(ir(this,Pa).get(e))),n}getNode(e,n){const r=this.getRootByColumn(n);if(!r)return;const i=n-ir(this,Pa).get(n);let o=0,s;return r.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(i>=o&&i<=o+l-1)return s=a,s.data.isRoot=n===s.data.columnIndex,!1;o+=l}}),s}rebuildTreeIndex(){let e=0;ir(this,Pa).clear(),H(ir(this,Jl),n=>{let[,{data:{colspan:r}}]=n;for(let i=e;i<e+r;i++)ir(this,Pa).set(i,e);e+=r})}buildTree(){this.clear();const e=ir(this,eu).getColumnsCount();let n=0;for(;n<e;){const r=ir(this,eu).getHeaderSettings(0,n),i=new jg;ir(this,Jl).set(n,i),this.buildLeaves(i,n,0,r.origColspan),n+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=ir(this,eu).getHeadersSettings(r,n,i);r+=1,H(o,s=>{const a={...s,headerLevel:r-1,columnIndex:n};let l;r===1?(e.data=a,l=e):(l=new jg(a),e.addChild(l)),r<ir(this,eu).getLayersCount()&&this.buildLeaves(l,n,r,s.origColspan),n+=s.origColspan})}clear(){ir(this,Jl).clear(),ir(this,Pa).clear()}}function uD(t,e){t.walkDown(n=>{let{data:r,childs:i}=n;if(!r.isHidden&&(e(r.columnIndex),i.length===0))for(let o=1;o<r.colspan;o++)e(r.columnIndex+o)})}function Kg(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function Xg(t){return Kg(t,"origColspan")===t.data.origColspan}function Wb(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(Xg(t))return Wb(n[0]);e.isCollapsed=!1;const i=n.slice(1),o=new Set;let s=0;if(i.length>0)H(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;s+=l.colspan,uD(a,u=>{o.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;s=l-a;for(let c=1;c<l;c++)o.add(u+c)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=s,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):Xg(a)&&(l.isCollapsed=Kg(a,"isCollapsed"))}),{rollbackModification:()=>Vb(t),affectedColumns:Array.from(o),colspanCompensation:s}}function Vb(t){var e;const{data:n,childs:r}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(Xg(t))return Vb(r[0]);n.isCollapsed=!0;const o=r.slice(1),s=new Set;if(o.length>0)H(o,l=>{uD(l,u=>{s.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=n;for(let c=1;c<l;c++){const d=u+c;s.add(d)}}const a=n.colspan-((e=Kg(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):Xg(l)&&(u.isCollapsed=Kg(l,"isCollapsed"))}),{rollbackModification:()=>Wb(t),affectedColumns:Array.from(s),colspanCompensation:a}}function eoe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(St`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}function toe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(St`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}const cD=new Map([["collapse",Vb],["expand",Wb],["hide-column",eoe],["show-column",toe]]);function noe(t,e,n){if(!cD.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return cD.get(t)(e,n)}function qg(t){const e=[];return H(t,n=>{n.walkDown(r=>{const i=r.data,{origColspan:o,columnIndex:s,headerLevel:a,crossHiddenColumns:l}=i,u=ioe(e,a);let c=!1;for(let d=s;d<s+o;d++)if(l.includes(d)||c)u.push(eD());else{const p=roe(i);p.isRoot=!0,u.push(p),c=!0}})}),e}function roe(t){const{crossHiddenColumns:e,...n}=Nb(t);return n}function ioe(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function Bb(t,e,n){ooe(t,e),e.set(t,n)}function ooe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ah(t,e,n){var r=hD(t,e,"set");return soe(t,r,n),n}function soe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Qt(t,e){var n=hD(t,e,"get");return aoe(t,n)}function hD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function aoe(t,e){return e.get?e.get.call(t):e.value}var Ji=new WeakMap,pr=new WeakMap,xa=new WeakMap;class loe{constructor(){Bb(this,Ji,{writable:!0,value:new Uie}),Bb(this,pr,{writable:!0,value:new Jie(Qt(this,Ji))}),Bb(this,xa,{writable:!0,value:[[]]})}setState(e){Qt(this,Ji).setData(e);let n=!1;try{Qt(this,pr).buildTree()}catch{Qt(this,pr).clear(),Qt(this,Ji).clear(),n=!0}return ah(this,xa,qg(Qt(this,pr).getRoots())),n}setColumnsLimit(e){Qt(this,Ji).setColumnsLimit(e)}mergeStateWith(e){const n=qe(e,r=>{let{row:i,...o}=r;return{row:i<0?this.rowCoordsToLevel(i):i,...o}});Qt(this,Ji).mergeWith(n),Qt(this,pr).buildTree(),ah(this,xa,qg(Qt(this,pr).getRoots()))}mapState(e){Qt(this,Ji).map(e),Qt(this,pr).buildTree(),ah(this,xa,qg(Qt(this,pr).getRoots()))}mapNodes(e){return en(Qt(this,pr).getRoots(),(n,r)=>(r.walkDown(i=>{const o=e(i.data);o!==void 0&&n.push(o)}),n),[])}triggerNodeModification(e,n,r){n<0&&(n=this.rowCoordsToLevel(n));const i=Qt(this,pr).getNode(n,r);let o;return i&&(o=noe(e,i,r),ah(this,xa,qg(Qt(this,pr).getRoots()))),o}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var r,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(i=Qt(this,xa)[e])===null||i===void 0?void 0:i[n])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,n){const r=this.getHeaderTreeNode(e,n);return r?{...r.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const r=Qt(this,pr).getNode(e,n);return r||null}findTopMostEntireHeaderLevel(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const i=r-e+1;let o=!1,s=null;for(let a=e;a<=r;a++){const l=Qt(this,pr).getRootByColumn(a);if(!l)break;o=!0,l.walkDown(u=>{const{columnIndex:c,headerLevel:d,origColspan:g,isHidden:p}=u.data;p||g<=i&&c>=e&&c+g-1<=r&&(s===null||d<s)&&(s=d)},rD)}return o&&s===null?-1:this.levelToRowCoords((n=s)!==null&&n!==void 0?n:0)}findLeftMostColumnIndex(e,n){var r;const{isRoot:i}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0};if(i)return n;let o=n-1;for(;o>=0;){var s;const{isRoot:a}=(s=this.getHeaderSettings(e,o))!==null&&s!==void 0?s:{isRoot:!0};if(a)break;o-=1}return o}findRightMostColumnIndex(e,n){var r;const{isRoot:i,origColspan:o}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0,origColspan:1};if(i)return n+o-1;let s=n+1;for(;s<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,s))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;s+=1}return s-1}getLayersCount(){return Qt(this,Ji).getLayersCount()}getColumnsCount(){return Qt(this,Ji).getColumnsCount()}clear(){ah(this,xa,[]),Qt(this,Ji).clear(),Qt(this,pr).clear()}}function lh(t,e,n){return e=uoe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uoe(t){var e=coe(t,"string");return typeof e=="symbol"?e:String(e)}function coe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hoe{constructor(e,n){lh(this,"hot",void 0),lh(this,"nestedHeaderSettingsGetter",void 0),lh(this,"layersCount",0),lh(this,"container",void 0),lh(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const e=this.container.querySelectorAll("tr:last-of-type th"),n=e.length;this.widthsMap.clear();for(let r=0;r<n;r++){const i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),o=this.hot.toPhysicalColumn(i);this.widthsMap.setValueAtIndex(o,e[r].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:r}=this.hot,i=n.createDocumentFragment(),o=n.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,a=r.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=n.createElement("tr");for(let c=0;c<a;c++){let d=r.getVisualFromRenderableIndex(c);d===null&&(d=c);const g=n.createElement("th"),p=this.nestedHeaderSettingsGetter(l,d);if(p&&(!p.isPlaceholder||p.isHidden)){let C=p.label;s&&(C+='<button class="changeType"></button>'),Ys(g,C),g.colSpan=p.colspan,u.appendChild(g)}}o.appendChild(u)}i.appendChild(o),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}const doe=hoe;function Rn(t,e){fD(t,e),e.add(t)}function dD(t,e,n){return e=foe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function foe(t){var e=goe(t,"string");return typeof e=="symbol"?e:String(e)}function goe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Zg(t,e,n){fD(t,e),e.set(t,n)}function fD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ha(t,e,n){var r=gD(t,e,"set");return moe(t,r,n),n}function moe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function ct(t,e){var n=gD(t,e,"get");return poe(t,n)}function gD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function poe(t,e){return e.get?e.get.call(t):e.value}function mn(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const mD="nestedHeaders",woe=280;var bt=new WeakMap,Ps=new WeakMap,uh=new WeakMap,Qg=new WeakMap,Jg=new WeakSet,pD=new WeakSet,wD=new WeakSet,CD=new WeakSet,vD=new WeakSet,SD=new WeakSet,yD=new WeakSet,bD=new WeakSet,RD=new WeakSet,ED=new WeakSet,TD=new WeakSet,_D=new WeakSet,MD=new WeakSet,OD=new WeakSet,AD=new WeakSet,ID=new WeakSet,PD=new WeakSet,xD=new WeakSet;class Coe extends gt{constructor(){super(...arguments),Rn(this,xD),Rn(this,PD),Rn(this,ID),Rn(this,AD),Rn(this,OD),Rn(this,MD),Rn(this,_D),Rn(this,TD),Rn(this,ED),Rn(this,RD),Rn(this,bD),Rn(this,yD),Rn(this,SD),Rn(this,vD),Rn(this,CD),Rn(this,wD),Rn(this,pD),Rn(this,Jg),Zg(this,bt,{writable:!0,value:new loe}),Zg(this,Ps,{writable:!0,value:null}),Zg(this,uh,{writable:!0,value:null}),Zg(this,Qg,{writable:!0,value:!1}),dD(this,"ghostTable",new doe(this.hot,(e,n)=>this.getHeaderSettings(e,n))),dD(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return mD}static get PLUGIN_PRIORITY(){return woe}isEnabled(){return!!this.hot.getSettings()[mD]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&At(St`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>mn(this,PD,Doe).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return mn(e,xD,Noe).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return mn(e,vD,boe).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return mn(e,SD,Roe).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return mn(e,yD,Eoe).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return mn(e,bD,Toe).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return mn(e,RD,_oe).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return mn(e,ED,Moe).call(e,...i)}),this.addHook("afterSelection",()=>mn(this,Jg,Ub).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return mn(e,pD,voe).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",r=>mn(this,_D,Aoe).call(this,r)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return mn(e,OD,Poe).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return mn(e,AD,xoe).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return mn(e,wD,Soe).call(e,...i)}),this.addHook("beforeCopy",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return mn(e,CD,yoe).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return mn(e,TD,Ooe).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return mn(e,MD,Ioe).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return mn(e,ID,Hoe).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>mn(this,Jg,Ub).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>mn(this,Jg,Ub).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();ct(this,bt).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=ct(this,bt).setState(e)),this.detectedOverlappedHeaders&&At(St`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,r)=>{const i=n===!0?"hide-column":"show-column";ct(this,bt).triggerColumnModification(i,r)}),!ct(this,Ps)&&this.enabled&&Ha(this,Ps,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(r=>{let{op:i,index:o,newValue:s}=r;if(i==="replace"){const a=s===!0?"hide-column":"show-column";ct(this,bt).triggerColumnModification(a,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),ct(this,bt).clear(),ct(this,Ps).unsubscribe(),Ha(this,Ps,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return ct(this,bt)}getLayersCount(){return ct(this,bt).getLayersCount()}getHeaderSettings(e,n){return ct(this,bt).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let s=0;s<n;s++){const a=r.childNodes[s];if(!a)break;const l=i.childNodes[s],u=o?o.childNodes[s]:null;for(let c=0,d=a.childNodes.length;c<d;c++)a.childNodes[c].removeAttribute("colspan"),Ue(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),Ue(l.childNodes[c],"hiddenHeader")),o&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),Ue(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const r=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,o)=>{var s;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(i);u===null&&(u=i),o.removeAttribute("colspan"),Ue(o,"hiddenHeader");const{colspan:c,isHidden:d,isPlaceholder:g}=(s=ct(this,bt).getHeaderSettings(e,u))!==null&&s!==void 0?s:{label:""};if(g||d)ce(o,"hiddenHeader");else if(c>1){var p,C;const{wtOverlays:E}=l._wt,I=(p=E.topInlineStartCornerOverlay)===null||p===void 0?void 0:p.clone.wtTable.THEAD.contains(o),M=(C=E.inlineStartOverlay)===null||C===void 0?void 0:C.clone.wtTable.THEAD.contains(o),y=I||M?Math.min(c,r-i):c;y>1&&o.setAttribute("colspan",y)}this.hot.view.appendColHeader(u,o,function(){return n.getColumnHeaderValue(...arguments)},e)}}getColumnHeaderValue(e,n){var r;const{isHidden:i,isPlaceholder:o}=(r=ct(this,bt).getHeaderSettings(n,e))!==null&&r!==void 0?r:{};return o||i?"":this.hot.getColHeader(e,n)}destroy(){Ha(this,bt,null),ct(this,Ps)!==null&&(ct(this,Ps).unsubscribe(),Ha(this,Ps,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return ct(this,bt).getHeaderTreeNodeData(e.row,e.col)}}function Ub(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:n}=e;if(n.isHeader()&&n.col>=0){const i=ct(this,bt).findLeftMostColumnIndex(n.row,n.col),o=this.hot.selection.highlight.getFocus();o.visualCellRange.highlight.col=i,o.visualCellRange.from.col=i,o.visualCellRange.to.col=i,o.commit()}}function voe(t){const e=this.hot.getSelectedRangeLast();if(!e)return t;const{highlight:n}=e;if(!(n.isHeader()&&n.col>=0))return t;const i=this.hot.view.getFirstFullyVisibleColumn(),o=this.hot.view.getLastFullyVisibleColumn(),s=ct(this,bt).findLeftMostColumnIndex(n.row,n.col),a=ct(this,bt).findRightMostColumnIndex(n.row,n.col);return s<i&&a>o?t:s<i?s:a}function Soe(t,e,n){const r=ct(this,bt).getHeaderTreeNodeData(e,t);if(!r)return t;const{columnCursor:i,selectionType:o,selectionWidth:s}=n,{isRoot:a,colspan:l}=ct(this,bt).getHeaderSettings(e,t);if(o===hC){if(!a)return r.columnIndex}else if(o===Q_&&(l>s-i||!a))return null;return t}function yoe(t,e,n){let{columnHeadersCount:r}=n;if(r!==0)for(let o=0;o<e.length;o++){const{startRow:s,startCol:a,endRow:l,endCol:u}=e[o],c=l-s+1,d=a-u+1;if(s>=0||d===1)break;for(let g=a;g<=u;g++)for(let p=s;p<=l;p++){var i;const C=c+p,E=g-a;if(E===0)continue;((i=ct(this,bt).getHeaderTreeNodeData(p,g))===null||i===void 0?void 0:i.isRoot)===!1&&(t[C][E]="")}}}function boe(t,e,n,r){this._getHeaderTreeNodeDataByCoords(e)&&(r.column=!0)}function Roe(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;Ha(this,uh,e.clone()),Ha(this,Qg,!0);const{selection:r}=this.hot,i=r.isSelected()?r.getSelectedRange().current():null,o=[],{columnIndex:s,origColspan:a}=n,l=!r.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?o.push(i.getTopEndCorner().col,s,e.row):e.col>i.from.col?o.push(i.getTopStartCorner().col,s+a-1,e.row):o.push(s,s+a-1,e.row):(bd(t)||is(t)&&l)&&o.push(s,s+a-1,e.row),r.selectColumns(...o)}function Eoe(t,e,n,r){if(!this.hot.view.isMouseDown())return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:o,origColspan:s}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;r.column=!0,r.cell=!0;const d=[],g=ar(e.row,-1/0,-1);e.col<c.col?d.push(u.col,o,g):e.col>c.col?d.push(l.col,o+s-1,g):d.push(o,o+s-1,g),this.hot.selection.selectColumns(...d)}function Toe(){Ha(this,Qg,!1)}function _oe(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!ct(this,Qg)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,r=e.getBottomEndCorner().col,{columnIndex:i,origColspan:o}=ct(this,bt).getHeaderTreeNodeData(ct(this,uh).row,ct(this,uh).col);if(e.setHighlight(ct(this,uh)),o>e.getWidth()||i<n||i+o-1>r){const s=ct(this,bt).findTopMostEntireHeaderLevel(ar(n,i,i+o-1),ar(r,i,i+o-1));e.highlight.row=s,e.highlight.col=e.from.col}}function Moe(t){const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const i=ct(this,bt).findLeftMostColumnIndex(n.row,n.col),o=ct(this,bt).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const s=e.col>=i&&e.col<=o?i-1:o,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const s=e.col>=i&&e.col<=o?o+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function Ooe(t,e){const n=t.row,r=this._getHeaderTreeNodeDataByCoords({row:n,col:t.col}),i=this._getHeaderTreeNodeDataByCoords({row:n,col:e.col});e.col<t.col?(r&&(t.col=r.columnIndex+r.origColspan-1),i&&(e.col=i.columnIndex)):e.col>=t.col&&(r&&(t.col=r.columnIndex),i&&(e.col=i.columnIndex+i.origColspan-1))}function Aoe(t){t.length=0;for(let e=0;e<ct(this,bt).getLayersCount();e++)t.push(this.headerRendererFactory(e))}function Ioe(t){const e=ct(this,bt).getLayersCount();let n=t.startColumn,r=!!e;for(let i=0;i<e;i++){const o=ct(this,bt).findLeftMostColumnIndex(i,t.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(r=!1),Xn(s)&&s<t.startColumn){n=s;break}}t.startColumn=r?ct(this,bt).getHeaderTreeNodeData(0,n).columnIndex:n}function Poe(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function xoe(t,e,n){var r;const{label:i}=(r=ct(this,bt).getHeaderTreeNodeData(n,e))!==null&&r!==void 0?r:{label:""};return i}function Hoe(t,e){if(t<0)return this.hot.getCell(t,ct(this,bt).findLeftMostColumnIndex(t,e),!0)}function Doe(){this.updatePlugin()}function Noe(t,e){e||this.updatePlugin()}function ch(t,e,n){return e=Loe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Loe(t){var e=$oe(t,"string");return typeof e=="symbol"?e:String(e)}function $oe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class koe{constructor(e,n){ch(this,"hot",void 0),ch(this,"data",null),ch(this,"plugin",void 0),ch(this,"parentReference",new WeakMap),ch(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Ie(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,r){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&H(e.__children,i=>{this.cacheNode(i,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,r,i){let o=!1,s=n;if(isNaN(s)&&s.end)return s;let a=e;return a||(a={__children:this.data},o=!0,s-=1),r!=null&&s===r?{result:a,end:!0}:i!=null&&a===i?{result:s,end:!0}:(s+=1,a.__children&&H(a.__children,l=>{if(this.parentReference.set(l,o?null:a),s=this.readTreeNodes(l,s,r,i),isNaN(s)&&s.end)return!1}),s)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return Ze(this.data[0],(n,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const r=this.getRowParent(e);return r==null?this.data.indexOf(n):r.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:(H(r.__children,i=>{n+=1,i.__children&&(n+=this.countChildren(i))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var r;return((r=e.__children)===null||r===void 0?void 0:r[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((n=r.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let r=n;this.hot.runHooks("beforeAddChild",e,r);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),r||(r=this.mockNode()),o.__children.push(r),this.rewriteCache();const s=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,n,r){let i=r,o;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,n),e){const a=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),o=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[n]);i=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,i,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const r=this.translateTrimmedRow(e),i=this.getRowParent(r),o=this.getRowIndexWithinParent(r);switch(n){case"below":this.addChildAtIndex(i,o+1,null);break;case"above":this.addChildAtIndex(i,o,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null;const i=[];Array.isArray(e)?(Ie(e[0],e[2],g=>{const p=this.translateTrimmedRow(g);i.push(this.getDataObject(p))}),Ie(0,i.length-2,g=>{this.detachFromParent(i[g],!1)}),r=i[i.length-1]):r=e;const o=this.getRowIndex(r),s=this.countChildren(r),a=this.getRowIndexWithinParent(r),l=this.getRowParent(r),u=this.getRowParent(l),c=this.getRowIndex(u);let d=null;if(this.hot.runHooks("beforeDetachChild",l,r),a!=null){const g=Array.from(new Array(o+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",o,s+1,g,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,s+1,g,this.plugin.pluginName),u){d=c+this.countChildren(u);const p=this.getChild(u,this.countChildren(u)-1),C=this.getRowIndex(p);this.hot.runHooks("beforeCreateRow",C+1,s+1,this.plugin.pluginName),u.__children.push(r)}else d=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",d-2,s+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",d-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,r,this.getRowIndex(r)),n&&this.hot.render()}filterData(e,n,r){const i=[];H(r,o=>{i.push(this.getDataObject(o))}),H(i,o=>{const s=this.getRowIndexWithinParent(o),a=this.getRowParent(o);a===null?this.data.splice(s,1):a.__children.splice(s,1)}),this.rewriteCache()}spliceData(e,n,r){const i=this.getDataObject(e-1);let o=null,s=e;i&&i.__children&&i.__children.length===0?(o=i,s=0):e<this.countAllRows()&&(o=this.getRowParent(e),s=this.getRowIndexWithinParent(e)),o?r?o.__children.splice(s,n,...r):o.__children.splice(s,n):r?this.data.splice(s,n,...r):this.data.splice(s,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,r=null;do r=this.getRowParent(r),r!==null&&(n=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,r,i){const o=n===this.hot.countRows(),s=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=s.__children.slice(a,a+1),u=e>n;let c=o?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);const d=o||r||i?c.__children.length:this.getRowIndexWithinParent(n),g=s===c;c.__children.splice(d,0,l[0]),s.__children.splice(a+(u&&g?1:0),1),this.syncRowWithRawSource(s),g||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}const Foe=koe;function HD(t,e,n){return e=Woe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Woe(t){var e=Voe(t,"string");return typeof e=="symbol"?e:String(e)}function Voe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Boe{constructor(e,n){HD(this,"hot",void 0),HD(this,"plugin",void 0),this.hot=n,this.plugin=e}}const Yb=Boe;class Yo extends Yb{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const r=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(r),o=this.dataManager.getDataObject(r),s=n.getElementsByTagName("DIV")[0],a=s.querySelector("span.rowHeader"),l=s.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(H(l,c=>{c&&s.removeChild(c)}),ce(n,Yo.CSS_CLASSES.indicatorContainer),i){const{rootDocument:c}=this.hot,d=a.cloneNode(!0);s.innerHTML="",Ie(0,i-1,()=>{const g=c.createElement("SPAN");ce(g,Yo.CSS_CLASSES.emptyIndicator),s.appendChild(g)}),s.appendChild(d)}if(this.dataManager.hasChildren(o)){const c=this.hot.rootDocument.createElement("DIV");u&&Le(c,[co()]),ce(n,Yo.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?(ce(c,`${Yo.CSS_CLASSES.button} ${Yo.CSS_CLASSES.expandButton}`),u&&Le(n,[Dr(!1)])):(ce(c,`${Yo.CSS_CLASSES.button} ${Yo.CSS_CLASSES.collapseButton}`),u&&Le(n,[Dr(!0)])),s.appendChild(c)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*n+25),this.hot.render()}}const DD=Yo;class Uoe extends Yb{constructor(e,n){var r;super(e,n),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,i)},shiftStash:function(i,o){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),H(r.lastCollapsedRows,(a,l)=>{a>=i&&a<o&&(r.lastCollapsedRows[l]=a+s)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,i),r.lastCollapsedRows=void 0},trimStash:(i,o)=>{Ie(i,i+o-1,s=>{const a=this.lastCollapsedRows.indexOf(s);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),s=e),this.dataManager.hasChildren(o)&&H(o.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),r&&this.trimRows(a),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(s)===-1&&this.collapsedRows.push(s),a}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];H(e,o=>{i.push(...this.collapseChildren(o,!1,!1))}),r&&this.trimRows(i),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return H(e,o=>{i.push(o),n&&this.collapseChildRows(o,i)}),r&&this.trimRows(i),i}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);H(i.__children,o=>{const s=this.dataManager.getRowIndex(o);n.push(s),this.collapseChildRows(s,n)})}r&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return H(e,o=>{i.push(o),n&&this.expandChildRows(o,i)}),r&&this.untrimRows(i),i}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);H(i.__children,o=>{if(!this.isAnyParentCollapsed(o)){const s=this.dataManager.getRowIndex(o);n.push(s),this.expandChildRows(s,n)}})}r&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),s=e),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(o)&&H(o.__children,l=>{const u=this.dataManager.getRowIndex(l);i.push(u)}),a=this.expandRows(i,!0,!1),r&&this.untrimRows(a),n&&this.renderAndAdjust(),a}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];H(e,o=>{i.push(...this.expandChildren(o,!1,!1))}),r&&this.untrimRows(i),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];H(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];H(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{H(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{H(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&H(n.__children,i=>{const o=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return r=!1,!1}),r}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const r=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const r=this.translateTrimmedRow(n.row);We(e.target,DD.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),Lr(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}const Yoe=Uoe;function Goe(t,e,n){zoe(t,e),e.set(t,n)}function zoe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function joe(t,e,n){return e=Koe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Koe(t){var e=Xoe(t,"string");return typeof e=="symbol"?e:String(e)}function Xoe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qoe(t,e){var n=Zoe(t,e,"get");return Qoe(t,n)}function Zoe(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Qoe(t,e){return e.get?e.get.call(t):e.value}var ND=new WeakMap;class Joe extends Yb{constructor(){super(...arguments),joe(this,"dataManager",this.plugin.dataManager),Goe(this,ND,{writable:!0,value:{row_above:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"below")}}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase(_v)},callback:()=>{const r=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(r);this.dataManager.addChild(i)},disabled:()=>{const r=this.hot.getSelectedLast();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(Mv)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const r=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(i)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return Ie(0,e.items.length-1,r=>{if(r===0)return H(n,(i,o)=>{e.items.splice(r+o,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return Ie(0,e.items.length-1,n=>{const r=qoe(this,ND)[e.items[n].key];r!=null&&(e.items[n].callback=r)}),e}}const ese=Joe;function em(t,e,n){return e=tse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tse(t){var e=nse(t,"string");return typeof e=="symbol"?e:String(e)}function nse(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rse{constructor(e){em(this,"plugin",void 0),em(this,"hot",void 0),em(this,"dataManager",void 0),em(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,r,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:r,movePossible:i}))return!1;this.movedToCollapsed=!1;const s=r===this.hot.countRows(),a=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let l=!0;const u=e.map(C=>{if(!l)return!1;const E=this.dataManager.translateTrimmedRow(C);return l=this.shouldAllowMoving(E,a),E}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const d=this.getBaseParent(u),g=this.getTargetParent(s,a),p=d===g;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(g),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,p),this.moveRows(u,a,g),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,r,i,i&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:r,dropIndex:i,movePossible:o}=e;let s=!1;return Mt(i)&&(At(St`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,r,i,o,!1),s=!0),s}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let r=this.dataManager.getRowParent(e?n-1:n);return r==null&&(r=this.dataManager.getRowParent(n-1)),r}shiftCollapsibleParentsLocations(e,n,r){r||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,r){const i=n===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,n,this.movedToCollapsed,i)})})}moveCellsMeta(e,n){const r=[],i=Math.max(...e)<n;e.forEach(o=>{r.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(i?r.length:0),0,...r)}selectCells(e,n){const r=e.length;let i=0,o=0,s=null,a=null;if(this.movedToCollapsed){let l=null;e[r-1]<n?l=this.dataManager.translateTrimmedRow(n-r):l=this.dataManager.translateTrimmedRow(n);const u=this.dataManager.getRowParent(l===null?this.hot.countSourceRows()-1:l-1),c=this.dataManager.getRowIndex(u);i=this.dataManager.untranslateTrimmedRow(c),o=i}else e[r-1]<n?(o=n-1,i=o-r+1):(i=n,o=i+r-1);s=this.hot.selection,a=this.hot.countCols()-1,s.setRangeStart(this.hot._createCellCoords(i,0)),s.setRangeEnd(this.hot._createCellCoords(o,a),!0)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}}function Yn(t,e){$D(t,e),e.add(t)}function LD(t,e,n){$D(t,e),e.set(t,n)}function $D(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gb(t,e,n){return e=ise(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ise(t){var e=ose(t,"string");return typeof e=="symbol"?e:String(e)}function ose(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tm(t,e){var n=kD(t,e,"get");return sse(t,n)}function sse(t,e){return e.get?e.get.call(t):e.value}function nm(t,e,n){var r=kD(t,e,"set");return ase(t,r,n),n}function kD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function ase(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function An(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const rm="nestedRows",lse=300,FD=rm,use="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var im=new WeakMap,tu=new WeakMap,WD=new WeakSet,VD=new WeakSet,BD=new WeakSet,UD=new WeakSet,YD=new WeakSet,GD=new WeakSet,zD=new WeakSet,jD=new WeakSet,KD=new WeakSet,XD=new WeakSet,qD=new WeakSet,ZD=new WeakSet,QD=new WeakSet,JD=new WeakSet,eN=new WeakSet,zb=new WeakSet;class cse extends gt{constructor(){super(...arguments),Yn(this,zb),Yn(this,eN),Yn(this,JD),Yn(this,QD),Yn(this,ZD),Yn(this,qD),Yn(this,XD),Yn(this,KD),Yn(this,jD),Yn(this,zD),Yn(this,GD),Yn(this,YD),Yn(this,UD),Yn(this,BD),Yn(this,VD),Yn(this,WD),Gb(this,"dataManager",null),Gb(this,"headersUI",null),Gb(this,"collapsedRowsMap",null),LD(this,im,{writable:!0,value:!1}),LD(this,tu,{writable:!0,value:!1})}static get PLUGIN_KEY(){return rm}static get PLUGIN_PRIORITY(){return lse}isEnabled(){return!!this.hot.getSettings()[rm]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new ec),this.dataManager=new Foe(this,this.hot),this.collapsingUI=new Yoe(this,this.hot),this.headersUI=new DD(this,this.hot),this.contextMenuUI=new ese(this,this.hot),this.rowMoveController=new rse(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return An(e,JD,Ese).call(e,...r)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return An(e,eN,Tse).call(e,...r)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return An(e,BD,fse).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return An(e,UD,gse).call(e,...r)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return An(e,YD,mse).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return An(e,VD,dse).call(e,...r)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return An(e,jD,Cse).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return An(e,zD,wse).call(e,...r)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return An(e,KD,vse).call(e,...r)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return An(e,XD,Sse).call(e,...r)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return An(e,qD,yse).call(e,...r)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return An(e,ZD,bse).call(e,...r)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return An(e,GD,pse).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return An(e,QD,Rse).call(e,...r)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return An(e,WD,hse).call(e,...r)}),this.addHook("beforeLoadData",n=>An(this,zb,tN).call(this,n)),this.addHook("beforeUpdateData",n=>An(this,zb,tN).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();if(e.col===-1&&e.row>=0){const n=this.collapsingUI.translateTrimmedRow(e.row);this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n)}},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()},group:FD})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(FD)}disableCoreAPIModifiers(){nm(this,tu,!0)}enableCoreAPIModifiers(){nm(this,tu,!1)}onModifyRowData(e){if(!tm(this,tu))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!tm(this,tu))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,r){return tm(this,tu)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,r),!1)}destroy(){super.destroy()}}function hse(t,e,n,r){return this.rowMoveController.onBeforeRowMove(t,e,n,r)}function dse(t,e,n){this.collapsingUI.toggleState(t,e,n)}function fse(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),nm(this,im,!0),this.dataManager.getData().slice()}function gse(t){return this.contextMenuUI.appendOptions(t)}function mse(t,e){this.headersUI.appendLevelIndicators(t,e)}function pse(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function wse(t,e,n,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{nm(this,im,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function Cse(t,e,n){const r=Array.from(n.reduce((i,o)=>{if(this.dataManager.isParent(o)){const s=this.dataManager.getDataObject(o).__children;return i.add(o),Array.isArray(s)&&s.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(o)},new Set));n.length=0,n.push(...r)}function vse(){this.collapsingUI.collapsedRowsStash.stash()}function Sse(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function yse(){this.collapsingUI.collapsedRowsStash.stash()}function bse(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Rse(){this.dataManager.rewriteCache()}function Ese(){this.headersUI.updateRowHeaderWidth()}function Tse(t,e){tm(this,im)&&(e.skipRender=!0)}function tN(t){if(!bM(t)){Ew(use),this.hot.getSettings()[rm]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function jb(t,e,n){return e=_se(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _se(t){var e=Mse(t,"string");return typeof e=="symbol"?e:String(e)}function Mse(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ose{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;jb(this,"rootWindow",void 0),jb(this,"prefix",void 0),jb(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const r=typeof e>"u"?n:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){H(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}const Ase=Ose;function Ise(t,e,n){return e=Pse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pse(t){var e=xse(t,"string");return typeof e=="symbol"?e:String(e)}function xse(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}_e.getSingleton().register("persistentStateSave"),_e.getSingleton().register("persistentStateLoad"),_e.getSingleton().register("persistentStateReset");const nN="persistentState",Hse=0;class Dse extends gt{constructor(){super(...arguments),Ise(this,"storage",void 0)}static get PLUGIN_KEY(){return nN}static get PLUGIN_PRIORITY(){return Hse}isEnabled(){return!!this.hot.getSettings()[nN]}enablePlugin(){this.enabled||(this.storage||(this.storage=new Ase(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function Nse(t,e){Lse(t,e),e.add(t)}function Lse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kb(t,e,n){return e=$se(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $se(t){var e=kse(t,"string");return typeof e=="symbol"?e:String(e)}function kse(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rN(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Xb="search",Fse=190,Wse="htSearchResult",Vse=function(t,e,n,r,i){t.getCellMeta(e,n).isSearchResult=i},Bse=function(t,e,n){return Mt(t)||t===null||!t.toLocaleLowerCase||t.length===0||Mt(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var qb=new WeakSet;class Use extends gt{constructor(){super(...arguments),Nse(this,qb),Kb(this,"callback",Vse),Kb(this,"queryMethod",Bse),Kb(this,"searchResultClass",Wse)}static get PLUGIN_KEY(){return Xb}static get PLUGIN_PRIORITY(){return Fse}isEnabled(){return this.hot.getSettings()[Xb]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Xb];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return rN(e,qb,iN).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return rN(e,qb,iN).call(e,...i)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),o=this.hot.countCols(),s=[],a=this.hot;return Ie(0,i-1,l=>{Ie(0,o-1,u=>{const c=this.hot.getDataAtCell(l,u),d=this.hot.getCellMeta(l,u),g=d.search.callback||n,C=(d.search.queryMethod||r)(e,c,d);if(C){const E={row:l,col:u,data:c};s.push(E)}g&&g(a,l,u,c,C)})}),s}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){Ke(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function iN(t,e,n,r,i,o){const s=o.className||[];let a=[];typeof s=="string"?a=s.split(" "):a.push(...s),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}function Zb(t,e){Yse(t,e),e.add(t)}function Yse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function om(t,e,n){return e=Gse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gse(t){var e=zse(t,"string");return typeof e=="symbol"?e:String(e)}function zse(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Qb(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const jse="touchScroll",Kse=200;var oN=new WeakSet,sN=new WeakSet,aN=new WeakSet;class Xse extends gt{constructor(){super(...arguments),Zb(this,aN),Zb(this,sN),Zb(this,oN),om(this,"scrollbars",[]),om(this,"clones",[]),om(this,"lockedCollection",!1),om(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return jse}static get PLUGIN_PRIORITY(){return Kse}static get SETTING_KEYS(){return!0}isEnabled(){return Zw()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>Qb(this,oN,qse).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>Qb(this,sN,Zse).call(this)),this.addHook("afterMomentumScroll",()=>Qb(this,aN,Qse).call(this))}}function qse(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function Zse(){this.freezeOverlays=!0,H(this.clones,t=>{ce(t,"hide-tween")})}function Qse(){this.freezeOverlays=!1,H(this.clones,t=>{Ue(t,"hide-tween"),ce(t,"show-tween")}),this.hot._registerTimeout(()=>{H(this.clones,t=>{Ue(t,"show-tween")})},400),H(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function Jse(t,e){eae(t,e),e.add(t)}function eae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tae(t,e,n){return e=nae(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nae(t){var e=rae(t,"string");return typeof e=="symbol"?e:String(e)}function rae(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function iae(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const sm="trimRows",oae=330;var lN=new WeakSet;class sae extends gt{constructor(){super(...arguments),Jse(this,lN),tae(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return sm}static get PLUGIN_PRIORITY(){return oae}isEnabled(){return!!this.hot.getSettings()[sm]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new ec),this.trimmedRowsMap.addLocalHook("init",()=>iae(this,lN,aae).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[sm];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),H(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{H(e,s=>{this.trimmedRowsMap.setValueAtIndex(s,!0)})},!0),this.hot.runHooks("afterTrimRow",n,i,r,r&&i.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;const o=this.trimmedRowsMap.getValues().slice(),s=e.length>0;r&&s&&(H(e,l=>{o[l]=!1}),i=en(o,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",n,i,r&&s)!==!1&&(r&&s&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",n,i,r&&s,r&&i.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<n)}destroy(){super.destroy()}}function aae(){const t=this.hot.getSettings()[sm];Array.isArray(t)&&this.hot.batchExecution(()=>{H(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}const uN="undoRedo",lae="undoRedo";function Ee(t){const e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",function(n,r){const i=n&&n.length;if(!i||!n.find(a=>{const[,,l,u]=a;return l!==u}))return;const s=()=>{const a=n.reduce((u,c)=>(u.push([...c]),u),[]);H(a,u=>{u[1]=t.propToCol(u[1])});const l=i>1?this.getSelected():[[a[0][0],a[0][1]]];return new Ee.ChangeAction(a,l)};e.done(s,r)}),t.addHook("afterCreateRow",(n,r,i)=>{e.done(()=>new Ee.CreateRowAction(n,r),i)}),t.addHook("beforeRemoveRow",(n,r,i,o)=>{const s=()=>{const a=t.toPhysicalRow(n),l=kn(e.instance.getSourceData(a,0,a+r-1,e.instance.countSourceCols()-1));return new Ee.RemoveRowAction(a,l,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop,t.rowIndexMapper.getIndexesSequence())};e.done(s,o)}),t.addHook("afterCreateCol",(n,r,i)=>{e.done(()=>new Ee.CreateColumnAction(n,r),i)}),t.addHook("beforeRemoveCol",(n,r,i,o)=>{const s=()=>{const a=e.instance.getSourceDataArray(),l=(e.instance.countCols()+n)%e.instance.countCols(),u=[],c=[],d=[];Ie(a.length-1,C=>{const E=[],I=a[C];Ie(l,l+(r-1),M=>{E.push(I[t.toPhysicalColumn(M)])}),u.push(E)}),Ie(r-1,C=>{d.push(t.toPhysicalColumn(l+C))}),Array.isArray(t.getSettings().colHeaders)&&Ie(r-1,C=>{c.push(t.getSettings().colHeaders[t.toPhysicalColumn(l+C)]||null)});const g=t.columnIndexMapper.getIndexesSequence(),p=t.rowIndexMapper.getIndexesSequence();return new Ee.RemoveColumnAction(l,d,u,c,g,p,t.getSettings().fixedColumnsStart)};e.done(s,o)}),t.addHook("beforeCellAlignment",(n,r,i,o)=>{e.done(()=>new Ee.CellAlignmentAction(n,r,i,o))}),t.addHook("beforeFilter",n=>{e.done(()=>new Ee.FiltersAction(n))}),t.addHook("beforeRowMove",(n,r)=>{n!==!1&&e.done(()=>new Ee.RowMoveAction(n,r))}),t.addHook("beforeMergeCells",(n,r)=>{r||e.done(()=>new Ee.MergeCellsAction(t,n))}),t.addHook("afterUnmergeCells",(n,r)=>{r||e.done(()=>new Ee.UnmergeCellsAction(t,n))}),t.addHook("afterInit",()=>{e.init()})}Ee.prototype.done=function(t,e){if(this.ignoreNewActions||e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto")return;const r=this.doneActions.slice();if(this.instance.runHooks("beforeUndoStackChange",r,e)===!1)return;const o=t(),s=this.undoneActions.slice();this.doneActions.push(o),this.instance.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",s),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",s,this.undoneActions.slice())},Ee.prototype.undo=function(){if(this.isUndoAvailable()){const t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());const n=kn(e);if(this.instance.runHooks("beforeUndo",n)===!1)return;this.ignoreNewActions=!0;const i=this,o=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",o),e.undo(this.instance,()=>{i.ignoreNewActions=!1,i.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.instance.runHooks("afterUndo",n)}},Ee.prototype.redo=function(){if(this.isRedoAvailable()){const t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());const n=kn(e);if(this.instance.runHooks("beforeRedo",n)===!1)return;this.ignoreNewActions=!0;const i=this,o=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",o),e.redo(this.instance,()=>{i.ignoreNewActions=!1,i.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.instance.runHooks("afterRedo",n)}},Ee.prototype.isUndoAvailable=function(){return this.doneActions.length>0},Ee.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},Ee.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},Ee.prototype.isEnabled=function(){return this.enabled},Ee.prototype.enable=function(){if(this.isEnabled())return;const t=this.instance;this.enabled=!0,hae(t),this.registerShortcuts(),t.addHook("afterChange",cN)},Ee.prototype.disable=function(){if(!this.isEnabled())return;const t=this.instance;this.enabled=!1,dae(t),this.unregisterShortcuts(),t.removeHook("afterChange",cN)},Ee.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null},Ee.Action=function(){},Ee.Action.prototype.undo=function(){},Ee.Action.prototype.redo=function(){},Ee.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"},go(Ee.ChangeAction,Ee.Action),Ee.ChangeAction.prototype.undo=function(t,e){const n=kn(this.changes),r=t.countEmptyRows(!0),i=t.countEmptyCols(!0);for(let o=0,s=n.length;o<s;o++)n[o].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.undo");for(let o=0,s=n.length;o<s;o++){const[a,l]=n[o];t.getSettings().minSpareRows&&a+1+t.getSettings().minSpareRows===t.countRows()&&r===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(a+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&l+1+t.getSettings().minSpareCols===t.countCols()&&i===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(l+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}t.selectCells(this.selected,!1,!1)},Ee.ChangeAction.prototype.redo=function(t,e){const n=kn(this.changes);for(let r=0,i=n.length;r<i;r++)n[r].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)},Ee.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"},go(Ee.CreateRowAction,Ee.Action),Ee.CreateRowAction.prototype.undo=function(t,e){const n=t.countRows(),r=t.getSettings().minSpareRows;this.index>=n&&this.index-r<n&&(this.index-=r),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")},Ee.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")},Ee.RemoveRowAction=function(t,e,n,r,i){this.index=t,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=n,this.fixedRowsTop=r,this.rowIndexesSequence=i},go(Ee.RemoveRowAction,Ee.Action),Ee.RemoveRowAction.prototype.undo=function(t,e){const n=t.getSettings(),r=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach((i,o)=>{Object.keys(i).forEach(s=>{const a=parseInt(s,10);r.push([this.index+o,isNaN(a)?s:a,i[s]])})}),t.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(r,null,null,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)},Ee.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")},Ee.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"},go(Ee.CreateColumnAction,Ee.Action),Ee.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")},Ee.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")},Ee.RemoveColumnAction=function(t,e,n,r,i,o,s){this.index=t,this.indexes=e,this.data=n,this.amount=this.data[0].length,this.headers=r,this.columnPositions=i.slice(0),this.rowPositions=o.slice(0),this.actionType="remove_col",this.fixedColumnsStart=s},go(Ee.RemoveColumnAction,Ee.Action),Ee.RemoveColumnAction.prototype.undo=function(t,e){const n=t.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;const r=this.indexes.slice(0).sort(),i=(u,c,d)=>d[this.indexes.indexOf(r[c])],o=this.data.length,s=[];for(let u=0;u<o;u++)s.push(qe(this.data[u],i));const a=qe(this.headers,i),l=[];t.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),H(t.getSourceDataArray(),(u,c)=>{H(r,(d,g)=>{u[d]=s[c][g],l.push([c,d,u[d]])})}),t.setSourceDataAtCell(l,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&H(a,(u,c)=>{t.getSettings().colHeaders[r[c]]=u}),t.batchExecution(()=>{t.rowIndexMapper.setIndexesSequence(this.rowPositions),t.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),t.addHookOnce("afterViewRender",e),t.render()},Ee.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")},Ee.CellAlignmentAction=function(t,e,n,r){this.stateBefore=t,this.range=e,this.type=n,this.alignment=r},Ee.CellAlignmentAction.prototype.undo=function(t,e){H(this.range,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&t.setCellMeta(r,i,"className",this.stateBefore[r][i]||" htLeft")})}),t.addHookOnce("afterViewRender",e),t.render()},Ee.CellAlignmentAction.prototype.redo=function(t,e){fs(this.range,this.type,this.alignment,(n,r)=>t.getCellMeta(n,r),(n,r,i,o)=>t.setCellMeta(n,r,i,o)),t.addHookOnce("afterViewRender",e),t.render()},Ee.FiltersAction=function(t){this.conditionsStack=t,this.actionType="filter"},go(Ee.FiltersAction,Ee.Action),Ee.FiltersAction.prototype.undo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),n.filter()},Ee.FiltersAction.prototype.redo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack),n.filter()};class uae extends Ee.Action{constructor(e,n){super(),this.cellRange=n;const r=this.cellRange.getTopStartCorner(),i=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(r.row,r.col,i.row,i.col)}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange)}}Ee.MergeCellsAction=uae;class cae extends Ee.Action{constructor(e,n){super(),this.cellRange=n}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange,!0)}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0),e.render()}}Ee.UnmergeCellsAction=cae,Ee.RowMoveAction=function(t,e){this.rows=t.slice(),this.finalIndex=e,this.actionType="row_move"},go(Ee.RowMoveAction,Ee.Action),Ee.RowMoveAction.prototype.undo=function(t,e){const n=t.getPlugin("manualRowMove"),r=[].concat(this.rows),i=r.filter(a=>a>this.finalIndex),o=r.filter(a=>a<=this.finalIndex),s=i.sort((a,l)=>l-a).concat(o.sort((a,l)=>a-l));t.addHookOnce("afterViewRender",e);for(let a=0;a<s.length;a+=1){const l=t.toVisualRow(s[a]);n.moveRow(l,s[a])}t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)},Ee.RowMoveAction.prototype.redo=function(t,e){const n=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),n.moveRows(this.rows.slice(),this.finalIndex),t.render(),t.deselectCell(),t.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)},Ee.prototype.init=function(){const t=this.instance.getSettings().undo,e=typeof t>"u"||t;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()},Ee.prototype.registerShortcuts=function(){const e=this.instance.getShortcutManager().getContext("grid"),r={runOnlyIf:i=>!i.altKey,group:uN};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],r)},Ee.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(uN)};function cN(t,e){const n=this;if(e==="loadData")return n.undoRedo.clear()}function hae(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}function dae(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}const hh=_e.getSingleton();hh.add("afterUpdateSettings",function(){var t;(t=this.getPlugin("undoRedo"))===null||t===void 0||t.init()}),hh.register("beforeUndo"),hh.register("afterUndo"),hh.register("beforeRedo"),hh.register("afterRedo"),Ee.PLUGIN_KEY=lae,Ee.SETTING_KEYS=!0;function fae(){dt(cc),dt(Q9),dt(gc),dt(A8),dt(k8),dt(jA),dt(A7),dt(g5),dt(rg),dt(kZ),dt(lQ),dt(pQ),dt(dg),dt(BQ),dt(qee),dt(Pte),dt(ine),dt(pne),dt(Ane),dt(Vne),dt(Qne),dt(vre),dt(Are),dt(iie),dt(Hie),dt(kie),dt(Coe),dt(cse),dt(Dse),dt(Use),dt(Xse),dt(sae),dt(Ee)}function gae(){D6(),X6(),r9(),p9(),fae()}function mae(t){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(n){const r=this.first();let i=r.data("handsontable");if(typeof n!="string"){const u=n||{};return i?i.updateSettings(u):(i=new t.Core(r[0],u),r.data("handsontable",i),i.init()),r}let o;if(i)if(typeof i[n]<"u"){for(var s=arguments.length,a=new Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];o=i[n].call(i,...a),n==="destroy"&&r.removeData()}else throw new Error(`Handsontable do not provide action: ${n}`);return o})}var Jb,eR,tR,nR,rR;gae(),mae(Be),Be.__GhostTable=YS,Be._getListenersCounter=JG,Be._getRegisteredMapsCounter=dX,Be.EventManager=br;const pae=[MY,DG,Q3,Z6,Oj,mG,PY,mz,PG,HY,$G,gz],wae=[hG,kG];Be.helper={},Be.dom={},H(pae,t=>{H(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Be.helper[e]=t[e])})}),H(wae,t=>{H(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Be.dom[e]=t[e])})}),Be.cellTypes=(Jb=Be.cellTypes)!==null&&Jb!==void 0?Jb:{},H(P4(),t=>{Be.cellTypes[t]=yS(t)}),Be.cellTypes.registerCellType=Vr,Be.cellTypes.getCellType=yS,Be.editors=(eR=Be.editors)!==null&&eR!==void 0?eR:{},H(zG(),t=>{Be.editors[`${$n(t)}Editor`]=Rd(t)}),Be.editors.registerEditor=sr,Be.editors.getEditor=Rd,Be.renderers=(tR=Be.renderers)!==null&&tR!==void 0?tR:{},H(Oz(),t=>{const e=Dd(t);t==="base"&&(Be.renderers.cellDecorator=e),Be.renderers[`${$n(t)}Renderer`]=e}),Be.renderers.registerRenderer=xi,Be.renderers.getRenderer=Dd,Be.validators=(nR=Be.validators)!==null&&nR!==void 0?nR:{},H(Pz(),t=>{Be.validators[`${$n(t)}Validator`]=kw(t)}),Be.validators.registerValidator=Ja,Be.validators.getValidator=kw,Be.plugins=(rR=Be.plugins)!==null&&rR!==void 0?rR:{},H($w(),t=>{Be.plugins[t]=Uu(t)}),Be.plugins[`${$n(gt.PLUGIN_KEY)}Plugin`]=gt,Be.plugins.registerPlugin=dt,Be.plugins.getPlugin=Uu;class Cae extends Be.editors.BaseEditor{init(){this.select=this.hot.rootDocument.createElement("div"),this.select.classList.add("htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select)}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.close(),this.row=e,this.col=n,this.originalValue=o,this.renderStyle=this.cellProperties.renderStyle,this.renderNode=this.cellProperties.renderNode,this.renderNode(null)}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){const{top:e,start:n,width:r,height:i}=this.getEditedCellRect(),o=this.select.style;this.cellProperties.afterRenderEdit(this.row,this.col,this.originalValue,this.hot,this),this._opened=!0,this.renderNode(this.cellProperties.editorReactNode,{row:this.row,col:this.col,hot:this.hot,originalValue:this.originalValue}),o.height=`${i}px`,o.minWidth=`${r}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${n}px`,o.margin="0px",o.display="",this.renderStyle(o)}focus(){this.select.focus()}close(){this.isClose&&(this._opened=!1,this.select.style.display="none",this.renderStyle(this.select.style),this.renderNode(null),delete this.isClose),typeof this.isClose>"u"&&(this.select.style.display="none",this.renderStyle&&this.renderStyle(this.select.style))}}const hN=Dt.createContext({});var vae=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,iR=Math.ceil,Gr=Math.floor,wr="[BigNumber Error] ",dN=wr+"Number primitive has more than 15 significant digits: ",yi=1e14,Xe=14,oR=9007199254740991,sR=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],xs=1e7,En=1e9;function fN(t){var e,n,r,i=y.prototype={constructor:y,toString:null,valueOf:null},o=new y(1),s=20,a=4,l=-7,u=21,c=-1e7,d=1e7,g=!1,p=1,C=0,E={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},I="0123456789abcdefghijklmnopqrstuvwxyz",M=!0;function y(v,S){var b,L,P,x,W,D,B,z,w=this;if(!(w instanceof y))return new y(v,S);if(S==null){if(v&&v._isBigNumber===!0){w.s=v.s,!v.c||v.e>d?w.c=w.e=null:v.e<c?w.c=[w.e=0]:(w.e=v.e,w.c=v.c.slice());return}if((D=typeof v=="number")&&v*0==0){if(w.s=1/v<0?(v=-v,-1):1,v===~~v){for(x=0,W=v;W>=10;W/=10,x++);x>d?w.c=w.e=null:(w.e=x,w.c=[v]);return}z=String(v)}else{if(!vae.test(z=String(v)))return r(w,z,D);w.s=z.charCodeAt(0)==45?(z=z.slice(1),-1):1}(x=z.indexOf("."))>-1&&(z=z.replace(".","")),(W=z.search(/e/i))>0?(x<0&&(x=W),x+=+z.slice(W+1),z=z.substring(0,W)):x<0&&(x=z.length)}else{if(Jt(S,2,I.length,"Base"),S==10&&M)return w=new y(v),q(w,s+w.e+1,a);if(z=String(v),D=typeof v=="number"){if(v*0!=0)return r(w,z,D,S);if(w.s=1/v<0?(z=z.slice(1),-1):1,y.DEBUG&&z.replace(/^0\.0*|\./,"").length>15)throw Error(dN+v)}else w.s=z.charCodeAt(0)===45?(z=z.slice(1),-1):1;for(b=I.slice(0,S),x=W=0,B=z.length;W<B;W++)if(b.indexOf(L=z.charAt(W))<0){if(L=="."){if(W>x){x=B;continue}}else if(!P&&(z==z.toUpperCase()&&(z=z.toLowerCase())||z==z.toLowerCase()&&(z=z.toUpperCase()))){P=!0,W=-1,x=0;continue}return r(w,String(v),D,S)}D=!1,z=n(z,S,10,w.s),(x=z.indexOf("."))>-1?z=z.replace(".",""):x=z.length}for(W=0;z.charCodeAt(W)===48;W++);for(B=z.length;z.charCodeAt(--B)===48;);if(z=z.slice(W,++B)){if(B-=W,D&&y.DEBUG&&B>15&&(v>oR||v!==Gr(v)))throw Error(dN+w.s*v);if((x=x-W-1)>d)w.c=w.e=null;else if(x<c)w.c=[w.e=0];else{if(w.e=x,w.c=[],W=(x+1)%Xe,x<0&&(W+=Xe),W<B){for(W&&w.c.push(+z.slice(0,W)),B-=Xe;W<B;)w.c.push(+z.slice(W,W+=Xe));W=Xe-(z=z.slice(W)).length}else W-=B;for(;W--;z+="0");w.c.push(+z)}}else w.c=[w.e=0]}y.clone=fN,y.ROUND_UP=0,y.ROUND_DOWN=1,y.ROUND_CEIL=2,y.ROUND_FLOOR=3,y.ROUND_HALF_UP=4,y.ROUND_HALF_DOWN=5,y.ROUND_HALF_EVEN=6,y.ROUND_HALF_CEIL=7,y.ROUND_HALF_FLOOR=8,y.EUCLID=9,y.config=y.set=function(v){var S,b;if(v!=null)if(typeof v=="object"){if(v.hasOwnProperty(S="DECIMAL_PLACES")&&(b=v[S],Jt(b,0,En,S),s=b),v.hasOwnProperty(S="ROUNDING_MODE")&&(b=v[S],Jt(b,0,8,S),a=b),v.hasOwnProperty(S="EXPONENTIAL_AT")&&(b=v[S],b&&b.pop?(Jt(b[0],-En,0,S),Jt(b[1],0,En,S),l=b[0],u=b[1]):(Jt(b,-En,En,S),l=-(u=b<0?-b:b))),v.hasOwnProperty(S="RANGE"))if(b=v[S],b&&b.pop)Jt(b[0],-En,-1,S),Jt(b[1],1,En,S),c=b[0],d=b[1];else if(Jt(b,-En,En,S),b)c=-(d=b<0?-b:b);else throw Error(wr+S+" cannot be zero: "+b);if(v.hasOwnProperty(S="CRYPTO"))if(b=v[S],b===!!b)if(b)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))g=b;else throw g=!b,Error(wr+"crypto unavailable");else g=b;else throw Error(wr+S+" not true or false: "+b);if(v.hasOwnProperty(S="MODULO_MODE")&&(b=v[S],Jt(b,0,9,S),p=b),v.hasOwnProperty(S="POW_PRECISION")&&(b=v[S],Jt(b,0,En,S),C=b),v.hasOwnProperty(S="FORMAT"))if(b=v[S],typeof b=="object")E=b;else throw Error(wr+S+" not an object: "+b);if(v.hasOwnProperty(S="ALPHABET"))if(b=v[S],typeof b=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(b))M=b.slice(0,10)=="0123456789",I=b;else throw Error(wr+S+" invalid: "+b)}else throw Error(wr+"Object expected: "+v);return{DECIMAL_PLACES:s,ROUNDING_MODE:a,EXPONENTIAL_AT:[l,u],RANGE:[c,d],CRYPTO:g,MODULO_MODE:p,POW_PRECISION:C,FORMAT:E,ALPHABET:I}},y.isBigNumber=function(v){if(!v||v._isBigNumber!==!0)return!1;if(!y.DEBUG)return!0;var S,b,L=v.c,P=v.e,x=v.s;e:if({}.toString.call(L)=="[object Array]"){if((x===1||x===-1)&&P>=-En&&P<=En&&P===Gr(P)){if(L[0]===0){if(P===0&&L.length===1)return!0;break e}if(S=(P+1)%Xe,S<1&&(S+=Xe),String(L[0]).length==S){for(S=0;S<L.length;S++)if(b=L[S],b<0||b>=yi||b!==Gr(b))break e;if(b!==0)return!0}}}else if(L===null&&P===null&&(x===null||x===1||x===-1))return!0;throw Error(wr+"Invalid BigNumber: "+v)},y.maximum=y.max=function(){return X(arguments,-1)},y.minimum=y.min=function(){return X(arguments,1)},y.random=function(){var v=9007199254740992,S=Math.random()*v&2097151?function(){return Gr(Math.random()*v)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(b){var L,P,x,W,D,B=0,z=[],w=new y(o);if(b==null?b=s:Jt(b,0,En),W=iR(b/Xe),g)if(crypto.getRandomValues){for(L=crypto.getRandomValues(new Uint32Array(W*=2));B<W;)D=L[B]*131072+(L[B+1]>>>11),D>=9e15?(P=crypto.getRandomValues(new Uint32Array(2)),L[B]=P[0],L[B+1]=P[1]):(z.push(D%1e14),B+=2);B=W/2}else if(crypto.randomBytes){for(L=crypto.randomBytes(W*=7);B<W;)D=(L[B]&31)*281474976710656+L[B+1]*1099511627776+L[B+2]*4294967296+L[B+3]*16777216+(L[B+4]<<16)+(L[B+5]<<8)+L[B+6],D>=9e15?crypto.randomBytes(7).copy(L,B):(z.push(D%1e14),B+=7);B=W/7}else throw g=!1,Error(wr+"crypto unavailable");if(!g)for(;B<W;)D=S(),D<9e15&&(z[B++]=D%1e14);for(W=z[--B],b%=Xe,W&&b&&(D=sR[Xe-b],z[B]=Gr(W/D)*D);z[B]===0;z.pop(),B--);if(B<0)z=[x=0];else{for(x=-1;z[0]===0;z.splice(0,1),x-=Xe);for(B=1,D=z[0];D>=10;D/=10,B++);B<Xe&&(x-=Xe-B)}return w.e=x,w.c=z,w}}(),y.sum=function(){for(var v=1,S=arguments,b=new y(S[0]);v<S.length;)b=b.plus(S[v++]);return b},n=function(){var v="0123456789";function S(b,L,P,x){for(var W,D=[0],B,z=0,w=b.length;z<w;){for(B=D.length;B--;D[B]*=L);for(D[0]+=x.indexOf(b.charAt(z++)),W=0;W<D.length;W++)D[W]>P-1&&(D[W+1]==null&&(D[W+1]=0),D[W+1]+=D[W]/P|0,D[W]%=P)}return D.reverse()}return function(b,L,P,x,W){var D,B,z,w,h,f,m,T,O=b.indexOf("."),_=s,Y=a;for(O>=0&&(w=C,C=0,b=b.replace(".",""),T=new y(L),f=T.pow(b.length-O),C=w,T.c=S(Go(jr(f.c),f.e,"0"),10,P,v),T.e=T.c.length),m=S(b,L,P,W?(D=I,v):(D=v,I)),z=w=m.length;m[--w]==0;m.pop());if(!m[0])return D.charAt(0);if(O<0?--z:(f.c=m,f.e=z,f.s=x,f=e(f,T,_,Y,P),m=f.c,h=f.r,z=f.e),B=z+_+1,O=m[B],w=P/2,h=h||B<0||m[B+1]!=null,h=Y<4?(O!=null||h)&&(Y==0||Y==(f.s<0?3:2)):O>w||O==w&&(Y==4||h||Y==6&&m[B-1]&1||Y==(f.s<0?8:7)),B<1||!m[0])b=h?Go(D.charAt(1),-_,D.charAt(0)):D.charAt(0);else{if(m.length=B,h)for(--P;++m[--B]>P;)m[B]=0,B||(++z,m=[1].concat(m));for(w=m.length;!m[--w];);for(O=0,b="";O<=w;b+=D.charAt(m[O++]));b=Go(b,z,D.charAt(0))}return b}}(),e=function(){function v(L,P,x){var W,D,B,z,w=0,h=L.length,f=P%xs,m=P/xs|0;for(L=L.slice();h--;)B=L[h]%xs,z=L[h]/xs|0,W=m*B+z*f,D=f*B+W%xs*xs+w,w=(D/x|0)+(W/xs|0)+m*z,L[h]=D%x;return w&&(L=[w].concat(L)),L}function S(L,P,x,W){var D,B;if(x!=W)B=x>W?1:-1;else for(D=B=0;D<x;D++)if(L[D]!=P[D]){B=L[D]>P[D]?1:-1;break}return B}function b(L,P,x,W){for(var D=0;x--;)L[x]-=D,D=L[x]<P[x]?1:0,L[x]=D*W+L[x]-P[x];for(;!L[0]&&L.length>1;L.splice(0,1));}return function(L,P,x,W,D){var B,z,w,h,f,m,T,O,_,Y,U,ie,se,oe,de,Se,pe,we=L.s==P.s?1:-1,ee=L.c,ye=P.c;if(!ee||!ee[0]||!ye||!ye[0])return new y(!L.s||!P.s||(ee?ye&&ee[0]==ye[0]:!ye)?NaN:ee&&ee[0]==0||!ye?we*0:we/0);for(O=new y(we),_=O.c=[],z=L.e-P.e,we=x+z+1,D||(D=yi,z=zr(L.e/Xe)-zr(P.e/Xe),we=we/Xe|0),w=0;ye[w]==(ee[w]||0);w++);if(ye[w]>(ee[w]||0)&&z--,we<0)_.push(1),h=!0;else{for(oe=ee.length,Se=ye.length,w=0,we+=2,f=Gr(D/(ye[0]+1)),f>1&&(ye=v(ye,f,D),ee=v(ee,f,D),Se=ye.length,oe=ee.length),se=Se,Y=ee.slice(0,Se),U=Y.length;U<Se;Y[U++]=0);pe=ye.slice(),pe=[0].concat(pe),de=ye[0],ye[1]>=D/2&&de++;do{if(f=0,B=S(ye,Y,Se,U),B<0){if(ie=Y[0],Se!=U&&(ie=ie*D+(Y[1]||0)),f=Gr(ie/de),f>1)for(f>=D&&(f=D-1),m=v(ye,f,D),T=m.length,U=Y.length;S(m,Y,T,U)==1;)f--,b(m,Se<T?pe:ye,T,D),T=m.length,B=1;else f==0&&(B=f=1),m=ye.slice(),T=m.length;if(T<U&&(m=[0].concat(m)),b(Y,m,U,D),U=Y.length,B==-1)for(;S(ye,Y,Se,U)<1;)f++,b(Y,Se<U?pe:ye,U,D),U=Y.length}else B===0&&(f++,Y=[0]);_[w++]=f,Y[0]?Y[U++]=ee[se]||0:(Y=[ee[se]],U=1)}while((se++<oe||Y[0]!=null)&&we--);h=Y[0]!=null,_[0]||_.splice(0,1)}if(D==yi){for(w=1,we=_[0];we>=10;we/=10,w++);q(O,x+(O.e=w+z*Xe-1)+1,W,h)}else O.e=z,O.r=+h;return O}}();function $(v,S,b,L){var P,x,W,D,B;if(b==null?b=a:Jt(b,0,8),!v.c)return v.toString();if(P=v.c[0],W=v.e,S==null)B=jr(v.c),B=L==1||L==2&&(W<=l||W>=u)?lm(B,W):Go(B,W,"0");else if(v=q(new y(v),S,b),x=v.e,B=jr(v.c),D=B.length,L==1||L==2&&(S<=x||x<=l)){for(;D<S;B+="0",D++);B=lm(B,x)}else if(S-=W,B=Go(B,x,"0"),x+1>D){if(--S>0)for(B+=".";S--;B+="0");}else if(S+=x-D,S>0)for(x+1==D&&(B+=".");S--;B+="0");return v.s<0&&P?"-"+B:B}function X(v,S){for(var b,L,P=1,x=new y(v[0]);P<v.length;P++)L=new y(v[P]),(!L.s||(b=Da(x,L))===S||b===0&&x.s===S)&&(x=L);return x}function G(v,S,b){for(var L=1,P=S.length;!S[--P];S.pop());for(P=S[0];P>=10;P/=10,L++);return(b=L+b*Xe-1)>d?v.c=v.e=null:b<c?v.c=[v.e=0]:(v.e=b,v.c=S),v}r=function(){var v=/^(-?)0([xbo])(?=\w[\w.]*$)/i,S=/^([^.]+)\.$/,b=/^\.([^.]+)$/,L=/^-?(Infinity|NaN)$/,P=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(x,W,D,B){var z,w=D?W:W.replace(P,"");if(L.test(w))x.s=isNaN(w)?null:w<0?-1:1;else{if(!D&&(w=w.replace(v,function(h,f,m){return z=(m=m.toLowerCase())=="x"?16:m=="b"?2:8,!B||B==z?f:h}),B&&(z=B,w=w.replace(S,"$1").replace(b,"0.$1")),W!=w))return new y(w,z);if(y.DEBUG)throw Error(wr+"Not a"+(B?" base "+B:"")+" number: "+W);x.s=null}x.c=x.e=null}}();function q(v,S,b,L){var P,x,W,D,B,z,w,h=v.c,f=sR;if(h){e:{for(P=1,D=h[0];D>=10;D/=10,P++);if(x=S-P,x<0)x+=Xe,W=S,B=h[z=0],w=Gr(B/f[P-W-1]%10);else if(z=iR((x+1)/Xe),z>=h.length)if(L){for(;h.length<=z;h.push(0));B=w=0,P=1,x%=Xe,W=x-Xe+1}else break e;else{for(B=D=h[z],P=1;D>=10;D/=10,P++);x%=Xe,W=x-Xe+P,w=W<0?0:Gr(B/f[P-W-1]%10)}if(L=L||S<0||h[z+1]!=null||(W<0?B:B%f[P-W-1]),L=b<4?(w||L)&&(b==0||b==(v.s<0?3:2)):w>5||w==5&&(b==4||L||b==6&&(x>0?W>0?B/f[P-W]:0:h[z-1])%10&1||b==(v.s<0?8:7)),S<1||!h[0])return h.length=0,L?(S-=v.e+1,h[0]=f[(Xe-S%Xe)%Xe],v.e=-S||0):h[0]=v.e=0,v;if(x==0?(h.length=z,D=1,z--):(h.length=z+1,D=f[Xe-x],h[z]=W>0?Gr(B/f[P-W]%f[W])*D:0),L)for(;;)if(z==0){for(x=1,W=h[0];W>=10;W/=10,x++);for(W=h[0]+=D,D=1;W>=10;W/=10,D++);x!=D&&(v.e++,h[0]==yi&&(h[0]=1));break}else{if(h[z]+=D,h[z]!=yi)break;h[z--]=0,D=1}for(x=h.length;h[--x]===0;h.pop());}v.e>d?v.c=v.e=null:v.e<c&&(v.c=[v.e=0])}return v}function re(v){var S,b=v.e;return b===null?v.toString():(S=jr(v.c),S=b<=l||b>=u?lm(S,b):Go(S,b,"0"),v.s<0?"-"+S:S)}return i.absoluteValue=i.abs=function(){var v=new y(this);return v.s<0&&(v.s=1),v},i.comparedTo=function(v,S){return Da(this,new y(v,S))},i.decimalPlaces=i.dp=function(v,S){var b,L,P,x=this;if(v!=null)return Jt(v,0,En),S==null?S=a:Jt(S,0,8),q(new y(x),v+x.e+1,S);if(!(b=x.c))return null;if(L=((P=b.length-1)-zr(this.e/Xe))*Xe,P=b[P])for(;P%10==0;P/=10,L--);return L<0&&(L=0),L},i.dividedBy=i.div=function(v,S){return e(this,new y(v,S),s,a)},i.dividedToIntegerBy=i.idiv=function(v,S){return e(this,new y(v,S),0,1)},i.exponentiatedBy=i.pow=function(v,S){var b,L,P,x,W,D,B,z,w,h=this;if(v=new y(v),v.c&&!v.isInteger())throw Error(wr+"Exponent not an integer: "+re(v));if(S!=null&&(S=new y(S)),D=v.e>14,!h.c||!h.c[0]||h.c[0]==1&&!h.e&&h.c.length==1||!v.c||!v.c[0])return w=new y(Math.pow(+re(h),D?v.s*(2-am(v)):+re(v))),S?w.mod(S):w;if(B=v.s<0,S){if(S.c?!S.c[0]:!S.s)return new y(NaN);L=!B&&h.isInteger()&&S.isInteger(),L&&(h=h.mod(S))}else{if(v.e>9&&(h.e>0||h.e<-1||(h.e==0?h.c[0]>1||D&&h.c[1]>=24e7:h.c[0]<8e13||D&&h.c[0]<=9999975e7)))return x=h.s<0&&am(v)?-0:0,h.e>-1&&(x=1/x),new y(B?1/x:x);C&&(x=iR(C/Xe+2))}for(D?(b=new y(.5),B&&(v.s=1),z=am(v)):(P=Math.abs(+re(v)),z=P%2),w=new y(o);;){if(z){if(w=w.times(h),!w.c)break;x?w.c.length>x&&(w.c.length=x):L&&(w=w.mod(S))}if(P){if(P=Gr(P/2),P===0)break;z=P%2}else if(v=v.times(b),q(v,v.e+1,1),v.e>14)z=am(v);else{if(P=+re(v),P===0)break;z=P%2}h=h.times(h),x?h.c&&h.c.length>x&&(h.c.length=x):L&&(h=h.mod(S))}return L?w:(B&&(w=o.div(w)),S?w.mod(S):x?q(w,C,a,W):w)},i.integerValue=function(v){var S=new y(this);return v==null?v=a:Jt(v,0,8),q(S,S.e+1,v)},i.isEqualTo=i.eq=function(v,S){return Da(this,new y(v,S))===0},i.isFinite=function(){return!!this.c},i.isGreaterThan=i.gt=function(v,S){return Da(this,new y(v,S))>0},i.isGreaterThanOrEqualTo=i.gte=function(v,S){return(S=Da(this,new y(v,S)))===1||S===0},i.isInteger=function(){return!!this.c&&zr(this.e/Xe)>this.c.length-2},i.isLessThan=i.lt=function(v,S){return Da(this,new y(v,S))<0},i.isLessThanOrEqualTo=i.lte=function(v,S){return(S=Da(this,new y(v,S)))===-1||S===0},i.isNaN=function(){return!this.s},i.isNegative=function(){return this.s<0},i.isPositive=function(){return this.s>0},i.isZero=function(){return!!this.c&&this.c[0]==0},i.minus=function(v,S){var b,L,P,x,W=this,D=W.s;if(v=new y(v,S),S=v.s,!D||!S)return new y(NaN);if(D!=S)return v.s=-S,W.plus(v);var B=W.e/Xe,z=v.e/Xe,w=W.c,h=v.c;if(!B||!z){if(!w||!h)return w?(v.s=-S,v):new y(h?W:NaN);if(!w[0]||!h[0])return h[0]?(v.s=-S,v):new y(w[0]?W:a==3?-0:0)}if(B=zr(B),z=zr(z),w=w.slice(),D=B-z){for((x=D<0)?(D=-D,P=w):(z=B,P=h),P.reverse(),S=D;S--;P.push(0));P.reverse()}else for(L=(x=(D=w.length)<(S=h.length))?D:S,D=S=0;S<L;S++)if(w[S]!=h[S]){x=w[S]<h[S];break}if(x&&(P=w,w=h,h=P,v.s=-v.s),S=(L=h.length)-(b=w.length),S>0)for(;S--;w[b++]=0);for(S=yi-1;L>D;){if(w[--L]<h[L]){for(b=L;b&&!w[--b];w[b]=S);--w[b],w[L]+=yi}w[L]-=h[L]}for(;w[0]==0;w.splice(0,1),--z);return w[0]?G(v,w,z):(v.s=a==3?-1:1,v.c=[v.e=0],v)},i.modulo=i.mod=function(v,S){var b,L,P=this;return v=new y(v,S),!P.c||!v.s||v.c&&!v.c[0]?new y(NaN):!v.c||P.c&&!P.c[0]?new y(P):(p==9?(L=v.s,v.s=1,b=e(P,v,0,3),v.s=L,b.s*=L):b=e(P,v,0,p),v=P.minus(b.times(v)),!v.c[0]&&p==1&&(v.s=P.s),v)},i.multipliedBy=i.times=function(v,S){var b,L,P,x,W,D,B,z,w,h,f,m,T,O,_,Y=this,U=Y.c,ie=(v=new y(v,S)).c;if(!U||!ie||!U[0]||!ie[0])return!Y.s||!v.s||U&&!U[0]&&!ie||ie&&!ie[0]&&!U?v.c=v.e=v.s=null:(v.s*=Y.s,!U||!ie?v.c=v.e=null:(v.c=[0],v.e=0)),v;for(L=zr(Y.e/Xe)+zr(v.e/Xe),v.s*=Y.s,B=U.length,h=ie.length,B<h&&(T=U,U=ie,ie=T,P=B,B=h,h=P),P=B+h,T=[];P--;T.push(0));for(O=yi,_=xs,P=h;--P>=0;){for(b=0,f=ie[P]%_,m=ie[P]/_|0,W=B,x=P+W;x>P;)z=U[--W]%_,w=U[W]/_|0,D=m*z+w*f,z=f*z+D%_*_+T[x]+b,b=(z/O|0)+(D/_|0)+m*w,T[x--]=z%O;T[x]=b}return b?++L:T.splice(0,1),G(v,T,L)},i.negated=function(){var v=new y(this);return v.s=-v.s||null,v},i.plus=function(v,S){var b,L=this,P=L.s;if(v=new y(v,S),S=v.s,!P||!S)return new y(NaN);if(P!=S)return v.s=-S,L.minus(v);var x=L.e/Xe,W=v.e/Xe,D=L.c,B=v.c;if(!x||!W){if(!D||!B)return new y(P/0);if(!D[0]||!B[0])return B[0]?v:new y(D[0]?L:P*0)}if(x=zr(x),W=zr(W),D=D.slice(),P=x-W){for(P>0?(W=x,b=B):(P=-P,b=D),b.reverse();P--;b.push(0));b.reverse()}for(P=D.length,S=B.length,P-S<0&&(b=B,B=D,D=b,S=P),P=0;S;)P=(D[--S]=D[S]+B[S]+P)/yi|0,D[S]=yi===D[S]?0:D[S]%yi;return P&&(D=[P].concat(D),++W),G(v,D,W)},i.precision=i.sd=function(v,S){var b,L,P,x=this;if(v!=null&&v!==!!v)return Jt(v,1,En),S==null?S=a:Jt(S,0,8),q(new y(x),v,S);if(!(b=x.c))return null;if(P=b.length-1,L=P*Xe+1,P=b[P]){for(;P%10==0;P/=10,L--);for(P=b[0];P>=10;P/=10,L++);}return v&&x.e+1>L&&(L=x.e+1),L},i.shiftedBy=function(v){return Jt(v,-oR,oR),this.times("1e"+v)},i.squareRoot=i.sqrt=function(){var v,S,b,L,P,x=this,W=x.c,D=x.s,B=x.e,z=s+4,w=new y("0.5");if(D!==1||!W||!W[0])return new y(!D||D<0&&(!W||W[0])?NaN:W?x:1/0);if(D=Math.sqrt(+re(x)),D==0||D==1/0?(S=jr(W),(S.length+B)%2==0&&(S+="0"),D=Math.sqrt(+S),B=zr((B+1)/2)-(B<0||B%2),D==1/0?S="5e"+B:(S=D.toExponential(),S=S.slice(0,S.indexOf("e")+1)+B),b=new y(S)):b=new y(D+""),b.c[0]){for(B=b.e,D=B+z,D<3&&(D=0);;)if(P=b,b=w.times(P.plus(e(x,P,z,1))),jr(P.c).slice(0,D)===(S=jr(b.c)).slice(0,D))if(b.e<B&&--D,S=S.slice(D-3,D+1),S=="9999"||!L&&S=="4999"){if(!L&&(q(P,P.e+s+2,0),P.times(P).eq(x))){b=P;break}z+=4,D+=4,L=1}else{(!+S||!+S.slice(1)&&S.charAt(0)=="5")&&(q(b,b.e+s+2,1),v=!b.times(b).eq(x));break}}return q(b,b.e+s+1,a,v)},i.toExponential=function(v,S){return v!=null&&(Jt(v,0,En),v++),$(this,v,S,1)},i.toFixed=function(v,S){return v!=null&&(Jt(v,0,En),v=v+this.e+1),$(this,v,S)},i.toFormat=function(v,S,b){var L,P=this;if(b==null)v!=null&&S&&typeof S=="object"?(b=S,S=null):v&&typeof v=="object"?(b=v,v=S=null):b=E;else if(typeof b!="object")throw Error(wr+"Argument not an object: "+b);if(L=P.toFixed(v,S),P.c){var x,W=L.split("."),D=+b.groupSize,B=+b.secondaryGroupSize,z=b.groupSeparator||"",w=W[0],h=W[1],f=P.s<0,m=f?w.slice(1):w,T=m.length;if(B&&(x=D,D=B,B=x,T-=x),D>0&&T>0){for(x=T%D||D,w=m.substr(0,x);x<T;x+=D)w+=z+m.substr(x,D);B>0&&(w+=z+m.slice(x)),f&&(w="-"+w)}L=h?w+(b.decimalSeparator||"")+((B=+b.fractionGroupSize)?h.replace(new RegExp("\\d{"+B+"}\\B","g"),"$&"+(b.fractionGroupSeparator||"")):h):w}return(b.prefix||"")+L+(b.suffix||"")},i.toFraction=function(v){var S,b,L,P,x,W,D,B,z,w,h,f,m=this,T=m.c;if(v!=null&&(D=new y(v),!D.isInteger()&&(D.c||D.s!==1)||D.lt(o)))throw Error(wr+"Argument "+(D.isInteger()?"out of range: ":"not an integer: ")+re(D));if(!T)return new y(m);for(S=new y(o),z=b=new y(o),L=B=new y(o),f=jr(T),x=S.e=f.length-m.e-1,S.c[0]=sR[(W=x%Xe)<0?Xe+W:W],v=!v||D.comparedTo(S)>0?x>0?S:z:D,W=d,d=1/0,D=new y(f),B.c[0]=0;w=e(D,S,0,1),P=b.plus(w.times(L)),P.comparedTo(v)!=1;)b=L,L=P,z=B.plus(w.times(P=z)),B=P,S=D.minus(w.times(P=S)),D=P;return P=e(v.minus(b),L,0,1),B=B.plus(P.times(z)),b=b.plus(P.times(L)),B.s=z.s=m.s,x=x*2,h=e(z,L,x,a).minus(m).abs().comparedTo(e(B,b,x,a).minus(m).abs())<1?[z,L]:[B,b],d=W,h},i.toNumber=function(){return+re(this)},i.toPrecision=function(v,S){return v!=null&&Jt(v,1,En),$(this,v,S,2)},i.toString=function(v){var S,b=this,L=b.s,P=b.e;return P===null?L?(S="Infinity",L<0&&(S="-"+S)):S="NaN":(v==null?S=P<=l||P>=u?lm(jr(b.c),P):Go(jr(b.c),P,"0"):v===10&&M?(b=q(new y(b),s+P+1,a),S=Go(jr(b.c),b.e,"0")):(Jt(v,2,I.length,"Base"),S=n(Go(jr(b.c),P,"0"),10,v,L,!0)),L<0&&b.c[0]&&(S="-"+S)),S},i.valueOf=i.toJSON=function(){return re(this)},i._isBigNumber=!0,i[Symbol.toStringTag]="BigNumber",i[Symbol.for("nodejs.util.inspect.custom")]=i.valueOf,t!=null&&y.set(t),y}function zr(t){var e=t|0;return t>0||t===e?e:e-1}function jr(t){for(var e,n,r=1,i=t.length,o=t[0]+"";r<i;){for(e=t[r++]+"",n=Xe-e.length;n--;e="0"+e);o+=e}for(i=o.length;o.charCodeAt(--i)===48;);return o.slice(0,i+1||1)}function Da(t,e){var n,r,i=t.c,o=e.c,s=t.s,a=e.s,l=t.e,u=e.e;if(!s||!a)return null;if(n=i&&!i[0],r=o&&!o[0],n||r)return n?r?0:-a:s;if(s!=a)return s;if(n=s<0,r=l==u,!i||!o)return r?0:!i^n?1:-1;if(!r)return l>u^n?1:-1;for(a=(l=i.length)<(u=o.length)?l:u,s=0;s<a;s++)if(i[s]!=o[s])return i[s]>o[s]^n?1:-1;return l==u?0:l>u^n?1:-1}function Jt(t,e,n,r){if(t<e||t>n||t!==Gr(t))throw Error(wr+(r||"Argument")+(typeof t=="number"?t<e||t>n?" out of range: ":" not an integer: ":" not a primitive number: ")+String(t))}function am(t){var e=t.c.length-1;return zr(t.e/Xe)==e&&t.c[e]%2!=0}function lm(t,e){return(t.length>1?t.charAt(0)+"."+t.slice(1):t)+(e<0?"e":"e+")+e}function Go(t,e,n){var r,i;if(e<0){for(i=n+".";++e;i+=n);t=i+t}else if(r=t.length,++e>r){for(i=n,e-=r;--e;i+=n);t+=i}else e<r&&(t=t.slice(0,e)+"."+t.slice(e));return t}var um=fN();const Sae=t=>{const e=Dt.useRef([]),n=Dt.useRef(null),r=Dt.useRef(),[i,o]=Dt.useState(),[s,a]=Dt.useState(),[l,u]=Dt.useState(),c=Dt.useRef();let d={};const[g,p]=Dt.useState([]),[C,E]=Dt.useState(),[I,M]=Dt.useState(!1),[y,$]=Dt.useState(0),[X,G]=Dt.useState(0),[q,re]=Dt.useState(0),[v,S]=Dt.useState(0),[b,L]=Dt.useState(0),[P,x]=Dt.useState(0);Dt.useEffect(()=>{z()},[t.data]);const W=(T,O,_,Y,U)=>{u({row:T,col:O,hot:Y,originalValue:_}),c.current=U},D=(T,O)=>{let _=T;T!=null&&(_=Dt.cloneElement(T,O)),o(_)},B=T=>{const O={};for(let _ in T)parseInt(_).toString()=="NaN"&&T.hasOwnProperty(_)&&T[_]!=""&&(O[_.replace(/-([a-z])/gi,Y=>Y[1].toUpperCase())]=T[_]);a(O)},z=()=>{e.current=[];let T=[...t.columns];if(t.selected){let _={title:"",width:60,className:"center",editor:!1,copyable:!1,rendereCell:(Y,U)=>su(uR.Checkbox,{disabled:U.readOnly,defaultChecked:Y,onChange:ie=>m(ie,U)})};t.isData&&(_={..._,data:"selected"}),T.unshift(_)}const O={wordWrap:!1};T.forEach(_=>{let Y={...O,..._};_.editorReactNode&&(Y.editor=Cae,Y.renderNode=D,Y.renderStyle=B,Y.afterRenderEdit=W),_.rendereCell&&(Y.renderer=(U,ie,se,oe,de,Se,pe)=>{let we=ie.firstChild,ee=document.createElement("div");return ee.setAttribute("last-data",Se),we?we.getAttribute("last-data")!=Se.toString()&&(d[`index-${se}${oe}`]={td:ee,node:_.rendereCell(Se,pe)},ie.replaceChild(ee,we)):(d[`index-${se}${oe}`]={td:ee,node:_.rendereCell(Se,pe)},ie.appendChild(ee)),pe.className&&ie.classList.add(pe.className),pe.required&&ie.classList.add("is-required"),ie}),_.required&&(_.className=_.className?`${_.className} is-required`:"is-required",_.title=`<span class="is-required">${_.title}</span>`),e.current.push(Y)}),!(!t.data||t.data.length==0)&&(t.selected&&t.data.forEach(_=>{t.isData?_.selected=!1:_.unshift(!1)}),r.current=new Be(n.current,{data:!t.data||t.data.length==0?[]:t.data,columns:e.current,rowHeaders:!0,columnHeaderHeight:40,rowHeights:40,licenseKey:"non-commercial-and-evaluation",afterRender:_=>{let Y=[];Object.keys(d).map(U=>{Y.push(d[U])}),setTimeout(()=>{p(Y)},0)},afterGetColHeader:(_,Y,U)=>{if(t.selected&&_==0){let ie=document.createElement("div");Y.firstChild.firstChild.innerHTML="",Y.firstChild.firstChild.appendChild(ie),E(ie)}},afterSelection:(_,Y,U,ie,se,oe)=>{let de=r.current.getSelected();if((de==null?void 0:de.length)>0){$(de[0][2]-de[0][0]+1),G(de[0][3]-de[0][1]+1);let Se=r.current.getSourceDataArray(de[0][0],de[0][1],de[0][2],de[0][3]),pe=[],we=0;for(let ee=0;ee<Se.length;ee++){let ye=Se[ee];pe=[...pe,...ye];for(let $e=0;$e<ye.length;$e++)we=new um(we).plus(ye[$e]).toNumber()}re(we),S(new um(we).div(pe.length).toNumber()),x(um.min(...pe).toNumber()),L(um.max(...pe).toNumber())}}}))},w=(T,O=!0)=>{var _;c.current&&(c.current.isClose=O),l&&((_=l==null?void 0:l.hot)==null||_.setDataAtCell(l.row,l.col,T),c.current.isClose=!0)},h=()=>l?l.originalValue:null,f=T=>{var O;M(T.target.checked);for(let _=0;_<t.data.length;_++)(O=r.current)==null||O.setDataAtCell([[_,0,T.target.checked]])},m=(T,O)=>{var U,ie;T.target.checked||M(T.target.checked),(U=r.current)==null||U.setDataAtCell([[O.row,O.col,T.target.checked]]);let _=(ie=r.current)==null?void 0:ie.getData(),Y=!0;_==null||_.forEach(se=>{se[0]||(Y=!1)}),M(Y)};return mm(hN.Provider,{value:{handsontableInfo:l,setValue:w,getValue:h},children:[mm("div",{className:"react-handsontable",children:[su("div",{className:"main",children:su("div",{ref:n,children:su("div",{className:"react-node",style:s,children:i&&i})})}),mm("div",{className:"foot-tool",children:["éä¸­[è¡æ°:",y," åæ°:",X," æ±å:",q," å¹³å:",v," æå¤§:",b," æå°:",P,"]"]})]}),g.map(T=>lR.createPortal(T.node,T.td)),C&&lR.createPortal(su(uR.Checkbox,{defaultChecked:I,onChange:f}),C)]})};Xr.ReactHandsontable=Sae,Xr.ReactHandsontableContext=hN,Xr.tuple=pN,Object.defineProperty(Xr,Symbol.toStringTag,{value:"Module"})});
